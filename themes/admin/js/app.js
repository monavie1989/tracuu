webpackJsonp([0],[function(e,t,n){var i,r;i=[n(1),n(6),n(3),n(209),n(289),n(290),n(929)],r=function(e,t,i,r,o,a){n.p=i(document.body).data("static-url")+"dist/webpack/",r.vent.on("change:content",function(e){a(e)}),i(document).on("pjax:end",function(e){r.vent.trigger("change:content",i(e.target))}),i(function(){r.vent.trigger("change:content",i(document.body)),e.history.start({pushState:o})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(151),n(152),n(153),n(154),n(155),n(156),n(159),n(160),n(166),n(169),n(177),n(184),n(186),n(189),n(190),n(146),n(7),n(207),n(208),n(216),n(217),n(218),n(225),n(247),n(252),n(253),n(254),n(282),n(283),n(284),n(285),n(286),n(287),n(288)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,$,S,T,D,P,E,A,I,R,M,j){var L=t(window);t.migrateMute="production"===r,n.extend(e.I18n.keys,i),u(function(){L.off("focus",I),I()}),document.hasFocus&&!document.hasFocus()&&L.one("focus",I),t(document).on("pjax:end",I)}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(146)],r=function(e,t,n,i){return n(function(){var n=t(".pullrequest-list, .issues-list, .repo-list, .snippet-list");n.on("click","a.follow",function(n){var i,r=t(n.target),o=r.closest(".iterable-item").find(".title, .text").text(),a=/#(\d+):/.exec(o),s=a?a[1]:null,l=!r.hasClass("following"),u=r.data("type"),c=s?u+" #"+s:"this "+u;i=l?gettext("You are now watching %(item)s."):gettext("You are no longer watching %(item)s."),e.messages.info({body:interpolate(i,{item:c},!0),fadeout:!0})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i;i=function(){return function(e){return{onReady:e}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(8),n(3),n(147),n(149)],r=function(e,t,n,i){var r=function(e,n){var r=e.find(".text"),o=e.attr("href"),a=e.data("follow-text")||gettext("Follow"),s=e.data("unfollow-text")||gettext("Following"),l=e.data("template");if(r.length||(r=e),l){var u=t(i.toHtml(l,{isFollowing:n,url:o}));return e.replaceWith(u),u}return n?(e.addClass("following"),r.text(s)):(e.removeClass("following"),r.text(a)),e};t(document).on("toggle-follow","a.follow, button.follow",function(e,n){var i=t(e.target).closest("a.follow,button.follow");i=r(i,n.isNowFollowing),i.trigger("follow:"+n.type,n.isNowFollowing)}),t(document).on("click","a.follow,button.follow",function(e){e.preventDefault();var i=t(e.target).closest("a.follow,button.follow"),o=i.attr("href")||i.data("url"),a=i.data("restful"),s=i.hasClass("following"),l="POST";i.attr("aria-disabled",!0),i=r(i,!s),a&&(l=s?"DELETE":i.data("follow-method")||"POST"),t.ajax({url:o,type:l,dataType:"json",success:function(e){var t=void 0===e.following?e.is_watching:e.following,r=e.type;if(void 0===t)return void(window.location.pathname=o);var a={repo:["atl._trackEvent","Share","Follow Repo"],user:["atl._trackEvent","Share","Follow User"],pullrequest:["atl._trackEvent","Notifications","Watch Pull Request"],issue:["atl._trackEvent","Notifications","Watch Issue"],commit:["atl._trackEvent","Notifications","Watch Commit"],snippet:["atl._trackEvent","Notifications","Watch Snippet"]};i.trigger("follow:"+r,t),t&&n(["atl._trackPageview","/"+r+"/follow"],a[r])},error:function(){r(i)},complete:function(){i.removeAttr("aria-disabled")}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(148)],r=function(e,t){var n=!1,i=function(){if(n)t?console&&console.log(["_gaq.push(",e.map(arguments,function(e){return'  ["'+e.join('", "')+'"]'}).join(",\n"),");"].join("\n")):(window._gaq||(window._gaq=[]),window._gaq.push.apply(window._gaq,e.toArray(arguments)));else{n=!0;var r="//www.google-analytics.com/plugins/ga/inpage_linkid.js";i(["_require","inpage_linkid",r],["_setAccount","UA-2456069-3"],["atl._setAccount","UA-6032469-33"]),i.apply(null,arguments)}};return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t="true"===e("#bb-debug").attr("content");return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(150)],r=function(e,t){t.tags=["[[","]]"];var n={};return{toHtml:function(i,r){var o=n[i];return o||(o=t.compile(e("#"+i).html()),n[i]=o),o(r).trim()},clear:function(e){delete n[e]}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i;i=function(){return{"imageDiffer.imageDiffToolbar.button.blend.disabled.tooltip":gettext("Blend mode image diff is not available because images are not of the same dimension"),"imageDiffer.imageDiffToolbar.button.blend.tooltip":gettext("Compare the image changes by fading in the differences"),"imageDiffer.imageDiffToolbar.button.blend":gettext("Blend"),"imageDiffer.imageDiffToolbar.button.split.disabled.tooltip":gettext("Split mode image diff is not available because images are not of the same dimension"),"imageDiffer.imageDiffToolbar.button.split.tooltip":gettext("Compare the image changes by moving your mouse cursor left or right over the image"),"imageDiffer.imageDiffToolbar.button.split":gettext("Split"),"imageDiffer.imageDiffToolbar.button.two-up.tooltip":gettext("Compare images alongside each other"),"imageDiffer.imageDiffToolbar.button.twoup":gettext("Two-up")}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e(document.body).hasClass("production")?"production":e(document.body).hasClass("staging")?"staging":"development"}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){(function(){var e,t,n,i,r,o=[].slice;i=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},n=function(e){return/^\/(.+)\/([gimy]*)$/.exec(e)},t=function(e){var t;return"string"==typeof e?RegExp("^"+i(e)):(t=n(e),RegExp("^"+t[1],t[2]))},e=function(e){var t;return"string"==typeof e?RegExp(""+i(e)+"$"):(t=n(e),RegExp(""+t[1]+"$",t[2]))},r=function(e){var t,n,i,r,o;for(n=[],i=[],r=0,o=e.length;o>r;r++)t=e[r],(_.isRegExp(t)?n:i).push(t);return n.concat(_.sortBy(i,function(e){return-e.length}))},String.prototype.lstrip=function(){var e,n,i,a,s,l;for(i=1<=arguments.length?o.call(arguments,0):[],l=r(i),a=0,s=l.length;s>a;a++)if(n=l[a],e=t(n).exec(this))return this.substr(e[0].length);return this.toString()},String.prototype.rstrip=function(){var t,n,i,a,s,l;for(i=1<=arguments.length?o.call(arguments,0):[],l=r(i),a=0,s=l.length;s>a;a++)if(n=l[a],t=e(n).exec(this))return this.substr(0,this.length-t[0].length);return this.toString()},String.prototype.startsWith=function(){var e,n,i,r;for(n=1<=arguments.length?o.call(arguments,0):[],i=0,r=n.length;r>i;i++)if(e=n[i],t(e).test(this))return!0;return!1},String.prototype.endsWith=function(){var t,n,i,r;for(n=1<=arguments.length?o.call(arguments,0):[],i=0,r=n.length;r>i;i++)if(t=n[i],e(t).test(this))return!0;return!1}}).call(this)},function(e,t){(function(){var e,t,n,i=[].slice;e=String.prototype.format=function(){var n,r,o,a,s,l=this;return n=1<=arguments.length?i.call(arguments,0):[],0===n.length?function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],l.format.apply(l,e)}:(a=0,o=s=!1,r="cannot switch from {} to {} numbering".format(),this.replace(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g,function(i,l,u,c){var d,h,p,f,m;if(l)return l;if(u.length){if(o=!0,s)throw r("implicit","explicit");h=null!=(p=t(n,u))?p:""}else{if(s=!0,o)throw r("explicit","implicit");h=null!=(f=n[a++])?f:""}return h=h.toString(),(d=e.transformers[c])?null!=(m=d.call(h))?m:"":h}))},t=function(e,t){var i;for(/^(\d+)([.]|$)/.test(t)||(t="0."+t);i=/(.+?)[.](.+)/.exec(t);)e=n(e,i[1]),t=i[2];return n(e,t)},n=function(e,t){var n;return n=e[t],"function"==typeof n?n.call(e):n},e.transformers={}}).call(this)},function(e,t){!function(e){e.esc=function(){return _.escape(this)},e.s=function(){return 1!==+this?"s":void 0}}(String.prototype.format.transformers)},function(e,t,n){var i,r;i=[n(3),n(157),n(158)],r=function(e,t){e.support.pjax&&(e.pjax.defaults.timeout=2e3),e(document).on("pjax:end",t),t()}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){var t=[],n=!1,i=function(){for(var e=t.length;e--;)t[e]();n=!0};return i.register=function(){if(t.push.apply(t,e.toArray(arguments)),n)for(var i=arguments.length;i--;)arguments[i]()},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){/*!
	 * Copyright 2012, Chris Wanstrath
	 * Released under the MIT License
	 * https://github.com/defunkt/jquery-pjax
	 */
!function(e){function t(t,i,r){var o=this;return this.on("click.pjax",t,function(t){var a=e.extend({},m(i,r));a.container||(a.container=e(this).attr("data-pjax")||o),n(t,a)})}function n(t,n,i){i=m(n,i);var o=t.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||location.protocol!==o.protocol||location.hostname!==o.hostname||o.href.indexOf("#")>-1&&f(o)==f(location)||t.isDefaultPrevented())){var a={url:o.href,container:e(o).attr("data-pjax"),target:o},s=e.extend({},a,i),l=e.Event("pjax:click");e(o).trigger(l,[s]),l.isDefaultPrevented()||(r(s),t.preventDefault(),e(o).trigger("pjax:clicked",[s]))}}function i(t,n,i){i=m(n,i);var o=t.currentTarget;if("FORM"!==o.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var a={type:o.method.toUpperCase(),url:o.action,container:e(o).attr("data-pjax"),target:o};if("GET"!==a.type&&void 0!==window.FormData)a.data=new FormData(o),a.processData=!1,a.contentType=!1;else{if(e(o).find(":file").length)return;a.data=e(o).serializeArray()}r(e.extend({},a,i)),t.preventDefault()}function r(t){function n(t,n,r){r||(r={}),r.relatedTarget=i;var o=e.Event(t,r);return s.trigger(o,n),!o.isDefaultPrevented()}t=e.extend(!0,{},e.ajaxSettings,r.defaults,t),e.isFunction(t.url)&&(t.url=t.url());var i=t.target,o=p(t.url).hash,s=t.context=g(t.container);t.data||(t.data={}),e.isArray(t.data)?t.data.push({name:"_pjax",value:s.selector}):t.data._pjax=s.selector;var l;t.beforeSend=function(e,i){if("GET"!==i.type&&(i.timeout=0),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Container",s.selector),!n("pjax:beforeSend",[e,i]))return!1;i.timeout>0&&(l=setTimeout(function(){n("pjax:timeout",[e,t])&&e.abort("timeout")},i.timeout),i.timeout=0);var r=p(i.url);o&&(r.hash=o),t.requestUrl=h(r)},t.complete=function(e,i){l&&clearTimeout(l),n("pjax:complete",[e,i,t]),n("pjax:end",[e,t])},t.error=function(e,i,r){var o=b("",e,t),s=n("pjax:error",[e,i,r,t]);"GET"==t.type&&"abort"!==i&&s&&a(o.url)},t.success=function(i,l,u){var d=r.state,h="function"==typeof e.pjax.defaults.version?e.pjax.defaults.version():e.pjax.defaults.version,f=u.getResponseHeader("X-PJAX-Version"),m=b(i,u,t),g=p(m.url);if(o&&(g.hash=o,m.url=g.href),h&&f&&h!==f)return void a(m.url);if(!m.contents)return void a(m.url);r.state={id:t.id||c(),url:m.url,title:m.title,container:s.selector,fragment:t.fragment,timeout:t.timeout},(t.push||t.replace)&&window.history.replaceState(r.state,m.title,m.url);try{document.activeElement.blur()}catch(v){}m.title&&(document.title=m.title),n("pjax:beforeReplace",[m.contents,t],{state:r.state,previousState:d}),s.html(m.contents);var y=s.find("input[autofocus], textarea[autofocus]").last()[0];y&&document.activeElement!==y&&y.focus(),w(m.scripts);var x=t.scrollTo;if(o){var _=decodeURIComponent(o.slice(1)),k=document.getElementById(_)||document.getElementsByName(_)[0];k&&(x=e(k).offset().top)}"number"==typeof x&&e(window).scrollTop(x),n("pjax:success",[i,l,u,t])},r.state||(r.state={id:c(),url:window.location.href,title:document.title,container:s.selector,fragment:t.fragment,timeout:t.timeout},window.history.replaceState(r.state,document.title)),u(r.xhr),r.options=t;var f=r.xhr=e.ajax(t);return f.readyState>0&&(t.push&&!t.replace&&(x(r.state.id,d(s)),window.history.pushState(null,"",t.requestUrl)),n("pjax:start",[f,t]),n("pjax:send",[f,t])),r.xhr}function o(t,n){var i={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return r(e.extend(i,m(t,n)))}function a(e){window.history.replaceState(null,"",r.state.url),window.location.replace(e)}function s(t){if(T===window.location.href)return void(T=null);T=null,u(r.xhr);var n,i=r.state,o=t.state;if(o&&o.container){if(i){if(i.id===o.id)return;n=i.id<o.id?"forward":"back"}var s=P[o.id]||[],l=e(s[0]||o.container),c=s[1];if(l.length){i&&_(n,i.id,d(l));var h=e.Event("pjax:popstate",{state:o,direction:n});l.trigger(h);var p={id:o.id,url:o.url,container:l,push:!1,fragment:o.fragment,timeout:o.timeout,scrollTo:!1};if(c){l.trigger("pjax:start",[null,p]),r.state=o,o.title&&(document.title=o.title);var f=e.Event("pjax:beforeReplace",{state:o,previousState:i});l.trigger(f,[c,p]),l.html(c),l.trigger("pjax:end",[null,p])}else r(p);l[0].offsetHeight}else a(location.href)}}function l(t){var n=e.isFunction(t.url)?t.url():t.url,i=t.type?t.type.toUpperCase():"GET",r=e("<form>",{method:"GET"===i?"GET":"POST",action:n,style:"display:none"});"GET"!==i&&"POST"!==i&&r.append(e("<input>",{type:"hidden",name:"_method",value:i.toLowerCase()}));var o=t.data;if("string"==typeof o)e.each(o.split("&"),function(t,n){var i=n.split("=");r.append(e("<input>",{type:"hidden",name:i[0],value:i[1]}))});else if(e.isArray(o))e.each(o,function(t,n){r.append(e("<input>",{type:"hidden",name:n.name,value:n.value}))});else if("object"==typeof o){var a;for(a in o)r.append(e("<input>",{type:"hidden",name:a,value:o[a]}))}e(document.body).append(r),r.submit()}function u(t){t&&t.readyState<4&&(t.onreadystatechange=e.noop,t.abort())}function c(){return(new Date).getTime()}function d(e){var t=e.clone();return t.find("script").each(function(){this.src||jQuery._data(this,"globalEval",!1)}),[e.selector,t.contents()]}function h(e){return e.search=e.search.replace(/([?&])(_pjax|_)=[^&]*/g,""),e.href.replace(/\?($|#)/,"$1")}function p(e){var t=document.createElement("a");return t.href=e,t}function f(e){return e.href.replace(/#.*/,"")}function m(t,n){return t&&n?n.container=t:n=e.isPlainObject(t)?t:{container:t},n.container&&(n.container=g(n.container)),n}function g(t){if(t=e(t),t.length){if(""!==t.selector&&t.context===document)return t;if(t.attr("id"))return e("#"+t.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+t.selector}function v(e,t){return e.filter(t).add(e.find(t))}function y(t){return e.parseHTML(t,document,!0)}function b(t,n,i){var r={},o=/<html/i.test(t),a=n.getResponseHeader("X-PJAX-URL");if(r.url=a?h(p(a)):i.requestUrl,o)var s=e(y(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),l=e(y(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var s=l=e(y(t));if(0===l.length)return r;if(r.title=v(s,"title").last().text(),i.fragment){if("body"===i.fragment)var u=l;else var u=v(l,i.fragment).first();u.length&&(r.contents="body"===i.fragment?u:u.contents(),r.title||(r.title=u.attr("title")||u.data("title")))}else o||(r.contents=l);return r.contents&&(r.contents=r.contents.not(function(){return e(this).is("title")}),r.contents.find("title").remove(),r.scripts=v(r.contents,"script[src]").remove(),r.contents=r.contents.not(r.scripts)),r.title&&(r.title=e.trim(r.title)),r}function w(t){if(t){var n=e("script[src]");t.each(function(){var t=this.src,i=n.filter(function(){return this.src===t});if(!i.length){var r=document.createElement("script"),o=e(this).attr("type");o&&(r.type=o),r.src=e(this).attr("src"),document.head.appendChild(r)}})}}function x(e,t){P[e]=t,A.push(e),k(E,0),k(A,r.defaults.maxCacheLength)}function _(e,t,n){var i,o;P[t]=n,"forward"===e?(i=A,o=E):(i=E,o=A),i.push(t),(t=o.pop())&&delete P[t],k(i,r.defaults.maxCacheLength)}function k(e,t){for(;e.length>t;)delete P[e.shift()]}function C(){return e("meta").filter(function(){var t=e(this).attr("http-equiv");return t&&"X-PJAX-VERSION"===t.toUpperCase()}).attr("content")}function $(){e.fn.pjax=t,e.pjax=r,e.pjax.enable=e.noop,e.pjax.disable=S,e.pjax.click=n,e.pjax.submit=i,e.pjax.reload=o,e.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:C},e(window).on("popstate.pjax",s)}function S(){e.fn.pjax=function(){return this},e.pjax=l,e.pjax.enable=$,e.pjax.disable=e.noop,e.pjax.click=e.noop,e.pjax.submit=e.noop,e.pjax.reload=function(){window.location.reload()},e(window).off("popstate.pjax",s)}var T=window.location.href,D=window.history.state;D&&D.container&&(r.state=D);var P={},E=[],A=[];e.inArray("state",e.event.props)<0&&e.event.props.push("state"),e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),e.support.pjax?$():S()}(jQuery)},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){var n=[];return"complete"!==document.readyState&&e(window).on("load",function(){n.forEach(function(e){t.defer(e)}),n=[]}),function(e){"complete"===document.readyState?t.defer(e):n.push(e)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(161),n(162)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(t){t.on("click","a",function(n){n.preventDefault(),t.find("input[name=language]").val(e(n.target).attr("data-value")),t.submit()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(147),n(163)],r=function(e,t,n,i){return t(function(e){e.slideDown(),n(["atl._trackEvent","i18n","Show call for translators banner"]),e.on("messageClose",function(){i.set("dismiss-call-for-translators","True")}),e.on("click",".view-language-link",function(){n(["atl._trackEvent","i18n","View language preference","banner"])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(164),n(165)],r=function(e,t,n,i){function r(e){return{url:i.concat("user","preferences",n.username,e),dataType:"json"}}return{get:function(n){return e.ajax(t.extend(r(n),{type:"GET"}))},set:function(n,i){return e.ajax(t.extend(r(n),{type:"PUT",data:{value:i}}))},"delete":function(n){return e.ajax(t.extend(r(n),{type:"DELETE"}))}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).data("currentUser")||{};return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){var t=Array.prototype.concat,n={concat:function(){return e.extend(t.apply(this,e.toArray(arguments)),n)},toString:function(){var n="",i=e.toArray(arguments);if("[object Object]"===Object.prototype.toString.call(e.last(i))){var r=i.pop();e.each(e.keys(r).sort(),function(e,t){n+="{sep}{key}={val}".format({sep:t?"&":"?",key:encodeURIComponent(e),val:encodeURIComponent(r[e])})})}return"/{}/{}".format(e.map(t.apply(this,i),encodeURIComponent).join("/"),n)}},i=e.extend(["!api","1.0"],n);return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(167)],r=function(e,t){window.setInterval(t,6e4),e(function(){t()}),e(document).on("pjax:end",function(){t()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(168)],r=function(e){var t=5,n=Math.abs,i=Math.floor,r=Math.round;return e.localize.format=function(o,a){var s,l,u,c,d,h,p,f,m,g,v;if(null==a&&(a=new Date),l=(o-a)/1e3,l>-10&&300>l)return"just now";if(c=0>l,l=n(l),h=c?"ago":"from now",o.setHours(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),s=n(r((o-a)/864e5)),s>t)return e.localize(o,"yyyy-mm-dd");if(s>1)return""+s+" days "+h;if(l>=86400)return c?"yesterday":"tomorrow";for(g=[["an hour",3600],["a minute",60],["a second",1]],f=0,m=g.length;m>f&&(v=g[f],p=v[0],d=v[1],!(l>=d));f++);return u=i(l/d),1===u?""+p+" "+h:""+u+" "+p.split(" ")[1]+"s "+h},function(t){t=t&&t.length?t:e("time"),t.each(function(){var t=e(this),n=t.data();n.format?t.localize({format:n.format,periods:n.associatedPressPeriods?["a.m.","p.m."]:void 0}):n.relative!==!1&&t.localize();var i=new Date(t.attr("datetime"));t.attr({title:e.localize(i,"d mmmm yyyy HH:MM")})})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){(function(){var e,t,n,i,r,o,a,s;a="0.8.0",o=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(?:[.](\d+))?)?(?:([-+]\d\d):(\d\d)|Z)$/,n=function(e,t,n){return null==t&&(t=0),null==n&&(n=0),e.setHours(s.H(e)-t,s.M(e)+(+t>0?-n:+n)),e},t=function(t){return i[t]||e[t]},r=function(e,t){return null==t&&(t=2),(e+1e3+"").substr(4-t)},s={yy:function(e){return r(s.yyyy(e)%100)},yyyy:function(e){return e.getFullYear()},m:function(e){return e.getMonth()+1},mm:function(e){return r(s.m(e))},mmm:function(e){return t("abbrMonths")[s.m(e)-1]},mmmm:function(e){return t("fullMonths")[s.m(e)-1]},d:function(e){return e.getDate()},dd:function(e){return r(s.d(e))},ddd:function(e){return t("abbrDays")[e.getDay()]},dddd:function(e){return t("fullDays")[e.getDay()]},o:function(e){return t("ordinals")(s.d(e))},h:function(e){return s.H(e)%12||12},hh:function(e){return r(s.h(e))},H:function(e){return e.getHours()},HH:function(e){return r(s.H(e))},M:function(e){return e.getMinutes()},MM:function(e){return r(s.M(e))},s:function(e){return e.getSeconds()},ss:function(e){return r(s.s(e))},S:function(e){return""+s.s(e)+"."+r(e%1e3,3)},SS:function(e){return""+s.ss(e)+"."+r(e%1e3,3)},a:function(e){return t("periods")[+(s.H(e)>11)]},Z:function(e){var t,n;return t=Math.abs(n=-e.getTimezoneOffset()),""+(0>n?"-":"+")+r(t/60>>0)+":"+r(t%60)}},e=function(t,n){var i,r,o,a,l,u,c;if(t instanceof Date||(n=t,t=new Date),n||(n=e.format),"function"==typeof n)return n(t);for(a=null,r=o="",c=(""+n.replace(/~/g,"~T").replace(/%%/g,"~P")+"%").split(""),l=0,u=c.length;u>l;l++)i=c[l],r&&(i===a||"%"===r?r+=i:(r=r.substr(1),o+=s.hasOwnProperty(r)?e.escaped?jQuery("<b>").text(s[r](t)).html():s[r](t):r)),/%/.test(r)||(r=/%/.test(n)?"%"===i?"%":(o+=i,""):"%"+i),a=i;return o.replace(/~P/g,"%").replace(/~T/g,"~")},e.abbrDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.abbrMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.fullDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.fullMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],e.format="d mmmm yyyy",e.periods=["AM","PM"],e.ordinals=function(e){return e+["th","st","nd","rd"][e>10&&14>e||(e%=10)>3?0:e]},e.version=a,jQuery.localize=e,i={},jQuery.fn.localize=function(t){var r;return"object"==typeof t&&(jQuery.extend(i,t),t=i.format),t||(t=e.format),r=i.escaped?"html":"text",this.each(function(){var i,a,s;return i=jQuery(this),"time"===this.nodeName.toLowerCase()&&(s=o.exec(i.attr("datetime")||e("yyyy-mm-ddTHH:MM:ssZ"))),s?(a=n(new Date(Date.UTC(+s[1],s[2]-1,+s[3],+s[4],+s[5],+s[6]||0,+(""+(s[7]||0)+"00").substr(0,3))),s[8],s[9]),i.attr("datetime",e(a,"yyyy-mm-ddTHH:MM"+(s[7]?":SS":s[6]?":ss":"")+"Z")),i[r]("function"==typeof t?t.call(i,a):e(a,t))):void 0}),i={},this}}).call(this)},function(e,t,n){var i,r;i=[n(3),n(2),n(170),n(171),n(172),n(173),n(147),n(174),n(175)],r=function(e,t,n,i,r,o,a,s,l){a(["_trackPageview"]),a(["atl._trackPageview"]),n.analyticsKey&&a(["repo._setAccount",n.analyticsKey],["repo._trackPageview"]),t.each(i,function(e){switch(e.type){case"trackPageview":a(["atl._trackPageview",e.pageName]);break;case"trackEvent":a(["atl._trackEvent",e.eventCategory,e.eventName]);break;case"setCustomVar":a(["atl._setCustomVar",e.customVarSlot,e.customVarName,e.customVarValue,e.customVarScope])}}),t.each(r,function(e){s(e)}),o&&o.length>0&&l(o),e(".support-ga").on("click submit",function(t){var n=e(this).data("support-gaq-page");a(["_trackPageview","/support/"+n],["atl._trackPageview","/support/"+n])}),e("#plan-details .aui-button-primary").on("click",function(){a(["atl._trackEvent","Account","Over Plan Upgrade"])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).data("currentRepo")||{owner:{username:""},slug:""};return t.toString=function(){return t.cname?t.slug:"{owner.username}/{slug}".format(t)},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).data("gaCommands")||[];return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).data("optCommands")||[];return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e(document.body).data("sioCommands")||[]}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(148)],r=function(e,t){return function(n){n=e.isArray(n)?n:["trackEvent",n],t?console&&console.log('window.optimizely.push(["'+n.join('", "')+'"])'):(window.optimizely=window.optimizely||[],window.optimizely.push(n))}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(148),n(176)],r=function(e,t,n){return function(i){t?console&&console.log('segment (["'+i.join('", "')+'"])'):n().then(function(){e.each(i,function(e){window.analytics[e[0]].apply(null,e[1])})})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(148)],r=function(e,t,n){return function(){var t;return n||t||(t=new e.Deferred,e.getScript("https://ace-cdn.atlassian.com/stp/current/analytics/js/atl-analytics.min.js").done(function(){window.ace.analytics.Initializer.initWithPageAnalytics("kFTUHPhH9Q"),window.ace.analytics.Initializer.ready(function(){t.resolve()})})),t.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(178),n(2),n(164),n(157),n(179),n(158)],r=function(e,t,n,i,r,o,a){if(r.isKbdShortcutsEnabled){var s=function(t){var i=e(".iterable-item.focused  a.execute:visible").first();if(i.length){t.preventDefault();var r=i.attr("href");if(!i.data("add-to-stack")){var o=n.get("lastFocusedIdArray")||[];o.push({id:r}),n.set("lastFocusedIdArray",o),n.set("leaveFocusedUniqueId",!0)}i.hasClass("click")||e.support.pjax&&i.data("bb-pjax-enabled")?i.click():window.location.href=r}},l=function(){return e("a.next-page, a.prev-page").length},u=function(){var t=e("a.next-page");t.attr("href")&&(n.set("focusFirst",!0),a.disabled=!0,e.support.pjax&&t.data("bb-pjax-enabled")?t.click():window.location=t.attr("href"))},c=function(){var t=e("a.prev-page");t.attr("href")&&(n.set("focusLast",!0),a.disabled=!0,e.support.pjax&&t.data("bb-pjax-enabled")?t.click():window.location=t.attr("href"))},d=[{section:gettext("Global navigation"),shortcuts:[{keys:["g","d"],description:gettext("Go to dashboard"),op:"followLink",params:["#logo a"]},{keys:["g","a"],description:gettext("Go to account settings"),op:"followLink",params:["#account-link"],guard:"#user-dropdown-trigger"},{keys:["g","i"],description:gettext("Go to inbox"),op:"followLink",params:["#inbox-link"],guard:"#user-dropdown-trigger"},{keys:["/"],description:gettext("Focus the site search"),op:"focus",params:["#search-query"]}]},{section:gettext("Global actions"),shortcuts:[{keys:["c","r"],description:gettext("Create a repository"),op:"followLink",params:["#create-repo-link"],guard:"#repositories-dropdown-trigger"},{keys:["i","r"],description:gettext("Import a repository"),op:"followLink",params:["#import-repo-link"],guard:"#repositories-dropdown-trigger"}]},{section:gettext("Repository navigation"),shortcuts:[{keys:["r","o"],description:gettext("Repository overview"),guard:"#repo-overview-link",op:"followLink",params:["#repo-overview-link"]},{keys:["r","s"],description:gettext("Repository source"),guard:"#repo-source-link",op:"followLink",params:["#repo-source-link"]},{keys:["r","c"],description:gettext("Repository commits"),guard:"#repo-commits-link",op:"followLink",params:["#repo-commits-link"]},{keys:["r","b"],description:gettext("Repository branches"),guard:"#repo-branches-link",op:"followLink",params:["#repo-branches-link"]},{keys:["r","p"],description:gettext("Repository pull requests"),guard:"#repo-pullrequests-link",op:"followLink",params:["#repo-pullrequests-link"]},{keys:["r","q"],description:gettext("Repository patch series"),guard:"#repo-patch-series-link",op:"followLink",param:["#repo-patch-series-link"]},{keys:["r","w"],description:gettext("Repository wiki"),guard:"#repo-wiki-link",op:"followLink",params:["#repo-wiki-link"]},{keys:["r","i"],description:gettext("Repository issues"),guard:"#repo-issues-link",op:"followLink",params:["#repo-issues-link"]},{keys:["r","d"],description:gettext("Repository downloads"),guard:"#repo-downloads-link",op:"followLink",params:["#repo-downloads-link"]},{keys:["r","a"],description:gettext("Repository administration"),guard:"#repo-admin-link",op:"followLink",params:["#repo-admin-link"]}]},{section:gettext("Repository actions"),shortcuts:[{keys:["x","f"],description:gettext("Fork repository"),guard:"#repo-fork-link, .repository-actions.forks-enabled",op:"followLink",params:["#repo-fork-link"]},{keys:["x","b"],description:gettext("Create branch"),guard:"#repo-create-branch-link, .repository-actions.can-create",op:"click",params:["#repo-create-branch-link"]},{keys:["x","c"],description:gettext("Compare repository"),guard:"#repo-compare-link, .repository-actions",op:"followLink",params:["#repo-compare-link"]},{keys:["x","p"],description:gettext("Create pull request"),guard:"#repo-create-pull-request-link, .repository-actions.can-create",op:"followLink",params:["#repo-create-pull-request-link"]},{keys:["x","i"],description:gettext("Create issue"),guard:"#repo-issues-link",op:"followLink",params:["#repo-create-issue"]},{keys:["x","u"],description:gettext("Invite user to repository"),guard:"#repo-invite-link",op:"click",params:["#repo-invite-link"]},{keys:["x","w"],description:gettext("Follow repository"),guard:"#repo-follow",op:"click",params:["#repo-follow"]}]},{section:gettext("List navigation"),shortcuts:[{keys:["j"],description:gettext("Select next item"),guard:".iterable-item:visible",op:"moveToNextItem",params:[".iterable-item:visible",l,u]},{keys:["k"],description:gettext("Select previous item"),guard:".iterable-item:visible",op:"moveToPrevItem",params:[".iterable-item:visible",l,c]},{keys:["return"],aliasKeys:["o"],description:gettext("View selected item"),guard:".iterable-item:visible",op:"execute",params:[s]}]},{section:gettext("Application"),shortcuts:[{keys:["?"],description:gettext("Display this help"),op:"kbShortcutsDialog",always:!0},{keys:["esc"],description:gettext("Dismiss dialog or remove focus"),op:"dismiss",always:!0},{keys:["u"],description:gettext("Back up"),op:"execute",params:[function(){n.set("leaveFocusedUniqueId",!0),window.history.back()}]},{keys:["["],description:gettext("Collapse/expand sidebar"),op:"execute",params:[e.noop],guard:".aui-sidebar"}]},{section:gettext("Commits / pull requests"),shortcuts:[{keys:["ctrl+return"],delegate:"textarea#id_new_comment",description:gettext("Submit your comment."),op:"submitComment",always:!0},{keys:["t","c"],description:gettext("Toggle display of inline comments"),guard:"#changeset-diff",op:"execute",params:[function(){var t=e("#changeset-diff");t.find(".comment-thread-container").addClass("existing-comment"),t.toggleClass("hide-comments")}]},{keys:["p","d"],description:gettext("Switch to the pull request diff tab"),guard:"#pr-menu-diff",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-diff",500,{axis:"y",offset:-50}),e("#pr-menu-diff").click()}]},{keys:["p","c"],description:gettext("Switch to the pull request commits tab"),guard:"#pr-menu-commits",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-commits",500,{axis:"y",offset:-50}),e("#pr-menu-commits").click()}]},{keys:["p","a"],description:gettext("Switch to the pull request activity tab"),guard:"#pr-menu-activity",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-activity",500,{axis:"y",offset:-50}),e("#pr-menu-activity").click()}]}]}];a.fromJSON(d);var h=function(){var i=null;if(n.get("focusLast"))i=e(".iterable-item:visible").last(),n.remove("focusLast"),a.disabled=!1;else if(n.get("focusFirst"))i=e(".iterable-item:visible").first(),n.remove("focusFirst"),a.disabled=!1;else{var r=n.get("lastFocusedIdArray");if(r)for(;r.length;){var o=r.pop();if(i=e('.iterable a[href="'+o.id+'"]:visible').closest(".iterable-item"),i.length){n.set("lastFocusedIdArray",r),n.remove("leaveFocusedUniqueId"),a.disabled=!1;break}}}if(i&&i.length){i.addClass("focused");var s=i.find("a.execute");s.length||(s=i.find("a:first")),s.focus(),e(document).one("keydown",function(e){e.keyCode===t.keyCode.ESCAPE&&(i.removeClass("focused"),i.find("a:focus").blur())})}};o.register(h),e(document).on("bb:compare",h);var p=window.onbeforeunload;window.onbeforeunload=function(e){return n.get("leaveFocusedUniqueId")||n.remove("lastFocusedIdArray"),n.remove("leaveFocusedUniqueId"),"function"==typeof p?p(e):void 0}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i=function(){function e(){try{return s in o&&o[s]}catch(e){return!1}}function t(){try{return l in o&&o[l]&&o[l][o.location.hostname]}catch(e){return!1}}function n(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(i),a.body.appendChild(i),i.addBehavior("#default#userData"),i.load(s);var n=e.apply(r,t);return a.body.removeChild(i),n}}var i,r={},o=window,a=o.document,s="localStorage",l="globalStorage",u="__storejs__";if(r.disabled=!1,r.set=function(e,t){},r.get=function(e){},r.remove=function(e){},r.clear=function(){},r.transact=function(e,t){var n=r.get(e);"undefined"==typeof n&&(n={}),t(n),r.set(e,n)},r.serialize=function(e){return JSON.stringify(e)},r.deserialize=function(e){return"string"!=typeof e?void 0:JSON.parse(e)},e())i=o[s],r.set=function(e,t){i.setItem(e,r.serialize(t))},r.get=function(e){return r.deserialize(i.getItem(e))},r.remove=function(e){i.removeItem(e)},r.clear=function(){i.clear()};else if(t())i=o[l][o.location.hostname],r.set=function(e,t){i[e]=r.serialize(t)},r.get=function(e){return r.deserialize(i[e]&&i[e].value)},r.remove=function(e){delete i[e]},r.clear=function(){for(var e in i)delete i[e]};else if(a.documentElement.addBehavior){var i=a.createElement("div");r.set=n(function(e,t,n){e.setAttribute(t,r.serialize(n)),e.save(s)}),r.get=n(function(e,t){return r.deserialize(e.getAttribute(t))}),r.remove=n(function(e,t){e.removeAttribute(t),e.save(s)}),r.clear=n(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(s);for(var n,i=0;n=t[i];i++)e.removeAttribute(n.name);e.save(s)})}try{r.set(u,u),r.get(u)!=u&&(r.disabled=!0),r.remove(u)}catch(c){r.disabled=!0}return r}();e.exports=i},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(180),n(181),n(182)],r=function(e,t,n,i,r,o){var a=function(n,i,s,l,u){function c(e){for(var t=e.length;t--;)if(e[t].length>1&&"space"!==e[t])return!0;return!1}var d,h,p,f=function(e,t,n){return n=t.length>1?interpolate(gettext("( type %(key1)s then %(key2)s )"),{key1:t[0],key2:t[1]},!0):interpolate(gettext("( type %(key1)s )"),{key1:t[0]},!0)},m=function(e){var i=t(e),r=i.attr("title")||"",o=n.slice(0);i.data("kbShortcutAppended")?(r=r.replace(/\)$/," OR "),r+=f(i,o,r).replace("(","")):(r=r?" ":"",r+=f(i,o,r)),i.attr({title:r}),i.data("kbShortcutAppended",!0)},g=function(e){var n=c(e)?"keydown":"keypress";t(document).on(n,u,e,function(e){d&&(l||!a.disabled&&!t("#keyboard-shortcut-container").is(":visible"))&&(!h||t(h).is(":visible"))&&(d(e),(u||13!==e.keyCode)&&e.preventDefault())})};return s||(s="Application"),Object.hasOwnProperty.call(r.keyDataMap,s)||(r.sections.push(s),r.keyDataMap[s]=[]),p={keys:[n],desc:i},r.keyDataMap[s].push(p),g(n),{or:function(e){return p.keys.push(e),g(e),this},moveToNextItem:function(n,i,r){d=function(){var o,a,s;if(t(".aui-dialog:visible").length&&-1===n.indexOf(".aui-dialog:visible")&&(n=".aui-dialog:visible "+n),a=t(n),s=t(n).filter(".focused"),d.blurHandler||t(document).one("keydown",function(t){t.keyCode===e.keyCode.ESCAPE&&s&&(s.removeClass("focused"),s.find("a:first").blur())}),0===s.length?s=t(n).eq(0):(s.removeClass("focused"),o=t.inArray(s.get(0),a),o<a.length-1?(o+=1,s=a.eq(o)):i&&i()?r():(s.removeClass("focused"),s=t(n).eq(0))),s&&s.length>0){s.addClass("focused"),s.moveTo();var l=s.find("a.execute");l.length||(l=s.find("a:first")),l.focus()}}},moveToPrevItem:function(n,i,r){d=function(){var o,a,s;t(".aui-dialog:visible").length&&-1===n.indexOf(".aui-dialog:visible")&&(n=".aui-dialog:visible "+n),a=t(n),s=t(n).filter(".focused"),d.blurHandler||t(document).one("keydown",function(t){t.keyCode===e.keyCode.ESCAPE&&s&&(s.removeClass("focused"),s.find("a:first").blur())}),0===s.length?s=t(n).last():(s.removeClass("focused"),o=t.inArray(s.get(0),a),o>0?(o-=1,s=a.eq(o)):i&&i()?r():(s.removeClass("focused"),s=t(n).last())),s&&s.length>0&&(s.addClass("focused"),s.moveTo(),s.find("a:first").focus())}},click:function(e){m(e),d=function(){t(e).trigger("click")}},goTo:function(e){d=function(){window.location.href=e}},followLink:function(e){m(e),d=function(){var n=t(e)[0];n&&"a"===n.nodeName.toLowerCase()&&(window.location.href=n.href)}},execute:function(e){d=e},moveToAndClick:function(e){m(e),d=function(){t(e).click().moveTo()}},moveToAndFocus:function(e){m(e),d=function(){t(e).focus().moveTo()}},focus:function(e){m(e),d=function(){t(e).focus()}},submitComment:function(){d=function(e){var n,i,r=t(e.currentTarget);1===r.length&&(n=r.closest("form"),1===n.length&&(i=n.find("button[type=submit]"),1===i.length&&i.click()))}},kbShortcutsDialog:function(){d=o},dismiss:function(){d=function(){t("#keyboard-shortcut-container").remove()}},guard:function(e){h=e,p.guard=e}}};return a.fromJSON=function(e){n.each(e,function(e){var t=e.section;n.each(e.shortcuts,function(e){var n=e.op,i=e.params||[],r=e.guard,o=a(e.keys,e.description,t,e.always,e.delegate);o[n].apply(null,i),r&&o.guard(r),e.aliasKeys&&o.or(e.aliasKeys)})})},t(document).on("keydown",function(e){27===e.keyCode&&/^(input|select|textarea)$/i.test(e.target.nodeName)&&e.target.blur()}),t(document).on("iframeAppended",function(e,n){t(n).load(function(){t(n).contents().bind("keyup keydown keypress",function(e){("Safari"!==i.browser||"keypress"!==e.type)&&(/^(input|select|textarea)$/i.test(e.target.nodeName)||t(document).trigger(e))})})}),a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;!function(o,a){i=a,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}(this,function(e){var t={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,i=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!==n.indexOf(e[t].subString))return e[t].identity}else if(i)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!==t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv:"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};t.init();var n={os:t.OS,browser:t.browser};return e.initialize&&(document.body.className+=" "+n.os.toLowerCase()+" "+n.browser.toLowerCase()),n})},function(e,t,n){var i;i=function(){return{sections:[],keyDataMap:{}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(181),n(183)],r=function(e,t,n,i,r){function o(){a&&a.hide().remove(),a=null;
}var a;return function(){if(a){var e=a.popup.element.is(":visible");if(o(),e)return}a=new r({width:800,height:"auto",id:"bb-keyboard-shortcuts-dialog"}),a.addPanel("main").addHeader("Keyboard shortcuts").addCancel("Close",function(){o()});var s=t('<section id="keyboard-shortcuts" class="aui-group"></div>'),l=t('<div class="aui-item"></div>').appendTo(s),u=t('<div class="aui-item"></div>').appendTo(s),c=1;n.each(i.sections,function(e){var r,o="";n.each(i.keyDataMap[e],function(e){(!e.guard||t(e.guard).is(":visible"))&&(o+="<dt>"+e.desc+"</dt>",o+="<dd>",o+=n.map(e.keys,function(e){return"<kbd>"+e.join("</kbd> then <kbd>")+"</kbd>"}).join(" or "),o+="</dd>")}),o&&(c++,r=t('<div class="keyboard-shortcut-context"></div>'),r.append('<h3 class="context-title">'+e+"</h3>"),t("<dl></dl>").append(o).appendTo(r),(c%2?u:l).append(r))}),a.getCurrentPanel().html(s),a.show()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8)],r=function(e,t){return function(n){var i,r=new t.Dialog(n);if(n.id){i=e("#{}".format(n.id)),i.addClass("bb-dialog").attr("data-aui-blanketed","true").attr("data-aui-modal","true").css({"margin-left":0,"margin-top":0});var o=t.layer.Manager||t.LayerManager;t.bind("show.dialog",function(e,t){t.dialog===r&&o.global.push(i)}).bind("hide.dialog",function(e,t){t.dialog===r&&o.global.popUntil(i)})}return r}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(185)],r=function(e,t,n){t.fn.select2.defaults.minimumResultsForSearch=8,n(function(){t("select.aui-select2").each(function(){var e,n=t(this);e=n.find("option").first(),e.val()||"---------"!==e.text()||e.text("")}).auiSelect2()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(t,n){var i=function(){if(n){var i=e(t);i.length&&n(i)}else t()};e(document).on("pjax:end",i),e(i)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187),n(3),n(145),n(164),n(147),n(188)],r=function(e,t,n,i,r){return n(function(n){var o,a;n.hasClass("ad")?(o=function(e){var n=t(e.target).parent(".bb-banner").attr("data-analytics");r(["atl._trackEvent","Advertisement",n+" - view"])},a=function(){var t=n.attr("data-analytics"),o=n.attr("data-ad");e.user(i.username).remove_ad(o,{}),n.addClass("hidden"),r(["atl._trackEvent","Advertisement",t+"- hide"])}):n.hasClass("feature")?(o=function(){r(["atl._trackEvent","Advertisement","new-feature-banner - view"])},a=function(){var t=n.attr("data-featureid");e.user(i.username).feature_viewed(t,{}),n.addClass("hidden"),r(["atl._trackEvent","Feature","new-feature-banner- hide"])},n.find(".tweet").on("click",function(){r(["atl._trackEvent","Advertisement","new-feature-banner - tweet"])})):n.is("#signup-banner")&&(o=function(){r(["atl._trackEvent","Signup","Signup Banner","Clicked"])},a=function(){t.cookie("bb.hide-signup-banner",!0),n.remove(),r(["atl._trackEvent","Signup","Signup Banner","Dismissed"])}),n.find(".signup-button").on("click",o),n.find(".close").on("click",a)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i=n(3);(function(){var e,t,n,r,o,a,s,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,$,S,T,D,P,E,A,I,R=[].slice,M={}.hasOwnProperty,j=function(e,t){function n(){this.constructor=e}for(var i in t)M.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r={},n=function(e,t){return function(){var n;return n=1<=arguments.length?R.call(arguments,0):[],t.apply(e,n)}},b=function(e,t){return null==e&&(e={}),"function"==typeof e&&(e={success:e}),void 0!==t&&(e.data=t),e},s=function(e,t){var n;return e=b(e),(n=e.success)&&(e.success=function(e,i,r){return n(t(e),i,r)}),e},S=function(e,t,n){var i,r,o,a,s;if(r=/^(.+?)[.](.+)$/.exec(t))S(e[r[1]],r[2],n);else if(r=/^\[(.+)\]$/.exec(t))for(t=r[1],a=0,s=e.length;s>a;a++)o=e[a],n(o,t);else if(r=/^\{(.+)\}$/.exec(t)){t=r[1];for(i in e)M.call(e,i)&&(o=e[i],n(o,t))}else n(e,t);return e},x=function(e,t){var n,i;e=b(e);for(i in t)M.call(t,i)&&(n=t[i])(i,e);return e},w=function(e){return function(t,n){return s(n,function(n){return S(n,t,e)})}},a={utc_created_on:"date_created",utc_last_updated:"date_updated",utc_sent_on:"date_created",utc_updated_on:"date_updated"},e=w(function(e,t){var n,i,r,o,s,l,u,c;for(u=t.split(","),s=0,l=u.length;l>s;s++)i=u[s],c=i.split(":"),o=c[0],r=c[1],(n=e[o])&&(r||(r=a[o]||"date"),delete e[o],delete e[o.replace(/^utc_?/,"")],e[r]=new Date(n.replace(" ","T")));return e}),y=w(function(e){return-1===e.size?delete e.size:void 0}),t=function(e,t){var n,i;return e===t?0:(n=e.toLowerCase(),i=t.toLowerCase(),(n===i?t>e:i>n)?-1:1)},d=w(function(e,n){var i,r,o,a,s;return s=n.split(":"),o=s[0],r=s[1],o in e&&(a=e[o].replace(/^\s+|\s+$/g,""),i=a?a.split(/\s*[\n\r]\s*/).sort(t):[],delete e[o],e[r||o]=i),e}),g=w(function(e,t){var n,i,r,o;return o=t.split(":"),i=o[0],n=o[1],i in e&&(r=e[i],delete e[i],e[n]=r),e}),T=w(function(e,t){var n,i,r,o,a,s;for(a=t.split(":"),t=a[0],i=a[1],s=i.split(","),r=0,o=s.length;o>r;r++)n=s[r],e[n]=e[t][n];return delete e[t],e}),v=function(e,t){return s(t,function(t){return t[e]})},c=function(e){return function(){var t,n,o,a,s;return o=arguments[0],a=3<=arguments.length?R.call(arguments,1,s=arguments.length-1):(s=1,[]),n=arguments[s++],t=a[0],n=b(n,t),n.type=e,n.url=o,"GET"!==e||r.proxy_url||(n.dataType="jsonp"),i.ajax(n)}},h=c("POST"),u=c("GET"),f=c("PUT"),l=c("DELETE"),D=function(){var e,t;return e=1<=arguments.length?R.call(arguments,0):[],t=r.proxy_url,(t||"https://bitbucket.org/!api/1.0/")+e.join("/")},m=function(e){var t,n,i,r,o,a,s,l,u;if(null==e&&(e={}),i=function(){var t;t=[];for(n in e)M.call(e,n)&&t.push(n);return t}().sort(),0===i.length)return"";for(t=[],a=0,l=i.length;l>a;a++)for(n=i[a],o=e[n],o instanceof Array||(o=[o]),s=0,u=o.length;u>s;s++)r=o[s],t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return"?"+t.join("&")},r.error=function(e){function t(e){return this instanceof t?(this.name="bitbucket.error",void(this.message=e)):new t(e)}return j(t,e),t}(Error),k=function(t,n,i){var r,o;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),r=["component","kind","milestone","version"],o={},o[i.replace(/%/,"utc_created_on,utc_last_updated")]=e,o[i.replace(/%/,"metadata:"+r.join())]=T,x(b(t,n),o)},C=function(t,n,i){var r;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),r={},r[i.replace(/%/,"utc_created_on,utc_updated_on")]=e,r[i.replace(/%/,"author_info:author")]=g,x(b(t,n),r)},$=function(t,n,i){var r;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),null!=(null!=n?n.mailing_lists:void 0)&&(n.email_mailinglist=n.mailing_lists.join("\n"),delete n.mailing_lists),r={},r[i.replace(/%/,"utc_created_on,utc_last_updated")]=e,r[i.replace(/%/,"email_mailinglist:mailing_lists")]=d,x(b(t,n),r)},_=function(t,n){var i;return null==n&&(n="%"),i={},i[n.replace(/%/,"utctimestamp")]=e,i[n.replace(/%/,"size")]=y,x(b(t),i)},r.flags={access:{direct:1,via_groups:2},output:{include_groups:4}},p=function(){var e,t,n,i,o,a,s,l,u,c;for(s=["read","write","admin"],l={},o=u=0,c=s.length;c>u;o=++u)i=s[o],l[i]=o;return a=function(){var e;return e=1<=arguments.length?R.call(arguments,0):[],s[Math.max.apply(Math,function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)i=e[t],r.push(l[i]||0);return r}())]},e=r.flags.access.direct,t=r.flags.access.via_groups,n=r.flags.output.include_groups,function(i){return{direct:e,expand:t,flags:i,groups:n,max:a,privileges:{}}}}(),r.repositories=function(){var e,t,n,i;return n=2<=arguments.length?R.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],u(D("repositories")+m(t),$(e,"repositories.[%]"))},r.repository=function(){function t(e,n){var i;return null==n&&(i=e.split("/"),e=i[0],n=i[1]),this instanceof t?(this.username=e,void(this.slug=n)):new t(e,n)}return t.create=function(e,n){var i,o;if(o=e.username,i=e.slug,!o||!i)throw r.error('"username" and "slug" are required attributes');if(/^[.]{1,2}$/.test(i))throw r.error('"'+i+'" is an invalid slug');if(/[^a-z0-9.-]/.test(i))throw r.error('"'+i+'" does not match /^[a-z0-9.-]+$/');return delete e.username,delete e.slug,e.name=i,h(D("repositories"),$(n,e)),t(o,i)},t.prototype.toString=function(){return this.username+"/"+this.slug},t.prototype.url=function(){var e;return e=1<=arguments.length?R.call(arguments,0):[],D.apply(null,["repositories",this.username,this.slug].concat(R.call(e)))},t.prototype.details=function(e){return u(this.url(),$(e))},t.prototype.update=function(e,t){return f(this.url(),$(t,e))},t.prototype.destroy=function(e){return l(this.url(),e)},t.prototype.branches=function(t){return u(this.url("branches"),x(t,{"{utctimestamp}":e,"{size}":y}))},t.prototype.changeset=function(e,t){return u(this.url("changesets",e),_(t))},t.prototype.changesets=function(){var e,t,n,i;return n=2<=arguments.length?R.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],u(this.url("changesets")+m(t),_(e,"changesets.[%]"))},t.prototype.diffstat=function(e,t){return u(this.url("changesets",e,"diffstat"),t)},t.prototype.directory=function(){var t,n,i,r;return i=arguments[0],n=3<=arguments.length?R.call(arguments,1,r=arguments.length-1):(r=1,[]),t=arguments[r++],u(this.url("src",i,n),x(t,{"files.[utctimestamp]":e}))},t.prototype.file=function(e,t,n){return u(this.url("src",e,t),v("data",n))},t.prototype.followers=function(e){return u(this.url("followers"),v("followers",e))},t.prototype.create_issue=function(e,t){return h(this.url("issues"),k(t,e))},t.prototype.update_issue=function(e,t,n){return f(this.url("issues",e),k(n,t))},t.prototype.delete_issue=function(e,t){return l(this.url("issues",e),t)},t.prototype.issue=function(e,t){return u(this.url("issues",e),k(t))},t.prototype.create_issue_comment=function(e,t,n){return h(this.url("issues",e,"comments"),C(n,t))},t.prototype.update_issue_comment=function(e,t,n,i){return f(this.url("issues",e,"comments",t),C(i,n))},t.prototype.delete_issue_comment=function(e,t,n){return l(this.url("issues",e,"comments",t),n)},t.prototype.issue_comment=function(e,t,n){return u(this.url("issues",e,"comments",t),C(n))},t.prototype.issue_comments=function(e,t){return u(this.url("issues",e,"comments"),C(t,"[%]"))},t.prototype.issue_followers=function(e,t){return u(this.url("issues",e,"followers"),v("followers",t))},t.prototype.issues=function(){var e,t,n,i;return n=2<=arguments.length?R.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],u(this.url("issues")+m(t),k(e,"issues.[%]"))},t.prototype.create_linkifier=function(e,t){return h(this.url("links"),e,t)},t.prototype.update_linkifier=function(e,t,n){return f(this.url("links",e),t,n)},t.prototype.delete_linkifier=function(e,t){return l(this.url("links",e),t)},t.prototype.linkifier=function(e,t){return u(this.url("links",e),t)},t.prototype.linkifiers=function(e){},t.prototype.deploy_key=function(e,t,n){return u(this.url("deploy-keys",e),t,n)},t.prototype.deploy_keys=function(e,t){return u(this.url("deploy-keys"),e,t)},t.prototype.create_deploy_key=function(e,t){return h(this.url("deploy-keys"),e,t)},t.prototype.update_deploy_key=function(e,t,n){return f(this.url("deploy-keys",e),t,n)},t.prototype.delete_deploy_key=function(e,t){return l(this.url("deploy-keys",e),t)},t.prototype.privileges=function(e,t){var i,r,o,a,s,l;return null==t&&(t=e,e=3),t=b(t),s=t.success||function(){},o=t.error||function(){},r=p(e),i=2,l=function(){return--i>0},a=!1,t.error=function(e,t,n){return a?void 0:(o(e,t,n),a=!0)},t.success=n(r,function(e,t,n){var i,r,o,a,u,c;if(this.flags&this.direct)for(a=0,u=e.length;u>a;a++)c=e[a],i=c.privilege,r=c.user,o=r.username,this.privileges[o]=this.max(this.privileges[o],i);return l()?void 0:s(this.privileges,t,n)}),u(D("privileges",this),t),t.success=n(r,function(e,t,n){var i,r,o,a,u,c,d,h,p;if(this.flags&(this.groups|this.expand))for(a=0,c=e.length;c>a;a++)if(h=e[a],r=h.privilege,i=h.group,this.flags&this.groups&&(this.privileges[i.owner.username+"/"+i.slug]=r),this.flags&this.expand)for(p=i.members,u=0,d=p.length;d>u;u++)o=p[u].username,this.privileges[o]=this.max(this.privileges[o],r);return l()?void 0:s(this.privileges,t,n)}),u(D("group-privileges",this),t)},t.prototype.tags=function(t){return u(this.url("tags"),x(t,{"{utctimestamp}":e,"{size}":y}))},t.prototype.wiki_page=function(){var e,t,n,i;return n=2<=arguments.length?R.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],u(this.url("wiki",t),e)},t}(),I=["component","milestone","version"],P=function(){var e,t,n;return t=o,e=o+"s",n=r.repository.prototype,n["create_"+t]=function(t,n){return h(this.url("issues",e),{name:t},n)},n["update_"+t]=function(t,n,i){return f(this.url("issues",e,t),{name:n},i)},n["delete_"+t]=function(t,n){return l(this.url("issues",e,t),n)},n[t]=function(t,n){return u(this.url("issues",e,t),n)},n[e]=function(t){return u(this.url("issues",e),t)}};for(E=0,A=I.length;A>E;E++)o=I[E],P();r.send_invitation=function(t,n,i,r){var o,a,s,l;return l=i.toString().split("/"),s=l[0],a=l[1],o=D("invitations",s,a,t),h(o,{permission:n},e("utc_sent_on",$(r,"repository.%")))},r.send_general_invitation=function(e,t){return h(D("invitations",e),t)},r.users=function(e,t){var n;return 0===(null!=(n=e.user)?n.length:void 0)?(t=b(t),"function"==typeof t.complete&&t.complete(),void t.success([])):u(D("users")+m(e),s(t,function(e){var t,n,i,r;for(n={},i=0,r=e.length;r>i;i++)t=e[i],n[t.username]=t;return n}))},r.user=function(){function t(e){return this instanceof t?void(this.username=e):new t(e)}return t.create=function(e,n){var i;if(i=e.username,!i)throw r.error('"username" is a required attribute');return h(D("newuser"),e,n),t(i)},t.prototype.url=function(){var e;return e=1<=arguments.length?R.call(arguments,0):[],D.apply(null,["users",this.username].concat(R.call(e)))},t.prototype.details=function(e){return u(this.url(),v("user",e))},t.prototype.events=function(){var t,n,i,r;return i=2<=arguments.length?R.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],n=i[0],u(this.url("events")+m(n),x(t,{"events.[utc_created_on:date]":e}))},t.prototype.followers=function(e){return u(this.url("followers"),v("followers",e))},t.prototype.delete_invitation=function(e,t){return l(this.url("invitations",e),t)},t.prototype.invitation=function(t,n){return u(this.url("invitations",t),x(n,{utc_sent_on:e}))},t.prototype.invitations=function(t){return u(this.url("invitations"),x(t,{"[utc_sent_on]":e}))},t.prototype.invite=function(e,t,n){return f(this.url("invitations",e,t),n)},t.prototype.uninvite=function(e,t,n){return l(this.url("invitations",e,t),n)},t.prototype.plan=function(e){return u(this.url("plan"),e)},t.prototype.privileges=function(e,t){var i,r,o,a,s,l;return null==t&&(t=e,e=3),t=b(t),s=t.success||function(){},o=t.error||function(){},r=p(e),i=2,l=function(){return--i>0},a=!1,t.error=function(e,t,n){return a?void 0:(o(e,t,n),a=!0)},t.success=n(r,function(e,t,n){var i,r,o,a,u,c,d;if(this.flags&this.direct)for(u=0,c=e.length;c>u;u++)d=e[u],i=d.privilege,r=d.repo,o=d.user,r=(a=this.privileges)[r]||(a[r]={}),r[o.username]=this.max(r[o.username],i);return l()?void 0:s(this.privileges,t,n)}),u(D("privileges",this.username),t),t.success=n(r,function(e,t,n){var i,r,o,a,u,c,d,h,p,f,m;if(this.flags&(this.groups|this.expand))for(c=0,h=e.length;h>c;c++)if(f=e[c],r=f.privilege,o=f.repo,i=f.group,o=(u=this.privileges)[o]||(u[o]={}),this.flags&this.groups&&(o[i.owner.username+"/"+i.slug]=r),this.flags&this.expand)for(m=i.members,d=0,p=m.length;p>d;d++)a=m[d].username,o[a]=this.max(o[a],r);return l()?void 0:s(this.privileges,t,n)}),u(D("group-privileges",this.username),t)},t.prototype.repositories=function(e){return u(this.url(),v("repositories",$(e,"[%]")))},t.prototype.add_email_address=function(e,t){return h(this.url("emails",e),t)},t.prototype.set_primary_email_address=function(e,t){return f(this.url("emails",e),{primary:!0},t)},t.prototype.remove_email_address=function(e,t){return l(this.url("emails",e),t)},t.prototype.email_address=function(e,t){return u(this.url("emails",e),t)},t.prototype.email_addresses=function(e){return u(this.url("emails"),e)},t.prototype.remove_ad=function(e,t){return l(this.url("ad",e),t)},t.prototype.feature_viewed=function(e,t){return l(this.url("feature",e),t)},t.prototype.add_ssh_key=function(e,t){return h(this.url("ssh-keys"),e,g("pk:id",t))},t.prototype.update_ssh_key=function(e,t,n){return f(this.url("ssh-keys",e),t,g("pk:id",n))},t.prototype.remove_ssh_key=function(e,t){return l(this.url("ssh-keys",e),t)},t.prototype.ssh_key=function(e,t){return u(this.url("ssh-keys",e),g("pk:id",t))},t.prototype.ssh_keys=function(e){return u(this.url("ssh-keys"),g("[pk:id]",e))},t.prototype.create_consumer=function(e,t){return h(this.url("consumers"),e,t)},t.prototype.update_consumer=function(e,t,n){return f(this.url("consumers",e),t,n)},t.prototype.delete_consumer=function(e,t){return l(this.url("consumers",e),t)},t.prototype.consumer=function(e,t){return u(this.url("consumers",e),t)},t.prototype.consumers=function(e){return u(this.url("consumers"),e)},t.prototype.add_member=function(e,t,n){return h(this.url("privileges",e),{privilege:t},n)},t.prototype.update_member=function(e,t,n){return f(this.url("privileges",e),{privilege:t},n)},t.prototype.remove_member=function(e,t){return l(this.url("privileges",e),t)},t.prototype.members=function(e){return u(this.url("privileges"),e)},t}(),r.groups=function(e,t){return u(D("groups")+m(e),t)},r.group=function(){function e(t,n){return this instanceof e?(this.username=t,void(this.slug=n)):new e(t,n)}return e.prototype.url=function(){var e;return e=1<=arguments.length?R.call(arguments,0):[],D.apply(null,["groups",this.username,this.slug].concat(R.call(e)))},e.prototype.details=function(e){return u(this.url(),e)},e}(),r.utils={alphabetical:t},window.bitbucket=r}).call(this),e.exports=bitbucket},function(e,t){/*!
	 * jQuery Cookie Plugin v1.2
	 * https://github.com/carhartl/jquery-cookie
	 *
	 * Copyright 2011, Klaus Hartl
	 * Dual licensed under the MIT or GPL Version 2 licenses.
	 * http://www.opensource.org/licenses/mit-license.php
	 * http://www.opensource.org/licenses/GPL-2.0
	 */
!function(e,t,n){function i(e){return e}function r(e){return decodeURIComponent(e.replace(o," "))}var o=/\+/g;e.cookie=function(o,a,s){if(a!==n&&!/Object/.test(Object.prototype.toString.call(a))){if(s=e.extend({},e.cookie.defaults,s),null===a&&(s.expires=-1),"number"==typeof s.expires){var l=s.expires,u=s.expires=new Date;u.setDate(u.getDate()+l)}return a=String(a),t.cookie=[encodeURIComponent(o),"=",s.raw?a:encodeURIComponent(a),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}s=a||e.cookie.defaults||{};for(var c,d=s.raw?i:r,h=t.cookie.split("; "),p=0;c=h[p]&&h[p].split("=");p++)if(d(c.shift())===o)return d(c.join("="));return null},e.cookie.defaults={},e.removeCookie=function(t,n){return null!==e.cookie(t,n)?(e.cookie(t,null,n),!0):!1}}(jQuery,document)},function(e,t,n){var i,r;i=[n(3),n(145),n(147)],r=function(e,t,n){return t(function(){e("#create-team-link").on("click",function(){n(["atl._trackEvent","Share","Create Team Menu Link"])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(191),n(195),n(196),n(200),n(201),n(204),n(205)],r=function(){}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(192),n(193),n(194)],r=function(e,t,n,i,r,o){return n(function(n){i().done(function(e){var i=t("#plan-upgrade").length;if(e.global_too_many_users.length&&!i){var a,s=e.global_too_many_users[0],l=gettext('It\'s time for <strong>%(username)s</strong> to upgrade to the next user level &mdash; committers currently have read-only access. <a href="%(upgrade_url)s">Upgrade or manage users</a>.');a=o.inAppPayments?"{}/account/user/{!esc}/plans-and-billing/":"{}/account/user/{!esc}/plan-upgrade/",n.addClass("has-message"),n.find(".message").html(interpolate(l,{username:s,upgrade_url:a.format(r,s)},!0))}}).always(function(){n.hasClass("has-message")&&n.slideDown(200,function(){var t=e.sidebar(".aui-sidebar");t.$el.length&&t.reflow()})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(164)],r=function(e,t){var n;return function(){var i=e.Deferred();if(t.isAuthenticated){if(!n)return e.ajax({cache:!1,type:"GET",url:"/account/xhr/header_information/",dataType:"json"}).then(function(e){return n=e,e});i.resolve(n)}else i.reject(new Error("User is not authenticated"));return i.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).attr("data-base-url");return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(e){return e.replace(/-\w/g,function(e){return e[1].toUpperCase()})}for(var t,n=document.body.attributes,i=/^data-switch-(.*)/,r={},o=0;o<n.length;o++)t=i.exec(n[o].name),t&&(r[e(t[1])]=!0);return r}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(t){e.ajax({url:"https://bitbucket.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e/en_US-w19h2v-1988229788/6253/229/1.4.7/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=4ced2b8c",type:"GET",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){t.click(function(t){t.preventDefault(),e()})}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(197),n(147),n(199),n(149)],r=function(e,t,n,i,r,o){return t(function(t){var a,s,l=function(e,t,n){r.general.send(e,{complete:n.complete,success:function(e,t,r){i(["atl._trackEvent","Share","General invite user",a]),n.success(e,t,r)},error:n.error})};t.on("click",function(t){t.preventDefault(),a="nav-link",s||(s=n(e(o.toHtml("general-invite-template")),"invitation-dialog",l)),s.show()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(183),n(198),n(199)],r=function(e,t,n,i,r){return function(o,a,s,l){l=l||{};var u,c=o.find('input[type="email"]'),d=new n({width:600,height:"auto",id:a,closeOnOutsideClick:!0}),h=o.find(".error");return d.addHeader(gettext("Send an invitation")),d.addPanel(gettext("Invite"),o,"panel-body"),o.show(),d.addButton(gettext("Send"),function(){o.submit()},"aui-button aui-style"),d.addCancel(gettext("Cancel"),function(){d.hide()}),u=d.getCurrentPanel().page.button[0].item,c.on("keyup input propertychange",function(){var e=t.trim(c.val());e?u.prop("disabled",!1).attr("aria-disabled",!1):u.prop("disabled",!0).attr("aria-disabled",!0)}),o.submit(function(n){n.preventDefault();var a=t.trim(c.val());if(a&&!u.attr("disabled")){var p=r.getErrorMessages(a,l.messages);u.prop("disabled",!0).attr("aria-disabled",!0);var f=i(200,function(){u.addClass("disabled loading")});h.addClass("hidden");var m={complete:function(){clearTimeout(f),u.prop("disabled",!1).removeClass("disabled loading").attr("aria-disabled",!1)},success:function(t,n,i){if(200===i.status){d.hide();var r=gettext("Invitation sent to %(email)s");e.messages.success({body:interpolate(r,{email:a},!0),fadeout:!0})}},error:function(e,t){var n;n="timeout"!==t?p[e.status]||p.other:gettext("There was a problem connecting to the server."),h.removeClass("hidden").find(".message").text(n)}};s(a,o,m)}}),e.bind("show.dialog",function(e,t){t.dialog.id===a&&(o.find(".error").addClass("hidden"),c.val(""),u.prop("disabled",!0).attr("aria-disabled",!0))}),{show:function(){d.show()},hide:function(){d.hide()}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e,t){return"function"==typeof e&&(t=e,e=0),window.setTimeout(t,e)}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(187),n(3)],r=function(e,t){return{repo:{send:e.send_invitation},general:{send:e.send_general_invitation},getErrorMessages:function(e,n){var i,r="There was a problem processing your request.";return i=e?"{!esc} has already been invited.".format(e):"That person has already been invited",t.extend({400:"Please enter a valid email address.",409:i,500:r,other:r},n||{})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(192)],r=function(e,t,n){return t(function(e){n().done(function(t){e.text("("+t.unread_notifications+")")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(202),n(149)],r=function(e,t,n,i){return t(function(t){n.get().done(function(n){n.hasViewed=!!n.viewed.length,n.hasUpdated=!!n.updated.length,(n.hasUpdated||n.hasViewed)&&e("#repositories-dropdown-trigger").one("mouseover",function(){t.replaceWith(i.toHtml("repo-dropdown-template",n))})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(164),n(165),n(203)],r=function(e,t,n){return n({cookieName:"recently-viewed-repos_"+e.username,storageName:"repo-history:"+e.username,url:t.toString("user","repositories","overview"),limit:5,maxAge:3e5})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(178),n(164),n(188)],r=function(e,t,n){return function(i){function r(i){if(n.isAuthenticated&&i){var r=e.cookie(a),o=r?r.split(","):[],l=o.indexOf(""+i);0!==l&&(~l&&o.splice(l,1),o=[i].concat(o.slice(0,u-1)),e.cookie(a,o.join(","),{path:"/",expires:1e6}),t.remove(s))}}function o(){var n=new e.Deferred,i=t.get(s),r=Date.now();return i&&r-i.time<d?(n.resolve(i),n):(e.ajax({cache:!1,type:"get",url:l,data:c,dataType:"json"}).done(function(e){e.time=r,t.set(s,e),n.resolve(e)}),n)}var a=i.key||i.cookieName,s=i.key||i.storageName,l=i.url,u=i.limit||5,c=i.query||{max:u},d=i.cacheTimeout||3e5;return{get:o,set:r}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(192),n(149)],r=function(e,t,n,i){return t(function(t){n().done(function(n){var r=t.attr("aria-owns")||t.attr("aria-controls"),o=e("#"+r);t.one("mouseover",function(){n.teams.length&&o.html(i.toHtml("team-dropdown-template",{teams:n.teams})).removeClass("hidden")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(164),n(206),n(147)],r=function(e,t,n,i,r){return t(function(){var t=i("Page Header");return e("#sign-up-link").on("click",function(){r(["atl._trackEvent","Signup","Header"])}),n.isAuthenticated?(e("#header").on("click",".app-switcher-trigger",function(n){e(n.target).hasClass("active")&&t("App Switcher - Displayed")}),e("#app-switcher").on("click",".nav-link a",function(){t("App Switcher - App Link Clicked")}),e("#ondemand-trial").on("click",function(){t("App Switcher - Free Trial Clicked")}),e("#ondemand-learn-more").on("click",function(){t("App Switcher - Learn More Clicked")}),e("#logo").on("click",function(){t("Bitbucket Logo Clicked")}),e("#teams-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Teams Dropdown - Displayed")}),e("#create-team-blank-slate").on("click",function(){t("Teams Dropdown - Create Clicked","No teams")}),e("#create-team-link").on("click",function(){t("Teams Dropdown - Create Clicked","Has teams")}),e("#teams-dropdown").on("click"," a.team-link",function(){t("Teams Dropdown - Team Clicked")}),e("#repositories-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Repo Dropdown - Displayed")}),e("#create-repo-link").on("click",function(){t("Repo Dropdown - Create Clicked")}),e("#import-repo-link").on("click",function(){t("Repo Dropdown - Import Clicked")}),e("#repo-dropdown").on("click","a.repo-link",function(n){t("Repo Dropdown - Repo Clicked",e(n.target).hasClass("recently-viewed")?"Recently Viewed":"Recently Updated")}),e("#header-snippets-link").on("click",function(){t("Snippets Clicked")}),e("#snippet-create-cta").on("click",function(){t("Create Snippet CTA Clicked")}),e("#help-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Help Dropdown - Displayed")}),e("#header-help-dropdown").on("click","a",function(n){t("Help Dropdown - Link Clicked",e(n.target).text().trim())}),e("#user-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Account Dropdown - Displayed")}),e("#user-dropdown").on("click","a",function(n){var i=e(n.target).closest("a").text().replace(/\(.*\)/,"").trim();t("Account Dropdown - Link Clicked",i)}),e("#dashboard-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Dashboard Dropdown - Displayed")}),e("#dashboard-overview-link").on("click",function(){t("Dashboard Dropdown - Repositories Clicked")}),e("#dashboard-prs-link").on("click",function(){t("Dashboard Dropdown - Pull Requests Clicked")}),e("#dashboard-issues-link").on("click",function(){t("Dashboard Dropdown - Issues Clicked")}),void e("#repo-create-cta").on("click",function(){t("Create Repo CTA Clicked")})):(new e.Deferred).reject(new Error("User not authenticated"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(147)],r=function(e){return function(t){return function(n,i){var r=["atl._trackEvent",t,n];i&&r.push(i),e(r)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145)],r=function(e,t,n){return n(function(n){e.InlineDialog(t("#meta-info"),"metaInfo",function(e,n,i){return e.css({padding:"20px",width:"150px"}).html(t("#meta-info-content").html()),i(),!1},{gravity:"s"}),n.find("a").tooltip({aria:!0,gravity:"s",delayIn:200})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(209),n(211),n(212),n(163)],r=function(e,t,n,i,r,o,a){return n(function(n){var o=e.dialog2(n),s=n.attr("data-descriptor-url"),l=n.attr("data-connections-url"),u=n.attr("data-create-repo-url"),c=n.attr("data-admin-url"),d=n.data("repository"),h=n.data("show-success-message");o.on("show",function(){r("bitbucket.hipchat.integration.installation.dialog.presented")}),t("#dialog-install-button").on("click",function(n){var a=new t.Deferred;t.ajax({url:l,type:"POST",data:{url:s},dataType:"json"}).done(function(t){var n=r("bitbucket.hipchat.integration.installed");if(i.vent.trigger("hipchatIntegration:installed"),h){var s,l=gettext("Manage integrations"),p=gettext("Create your first repository");s=d?gettext('<a href="{}">{}</a>').format(c,l):gettext('<a href="{}">{}</a> &middot; <a href="{}">{}</a>').format(u,p,c,l),e.messages.success({title:gettext("HipChat integration complete"),body:s,fadeout:!0}),o.hide(),a.resolve()}else n.done(function(){window.location.reload()})}).fail(function(t){var n=JSON.parse(t.responseText).error.message;r("bitbucket.hipchat.integration.installation.error",{errorMessage:n}),e.messages.error({title:gettext("There was a problem installing the integration"),body:n}),a.resolve()});t(n.target).loading(a)}),t("#dialog-cancel-button").on("click",function(e){r("bitbucket.hipchat.integration.installation.dialog.dismissed"),o.hide()}),a.get("show-hipchat-dialog").done(function(e){e&&(o.show(),a["delete"]("show-hipchat-dialog"))})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(210)],r=function(e){return e.radio.channel("global")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;!function(o,a){i=[n(1),n(2)],r=function(e,t){return a(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){"use strict";var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.1",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,n,i){var r=this.storage.getCommands(e);t.each(r.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.hasHandler(e)?this.getHandler(e).apply(this,t):void 0}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(n){var i=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var r="vent"===e?"on":"setHandler";t.each(n,function(n,o){this[e][r](o,t.bind(n,i))},this)}}}),i}(i),i.radio=function(e){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,t,n){return function(i){var r=e._getChannel(i)[t],o=Array.prototype.slice.call(arguments,1);return r[n].apply(r,o)}};return new n}(i),e.Wreqr})},function(e,t,n){var i,r;i=[n(3),n(148)],r=function(e,t){function n(){var e=sessionStorage.getItem(u);return null===e?{}:JSON.parse(e)}function i(e){var t=[];for(var n in e)t.push(e[n]);return t}function r(e){sessionStorage.setItem(u,JSON.stringify(e))}function o(t){var i=n(),o=e.extend(i,t);r(o)}function a(){var t=n();if(!d&&Object.keys(t).length>0){r({});for(var a=i(t),l=(new Date).getTime(),u=0;u<a.length;u++)a[u].timeDelta=a[u].time-l;d=!0,e.ajax({url:"/xhr/analytics/events",type:"POST",contentType:"application/json",data:JSON.stringify({events:a},s)}).fail(function(){o(t)}).always(function(){d=!1})}}function s(e,t){return"time"===e?void 0:t}function l(){var e=(new Date).getTime(),t=Math.floor(1e3*Math.random()+1);return e+"_"+t}var u="bitbucket-analytics",c=5e3,d=!1;return setInterval(a,c),function(e,n){var i={name:e,time:(new Date).getTime()};n&&(i.properties=n),t&&console&&console.log("Name:",e,"Properties:",n);var r={};r[l()]=i,o(r)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r,o;!function(a,s){r=[n(3),n(213),n(215)],i=s,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(e){e.fn.loading=function(t,n){var i=e(this),r=e.extend({loadTime:400,spin:!1,disable:!0,restore:!0},n),o=setTimeout(function(){r.spin?i.spin(r.spin):r.mask?i.addClass("has-mask"):i.addClass("loading"),r.disable&&i.disable(!0)},r.loadTime);return t=t||new e.Deferred,t.fail(function(){i.disable(!1)}),t.done(function(){r.disable&&r.restore&&i.disable(!1)}),t.always(function(){clearTimeout(o),r.spin?i.spin(!1):r.mask?i.removeClass("has-mask"):i.removeClass("loading")})}})},function(e,t,n){!function(e){e(n(3),n(214))}(function(e,t){e.fn.spin=function(n,i){return this.each(function(){var r=e(this),o=r.data();o.spinner&&(o.spinner.stop(),delete o.spinner),n!==!1&&(n=e.extend({color:i||r.css("color")},e.fn.spin.presets[n]||n),o.spinner=new t(n).spin(this))})},e.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}})},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var r=["opacity",t,~~(100*e),n,i].join("-"),o=.01+n/i*100,a=Math.max(1-(1-e)/t*(100-o),e),s=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return h[r]||(p.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+a+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",p.cssRules.length),h[r]=1),r}function i(e,t){var n,i,r=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<d.length;i++)if(n=d[i]+t,void 0!==r[n])return n;return void 0!==r[t]?t:void 0}function r(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function a(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function s(e,t){return"string"==typeof e?e:e[t%e.length]}function l(e){return"undefined"==typeof this?new l(e):void(this.opts=o(e||{},l.defaults,f))}function u(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}p.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(e,i){function o(){return r(n("group",{coordsize:c+" "+c,coordorigin:-u+" "+-u}),{width:c,height:c})}function a(e,a,l){t(h,t(r(o(),{rotation:360/i.lines*e+"deg",left:~~a}),t(r(n("roundrect",{arcsize:i.corners}),{width:u,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:s(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,u=i.length+i.width,c=2*u,d=2*-(i.width+i.length)+"px",h=r(o(),{position:"absolute",top:d,left:d});if(i.shadow)for(l=1;l<=i.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)a(l);return t(e,h)},l.prototype.opacity=function(e,t,n,i){var r=e.firstChild;i=i.shadow&&i.lines||0,r&&t+i<r.childNodes.length&&(r=r.childNodes[t+i],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}}var c,d=["webkit","Moz","ms","O"],h={},p=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},o(l.prototype,{spin:function(t){this.stop();var n,i,o=this,s=o.opts,l=o.el=r(e(0,{className:s.className}),{position:s.position,width:0,zIndex:s.zIndex}),u=s.radius+s.length+s.width;if(t&&(t.insertBefore(l,t.firstChild||null),i=a(t),n=a(l),r(l,{left:("auto"==s.left?i.x-n.x+(t.offsetWidth>>1):parseInt(s.left,10)+u)+"px",top:("auto"==s.top?i.y-n.y+(t.offsetHeight>>1):parseInt(s.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),o.lines(l,o.opts),!c){var d,h=0,p=(s.lines-1)*(1-s.direction)/2,f=s.fps,m=f/s.speed,g=(1-s.opacity)/(m*s.trail/100),v=m/s.lines;!function y(){h++;for(var e=0;e<s.lines;e++)d=Math.max(1-(h+(s.lines-e)*v)%m*g,s.opacity),o.opacity(l,e*s.direction+p,d,s);o.timeout=o.el&&setTimeout(y,~~(1e3/f))}()}return o},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,o){function a(t,n){return r(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*u+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var l,u=0,d=(o.lines-1)*(1-o.direction)/2;u<o.lines;u++)l=r(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,d+u*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(l,r(a("#000","0 0 4px #000"),{top:"2px"})),t(i,t(l,a(s(o.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var m=r(e("group"),{behavior:"url(#default#VML)"});return!i(m,"transform")&&m.adj?u():c=i(m,"animation"),l})},function(e,t,n){var i,r,o;!function(a,s){r=[n(3)],i=s,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(e){e.fn.disable=function(t,n){var i=e(this);return t=void 0===t?i.prop("disabled"):!!t,n=n||{},t?i.addClass("disabled").attr("disabled",!0).attr("aria-disabled",!0):i.removeClass("disabled").removeAttr("disabled aria-disabled"),n.text&&i.text(n.text),this}})},function(e,t,n){var i,r;i=[n(8),n(145),n(211),n(163)],r=function(e,t,n,i){return t(function(t){var r=t.attr("data-admin-url"),o=gettext("Manage integrations");e.messages.success({title:gettext("HipChat integration complete"),body:gettext('<a href="{}">{}</a>').format(r,o),fadeout:!0}),n("bitbucket.hipchat.integration.confirmation.message.presented"),i["delete"]("show-hipchat-dialog")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(211)],r=function(e,t,n,i){return n(function(t){var n=e.dialog2("#hipchat-integration-dialog");t.on("click",function(e){i("bitbucket.hipchat.integration.installation.dialog.trigger.clicked"),n.show()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(219),n(224)],r=function(e,t,n){return e(function(e){var i=e.find(".image-diff-toolbar"),r=new t(e),o=new n(e,i);r.init().done(function(e){o.init(e)}),o.on("modeChanged",function(e){r.setMode(e)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(220),n(222),n(223),n(3)],r=function(e,t,n,i){function r(e){this._$container=e}function o(e,t){e.onchange=t,e.oninput=t}function a(e){e.onchange=null,e.oninput=null}function s(e){if(e.data("natural-size"))return i.Deferred().resolve(e.data("natural-size"));if(e[0].naturalWidth){var t={width:e[0].naturalWidth,height:e[0].naturalHeight};return e.data("natural-size",t),i.Deferred().resolve(t)}var n=new Image,r=i.Deferred(),o=!1,a=function(){if(!o){var t={width:n.width,height:n.height};e.data("natural-size",t),r.resolve(t),o=!0}};return n.onload=a,n.src=e[0].src,n.complete&&a(),r}function l(e,t){var n=e.data("margin_border_padding");return null==n&&(n=e.outerWidth(!0)-e.width(),e.data("margin_border_padding",n)),t-n}return r.modes={TWO_UP:"two-up",BLEND:"blend",SPLIT:"split"},Object.freeze&&Object.freeze(r.modes),r.prototype.init=function(){var e,t,n=this,o=this._$imgs=this._$container.find("img");this._$sinceImg=o.eq(0),this._$untilImg=o.eq(1),this._$untilRevision=this._$untilImg.parent(),this._$sinceRevision=this._$sinceImg.parent(),this._$revisions=this._$untilRevision.add(this._$sinceRevision),this._$untilRevisionLabel=n._$untilRevision.find("h5"),this._$sinceRevisionLabel=n._$sinceRevision.find("h5"),n.setMode(r.modes.TWO_UP);var a=i.Deferred();return o.imagesLoaded().always(function(){var r=s(n._$sinceImg).done(function(t){e=t}),o=s(n._$untilImg).done(function(e){t=e});i.when(r,o).done(function(){var n=e.width===t.width&&e.height===t.height,i=n&&e.width>0;a.resolve(i)}).fail(function(){a.reject()})}),a},r.prototype.destroy=function(){this._cleanOldMode(this._mode),this._mode=null},r.prototype.setMode=function(e){this._mode!==e&&(this._onDiffModeChanged(e,this._mode),this._mode=e)},r.prototype._cleanOldMode=function(e){switch(e){case r.modes.TWO_UP:this._cleanTwoUpDiff();break;case r.modes.BLEND:this._cleanBlendDiff();break;case r.modes.SPLIT:this._cleanSplitDiff()}},r.prototype._onDiffModeChanged=function(t,n){switch(this._$container.removeClass("two-up blend split").addClass(t),this._cleanOldMode(n),t){case r.modes.TWO_UP:this._setupTwoUpDiff();break;case r.modes.BLEND:this._setupBlendDiff();break;case r.modes.SPLIT:this._setupSplitDiff()}e.trigger("imageDiffer.modeChanged",null,t,n)},r.prototype._cleanTwoUpDiff=i.noop,r.prototype._setupTwoUpDiff=i.noop,r.prototype._cleanBlendDiff=function(){var e=this._$container.children(".opacity-slider-container"),t=e.find("input");e.remove(),this._$untilImg.css("opacity",""),a(t[0])},r.prototype._setupBlendDiff=function(){var e=this,n=i('<input type="range" min="0" max="1" step="0.01" value="1" />');this._$container.children(".image-diff-toolbar").after(i('<div class="opacity-slider-container" />').append(n)),t.onDomReady(),o(n[0],function(){e._$untilImg.css("opacity",parseFloat(i(this).val()))})},r.prototype._cleanSplitDiff=function(){this._$imgs.css("width","").css("height",""),this._$revisions.css("width",""),this._$untilRevision.css("margin-left",""),this._$untilRevisionLabel.add(this._$sinceRevisionLabel).css("margin-left","").css("margin-right",""),this._$untilImg.unwrap(),this._$untilRevisionImageContainer.remove(),delete this._$untilRevisionImageContainer,this._$revisions.unwrap(),this._$splitContainer.remove(),delete this._$splitContainer,this._onResize&&(e.off("window.resize.debounced",this._onResize),delete this._onResize)},r.prototype._setSplitDiffElementProperties=function(e,t,n){var i=l(this._$container,this._$container.parent().width()),r=l(t,i),o=l(this._$sinceRevision,r),a=l(this._$sinceImg,o),s=Math.min(n.width,a);this._$imgs.width(s),this._$imgs.height(Math.floor(s/n.width*n.height)),e.height(this._$imgs.outerHeight(!0));var u=s+(o-a);this._$revisions.width(u),this._$untilRevision.css("margin-left",-u)},r.prototype._setupSplitDiff=function(){var t=this;return s(this._$imgs).done(function(n){t._$untilImg.wrap('<div class="image-container" />'),t._$revisions.wrapAll('<div class="split-container" />'),t._$untilRevisionImageContainer=t._$untilImg.parent(),t._$splitContainer=t._$container.find(".split-container");var i;t._onResize=function(){t._setSplitDiffElementProperties(t._$untilRevisionImageContainer,t._$splitContainer,n),i=t._$sinceImg.outerWidth(!0)},t._onResize(),e.on("window.resize.debounced",t._onResize),n.width<50?(t._$untilRevisionLabel.css("margin-left","-50px"),t._$sinceRevisionLabel.css("margin-right","-50px")):n.width<100&&(t._$untilRevisionLabel.css("margin-left",-n.width),t._$sinceRevisionLabel.css("margin-right",-n.width));var r;t._$splitContainer.on("mouseenter",function(){r=t._$untilRevision.offset(),t._$revisions.on("mousemove",o)}),t._$splitContainer.on("mouseleave",function(){t._$revisions.off("mousemove",o)});var o=function(e){t._$untilRevisionImageContainer.css("width",Math.min(e.pageX-r.left,i))}})},r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(221),n(2)],r=function(e,t,n){"use strict";var i={trigger:function(e,n){return t.apply(this,arguments)},on:function(e,n){return t.on(e,n)},off:function(e,n){return t.off(e,n)},once:function(e,n){return t.once(e,n)},listeners:function(e){return t.listeners(e)},name:function(e){return t.nt(e)},chain:function(){return this.chainWith(this)},chainWith:function(e){var t=[],n={on:function(n,i){var r=arguments;return e.on.apply(e,r),t.push(function(){e.off.apply(e,r)}),this},destroy:function(){for(var e=0;e<t.length;e++)t[e]();t=[]}};return n},stop:function(){return t.stop()},createEventMixin:function(t,r){return r=r||{},n.extend({},e.Events,{trigger:function(n){var o=e.Events.trigger.apply(this,arguments);return r.localOnly||i.trigger.apply(i,[t+"/"+n,this].concat(Array.prototype.slice.call(arguments,1))),o},retriggerFrom:function(e){function t(e,t){return e.on(t,this.trigger.bind(this,t))}var n=Array.prototype.slice.call(arguments,1);return n.reduce(t.bind(this),i.chainWith(e))}})},createLocalEventMixin:function(){return this.createEventMixin(null,{localOnly:!0})},addEventMixin:function(e,t,i){n.extend(e,this.createEventMixin(t,i))},addLocalEventMixin:function(e){n.extend(e,this.createLocalEventMixin())}};return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;!function(n){var o,a,s="0.4.2",l="hasOwnProperty",u=/[\.\/]/,c=/\s*,\s*/,d="*",h=function(e,t){return e-t},p={n:{}},f=function(){for(var e=0,t=this.length;t>e;e++)if("undefined"!=typeof this[e])return this[e]},m=function(){for(var e=this.length;--e;)if("undefined"!=typeof this[e])return this[e]},g=function(e,t){e=String(e);var n,i=a,r=Array.prototype.slice.call(arguments,2),s=g.listeners(e),l=0,u=[],c={},d=[],p=o;d.firstDefined=f,d.lastDefined=m,o=e,a=0;for(var v=0,y=s.length;y>v;v++)"zIndex"in s[v]&&(u.push(s[v].zIndex),s[v].zIndex<0&&(c[s[v].zIndex]=s[v]));for(u.sort(h);u[l]<0;)if(n=c[u[l++]],d.push(n.apply(t,r)),a)return a=i,d;for(v=0;y>v;v++)if(n=s[v],"zIndex"in n)if(n.zIndex==u[l]){if(d.push(n.apply(t,r)),a)break;do if(l++,n=c[u[l]],n&&d.push(n.apply(t,r)),a)break;while(n)}else c[n.zIndex]=n;else if(d.push(n.apply(t,r)),
a)break;return a=i,o=p,d};g._events=p,g.listeners=function(e){var t,n,i,r,o,a,s,l,c=e.split(u),h=p,f=[h],m=[];for(r=0,o=c.length;o>r;r++){for(l=[],a=0,s=f.length;s>a;a++)for(h=f[a].n,n=[h[c[r]],h[d]],i=2;i--;)t=n[i],t&&(l.push(t),m=m.concat(t.f||[]));f=l}return m},g.on=function(e,t){if(e=String(e),"function"!=typeof t)return function(){};for(var n=e.split(c),i=0,r=n.length;r>i;i++)!function(e){for(var n,i=e.split(u),r=p,o=0,a=i.length;a>o;o++)r=r.n,r=r.hasOwnProperty(i[o])&&r[i[o]]||(r[i[o]]={n:{}});for(r.f=r.f||[],o=0,a=r.f.length;a>o;o++)if(r.f[o]==t){n=!0;break}!n&&r.f.push(t)}(n[i]);return function(e){+e==+e&&(t.zIndex=+e)}},g.f=function(e){var t=[].slice.call(arguments,1);return function(){g.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},g.stop=function(){a=1},g.nt=function(e){return e?new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)").test(o):o},g.nts=function(){return o.split(u)},g.off=g.unbind=function(e,t){if(!e)return void(g._events=p={n:{}});var n=e.split(c);if(n.length>1)for(var i=0,r=n.length;r>i;i++)g.off(n[i],t);else{n=e.split(u);var o,a,s,i,r,h,f,m=[p];for(i=0,r=n.length;r>i;i++)for(h=0;h<m.length;h+=s.length-2){if(s=[h,1],o=m[h].n,n[i]!=d)o[n[i]]&&s.push(o[n[i]]);else for(a in o)o[l](a)&&s.push(o[a]);m.splice.apply(m,s)}for(i=0,r=m.length;r>i;i++)for(o=m[i];o.n;){if(t){if(o.f){for(h=0,f=o.f.length;f>h;h++)if(o.f[h]==t){o.f.splice(h,1);break}!o.f.length&&delete o.f}for(a in o.n)if(o.n[l](a)&&o.n[a].f){var v=o.n[a].f;for(h=0,f=v.length;f>h;h++)if(v[h]==t){v.splice(h,1);break}!v.length&&delete o.n[a].f}}else{delete o.f;for(a in o.n)o.n[l](a)&&o.n[a].f&&delete o.n[a].f}o=o.n}}},g.once=function(e,t){var n=function(){return g.unbind(e,n),t.apply(this,arguments)};return g.on(e,n)},g.version=s,g.toString=function(){return"You are running Eve "+s},"undefined"!=typeof e&&e.exports?e.exports=g:(i=[],r=function(){return g}.apply(t,i),!(void 0!==r&&(e.exports=r)))}(this)},function(e,t,n){/*! Unobtrusive Slider Control / HTML5 Input Range polyfill - MIT/GPL2 @freqdec */
(function(){function e(e){function t(e){e=!!e,e!=Ke&&(Ke=e,O(j()))}function n(e){if(!oe||e){try{Y(te,-1),m(te,"focus",p),m(te,"blur",w),u?m(te,"keypress",k):(m(te,"keydown",k),m(te,"keypress",_)),m(X,"mouseover",C),m(X,"mouseout",$),m(X,"mousedown",S),m(X,"touchstart",S),i&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",x,!1):(m(document,"mousewheel",x),m(window,"mousewheel",x)))}catch(t){}b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),y(Z,"fd-slider-disabled"),X.setAttribute("aria-disabled",!0),re.disabled=oe=!0,clearTimeout(Ee),e||h("disable")}}function l(e){(oe||e)&&(Y(te,0),f(te,"focus",p),f(te,"blur",w),u?f(te,"keypress",k):(f(te,"keydown",k),f(te,"keypress",_)),f(X,"touchstart",S),f(X,"mousedown",S),f(X,"mouseover",C),f(X,"mouseout",$),b(Z,"fd-slider-disabled"),X.setAttribute("aria-disabled",!1),re.disabled=oe=Ge=!1,e||h("enable"))}function c(){clearTimeout(Ee),ee=ie=te=X=Z=Ee=null,h("destroy"),we=null}function d(){A();try{var e=X.offsetWidth,t=X.offsetHeight,n=te.offsetWidth,i=te.offsetHeight,r=(ie.offsetHeight,ie.offsetWidth,be?t-i:e-n);Ve=r/me,qe=Math.max(ge?q(F(ue)):Math.abs((ue-se)/he)*Ve,0),Fe=Math.min(ge?q(F(ce)):Math.abs((ce-se)/he)*Ve,Math.floor(be?t-i:e-n)),Re=e,Ie=t,O($e?j():"select"==ae?re.selectedIndex:parseFloat(re.value),!1)}catch(o){}h("redraw")}function h(e){if(_e){if(e.match(/^(blur|focus|change)$/i)){var t;if("undefined"!=typeof document.createEvent)t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0),re.dispatchEvent(t);else if("undefined"!=typeof document.createEventObject)try{t=document.createEventObject(),re.fireEvent("on"+e.toLowerCase(),t)}catch(n){}}}else if(we.hasOwnProperty(e))for(var i,r={userSet:Ke,disabled:oe,elem:re,value:"select"==ae?re.options[re.selectedIndex].value:re.value},o=0;i=we[e][o];o++)i.call(re,r)}function p(e){return y(Z,"fd-slider-focused"),a.onfocus&&(Ke=!0,O(j())),i&&(f(window,"DOMMouseScroll",x),f(document,"mousewheel",x),u||f(window,"mousewheel",x)),h("focus"),!0}function w(e){b(Z,"fd-slider-focused"),i&&(m(document,"mousewheel",x),m(window,"DOMMouseScroll",x),u||m(window,"mousewheel",x)),Ae=!0,h("blur")}function x(e){if(Ae){e=e||window.event;var t,n=0;e.wheelDelta?(n=e.wheelDelta/120,u&&window.opera.version()<9.2&&(n=-n)):e.detail&&(n=-e.detail/3),be&&(n=-n),n&&(t=j(),t+=0>n?-he:he,Ke=!0,O(L(t))),v(e)}}function _(e){return e=e||window.event,e.keyCode>=33&&e.keyCode<=40||!Ae||45==e.keyCode||46==e.keyCode?g(e):!0}function k(e){if(!Ae)return!0;e=e||window.event;var t,n=null!==e.keyCode?e.keyCode:e.charCode;return 33>n||n>40&&45!=n&&46!=n?!0:(t=j(),37==n||40==n||46==n||34==n?t-=e.ctrlKey||34==n?+pe:+he:39==n||38==n||45==n||33==n?t+=e.ctrlKey||33==n?+pe:+he:35==n?t=ce:36==n&&(t=ue),Ke=!0,O(L(t)),h("update"),void v(e))}function C(e){y(Z,"fd-slider-hover")}function $(e){b(Z,"fd-slider-hover")}function S(e){e=e||window.event,v(e);var t;if(e.target?t=e.target:e.srcElement&&(t=e.srcElement),t&&3==t.nodeType&&(t=t.parentNode),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0],Ge=!0}if(clearTimeout(Ee),Ee=null,Ae=!1,Ke=!0,-1!=t.className.search("fd-slider-handle"))ze=be?e.clientY:e.clientX,Be=parseInt(be?te.offsetTop:te.offsetLeft)||0,P(e),Ge?(f(document,"touchmove",P),f(document,"touchend",D),m(X,"mousedown",S)):(f(document,"mousemove",P),f(document,"mouseup",D)),y(Z,"fd-slider-active"),y(document.body,"fd-slider-drag-"+(be?"vertical":"horizontal")),h("dragstart");else{A();var n=0;e.pageX||e.pageY?n=be?e.pageY:e.pageX:(e.clientX||e.clientY)&&(n=be?e.clientY+document.body.scrollTop+document.documentElement.scrollTop:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),n-=be?He+Math.round(te.offsetHeight/2):Ue+Math.round(te.offsetWidth/2),n=U(n),"tween"==ye?(y(Z,"fd-slider-active"),R(n)):"timed"==ye?(y(Z,"fd-slider-active"),f(document,Ge?"touchend":"mouseup",T),We=n,I()):N(n)}return!1}function T(e){return e=e||window.event,v(e),m(document,Ge?"touchend":"mouseup",T),b(Z,"fd-slider-active"),clearTimeout(Ee),Ee=null,Ae=!0,!1}function D(e){return e=e||window.event,v(e),Ge?(m(document,"touchmove",P),m(document,"touchend",D)):(m(document,"mousemove",P),m(document,"mouseup",D)),Ae=!0,b(document.body,"fd-slider-drag-"+(be?"vertical":"horizontal")),b(Z,"fd-slider-active"),h("dragend"),!1}function P(e){if(e=e||window.event,v(e),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0]}return N(U(Be+(be?e.clientY-ze:e.clientX-ze))),!1}function E(e){var t=j();Ke=!0,t+=e*he,O(L(t))}function A(){var e=0,t=0,n=X;try{do e+=n.offsetLeft,t+=n.offsetTop;while(n=n.offsetParent)}catch(i){}Ue=e,He=t}function I(){var e=parseInt(be?te.offsetTop:te.offsetLeft,10);e=Math.round(e>We?Math.max(We,Math.floor(e-Ve)):Math.min(We,Math.ceil(e+Ve))),N(U(e)),e!=We?Ee=setTimeout(I,me>20?50:100):(Ae=!0,b(Z,"fd-slider-active"),h("finalise"))}function R(e){Ae=!1,Me=parseInt(e,10),je=parseInt(be?te.offsetTop:te.offsetLeft,10),Le=Me-je,Ne=20,Oe=0,Ee||(Ee=setTimeout(Je,20))}function M(e){return isNaN(e)||""===e||"undefined"==typeof e?(Ke=!1,ke):e<Math.min(ue,ce)?(Ke=!1,Math.min(ue,ce)):e>Math.max(ue,ce)?(Ke=!1,Math.max(ue,ce)):(Ke=!0,e)}function j(){return L("input"==ae?parseFloat(re.value):re.selectedIndex)}function L(e){return isNaN(e)||""===e||"undefined"==typeof e?ke:Math.min(Math.max(e,Math.min(ue,ce)),Math.max(ue,ce))}function N(e){var t=L(ge?H(B(e)):be?le-Math.round(e/Ve)*he:se+Math.round(e/Ve)*he);te.style[be?"top":"left"]=(e||0)+"px",V(),W("select"==ae||1==he?Math.round(t):t)}function O(e,t){var n,i=!1;"undefined"!=typeof e&&!isNaN(e)&&""!==e||"input"!=ae||$e?n=M(e):(n=ke,i=!0,Ke=!1),te.style[be?"top":"left"]=(ge?q(F(n)):be?Math.round((le-n)/he*Ve):Math.round((n-se)/he*Ve))+"px",V(),typeof t!==!1&&W(i?"":n)}function U(e){if(ge)return Math.max(Math.min(Fe,e),qe);var t=e%Ve;return t&&t>=Ve/2?e+=Ve-t:e-=t,e<Math.min(Math.abs(qe),Math.abs(Fe))?e=Math.min(Math.abs(qe),Math.abs(Fe)):e>Math.max(Math.abs(qe),Math.abs(Fe))&&(e=Math.max(Math.abs(qe),Math.abs(Fe))),Math.min(Math.max(e,0),Fe)}function H(e){var t,n=0,i=se;for(var r in ge)ge.hasOwnProperty(r)&&(e>=n&&+r>=e&&(t=i+(e-n)*(+ge[r]-i)/(+r-n)),n=+r,i=+ge[r]);return t}function F(e){var t=0,n=se,i=0;for(var r in ge)ge.hasOwnProperty(r)&&(e>=n&&e<=+ge[r]&&(i=t+(e-n)*(+r-t)/(+ge[r]-n)),t=+r,n=+ge[r]);return i}function q(e){return(X[be?"offsetHeight":"offsetWidth"]-te[be?"offsetHeight":"offsetWidth"])/100*e}function B(e){return e/((X[be?"offsetHeight":"offsetWidth"]-X[te?"offsetHeight":"offsetWidth"])/100)}function W(e){if(h("update"),Ke?b(Z,"fd-slider-no-value"):y(Z,"fd-slider-no-value"),"select"==ae)try{if(e=parseInt(e,10),re.selectedIndex===e)return void G();re.options[e].selected=!0}catch(t){}else{if(""===e||Pe||(e=(se+Math.round((e-se)/he)*he).toFixed(fe)),re.value===e)return void G();re.value=e}G(),h("change")}function z(e,t){ue>ce?(e=Math.min(se,Math.max(e,t)),t=Math.max(le,Math.min(e,t)),ue=Math.max(e,t),ce=Math.min(e,t)):(e=Math.max(se,Math.min(e,t)),t=Math.min(le,Math.max(e,t)),ue=Math.min(e,t),ce=Math.max(e,t)),ke<Math.min(ue,ce)?ke=Math.min(ue,ce):ke>Math.max(ue,ce)&&(ke=Math.max(ue,ce)),te.setAttribute("aria-valuemin",ue),te.setAttribute("aria-valuemax",ce),M("input"==ae?parseFloat(re.value):re.selectedIndex),d()}function V(){s||(be?ne.style.height=Math.max(1,ie.offsetHeight-te.offsetTop)+"px":ne.style.width=Math.max(1,te.offsetLeft)+"px")}function K(){for(var e,t=!1,n=document.getElementsByTagName("label"),i=0;e=n[i];i++)if(e.htmlFor&&e.htmlFor==re.id||e.getAttribute("for")==re.id){t=e;break}return t&&!t.id&&(t.id=re.id+"_label"),t}function G(){var e="select"==ae?re.options[re.selectedIndex].value:re.value,t=Te?Te(e):"select"==ae&&re.options[re.selectedIndex].text?re.options[re.selectedIndex].text:e;te.setAttribute("aria-valuenow",e),te.setAttribute("aria-valuetext",t)}function J(e){Ke=!0,Pe=De,O("input"==ae?parseFloat(re.value):re.selectedIndex),G(),Pe=!1}function Q(e){"input"==ae?re.value=re.defaultValue:re.selectedIndex=Ce,M("select"==ae?re.options[re.selectedIndex].value:re.value),d(),G()}function t(e){Ke=!!e}function Y(e,t){e.setAttribute("tabIndex",t),e.tabIndex=t}var X,Z,ee,te,ne,ie,re=e.inp,oe=!1,ae=re.tagName.toLowerCase(),se=+e.min,le=+e.max,ue=+e.min,ce=+e.max,de=Math.abs(le-se),he="select"==ae?1:+e.step,pe=e.maxStep?+e.maxStep:2*he,fe=e.precision||0,me=Math.ceil(de/he),ge=e.scale||!1,ve=!!e.hideInput,ye=e.animation||"",be=!!e.vertical,we=e.callbacks||{},xe=e.classNames||"",_e=!!e.html5Shim,ke=se>le?se:se+(le-se)/2,Ce="select"==ae?re.selectedIndex:re.defaultValue||ke,$e=_e||!!e.forceValue,Se=_e&&be&&"inpHeight"in e?e.inpHeight:!1,Te=!_e&&e.ariaFormat?e.ariaFormat:!1,De=!_e&&"select"!=ae&&"userSnap"in e?!!e.userSnap:!1,Pe=!1,Ee=null,Ae=!0,Ie=("select"==ae?re.selectedIndex:re.value,0),Re=0,Me=0,je=0,Le=0,Ne=0,Oe=0,Ue=0,He=0,Fe=0,qe=0,Be=0,We=0,ze=0,Ve=0,Ke=!1,Ge=!1;"input"==ae&&$e&&!re.defaultValue&&(re.defaultValue=j()),se>le&&(he=-Math.abs(he),pe=-Math.abs(pe)),ge&&(ge[100]=le);var Je=function(){Oe++;var e=Le,t=20,n=Oe,i=je,r=Math.ceil(n==t?i+e:e*(-Math.pow(2,-10*n/t)+1)+i);N(n==t?Me:r),n!=t?(h("move"),Ee=setTimeout(Je,20)):(clearTimeout(Ee),Ee=null,Ae=!0,b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),h("finalise"))};return function(){_e||ve?y(re,"fd-form-element-hidden"):f(re,"change",J),_e&&(re.stepUp=function(e){E(e||1)},re.stepDown=function(e){E(e||-1)}),X=document.createElement("span"),X.className="fd-slider"+(be?"-vertical ":" ")+xe,X.id="fd-slider-"+re.id,be&&Se&&(X.style.height=Se+"px"),Z=document.createElement("span"),Z.className="fd-slider-wrapper"+(_e?"":" fd-slider-no-value"),ee=document.createElement("span"),ee.className="fd-slider-inner",ie=document.createElement("span"),ie.className="fd-slider-bar",r?te=document.createElement("span"):(te=document.createElement("a"),te.setAttribute("href","#"),f(te,"click",g)),Y(te,0),te.className="fd-slider-handle",te.appendChild(document.createTextNode(String.fromCharCode(160))),Z.appendChild(ee),s||(ne=document.createElement("span"),ne.className="fd-slider-range",Z.appendChild(ne)),Z.appendChild(ie),Z.appendChild(te),X.appendChild(Z),re.parentNode.insertBefore(X,re),u&&(te.unselectable="on",ie.unselectable="on",ee.unselectable="on",X.unselectable="on",Z.unselectable="on",s||(ne.unselectable="on")),X.setAttribute("role","application"),te.setAttribute("role","slider"),te.setAttribute("aria-valuemin","select"==ae?re.options[0].value:se),te.setAttribute("aria-valuemax","select"==ae?re.options[re.options.length-1].value:le);var e=K();e&&(te.setAttribute("aria-labelledby",e.id),te.id="fd-slider-handle-"+re.id,e.setAttribute("for",te.id)),document.getElementById(o)&&te.setAttribute("aria-describedby",o),1==re.getAttribute("disabled")||"disabled"==re.getAttribute("disabled")?n(!0):l(!0),a.onvalue&&(Ke=!0,M("input"==ae?parseFloat(re.value):re.selectedIndex)),re.form&&f(re.form,"reset",Q),G(),h("create"),d()}(),{onResize:function(e){(X.offsetHeight!=Ie||X.offsetWidth!=Re)&&d()},destroy:function(){c()},reset:function(){O("input"==ae?parseFloat(re.value):re.selectedIndex)},stepUp:function(e){E(Math.abs(e)||1)},stepDown:function(e){E(-Math.abs(e)||-1)},increment:function(e){E(e)},disable:function(){n()},enable:function(){l()},setRange:function(e,t){z(e,t)},getValueSet:function(){return!!Ke},setValueSet:function(e){t(e)},checkValue:function(){a.onvalue&&(Ke=!0,M("input"==ae?parseFloat(re.value):re.selectedIndex)),G(),d()}}}var t={},n=0,i=!0,r=!0,o="fd-slider-describedby",a={onfocus:!0,onvalue:!0},s=!1,l="jump",u="[object Opera]"===Object.prototype.toString.call(window.opera),c=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,d=/^([0-9]+(\.[0-9]+){0,1})$/,h=function(e){if("string"!=typeof e||""===e)return{};try{if("object"==typeof JSON&&"function"==typeof JSON.parse)return JSON.parse(e);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(e.toLowerCase())){var t=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",e.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""));return t()}}catch(n){}return{err:"Could not parse the JSON object"}},p=function(e){if("object"==typeof e)for(var t in e)switch(value=e[t],t.toLowerCase()){case"mousewheelenabled":i=!!value;break;case"fullaria":r=!!value;break;case"describedby":o=String(value);break;case"norangebar":s=!!value;break;case"html5animation":l=-1!=String(value).search(/^(jump|tween|timed)$/i)?String(value).toLowerCase():"jump";break;case"varsetrules":"onfocus"in value&&(a.onfocus=!!value.onfocus),"onvalue"in value&&(a.onvalue=!!value.onvalue)}},f=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent&&e.attachEvent("on"+t,n)},m=function(e,t,n){try{e.removeEventListener?e.removeEventListener(t,n,!0):e.detachEvent&&e.detachEvent("on"+t,n)}catch(i){}},g=function(e){return e=e||window.event,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},v=function(e){return e=e||window.event,e.preventDefault?void e.preventDefault():void(e.returnValue=!1)},y=function(e,t){new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)||(e.className+=(e.className?" ":"")+t)},b=function(e,t){e.className=t?e.className.replace(new RegExp("(^|\\s)"+t+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},w=function(){var e={};for(var n in t)e[n]=t[n].getValueSet();return e},x=function(e,n){t[e].setValueSet(!!n)},_=function(e){return!!(e in t&&t.hasOwnProperty(e))},k=function(n){if(!n||!n.inp||!n.inp.tagName||-1==n.inp.tagName.search(/^input|select/i))return!1;if(n.html5Shim=!1,"select"==n.inp.tagName.toLowerCase()){if(n.inp.options.length<2)return!1;n.min=0,n.max=n.inp.options.length-1,n.step=1,n.precision=0,n.scale=!1,n.forceValue=!0}else{if(-1==String(n.inp.type).search(/^(text|range)$/i))return!1;n.min=n.min&&-1!=String(n.min).search(c)?+n.min:0,n.max=n.max&&-1!=String(n.max).search(c)?+n.max:100,n.step=n.step&&-1!=String(n.step).search(d)?n.step:1,n.precision=n.precision&&-1!=String(n.precision).search(/^[0-9]+$/)?n.precision:-1!=String(n.step).search(/\.([0-9]+)$/)?String(n.step).match(/\.([0-9]+)$/)[1].length:0,n.scale=n.scale||!1,n.forceValue="forceValue"in n?!!n.forceValue:!1,n.userSnap="userSnap"in n?!!n.userSnap:!1}return n.ariaFormat="ariaFormat"in n&&"function"==typeof n.ariaFormat?n.ariaFormat:!1,n.maxStep=n.maxStep&&-1!=String(n.maxStep).search(d)?+n.maxStep:2*+n.step,n.classNames=n.classNames||"",n.callbacks=n.callbacks||!1,S(n.inp.id),t[n.inp.id]=new e(n),!0},C=function(e,t){return e.getAttribute(t)||""},$=function(){for(var i,r,o=document.getElementsByTagName("input"),a=0;r=o[a];a++)if("input"==r.tagName.toLowerCase()&&"text"==r.type.toLowerCase()&&(C(r,"min")&&-1!=C(r,"min").search(c)||C(r,"max")&&-1!=C(r,"max").search(c)||C(r,"step")&&-1!=C(r,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i))){if(r.id&&document.getElementById("fd-slider-"+r.id))continue;r.id&&!document.getElementById("fd-slider-"+r.id)&&S(r.id),r.id||(r.id="fd-slider-form-elem-"+n++),i={inp:r,callbacks:[],animation:l,vertical:C(r,"data-fd-slider-vertical")?!0:r.offsetHeight>r.offsetWidth,classNames:C(r,"data-fd-slider-vertical"),html5Shim:!0},i.vertical&&!C(r,"data-fd-slider-vertical")&&(i.inpHeight=r.offsetHeight),i.min=C(r,"min")||0,i.max=C(r,"max")||100,i.step=-1!=C(r,"step").search(/^any$/i)?i.max-i.min:-1!=C(r,"step").search(d)?r.getAttribute("step"):1,i.precision=-1!=String(i.step).search(/\.([0-9]+)$/)?String(i.step).match(/\.([0-9]+)$/)[1].length:0,i.maxStep=2*i.step,S(i.inp.id),t[i.inp.id]=new e(i)}return!0},S=function(e){return e in t&&t.hasOwnProperty(e)?(t[e].destroy(),delete t[e],!0):!1},T=function(e){for(var n in t)t.hasOwnProperty(n)&&t[n].destroy();t=[]},D=function(e){T(),t=null},P=function(e){for(var n in t)t.hasOwnProperty(n)&&t[n].onResize()},E=function(){A(),$()},A=function(){m(window,"load",$)};return f(window,"load",$),f(window,"load",function(){setTimeout(function(){var e;for(e in t)t[e].checkValue()},0)}),f(window,"resize",P),f(window,"unload",D),function(){var e=document.getElementsByTagName("script"),t=String(e[e.length-1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""),n=h(t);"object"!=typeof n||"err"in n||p(n)}(),{rescanDocument:$,createSlider:function(e){return k(e)},onDomReady:function(){E()},destroyAll:function(){T()},destroySlider:function(e){return S(e)},redrawAll:function(){P()},addEvent:f,removeEvent:m,stopEvent:g,increment:function(e,n){return _(e)?void t[e].increment(n):!1},stepUp:function(e,n){return _(e)?void t[e].stepUp(Math.abs(n)||1):!1},stepDown:function(e,n){return _(e)?void t[e].stepDown(-Math.abs(n)||-1):!1},setRange:function(e,n,i){return _(e)?void t[e].setRange(n,i):!1},updateSlider:function(e){return _(e)?(t[e].onResize(),void t[e].reset()):!1},disable:function(e){return _(e)?void t[e].disable():!1},enable:function(e){return _(e)?void t[e].enable():!1},getValueSet:function(){return w()},setValueSet:function(e,t){return _(id)?void x(e,t):!1},setGlobalVariables:function(e){p(e)},removeOnload:function(){A()}}})()},function(e,t){!function(e,t){"use strict";var n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(i){function r(){var t=e(h),n=e(p);l&&(p.length?l.reject(c,t,n):l.resolve(c)),e.isFunction(i)&&i.call(s,c,t,n)}function o(e){a(e.target,"error"===e.type)}function a(t,i){t.src!==n&&-1===e.inArray(t,d)&&(d.push(t),i?p.push(t):h.push(t),e.data(t,"imagesLoaded",{isBroken:i,src:t.src}),u&&l.notifyWith(e(t),[i,c,e(h),e(p)]),c.length===d.length&&(setTimeout(r),c.unbind(".imagesLoaded",o)))}var s=this,l=e.isFunction(e.Deferred)?e.Deferred():0,u=e.isFunction(l.notify),c=s.find("img").add(s.filter("img")),d=[],h=[],p=[];return e.isPlainObject(i)&&e.each(i,function(e,t){"callback"===e?i=t:l&&l[e](t)}),c.length?c.bind("load.imagesLoaded error.imagesLoaded",o).each(function(i,r){var o=r.src,s=e.data(r,"imagesLoaded");return s&&s.src===o?void a(r,s.isBroken):r.complete&&r.naturalWidth!==t?void a(r,0===r.naturalWidth||0===r.naturalHeight):void((r.readyState||r.complete)&&(r.src=n,r.src=o))}):r(),l?l.promise(s):s}}(jQuery)},function(e,t,n){var i,r;i=[n(8),n(220),n(3)],r=function(e,t,n){"use strict";function i(e){this._$toolbar=n(e),this._$toggle=this._$toolbar.find(".image-diff-toggle")}return t.addLocalEventMixin(i.prototype),i.prototype.init=function(t){function i(e){r.trigger("modeChanged",e,r._mode),r._mode=e}var r=this,o=this._$toggle.find(".image-diff-two-up"),a=this._$toggle.find(".image-diff-blend"),s=this._$toggle.find(".image-diff-split");s.attr("aria-disabled",!t).prop("disabled",!t),t&&s.attr("title",e.I18n.getText("imageDiffer.imageDiffToolbar.button.split.tooltip")),a.attr("aria-disabled",!t).prop("disabled",!t),t&&a.attr("title",e.I18n.getText("imageDiffer.imageDiffToolbar.button.blend.tooltip"));var l=this._$toggle.find(".aui-button"),u=function(e){return function(t){var r=n(this);"true"!==r.attr("aria-disabled")&&"true"!==r.attr("aria-pressed")&&(l.attr("aria-pressed","false"),r.attr("aria-pressed","true"),i(e)),t.preventDefault()}};o.click(u("two-up")),a.click(u("blend")),s.click(u("split")),o.add(a).add(s).tooltip({gravity:"s"}),i("two-up")},i.prototype.getMode=function(){return this._mode},i.prototype.destroy=function(){this._$toolbar&&(this._$toolbar.remove(),this._$toolbar=null),this._$toggle=null},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(2),n(232),n(237),n(239),n(226),n(227),n(244),n(245),n(246),n(164)],r=function(e,t,n,i,r,o,a,s,l,u,c,d){function h(){var t=[];d.id&&(t=n.map(e("#recently-mentioned-"+d.id).data("value"),function(e){return new r(e)}));var c=e("body")[0],h={model:r,matcher:r.matcher,queryEndpoint:"/xhr/user-mention",queryParamKey:"term",maxResponseSize:20},p=new o(t,h),f=new o(t,n.extend({},h,{model:r,matcher:r.matcher})),m=new o(t,n.extend(h,{queryData:{include_teams:!0}})),g={el:c,results:l,resultView:u};new i(n.extend({source:f},g)).render(),new s(n.extend({source:p},g)).render(),new a(n.extend({source:m},g)).render()}return t(function(){h()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(227)],r=function(e){return e.extend({className:"bb-user-team-typeahead"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(228)],r=function(e,t){return t.extend({className:"bb-user-typeahead"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(2),n(229),n(230)],r=function(e,t,n,i,r,o){return t.View.extend({BACKSPACE:8,DELETE:46,ESC:27,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,TAB:9,className:"bb-typeahead-input",boundEventTypes:["keydown","keypress","focus","paste","cut"],events:function(){var e={keydown:"onKeyDown",keypress:"onKeyPress",focus:"onFocus",paste:"onChange",cut:"onChange"},t={};return i.each(this.boundEventTypes,function(n){t[n+" ."+this.className]=e[n]}.bind(this)),t},initialize:function(e){if(this.hide=i.has(e,"hide")?!!e.hide:!0,this.focus=i.has(e,"focus")?!!e.focus:!0,this.source=e.source,this.source.on("respond",this.respond,this),e.results&&e.results.cid)this.results=e.results;else{var t=e.results||o;this.results=new t({suggestionView:e.resultView,callToActionText:e.callToActionText,extraClasses:e.resultsClasses,suggestionTemplate:e.resultTemplate,noResultsText:e.noResultsText,searchingText:e.searchingText})}skate.init(this.results.el),this.results.$el.appendTo("body"),this.results.$el.on("click",".bb-typeahead-item",i.bind(this.complete,this)),this.caretMarker=n('<div class="caret-marker"/>').attr({"aria-owns":this.results.$el.attr("id"),"aria-haspopup":"true"}).addClass("aui-dropdown2-trigger aui-dropdown2-trigger-arrowless"),skate.init(this.caretMarker[0]),this.caretMarker.appendTo("body"),this.showingSuggestions=!1,this.currentEl=null,this.escPressed=!1,this.searchingTimeout=null,this.onFocusTimeout=null,this.queueQuery=i.debounce(this.queueQuery,e.queryDelay||600)},adjustCaretMarker:function(){var e=this.currentEl,t=n(e),i=parseInt(t.css("height"),10),r=t.offset(),o=t.closest(".aui-layer"),a=o.length?o:n(document.body),s=a.offset();a.append(this.caretMarker),this.caretMarker.css({position:"absolute",top:r.top-s.top+i,left:r.left-s.left})},respond:function(e){var t=this,r=e.query||"",o=!!r&&t.source.activeQueryCount>0;t.hide&&r&&!e.results.length?t.showingSuggestions&&!o&&t.hideSuggestions(t.currentEl):(t.showSuggestions(t.currentEl),t.results.render(i.extend(e,{searching:o}))),clearTimeout(t.searchingTimeout),o&&!e.results.length?t.searchingTimeout=setTimeout(function(){n(t.currentEl).addClass("bb-typeahead-searching")},300):n(t.currentEl).removeClass("bb-typeahead-searching")},onKeyDown:function(e){if(this.currentEl=e.target,e.which===this.BACKSPACE||e.which===this.DELETE)return void this.queueQuery(e.target);if(this.showingSuggestions){switch(e.which){case this.DOWN:e.preventDefault(),e.stopPropagation(),this.results.next();break;case this.UP:e.preventDefault(),e.stopPropagation(),this.results.prev();break;case this.LEFT:case this.RIGHT:this.queueQuery(e.target),e.stopPropagation();break;case this.ESC:e.preventDefault(),e.stopPropagation(),this.escPressed=!0,this.hideSuggestions(e.target);break;case this.TAB:e.preventDefault(),e.stopPropagation(),1===this.results.count()?this.complete(e):e.shiftKey?this.results.prev():this.results.next();break;case this.ENTER:e.preventDefault(),e.stopPropagation(),this.complete(e)}this.currentEl.focus()}},shouldStopSuggesting:function(e){return!1},shouldSuppressSuggestions:function(){return this.escPressed},stopSuppressingSuggestions:function(){this.escPressed=!1},isWithinCodeBlock:function(e){return!1},onKeyPress:function(e){if(0!==e.which&&e.which!==this.ENTER){var t=e.target;this.currentEl=t,this.shouldStopSuggesting(e)?this.hideSuggestions(t):this.queueQuery(t)}},onChange:function(e){this.currentEl=e.target,this.queueQuery(this.currentEl)},onFocus:function(e){var t=this,i=e.target;t.currentEl=i,null===this.onFocusTimeout&&(this.onFocusTimeout=setTimeout(function(){t.focus&&!i.value&&"false"!==n(i).attr("data-bb-typeahead-focus")&&(n(i).attr("data-bb-typeahead-focus","false"),t.queueQuery(i)),t.onFocusTimeout=null},200))},hideSuggestions:function(e){this.results.$el.is(":visible")&&n(e).trigger("aui-button-invoke"),this.setShowingState(e,!1)},cursor:function(){return new r(/(.*)/,/(.*)/)},queryTerm:function(e){return this.cursor().token(e).value},queueQuery:function(e){var t=this;setTimeout(function(){!e.value&&t.shouldSuppressSuggestions()&&t.stopSuppressingSuggestions();var n=t.queryTerm(e);null!==n?t.source.query(n):t.hideSuggestions(e)},0)},setShowingState:function(e,t){this.showingSuggestions=t,this.results.$el.is(":visible")!==t&&this.caretMarker.trigger("aui-button-invoke")},showSuggestions:function(e){if(!this.isWithinCodeBlock(e)&&!this.shouldSuppressSuggestions()){var t=n(this.currentEl);this.results.$el.width(t.outerWidth()),this.results.$el.attr("data-aui-alignment","bottom left"),this.adjustCaretMarker(),this.setShowingState(e,!0)}},complete:function(e){var t;t="click"===e.type?this.results.replacementText(e.currentTarget):this.results.replacementText(),null!==t&&(this.replaceText(this.currentEl,t),document.activeElement!==this.currentEl&&n(this.currentEl).focus()),this.hideSuggestions(this.currentEl)},replaceText:function(e,t){var i=n(e);n.browser.msie&&parseInt(n.browser.version,10)<10&&i.focus(),this.cursor().replace(e,t),i.trigger("typeahead-completed")},setSource:function(e){this.source.off("respond",this.respond,this),this.source=e,this.source.on("respond",this.respond,this)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(e,t,n){this.leftRegex=new RegExp((e||/(?:^|\s)(\S+)/).source+"$"),this.rightRegex=new RegExp("^"+(t||/(\S*)/).source),this.maxLength=n>0?n:128}return e.VERSION="0.2",e.startsWith=function(t){return new e(new RegExp(["(?:^|\\s)(",t,"[^",t,"\\s]*)"].join("")))},e.prototype.token=function(e,t){var n;"string"==typeof e?n=e:(n=e.value,t=e.selectionStart);var i=n.slice(0,t),r=n.slice(t),o=i.slice(-this.maxLength),a=r.slice(0,this.maxLength),s=o.match(this.leftRegex),l=s?s[1]:"",u=(s=a.match(this.rightRegex))?s[1]:"";return{value:l?l+u:"",prefix:l,suffix:l?u:"",toString:function(){return this.value}}},e.prototype.replace=function(e,t,n){var i;"string"==typeof e?i=e:(i=e.value,n=t,t=e.selectionStart);var r=this.token(i,t);if(i&&!r.value)return"string"==typeof e?i:!1;var o=i.slice(0,t),a=i.slice(t),s=[o.slice(0,o.length-r.prefix.length),n,a.slice(r.suffix.length)].join("");if("string"==typeof e)return s;var l=n.length-r.prefix.length;return e.value=s,e.setSelectionRange(t+l,t+l),!0},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(231)],r=function(e,t,n,i){return t.View.extend({tagName:"div",className:"bb-typeahead-suggestions aui-dropdown2 aui-style-default",extraClassNames:function(){return this.extraClasses},viewClass:function(){return this.suggestionView},callToActionHtml:function(){var t=e("<li>").addClass("bb-typeahead-item");return t.text(this.callToActionText),t},noResultHtml:function(t){var n=e("<li>").addClass("bb-typeahead-item");return t.searching?(n.addClass("bb-typeahead-searching"),n.text(interpolate(this.searchingText,{query:t.query},!0))):n.text(interpolate(this.noResultsText,{query:t.query},!0)),n},initialize:function(t){this.$ul=e("<ul></ul>"),this.$el.append(this.$ul),this.$el.attr("id",n.uniqueId("bb-typeahead-suggestions-")),this.$el.css("z-index",5e3),this.views={},this.models=[],this.index=0,t=t||{},this.suggestionView=t.suggestionView||i,this.callToActionText=t.callToActionText||gettext("Begin typing to search"),this.noResultsText=t.noResultsText||gettext("Found no matches for %(query)s"),this.searchingText=t.searchingText||gettext("Searching for %(query)s"),this.extraClasses=t.extraClasses||"",this.suggestionTemplate=t.suggestionTemplate||"mention-result",this.transformModelId=t.transformModelId||function(e){return e}},render:function(t){if(!t)return this;var i=this;return i.models=t.results,i.$ul.removeClass("bb-typeahead-suggestions-none").children("li").detach().find("a").removeClass("active"),i.$el.addClass(n.result(i,"extraClassNames")),i.models.length?n.each(i.models,function(n,r){var o,a=n.get(n.idAttribute);(o=i.views[a])?o.setQuery(t.query):o=i.views[a]=new(i.viewClass())({model:n,query:t.query,templateName:i.suggestionTemplate}),o.render(),o.$el.attr("data-model-id",n.get(n.idAttribute)),0===r&&o.$el.addClass("active"),i.$ul.append(e('<li class="bb-typeahead-item">').append(o.el))}):t.query?i.$ul.addClass("bb-typeahead-suggestions-none").append(this.noResultHtml({query:t.query,searching:t.searching})):i.$ul.addClass("bb-typeahead-suggestions-none").append(this.callToActionHtml({})),this.lastFocused=0,i},prev:function(){if(0===this.lastFocused){var e=this.models.length-1;this.el.focusItem(e),this.lastFocused=e}else this.el.focusItem(--this.lastFocused)},next:function(){this.lastFocused===this.models.length-1?(this.el.focusItem(0),this.lastFocused=0):this.el.focusItem(++this.lastFocused)},count:function(){return this.models.length},activeModel:function(t){var i,r=t?e(t).find("a"):this.$ul.find("a.active");return r.length?(i=this.transformModelId(r.attr("data-model-id")),n.find(this.models,function(e){return e.get(e.idAttribute)===i})):null},replacementText:function(e){var t=this.activeModel(e);return t?t.replacementText():null}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(149)],r=function(e,t,n){return e.View.extend({tagName:"a",className:"interactive",extraClassNames:"",initialize:function(e){this.query=e.query||"",e.templateName&&(this.template=t.partial(n.toHtml,e.templateName))},render:function(){return this.$el.children().length?this:(this.$el.html(this.template(this.model.toHighlightedJSON(this.query))),this.$el.addClass(t.result(this,"extraClassNames")),this)},setQuery:function(e){var n=this.model.toHighlightedJSON(e);return t.each(t.result(this.model,"highlightAttrs"),function(e){var t=e.replace("_","-");this.$(".{}".format(t)).html(n[e])},this),this.query=e,this.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(229),n(233)],r=function(e,t,n){return n.extend({initialize:function(e){this.usernameCursor=this._getUsernameCursor(),this.relaxedCursor=this._getRelaxedCursor(),n.prototype.initialize.call(this,e)},_getUsernameCursor:function(){return new t(/(?:^|\s)(@[^@,?!'"\s]*[^\.])/,/([^.,?!'"\s]+)/)},_getRelaxedCursor:function(){return new t(/(?:^|\s)(@|@[^@\s](?:[^@\n]*[^\.])?)/,/([^.,?!'"\s]+)/)},cursor:function(){return this.showingSuggestions?this.relaxedCursor:this.usernameCursor},isWithinCodeBlock:function(e){var t=e.value.substring(0,e.selectionEnd),n=e.value.substring(0,e.selectionEnd).split("\n"),i=n[n.length-1],r=t.split("```").length%2===0,o=0===i.indexOf("    ");return r||o}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(234),n(236)],r=function(e,t,n){return t.extend({prefix:"@",shouldStopSuggesting:function(t){var i=String.fromCharCode(t.which);if(n.mention.test(i))return!1;var r=this.results.models.length,o=this.cursor().token(t.target).prefix.slice(1),a=0===this.source.activeQueryCount,s=0===r,l=1===r&&this.results.replacementText()===o,u=e.any(this.results.models,function(e){return 0===e.get("username").indexOf(o)});return a&&(u||s||l)},replaceText:function(e,n){var i=e.selectionStart===e.value.length?" ":"";t.prototype.replaceText.call(this,e,"@"+n+i)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(229),n(228),n(235)],r=function(e,t,n,i,r,o){return r.extend({className:"bb-mention-input",boundEventTypes:["keydown","keypress"],initialize:function(e){if(r.prototype.initialize.call(this,n.extend({hide:!1,focus:!1},e)),this.prefixCursor=i.startsWith(this.prefix),this.results.$el.addClass("aui-dropdown2-tailed bb-mention-input-results"),this.prefix=this.prefix||e.prefix,!this.prefix)throw new Error("A prefix must be defined")},cursor:function(){return this.prefixCursor;
},isWithinCodeBlock:function(){return!1},onKeyPress:function(e){r.prototype.onKeyPress.call(this,e);var t=String.fromCharCode(e.which);this.isWithinCodeBlock(e.target)||!this.shouldSuppressSuggestions()||this.showingSuggestions||t!==this.prefix||r.prototype.stopSuppressingSuggestions.call(this)},adjustCaretMarker:function(){var e,n,i=this.currentEl,r=t(i),a=i.selectionStart,s=this.cursor().token(i),l=parseInt(r.css("font-size"),10);i.setSelectionRange(a-s.prefix.length,a-s.prefix.length),e=o(i,i.selectionEnd),i.setSelectionRange(a-(s.prefix.length-1),a-(s.prefix.length-1)),n=o(i,i.selectionEnd),i.setSelectionRange(a,a);var u=r.offset(),c=(n.left-e.left)/2,d=20,h=8,p=2;this.caretMarker.css({position:"absolute",top:u.top+n.top-r.scrollTop()+l+p,left:u.left+e.left+c-(d+h)})},queryTerm:function(e){var t=this.cursor().token(e);return t.value?t.value.slice(this.prefix.length):null}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){!function(){function t(e,t){var r=document.createElement("div");r.id="input-textarea-caret-position-mirror-div",document.body.appendChild(r);var o=r.style,a=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",n.forEach(function(e){o[e]=a[e]}),i?e.scrollHeight>parseInt(a.height)&&(o.overflowY="scroll"):o.overflow="hidden",r.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(r.textContent=r.textContent.replace(/\s/g,""));var s=document.createElement("span");s.textContent=e.value.substring(t)||".",r.appendChild(s);var l={top:s.offsetTop+parseInt(a.borderTopWidth),left:s.offsetLeft+parseInt(a.borderLeftWidth)};return document.body.removeChild(r),l}var n=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],i=null!=window.mozInnerScreenX;"undefined"!=typeof e&&"undefined"!=typeof e.exports?e.exports=t:window.getCaretCoordinates=t}()},function(e,t,n){var i;i=function(){return{email:/^.+@.+$/,mention:/^[\.\w-]+$/,username:/^[\w-]+$/}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(2),n(238)],r=function(e,t){return t.extend({idAttribute:"username",highlightAttrs:["display_name","username"],sortKeys:function(e){var t=this.get("display_name")||this.get("username");return[!(e.toLowerCase()===this.get("username").toLowerCase()),this.get("is_team"),!this.get("is_teammate"),!(this.usernameMatch(e)||this.displayNameMatch(e)),t.toLowerCase(),this.get("username").toLowerCase()]},usernameMatch:function(e){return this.startsWith(this.get("username"),e)},displayNameMatch:function(e){var t=this.get("display_name");return t&&this.startsWith(t,e)},keywordMatch:function(t){return e.some(this.get("keywords"),function(e){return this.startsWith(e,t)},this)},matches:function(e,t){var n=t.getQueryData(e),i=n.include_teams||!this.get("is_team");if(!e)return i;var r=this.usernameMatch(e),o=this.displayNameMatch(e),a=this.keywordMatch(e);return i&&(r||o||a)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2)],r=function(e,t){return e.Model.extend({replacementText:function(){return this.get(this.idAttribute)},highlightAttrs:function(){return[this.idAttribute]},toHighlightedJSON:function(e){var n=this.toJSON();return t.each(t.result(this,"highlightAttrs"),function(t){n[t]&&(n[t]=this.highlightSubstring(n[t],e))},this),n},highlight:function(e,n){return n=n.toLowerCase(),0===n.length||0!==e.toLowerCase().indexOf(n)?t.escape(n):["<em>",t.escape(e.slice(0,n.length)),"</em>",t.escape(e.slice(n.length))].join("")},highlightSubstring:function(e,n){n=n.toLowerCase();var i=this.splitWords(e);if(!i.length||!n)return t.escape(e);for(var r=[];i.length;){if(0===i.join("").toLowerCase().indexOf(n)){r.push(this.highlight(i.join(""),n));break}r.push(t.escape(i.shift(),n))}return r.join("")},splitWordsRegExp:/\s+/,splitWords:function(e){for(var t=[],n=e.split(this.splitWordsRegExp);n.length;){var i=n.shift();if(i){var r=e.indexOf(i);r>0&&t.push(e.slice(0,r)),t.push(i),e=e.slice(r+i.length)}}return e&&t.push(e),t},startsWith:function(e,t){var n=this.splitWords(e.toLowerCase());if(!n.length)return!1;for(/\s+/.test(n[0])&&n.shift(),t=t.toLowerCase();n.length;){if(0===n.join("").indexOf(t))return!0;n=n.slice(2)}return!1},matches:function(e,t){return e?this.startsWith(this.replacementText(),e):!0}},{matcher:function(e,t){var n=this;return e.matches(t,n)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(240)],r=function(e,t){return t.extend({getFilteredResults:function(n){var i=t.prototype.getFilteredResults.call(this,n),r=e.filter(i,function(e){return e.get("is_teammate")}),o=e.filter(i,function(e){return!e.get("is_teammate")&&n.toLowerCase()===e.get("username").toLowerCase()}),a=e.filter(i,function(e){return!e.get("is_teammate")&&n.toLowerCase()!==e.get("username").toLowerCase()});return r.concat(o).concat(a)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(241),n(243)],r=function(e,t){return e.extend({hasQueryCache:function(n){return n.length<t.MENTIONS_MIN_QUERY_LENGTH||e.prototype.hasQueryCache.call(this,n)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(8),n(242)],r=function(e,t,n){var i=n.TruncatingProgressiveDataSet;return i.extend({initialize:function(e,t){t.maxResponseSize=t.maxResponseSize||20,this.allowMultipleActiveQueries=!!t.allowMultipleActiveQueries,this.queries=[],i.prototype.initialize.call(this,e,t)},getFilteredResults:function(e){var n=this.filter(function(t){return this.matcher(t,e)},this);return n=t.sortBy(n,function(t){return t.sortKeys(e)}),n=t.first(n,this._maxResults)},query:function(t){var i=e.when.apply(this,this.queries);i.then(function(){this.queries=[]}.bind(this)),this.allowMultipleActiveQueries?n.TruncatingProgressiveDataSet.prototype.query.call(this,t):i.then(function(){n.TruncatingProgressiveDataSet.prototype.query.call(this,t)}.bind(this))},fetch:function(e){var t=n.TruncatingProgressiveDataSet.prototype.fetch.call(this,e);return this.queries.push(t),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){AJS.TruncatingProgressiveDataSet=AJS.ProgressiveDataSet.extend({initialize:function(e,t){this._maxResponseSize=t.maxResponseSize,AJS.ProgressiveDataSet.prototype.initialize.call(this,e,t)},shouldGetMoreResults:function(e){var t=this.findQueryResponse(this.value);return!t||t.length===this._maxResponseSize},findQueryResponse:function(e){for(;e;){var t=this.findQueryCache(e);if(t)return t;e=e.substr(0,e.length-1)}return null}})},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e(document.body).data("settings")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(149),n(230),n(243)],r=function(e,t,n,i){return n.extend({extraClassNames:function(){return n.prototype.extraClassNames.call(this)+" bb-user-suggestions"},callToActionHtml:e.bind(t.toHtml,null,"mention-call-to-action"),noResultHtml:function(e){return e.query.length>=i.MENTIONS_MIN_QUERY_LENGTH?n.prototype.noResultHtml.call(this,e):this.callToActionHtml(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(231)],r=function(e,t){return t.extend({extraClassNames:function(){return this.model.get("is_team")?"bb-typeahead-team":"bb-typeahead-user"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(t,n){var i=e(t);1===i.length&&n(i)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(248),n(249),n(250),n(251),n(240),n(230)],r=function(e,t,n,i,r,o,a){return e(function(){var e=new i([],{model:t,matcher:t.matcher,queryEndpoint:"/xhr/repos",queryParamKey:"term",maxResults:10,maxResponseSize:20});new r({el:document.body,source:e,results:a,resultsClasses:"bb-repo-typeahead-suggestions",resultView:n,resultTemplate:"repo-typeahead-result"}).render()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(238),n(164)],r=function(e,t,n){return t.extend({idAttribute:"full_slug",splitWordsRegExp:/[-_]/,initialize:function(e,t){this.set(this.parse(e))},highlightAttrs:["owner","slug"],getFullSlug:function(){return"{}/{}".format(this.get("owner"),this.get("slug"))},queryParts:function(e){var t,n,i=e.split("/");return i.length>1?(t=i[0],n=i[1]):(t="",n=e),{owner:t,slug:n}},toHighlightedJSON:function(t){var n=this.queryParts(t),i=this.toJSON();return e.extend(i,{owner:this.highlightSubstring(this.get("owner"),n.owner||n.slug),slug:this.highlightSubstring(this.get("slug"),n.slug)})},sortKeys:function(e){var t=this.queryParts(e);return t.owner&&t.slug?[!(this.get("owner")===n.username),!(this.get("owner")===t.owner),!(this.get("slug")===t.slug),this.get("owner"),this.get("slug")]:t.owner?[!(this.get("owner")===n.username),!(this.get("owner")===t.owner),this.get("owner"),this.get("slug")]:[!(this.get("owner")===n.username),!(this.get("owner")===e),!(this.get("slug")===e),this.get("owner"),this.get("slug")]},matches:function(e,t){var n,i,r=this.queryParts(e);return r.owner&&r.slug?(n=this.startsWith(this.get("owner"),r.owner),i=this.startsWith(this.get("slug"),r.slug),n&&i):r.owner?n=this.startsWith(this.get("owner"),r.owner):(n=this.startsWith(this.get("owner"),e),i=this.startsWith(this.get("slug"),e),n||i)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(231)],r=function(e,t){return t.extend({extraClassNames:function(){return"bb-repo-typeahead-item"},render:function(){this.$el.attr("title",this.model.getFullSlug()),this.$el.attr("href",this.model.get("href")),t.prototype.render.apply(this,arguments)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(240)],r=function(e){return e.extend({findQueryResponse:function(e){return this.findQueryCache(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(228),n(206)],r=function(e,t,n){var i=n("Page Header");return t.extend({className:"bb-repo-typeahead",complete:function(e){var t=this.results.$(".active").closest("a").attr("href");i("QuickSearch Result Clicked",t),"keydown"===e.type&&(window.location.href=t)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(145)],r=function(e,t){return t(function(e){e.tooltip()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187)],r=function(e){e.proxy_url="/!api/1.0/"}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(255),n(280),n(3)],r=function(e,t,n){if(Math.random()<=.1&&t){var i=t({product:"bitbucket",subproduct:"web"});i.start();var r=n('meta[name="bb-view-name"]').attr("content");e.start({key:r,isInitial:!0}),e.end({key:r})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(256),n(267),n(264),n(278)],r=function(e,t,n,i){return i()?(t(n),e):{start:function(){},end:function(){}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(257),n(263),n(264),n(265),n(266)],r=function(e,t,n,i,r,o){function a(e,t){return Array.isArray(e)||(e=[e]),e.map(function(e){"string"==typeof e&&(e={selector:e});var n,i={};for(n in t)i[n]=t[n];for(n in e)i[n]=e[n];return i})}function s(o){var a;return a=o.map(function(e){var o;return e.requireUpdate?(o=new n(e.selector),i.one("start",function(){o.dismiss()})):o=r(),o.pipe(function(){var n=new t(e.selector);return i.one("start",function(){n.dismiss()}),n})}),e.when.apply(e,a)}var l={};return l.start=function(e){var t,n="isInitial"in e?e.isInitial:o()===!1;i.trigger("start",{key:e.key,isInitial:n}),e.ready&&(t=a(e.ready,{requireUpdate:!n}),s(t).done(function(){l.end({key:e.key})}))},l.end=function(e){i.trigger("end",{key:e.key})},l}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(258),n(259),n(262)],r=function(e,t,n,i){function r(e,t){u||(s.observe(document,{attributes:!0,childList:!0,subtree:!0}),u=!0),l.add(e,t)}function o(e,t){l.remove.apply(l,arguments),0===l.length&&(s.disconnect(),u=!1)}function a(t){var n,i,a=[];return t.forEach||(t=[t]),t.forEach(function(t){var n;document.querySelector(t)||(n=e.Deferred(),n.selector=t,n.callback=function(){n.resolve()},a.push(n),r(t,n.callback))}),n=e.when.apply(e,a),n.always(function(){a.forEach(function(e){o(e.selector,e.callback)})}),i=n.promise(),i.dismiss=function(){a.forEach(function(e){e.reject()})},i}var s,l,u=!1;return l=new i,s=new n(function(e){e.forEach(function(e){var n="childList"===e.type&&e.addedNodes&&e.addedNodes.length>0,i="attributes"===e.type;(n||i)&&l.forEach(function(n,i){(e.target.querySelector(i)||t.call(e.target,i))&&(n.forEach(function(e){e()}),o(i))})})}),a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){var e=window.HTMLElement.prototype,t=e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector;return t}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(260)],r=function(e){return window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver||e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(261)],r=function(e){function t(e){this.callback=e,this.elements=[]}function n(e,t){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:e,type:t||"childList"}}function i(e,t){return 1!==e.nodeType?!1:e.contains?e.contains(t):r.call(e,t)}t.prototype={observe:function(t,r){function o(e){h.push(e),f()}function a(e){var t=e.target;if(t){var r=t.parentNode;l(r)&&(u&&i(u,t)||(c&&c.target===r||p.push(c=n(r)),r?(c.addedNodes||(c.addedNodes=[]),c.addedNodes.push(t)):(c.removedNodes||(c.removedNodes=[]),c.removedNodes.push(t)),u=t))}}function s(e){return r.attributes&&(r.subtree||e===t)}function l(e){return r.childList&&(r.subtree||e===t)}var u,c,d=this,h=[],p=[],f=e(function(){for(var e=h.length,t=0;e>t;t++)a(h[t]);d.callback(p),h=[],p=[],u=void 0,c=void 0}),m={},g=[],v=e(function(){var e=g.length;d.callback(g),g.splice(0,e)}),y={target:t,options:r,insertHandler:o,removeHandler:o,attributeHandler:function(e){var t=e.target;if(s(t)){var i=e.attrName,o=e.prevValue,a=e.newValue,l=n(t,"attributes");l.attributeName=i,r.attributeOldValue&&(l.oldValue=m[i]||o||null),g.push(l),r.attributeOldValue&&(m[i]=a),v()}}};return this.elements.push(y),r.childList&&(t.addEventListener("DOMNodeInserted",y.insertHandler),t.addEventListener("DOMNodeRemoved",y.removeHandler)),r.attributes&&t.addEventListener("DOMAttrModified",y.attributeHandler),this},disconnect:function(){return this.elements.forEach(function(e){e.target.removeEventListener("DOMNodeInserted",e.insertHandler),e.target.removeEventListener("DOMNodeRemoved",e.removeHandler),e.target.removeEventListener("DOMAttrModified",e.attributeHandler)}),this.elements=[],this}};var r=window.HTMLElement.prototype.contains;return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},1))}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){function e(){this._items={},this.length=0}return e.prototype.add=function(e,t){this._items.hasOwnProperty(e)||(this.length++,this._items[e]=[]),this._items[e].push(t)},e.prototype.remove=function(e,t){var n,i=!1;return this._items.hasOwnProperty(e)&&(1===arguments.length?(delete this._items[e],i=!0):(n=this._items[e].indexOf(t),n>-1&&(this._items[e].splice(n,1),0===this._items[e].length&&delete this._items[e],i=!0))),i},e.prototype.get=function(e){return this._items.hasOwnProperty(e)?this._items[e]:[]},e.prototype.forEach=function(e){var t=this._items;Object.keys(t).forEach(function(n){e(t[n],n)})},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(258),n(259),n(262)],r=function(e,t,n,i){function r(e,t){u||(s.observe(document,{childList:!0,subtree:!0}),u=!0),l.add(e,t)}function o(e,t){l.remove.apply(l,arguments),0===l.length&&(s.disconnect(),u=!1)}function a(t){var n,i,a=[];return t.forEach||(t=[t]),t.forEach(function(t){var n;document.querySelector(t)&&(n=e.Deferred(),n.selector=t,n.callback=function(){n.resolve()},a.push(n),r(t,n.callback))}),n=e.when.apply(e,a),n.always(function(){a.forEach(function(e){o(e.selector,e.callback)})}),i=n.promise(),i.dismiss=function(){a.forEach(function(e){e.reject()})},i}var s,l,u=!1;return l=new i,s=new n(function(e){e.forEach(function(e){var n="childList"===e.type&&e.removedNodes&&e.removedNodes.length>0;n&&l.forEach(function(n,i){for(var r,a=0;a<e.removedNodes.length;a++)if(r=e.removedNodes[a],r.querySelector&&(r.querySelector(i)||t.call(r,i))){for(var s=0;s<n.length;s++)n[s]();o(i)}})})}),a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[],r=function(){var e={},t={},n=function(e,n,i){"undefined"!=typeof t[e]?t[e].push({callback:n,once:i}):t[e]=[{callback:n,once:i}]};return e.on=function(e,t){n(e,t,!1)},e.one=function(e,t){n(e,t,!0)},e.trigger=function(e,n){if("undefined"!=typeof t[e]){for(var i=t[e].length,r=[],o=0;i>o;o++){var a=t[e][o];a&&a.callback&&(a.callback.apply(void 0,[n]),a.once||r.push(a))}t[e]=r}},e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(){var t=e.Deferred();return t.resolve.apply(t,arguments),t.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(){return n}var n=!1;return e(function(){setTimeout(function(){n=!0},0)}),t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(268),n(270),n(275),n(277)],r=function(e,t,n,i){function r(e){return n({start:i(),end:null},e)}function o(n){var o;n.on("start",function(e){o=r(e)}),n.on("end",function(n){o&&o.key===n.key&&(o.end=i(),t(o).done(function(t){e("browser.metrics.navigation",t)}),o=null)})}return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(269)],r=function(e){function t(t,n){e.EventQueue.push({name:t,properties:n})}return e.EventQueue=e.EventQueue||[],t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return window.AJS||(window.AJS={})}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(271),n(272),n(273),n(265),n(275),n(276),n(3)],r=function(e,t,n,i,r,o,a){function s(){var e="browser-metrics-journey-id-key",t="undefined";return"undefined"===window.sessionStorage?t:(window.sessionStorage[e]?t=window.sessionStorage.getItem(e):(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)}),window.sessionStorage.setItem(e,t)),t)}function l(e){var l=i(),u=e.start,c={},d=a.Deferred();return e.isInitial&&(l=l.pipe(n).pipe(function(e){c=r(c,e),u=c.navigationStart,delete c.navigationStart})),l.always(function(){c=r(c,{readyForUser:Math.round(e.end)}),c=o(c,-u),c=r(c,{key:e.key,isInitial:e.isInitial,userAgent:window.navigator.userAgent,journeyId:s()},t()),d.resolve(c)}),d.promise()}return l}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(t,n){function i(){var e=t();void 0!==e&&(clearInterval(r),o.resolve(e))}var r,o=e.Deferred();return r=setInterval(i,n),i(),o.promise()}return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(){var e={};return window.performance&&window.performance.navigation&&window.performance.navigation.redirectCount>0&&(e.redirectCount=window.performance.navigation.redirectCount),e}return e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(265),n(274),n(271)],r=function(e,t,n){function i(){return window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}function r(){function r(){var e=window.performance.timing.loadEventEnd;return e>0?e:void 0}function a(){var t={};return o.forEach(function(e){var n=window.performance.timing[e];n>0&&(t[e]=n)}),e(t)}return i()?n(r,500).pipe(a):t()}var o=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(){var t=e.Deferred();return t.reject.apply(t,arguments),t.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(){for(var e,n,i={},r=0,o=arguments.length;o>r;r++){e=arguments[r];for(n in e)t.call(e,n)&&(i[n]=e[n])}return i}var t=Object.prototype.hasOwnProperty;return e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){function e(e,t){var n={};return Object.keys(e).forEach(function(i){n[i]=e[i]+t}),n}return e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){var e;return e=window.performance&&window.performance.now?function(){return window.performance.timing.navigationStart+window.performance.now()}:window.Date.now.bind(window.Date)}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(279)],r=function(e){function t(e){return!!(e&&e.constructor&&e.call&&e.apply)}function n(n,i){return e&&e.data&&e.data.claim&&t(e.data.claim)?e.data.claim(n):e&&e.data&&t(e.data)?e.data(n):i}function i(){return void 0===r&&(r=n(o,!0)),r}var r,o="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider";return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return window.WRM||(window.WRM={})}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(281)],r=function(e){return function(t){var n,i,r={},o="herment",a=100,s=5e3,l=1e3;return r.getAtlPath=function(){return e.getCookieValue("__atl_path")},r.getServerName=function(){var e;return"undefined"!=typeof document.location&&"undefined"!=typeof document.location.hostname&&(e=document.location.hostname),""===e&&(e="-"),e},r.getProductNameFromServerName=function(e){return"undefined"!=typeof e?e.replace(".com","").replace(".net","").replace(".org","").replace(".au","").replace(".io",""):"-"},r.getSubdomain=function(e){var t="-",n=e.match(/^([a-z0-9\.]*)[\-\.]{1}([a-z0-9]+)+\.([a-z]{2,6})$/i);if(n){var i=e.split(".");i=2===i[i.length-1].length?i.slice(0,i.length-3):i.slice(0,i.length-2),0!==i.length&&(t=i.join("."))}return t},r.generateRandomStorageKey=function(){var e=2,t=12,n=(Math.random()+"").slice(e,t),i=(Math.random()+"").slice(e,t);return n.concat(i)},r.ajaxPost=function(t,n){var i;if(e.useXDomainRequest(t))i=new window.XDomainRequest;else if(window.XMLHttpRequest)i=new XMLHttpRequest;else{if(!window.ActiveXObject)return;i=new window.ActiveXObject("Microsoft.XMLHTTP")}i.open("POST",t,!0),"undefined"!=typeof i.setRequestHeader&&(i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Accept","application/json, text/javascript, */*;")),i.send(n)},r.parseConfig=function(e,t){var n,i,r,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k;if("undefined"==typeof e||"undefined"==typeof e.queue){var C=window.AJS=window.AJS||{};C.EventQueue=C.EventQueue||[],n=C.EventQueue}else n=e.queue;return i="undefined"==typeof e||"undefined"==typeof e.analyticsscheme?"https":e.analyticsscheme,r="undefined"==typeof e||"undefined"==typeof e.analyticsserver?"analytics.atlassian.com":e.analyticsserver,u="undefined"==typeof e||"undefined"==typeof e.analyticsurl?"/analytics/events":e.analyticsurl,c="undefined"==typeof e||"undefined"==typeof e.server?t.getServerName():e.server,d="undefined"==typeof e||"undefined"==typeof e.product?t.getProductNameFromServerName(c):e.product,"undefined"==typeof e||"undefined"==typeof e.subproduct?(h=t.getSubdomain(c),"undefined"==typeof h&&(h="-")):h=e.subproduct,p="undefined"==typeof e||"undefined"==typeof e.version?null:e.version,f="undefined"==typeof e||"undefined"==typeof e.session?null:e.session,m="undefined"==typeof e||"undefined"==typeof e.sen?null:e.sen,g="undefined"==typeof e||"undefined"==typeof e.sourceip?null:e.sourceip,v="undefined"==typeof e||"undefined"==typeof e.atlpath?t.getAtlPath():e.atlpath,y="undefined"==typeof e||"undefined"==typeof e.ajax?t.ajaxPost:e.ajax,b="undefined"==typeof e||"undefined"==typeof e.maxevents?a:e.maxevents,w="undefined"==typeof e||"undefined"==typeof e.storage_key?o+t.generateRandomStorageKey()+t.generateRandomStorageKey():e.storage_key,x="undefined"==typeof e||"undefined"==typeof e.user?"default":e.user,_="undefined"==typeof e||"undefined"==typeof e.publish_interval?s:e.publish_interval,k="undefined"==typeof e||"undefined"==typeof e.save_interval?l:e.save_interval,{queue:n,gasScheme:i,gasServer:r,gasUrl:u,serverName:c,productName:d,subProductName:h,version:p,session:f,sen:m,sourceIP:g,atlPath:v,post:y,maxevents:b,storageKey:w,user:x,publishInterval:_,saveInterval:k}},n=r.parseConfig(t,r),r.config=n,i=e.getStorage(),r.pushToServer=function(e,t){var i="undefined"!=typeof t?t:r.config.post,o=n.gasScheme+"://"+n.gasServer+n.gasUrl,a={events:e},s=JSON.stringify(a);i(o,s)},r.addEventsToArray=function(e,t,n){if("undefined"!=typeof n&&"undefined"!=typeof n.server&&"undefined"!=typeof n.product&&"undefined"!=typeof n.subproduct&&"undefined"!=typeof n.user)for(var i in e)if(e.hasOwnProperty(i)){var o=e[i];if(t.length>=r.config.maxevents)break;if(o.name&&o.properties){var a={name:o.name,properties:o.properties,serverTime:o.time||(new Date).getTime(),server:n.server,user:n.user,product:n.product,subproduct:n.subproduct,version:n.version,session:n.session,sen:n.sen,sourceIP:n.sourceIP,atlPath:n.atlPath};t.push(a)}}},r.publishFromQueueAndStorage=function(e){var t="undefined"!=typeof e?e:r.pushToServer,o=[];if(!(n.queue.length<1&&("undefined"==typeof i||i.length<1))){var a={server:n.serverName,user:n.user,product:n.productName,subproduct:n.subProductName,version:n.version,session:n.session,sen:n.sen,sourceIP:n.sourceIP,atlPath:n.atlPath};r.addEventsToArray(n.queue,o,a);var s=r.popEventsFromStorage();r.addEventsToArray(s,o,a),n.queue.length=0,o&&o.length&&t(o)}},r.serialiseEventsToString=function(e){return JSON.stringify(e)},r.deserialiseEvents=function(e){return JSON.parse(e)},r.storeEvents=function(e){if("undefined"!=typeof i)try{if(i[n.storageKey]){var t=r.deserialiseEvents(i[n.storageKey])||[];t.length<r.config.maxevents&&t.push.apply(t,e),e=t}i.setItem(n.storageKey,r.serialiseEventsToString(e))}catch(o){}},r.popEventsFromStorage=function(){if("undefined"==typeof i)return[];try{if(i[n.storageKey]){var e=r.deserialiseEvents(i[n.storageKey]);return i[n.storageKey]=r.serialiseEventsToString([]),e}}catch(t){}return[]},r.moveQueueToStorage=function(){0!==n.queue.length&&"undefined"!=typeof i&&(r.storeEvents(n.queue),n.queue.length=0)},r.start=function(){var e=Array.prototype.push;n.queue.push=function(t){t.time=(new Date).getTime(),e.call(n.queue,t)},setTimeout(r.publishFromQueueAndStorage,n.saveInterval),setInterval(r.publishFromQueueAndStorage,n.publishInterval),setInterval(r.moveQueueToStorage,n.saveInterval)},"undefined"!=typeof window.addEventListener?window.addEventListener("unload",function(){r.moveQueueToStorage()}):window.attachEvent("onunload",function(){r.moveQueueToStorage()}),r}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){var e={},t={};return e.getLocalStorage=function(){return window.localStorage},e.getSessionStorage=function(){return window.sessionStorage},e.getInternalStorage=function(){return t.getItem=function(e){return t[e]},t.setItem=function(e,n){t[e]=n},t.clear=function(){t={}},t},e.getStorage=function(){var t;try{var n=e.getLocalStorage();t="undefined"!=typeof n?n:e.getSessionStorage()}catch(i){}return"undefined"==typeof t&&(t=e.getInternalStorage()),t},e.isCORSRequest=function(e){var t=document.createElement("a");return t.href=e,t.host!==window.location.host},e.useXDomainRequest=function(t){return e.isCORSRequest(t)&&!!window.XDomainRequest&&(-1!==navigator.appVersion.indexOf("MSIE 8.")||-1!==navigator.appVersion.indexOf("MSIE 9."))},e.getCookieValue=function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(211)],r=function(e,t){e(document).on("click","[data-ct]",function(){var n=e(this),i="bitbucket."+n.data("ct")+".click",r=n.data("ct-data");t(i,r)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(t){var n=null;if(document.cookie&&""!==document.cookie)for(var i=document.cookie.split(";"),r=0;r<i.length;r++){var o=e.trim(i[r]);if(o.substring(0,t.length+1)===t+"="){n=decodeURIComponent(o.substring(t.length+1));break}}return n}e.ajaxSetup({beforeSend:function(e,n){(/^(?!https?:)/.test(n.url)||0===n.url.indexOf(location.origin))&&e.setRequestHeader("X-CSRFToken",t("csrftoken"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(){e(".deferred-image").each(function(){var t=e(this),n=t.attr("data-src-url"),i=t.attr("data-src-url-2x");window.devicePixelRatio>1.5&&i?t.attr("src",i):n&&t.attr("src",t.attr("data-src-url")),t.removeClass("deferred-image")})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(158)],r=function(e){var t=/<meta .*>/;if(e.support.pjax){var n=e("body").attr("data-replace-url");n&&window.history.replaceState({},"",n),e(document).on("pjax:success",function(i,r){if(r){var o=r.match(t);if(o){var a=e(o[0]);n=a.attr("content"),n&&window.history.replaceState({},"",n)}}})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return window.devicePixelRatio<=1.5?t():t(function(e){if(e.is('[src*="language-avatars"]')){var t=e.attr("src"),n=/(\d+)\.png$/,i=t.match(n),r=parseInt(i[1],10);e.attr("src",t.replace(n,2*r+".png"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(178)],r=function(e,t){var n=t.get("events");n&&n.length&&e.ajax({url:"/xhr/trigger-events/",type:"POST",dataType:"json",data:JSON.stringify(n)}),t.set("events",[])}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i;i=function(){var e=navigator.userAgent;return-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone")?window.history&&"pushState"in window.history:!1}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=i(r),a=n(291),s=i(a);t["default"]=function(e){e.find("[data-modules]").each(function(){var e=o["default"](this),t=e.attr("data-modules").trim();t&&t.split(/\s*,\s*/).forEach(function(t){console&&console.log("loading module",t);var n=s["default"][t];if(!n)throw new Error("module "+t+" not found.");n.onReady&&n.onReady(e)})}),window.jsReady=!0},e.exports=t["default"]},function(e,t,n){e.exports={"account-admin/2fa":n(292),"account-admin/account-selector":n(297),"account-admin/connected-accounts":n(299),"account-admin/delete":n(300),"account-admin/edit-oauth-consumer":n(301),"account-admin/email":n(302),"account-admin/groups/filter":n(303),"account-admin/groups/group-list":n(308),"account-admin/groups/index":n(313),"account-admin/groups/member-form":n(330),"account-admin/groups/view":n(331),"account-admin/import-ssh-keys":n(332),
"account-admin/index":n(333),"account-admin/language-selector":n(334),"account-admin/notifications":n(335),"account-admin/oauth-consumers":n(336),"account-admin/plans":n(337),"account-admin/plans-performance":n(340),"account-admin/settings":n(341),"account-admin/ssh-keys":n(358),"aui/inline-dialog2":n(85),"billing/address-validation":n(362),"billing/credit-card-validation":n(365),"billing/submit-card":n(367),"branches/create":n(370),"components/banner":n(186),"components/branch-dialog":n(373),"components/clone/clone-dialog":n(379),"components/clone/clone-in-sourcetree":n(382),"components/clone/clone-wiki-contextual":n(383),"components/clone/url-dropdown":n(384),"components/compare":n(385),"components/follow-list":n(7),"components/footer":n(207),"components/hipchat-integration-dialog":n(208),"components/hipchat-integration-message":n(216),"components/hipchat-integration-trigger":n(217),"components/image-diff":n(218),"components/mathjax":n(442),"components/mentions/index":n(225),"components/repo-sidebar":n(443),"components/repo-typeahead/index":n(247),"components/repo-watch/setup":n(444),"components/tooltip":n(252),"components/typeahead/emoji/index":n(448),"dashboard/ad-feature":n(453),"dashboard/index":n(454),"dashboard/issues":n(456),"dashboard/overview":n(455),"dashboard/pullrequests":n(457),"header/account-warning":n(191),"header/feedback":n(195),"header/general-invite":n(196),"header/help-menu":n(459),"header/inbox-count":n(200),"header/recent-repos":n(201),"header/teams-dropdown":n(204),"header/tracking":n(205),"i18n/call-for-translators":n(162),"i18n/header-language-form":n(161),"inbox/compose":n(460),"inbox/messages":n(461),"js/commitstatus/status-dialog":n(462),"js/components/omnibar/index":n(464),"js/components/project-select":n(485),"js/connect/admin/index":n(486),"js/connect/connect-views":n(513),"js/connect/fileview":n(525),"js/connect/super-touch-point":n(526),"js/issues/index":n(527),"js/login/login-form":n(529),"js/marketplace/addon-directory":n(531),"js/marketplace/addon-management":n(540),"js/pullrequests/index":n(546),"js/repo-admin/default-reviewers":n(558),"js/source/set-changeset":n(563),"onboarding/create-repo":n(565),"onboarding/creating":n(567),"onboarding/importing":n(568),plans:n(570),"profile/filter":n(572),"profile/filter-user":n(573),"profile/hipchat-integration-ad":n(574),"profile/snippets":n(575),"profile/view":n(576),"registration/atlassian-id-flow/pick-email-and-password-form":n(577),"registration/atlassian-id-flow/pick-username-form":n(581),"registration/atlassian-id-flow/setup-email-verification-retry":n(582),"registration/connect-account-button":n(583),"registration/create-team-form":n(584),"registration/create-team-link":n(189),"registration/hipchat-integration-ad":n(588),"registration/openid-form":n(589),"registration/signup-form":n(590),"registration/team-locked":n(591),"repo-admin/access":n(592),"repo-admin/branch-management":n(605),"repo-admin/delete":n(623),"repo-admin/deploy-keys":n(624),"repo-admin/hooks":n(625),"repo-admin/index":n(626),"repo-admin/issue-export":n(628),"repo-admin/issue-import":n(630),"repo-admin/issues":n(631),"repo-admin/issues-category":n(632),"repo-admin/issues-notifications":n(637),"repo-admin/links":n(641),"repo-admin/settings":n(642),"repo-admin/strip-log":n(645),"repo-admin/transfer":n(646),"repo-admin/transfer-invite":n(647),"repo-admin/transfer-upgrade-required":n(648),"repo-admin/username-mapping":n(649),"repo/branches/compare":n(654),"repo/branches/compare-detail-summary":n(655),"repo/branches/compare-tabs":n(662),"repo/branches/detail":n(663),"repo/branches/filter":n(670),"repo/branches/list":n(671),"repo/commits/branch-selector":n(672),"repo/commits/build-graph":n(674),"repo/commits/commit-header":n(677),"repo/commits/filter":n(684),"repo/commits/list":n(685),"repo/commits/view":n(687),"repo/create":n(688),"repo/create-branch":n(689),"repo/downloads/captcha-form":n(690),"repo/downloads/index":n(691),"repo/downloads/upload-file-form":n(692),"repo/editor/edit-readme":n(693),"repo/editor/readme-edit-button":n(697),"repo/hipchat-integration-ad":n(699),"repo/import":n(700),"repo/index":n(701),"repo/issues/attachments":n(705),"repo/issues/comments":n(706),"repo/issues/form":n(709),"repo/issues/list":n(710),"repo/issues/query-builder":n(711),"repo/issues/transition":n(712),"repo/issues/view":n(713),"repo/overview/filterable-list-dialog":n(714),"repo/overview/followers-dialog":n(715),"repo/overview/getting-started":n(716),"repo/overview/index":n(717),"repo/overview/repo-invite":n(718),"repo/overview/repo-stats":n(719),"repo/overview/revoke-access":n(720),"repo/overview/sourcetree-dialog":n(721),"repo/overview/sync-repo":n(722),"repo/project-select":n(723),"repo/pullrequests/form":n(724),"repo/pullrequests/list":n(730),"repo/pullrequests/view":n(731),"repo/qseries":n(865),"repo/share":n(866),"repo/source/create-file":n(878),"repo/source/delete-file":n(879),"repo/source/diff-file":n(880),"repo/source/editor":n(882),"repo/source/highlight-lines":n(884),"repo/source/index":n(885),"repo/source/list":n(887),"repo/source/rename-file":n(888),"repo/source/view-file":n(889),"repo/wiki/edit":n(890),search:n(892),"snippets/generate-embed-link":n(893),"snippets/list":n(894),"snippets/recent-list":n(895),"snippets/source":n(897),"snippets/view":n(898),supportadmin:n(899),"supportadmin/clear-branch-cache":n(903),"supportadmin/clear-sessions":n(904),"supportadmin/delete-repo":n(905),"supportadmin/delete-user":n(906),"supportadmin/git-gc":n(900),"supportadmin/repository-info":n(901),"supportadmin/toggle-academic":n(907),"utils/atlassian-analytics":n(908),"utils/retina":n(286),"workflow/cloning-repo":n(909),"workflow/fork-form":n(910),"workflow/github-import":n(911),"workflow/importing":n(914),"workflow/invite-form":n(915),"workflow/plan-upgrade":n(916),"workflow/repo-form":n(643),"workflow/repo-import":n(917),"workflow/social-error":n(927),"workflow/social-wizard":n(928)}},function(e,t,n){var i,r;i=[n(3),n(145),n(293)],r=function(e,t,n){return t(function(t){t.on("click",".two-step-verification--recovery-codes--toggle",function(){var t=e(this),n=t.attr("data-toggle-container"),i=t.attr("data-toggle-label");e(n).toggleClass("hidden"),t.attr("data-toggle-label",t.text()),t.text(i)}),t.on("click",".two-step-verification--disable-button",function(){n({id:"delete-account",title:gettext("Disable two-step verification"),content:gettext("Are you sure you want to disable two-step verification? You'll be able to re-enable but you'll have to go through the set up process again."),buttonText:gettext("Disable")}).done(function(){e(".two-step-verification--disable-form").submit()})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(294)],r=function(e,t){return function(n){var i,r=new e.Deferred;i="string"==typeof n?{content:n}:n,i.buttonText=i.buttonText||gettext("Confirm"),i.cancelText=i.cancelText||gettext("Cancel"),i.showCancel=!0;var o=t(i,r);return i.dialog2||o.addCancel(i.cancelText,function(e){e.remove(),r.reject()}),o.show(),r.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(150),n(183),n(295),n(296)],r=function(e,t,n,i,r,o){function a(e,n){var i=new r(t.extend({},{contents:e.content,dialogClass:e.classes,closeText:e.cancelText},e));return i.on("confirm",function(){n.resolve()}).on("cancel",function(){n.reject()}),i}var s=0;return function(e,n){if(e.dialog2)return a(e,n);var r,o=e.id||s++,l=new i({width:e.width||450,height:e.height||"auto",id:"bb-"+o+"-confirmation-dialog"}),u=e.buttonText||gettext("Okay");return r=e.isSafeContent?e.content:t("<div></div>").text(e.content),e.title&&l.addHeader(e.title),l.addPanel("main",r,"confirmation-dialog-body"),l.addButton(u,function(){l.remove(),n.resolve()}),l}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(150),n(2),n(296)],r=function(e,t,n,i,r,o){function a(t){this.options=r.extend({},{size:"medium",isSafeContent:!1,showCloseIcon:!1,hideFooter:!1,showCancel:!1,contents:"",dialogClass:"",buttonText:gettext("Okay"),closeText:gettext("Cancel")},t),t.warning&&(this.options.dialogClass+=" aui-dialog2-warning");var a=i.render(o,this.options);this.$el=n(a),this.options.contents instanceof n&&this.$el.find(".aui-dialog2-content").html(this.options.contents),n(window.body).append(this.$el),this.dialog=e.dialog2(this.$el),this.$el.find(".dialog-accept").on("click",function(){this.trigger("confirm"),this.hide()}.bind(this)),this.$el.find(".dialog-close").on("click",function(){this.trigger("cancel"),this.hide()}.bind(this))}return r.extend(a.prototype,t.Events,{show:function(){this.dialog.show(),this.trigger("show")},hide:function(){this.dialog.hide(),this.trigger("hide")},remove:function(){this.dialog.remove()}}),a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports='<div class="aui-layer aui-dialog2 aui-dialog2-[[size]] [[dialogClass]]"\n    role="dialog" id="[[dialogId]]" aria-hidden="true">\n\n  <header class="aui-dialog2-header">\n    <h1 class="aui-dialog2-header-main">[[title]]</h1>\n    [[{headerSecondary}]]\n    [[#showCloseIcon]]\n      <a class="aui-dialog2-header-close">\n        <span class="aui-icon aui-icon-small aui-iconfont-close-dialog dialog-close"></span>\n      </a>\n    [[/showCloseIcon]]\n  </header>\n\n  <div class="aui-dialog2-content [[contentClass]]">\n    [[#isSafeContent]]\n      [[&contents]]\n    [[/isSafeContent]]\n    [[^isSafeContent]]\n      <p>\n        [[contents]]\n      </p>\n    [[/isSafeContent]]\n  </div>\n\n  [[^hideFooter]]\n    <footer class="aui-dialog2-footer">\n      <div class="aui-dialog2-footer-actions">\n        <button class="aui-button aui-button-light dialog-accept">[[buttonText]]</button>\n        [[#showCancel]]\n          <button class="aui-button aui-button-link dialog-close">[[closeText]]</button>\n        [[/showCancel]]\n      </div>\n\n      [[#showHint]]\n        <div class="aui-dialog2-footer-hint">[[hintText]]</div>\n      [[/showHint]]\n    </footer>\n  [[/hideFooter]]\n</div>\n\n'},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(149),n(298),n(192),n(164)],r=function(e,t,n,i,r,o,a,s){return n(function(e){function t(t){u!==s.username&&e.prepend(r.toHtml("target-user-template",{username:s.username,display_name:s.displayName,avatar:s.avatarUrl}));var o=i.chain(t.teams).filter(n).filter(l).value();i.each(o,function(t){e.append(r.toHtml("target-user-template",t))}),e.on("change",function(e){window.location.href=e.val})}function n(e){return e.username!==u}function l(e){return"admin"===e.privilege}var u=e.attr("data-target-user");e.auiSelect2({formatResult:o,formatSelection:o,dropdownAutoWidth:!0,minimumResultsForSearch:-1}),a().done(t)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(149)],r=function(e,t){return function(n){var i=e(n.element),r=i.data("user");return r||(r={display_name:n.text,avatar:i.data("avatar")}),t.toHtml("user-select-template",r)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(165)],r=function(e,t,n,i){return n(function(){var n=t("#connected-accounts"),r=n.attr("data-password-change-url");n.on("click",'a[href="#delete"]',function(n){n.preventDefault();var o=t(this).closest("tr"),a=o.find("script").html(),s=o.data("type"),l=o.data("pk"),u=i.concat("user","3rdparty",s);t.ajax({type:"DELETE",url:u.toString(l),dataType:"json",success:function(){if("openid"!==s)t(n.target).closest("div").replaceWith(a);else{var e=o.closest("tbody");o.remove(),0===e.find("tr").length&&(t("h2").remove(),e.closest("table").remove())}"github"===s&&(o.find(".github-import").remove(),t("#import-github-repo-link").remove())},error:function(){var t=gettext('Please <a href="%(password_change_url)s">set a password</a> before disconnecting this account');e.messages.error({body:interpolate(t,{password_change_url:r},!0)})}})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(293)],r=function(e,t,n){return t(function(){e("#delete-account").on("click","form button",function(t){t.preventDefault(),n({id:"delete-account",title:gettext("Delete account"),content:gettext("This is a destructive operation. Delete account?"),buttonText:gettext("Delete")}).done(function(){e(t.target).closest("form").submit()})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(2)],r=function(e,t,n){function i(e,t){return e.find(t.map(function(e){return'[data-scope="'+e+'"]'}).join(", "))}function r(e,t){var r=[],o=[];n.each(t,function(t,n){var a=i(e,[n]);if(a.is(":checked")){r.push.apply(r,t);var s=i(e,t);s.prop({disabled:!0,checked:!0})}else o.push.apply(o,t)}),r=n.uniq(r),o=n.uniq(o);var a=o.filter(function(e){return!n.contains(r,e)}),s=i(e,a);s.prop({disabled:!1})}var o={account:["email"],"account:write":["email","account"],"team:write":["team"],"repository:write":["repository"],pullrequest:["repository"],"pullrequest:write":["repository","repository:write","pullrequest"],"issue:write":["issue"],"snippet:write":["snippet"]};return t(function(e){e.on("change","[data-scope]",function(t){r(e,o)}),r(e,o)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(2),n(145),n(165),n(198),n(149)],r=function(e,t,n,i,r,o,a,s){var l=t.Model.extend({idAttribute:"email"}),u=t.Collection.extend({model:l,initialize:function(e,t){this.emailsApi=t.emailsApi,this.isTeam=t.isTeam},comparator:function(e){return[e.get("primary")?0:1,e.get("active")?0:1,e.get("email").toLowerCase()]},url:function(){return this.emailsApi.toString()}}),c=t.View.extend({tagName:"tr",template:"email-template",events:{'click [href="#delete"]':"deleteEmail",'click [href="#resend"]':"resend",'click [href="#set-as-primary"]':"setAsPrimary"},initialize:function(){this.model.on("change",this.render,this)},render:function(e){e="boolean"==typeof e&&e;var t=this.model.toJSON();return t.team=this.model.collection.isTeam,this.$el.html(s.toHtml(this.template,t)),e&&this.model.get("primary")&&this.highlight(),this},highlight:function(){var e=this.$el.addClass("highlight");setTimeout(function(){e.animate({backgroundColor:"#fff"},{duration:1e3,complete:function(){e.removeClass("highlight")}})},1e3)},markSent:function(){var e=gettext("confirmation sent");return this.$(".status").addClass("sent").hide().html("<div>{}</div>".format(i.escape(e))).fadeIn("slow"),this},resend:function(t){return t.preventDefault(),this.model.save({},{wait:!0,success:function(t,n,i){t.get("active")?e.messages.success({body:gettext("Your email address has been confirmed."),fadeout:!0}):this.markSent()}.bind(this)}),this},deleteEmail:function(e){return e.preventDefault(),this.model.destroy({wait:!0,error:function(e,t){var n=t.responseText;this.parent.respond(n?n.substr(0,140):gettext("An unknown error occurred."))}.bind(this)}),this},setAsPrimary:function(t){t.preventDefault(),this.model.save({primary:!0},{wait:!0,success:function(){e.messages.success({body:gettext("Your primary email address has been updated."),fadeout:!0})}})}}),d=t.View.extend({events:{"submit form":"onSubmit"},initialize:function(e){this.submitDisabled=!1,this.$table=this.$("table.widget"),this.$form=this.$("form"),this.$inputRow=this.$("tr.form"),this.$body=this.$("tbody"),this.$emailAddress=this.$("#email-input"),this.$error=this.$(".error"),this.collection.on("add",this.emailAdd,this),this.collection.on("remove",this.emailRemove,this),this.collection.on("reset",this.render,this),this.collection.on("change:primary",this.reorder,this)},render:function(e){if(this.$inputRow=this.$inputRow.detach(),this.$body.empty(),this.$body.append(this.$inputRow),this.collection.length)this.collection.forEach(function(t){var n=new c({model:t});return n.parent=this,this.$body.append(n.render(e).el),this}.bind(this));else{var t;t=this.collection.isTeam?gettext("Adding email addresses to teams is no longer supported"):gettext("No email addresses"),this.$body.append('<tr><td colspan="3">{text}</td></tr>'.format({text:t}))}return this},reorder:function(e){var t=this.collection.find(function(t){return t.get("email")!==e.get("email")&&t.get("primary")});t&&t.set({primary:!1},{silent:!0}),this.collection.sort(),this.render(!0)},emailAdd:function(e,t){var n=new c({model:e}),i=this.collection.indexOf(e);n.parent=this,this.$inputRow.nextAll().eq(i-1).after(n.render().el),n.highlight(),this.respond()},emailRemove:function(e,t,n){var i=this.$inputRow.nextAll().eq(n.index);i.slideUp(function(){i.remove()}),this.respond()},_reword:function(e){var t=/not a valid email address/.test(e);return t?gettext("Invalid email address."):e},respond:function(e){if(e){var t=this._reword(e);this.$error.removeClass("hidden").find(".message").text(t)}else this.$error.addClass("hidden").find(".message").text("")},onSubmit:function(e){e.preventDefault();var t=this.$emailAddress.val().trim();if(!this.submitDisabled&&t){if(this.collection.get(t.toLowerCase()))return void this.respond(gettext("You've already added this email address."));var n=this;n.submitDisabled=!0;var i=a(400,function(){n.$form.addClass("loading")}),r=function(){window.clearTimeout(i),n.$form.removeClass("loading"),n.submitDisabled=!1};n.collection.create({email:t},{wait:!0,complete:r,error:function(e,t){return n.respond(t.responseText)},success:function(e,t){n.$emailAddress.val(""),n.respond()}})}}});return r(function(){var e=n("#account-email"),t=new u([],{emailsApi:o.concat("users",e.attr("data-target-user"),"emails"),isTeam:!!e.attr("data-target-user-is-team")});new d({el:n("#email-pane")[0],collection:t}),t.fetch({reset:!0})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(145),n(304),n(305),n(307),n(306)],r=function(e,t,n,i,r,o,a){return n(function(){function t(t,n){return function(){var i=window.location.href,r=window.location.search.length,o=i.slice(0,-r),s={};s[t]=n,o=o+"?"+e.param(s),a.update({repositories:null,members:null}).update(t,n),e.support.pjax?window.history.replaceState({},"",o):window.location.replace(o)}}var n=e("#group-repositories"),s=e("#repositories-pane"),l=e("#group-members"),u=e("#members-pane"),c=s.find(".maskable").data("page"),d=u.find("#add-member-form").data("page"),h={timeout:3e4,scrollTo:!1};i(u,e.extend({$pjaxContainer:l},h)),i(s,e.extend({$pjaxContainer:n},h)),s.on("pjax:beforeReplace",function(t,n){c=e(n[1]).closest("[data-page]").data("page")}),u.on("pjax:beforeReplace",function(t,n){d=e(n[1]).closest("[data-page]").data("page")}),e("#repositories-tab").on("tabSelect",t("repositories",c)),e("#members-tab").on("tabSelect",t("members",d)),r({$container:s,$pjaxContainer:n,filterTerm:s.find(".filter-status").attr("data-filter-term"),ignoreQuery:"repositories",pjaxOptions:h}),o({$pjaxContainer:n,$controls:e("#repo-filter"),ignoreQuery:"repositories",pjaxOptions:h})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(158)],r=function(e,t){return function(t,n){n=n||{},n.container=n.$pjaxContainer&&n.$pjaxContainer.length?n.$pjaxContainer:t,t.pjax(".aui-nav-pagination a",n).on("click",".aui-nav-pagination a",function(t){e(t.target).attr("aria-disabled")&&t.preventDefault()}),n.setMask!==!1&&t.on("pjax:send",function(){n.container.find(".maskable").addClass("has-mask")}).on("pjax:complete",function(){n.container.find(".maskable").removeClass("has-mask")})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(306),n(158)],r=function(e,t){return function(n){var i=n.$container,r=n.$pjaxContainer,o=n.filterTerm||i.find(".filter-status").attr("data-filter-term"),a=e.extend({},{timeout:3e4},n.pjaxOptions);r.on("pjax:send",function(){r.find(".maskable").addClass("has-mask")}),r.on("pjax:complete",function(){r.find(".maskable").removeClass("has-mask")}),r.on("pjax:end",function(){var t=r.find("[data-current-status]").attr("data-current-status");i.find(".filter-status li").removeAttr("aria-pressed"),t&&e("[data-status={}]".format(t)).parent("li").attr("aria-pressed","true")}),t.ignore(n.ignoreQuery),e.support.pjax&&i.on("click",".filter-status a",function(n){var i=e(this),s=i.attr("data-status"),l=i.attr("href");e.pjax.click(n,e.extend({},a,{container:r,url:t.update(o,s).asUrl(l)}))})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(185)],r=function(e,t,n){function i(e){if(!e)return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t}function r(e,n){t.isNull(e)||t.isUndefined(e)||-1!==s.indexOf(n)?delete a[n]:a[n]=e}function o(){}var a={},s=[];return n(function(){var e=i(window.location.search.substr(1).split("&"));a={},t.each(e,r)}),o.prototype.update=function(){var e=Array.prototype.slice.apply(arguments);return 1===e.length?t.each(e[0],r):2===e.length&&r(e[1],e[0]),this},o.prototype.get=function(){var e=Array.prototype.slice.apply(arguments);return 1===e.length?t.has(a,e[0])?a[e[0]]:null:a},o.prototype.ignore=function(e){return e&&(delete a[e],s.push(e)),this},o.prototype.asUrl=function(n){var i=n.match(/([^#]*)(#.*)?/),r=i[1],o=i[2];return r=r.match(/([^?]*)\??/)[1],"{url}{query}{hash}".format({url:r,query:t.keys(a).length?"?"+e.param(a):"",hash:o})},new o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(306),n(158)],r=function(e,t){return function(n){var i,r=n.$pjaxContainer,o=n.$controls,a=o.find('input[type="search"]'),s=e.extend({},{timeout:3e4},n.pjaxOptions),l=a.val();a.on("input",function(t){clearTimeout(i);var n=e(this),r=n.val();if(13!==t.keyCode&&r!==e("#corrected-search").attr("data-value")&&r!==l){l=r;var o=n.closest("form");i=setTimeout(function(){o.submit()},300)}}),r.on("pjax:start",function(){r.find(".maskable").addClass("has-mask")}).on("pjax:end",function(){r.find(".maskable").removeClass("has-mask"),a.focus()}),t.ignore(n.ignoreQuery),o.on("submit",function(n){n.preventDefault();var i=e(this),o=i.attr("data-url"),a=i.find("input").val(),l=i.attr("data-search-term");e.pjax(e.extend({},s||{},{container:r,url:t.update(l,a).asUrl(o)}))})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(309),n(311),n(293),n(149),n(145),n(212)],r=function(e,t,n,i,r,o,a){return a(function(){n({$trigger:e("#add-group-button"),id:"add-group-dialog",header:gettext("Add group"),saveText:gettext("Add"),saveOptions:function(e){return{url:e.attr("action"),type:"POST"}}});var o=e("#groups"),a=e("#group-errors"),s=o.find("tbody"),l=o.attr("data-remove-group-url");s.on("click",".remove-group",function(n){n.preventDefault();var i=e(this),o=i.parents("tr");r({buttonText:gettext("Remove"),title:gettext("Remove group?"),content:interpolate(gettext("Are you sure you want to remove the group %(group)s?"),{group:o.attr("data-name")},!0)}).done(function(){i.loading(e.ajax({url:l.format(o.attr("data-group")),type:"DELETE"})).done(function(){o.remove()}).fail(function(e){t.messages.error(a,{title:JSON.parse(e.responseText).error.message,closeable:!1})})})}),i({$trigger:e("#add-member-button"),memberAdded:function(e){e.forEach(function(e){var t=s.find("[data-group="+e+"] .member-count"),n=parseInt(t.text(),10);t.text(n+1)})}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(183),n(310),n(212),n(149)],r=function(e,t,n,i,r,o){function a(t,n){var r=t.getCurrentPanel().body.find("form"),o=r.serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{}),a=r.find("#group-emails"),s=t.getPage(0).button[0].item;o[a.attr("name")]=!a.is(":checked"),s.loading(e.ajax(e.extend(n(r),{data:JSON.stringify(o),contentType:"application/json"}))).done(function(e){window.location=e.links.web.href}).fail(function(e){i.markApiErrors(r,e)})}function s(e){e.beforeDialogShow=e.beforeDialogShow||function(e){e.find(".error").addClass("hidden").find(".error-message").text("")};var t=new n({width:600,height:"auto",id:e.id,closeOnOutsideClick:!0});t.addHeader(e.header).addPanel("main",o.toHtml("add-group-form-template",{})).addButton(e.saveText||gettext("Save"),function(t){a(t,e.saveOptions)}).addCancel(gettext("Cancel"),function(e){e.hide()});var i=t.getCurrentPanel().body,r=i.find("select"),s=i.find("#group-access"),l=i.find(".group-notifications");return r.auiSelect2({minimumResultsForSearch:-1,dropdownAutoWidth:!0}),s.on("change",function(e){e.val&&l.toggleClass("hidden","admin"!==e.val)}),e.$trigger.on("click",function(n){n.preventDefault(),e.beforeDialogShow(i),t.show()}),t}return s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(t){var n=t.find(".aui-message.error");return n.length||(n=e("<div>").addClass("aui-message error").append(e("<p>").addClass("title").append(e("<span>").addClass("aui-icon aui-icon-error"),e("<span>").addClass("error-message"))).prependTo(t)),n}function n(t,n){var i=t.find('[name="{}"]'.format(n)),r=i.next(".error");return r.length||(r=e("<div>").addClass("error").insertAfter(i)),r}function i(e,i){var r=JSON.parse(i.responseText),o=r.error.message,a=r.error.fields;if(a)for(var s in a)n(e,s).removeClass("hidden").text(a[s]);t(e).removeClass("hidden").find(".error-message").text(o)}return{markApiErrors:i}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(183),n(312),n(149),n(212)],r=function(e,t,n,i,r){function o(t,n){if(402===t.status){var o=e.parseJSON(t.responseText).data;o.messageType="warning",o.owner=!0;var a=e(r.toHtml("over-limit-template",o)),s=a.find(".upgrade-button");a.insertAfter(n),n.addClass("hidden"),s.on("mousedown",function(){i("upgrade_dialog_button_clicked",{user:o.user.username})}).on("click",function(t){t.preventDefault();var n=s.loading(e.ajax({type:"POST",url:s.attr("data-upgrade-url"),dataType:"json"}));n.done(function(e){e.href&&(window.location.href=e.href)})})}else{var l=JSON.parse(t.responseText),u=l.error;n.removeClass("hidden").find(".error-message").text(u)}}function a(t,n){var i=t.getCurrentPanel().body.find("form"),r=i.serialize(),a=t.getPage(0).button[0].item,s=i.find(".error"),l=i.find(".warning");s.addClass("hidden").find(".error-message").text(""),l.addClass("hidden").find(".warning-message").text(""),a.loading(e.ajax({url:i.attr("action"),type:"POST",data:r})).done(function(e){t.hide(),n(e.groups)}).fail(function(e){o(e,s)})}function s(t){var i="group-add-member-dialog",o=new n({width:600,height:"auto",id:i,closeOnOutsideClick:!0});o.addHeader(gettext("Add team member")).addPanel("main",r.toHtml("add-group-member-template",{})).addButton(gettext("Add"),function(e){a(e,t.memberAdded)}).addCancel(gettext("Cancel"),function(e){e.hide()});var s=o.getCurrentPanel().body,l=e("#group-add-member"),u=e("#group-selection");return u.auiSelect2({dropdownAutoWidth:!0}),t.$trigger.attr("aria-controls",i),t.$trigger.on("click",function(e){e.preventDefault(),s.find(".error").addClass("hidden").find(".error-message").text(""),o.show(),l.val(""),u.auiSelect2("val","")}),o}return s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(178),n(2)],r=function(e,t){return function(n,i){var r=e.get("events")||[];r.push({verb:n,data:t.extend(i,{published:Date.now()})}),e.set("events",r)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(187),n(3),n(145),n(315),n(320),n(314),n(316),n(164),n(327),n(198)],r=function(e,t,n,i,r,o,a,s,l,u,c){return i(function(){var e=n("#groups"),t=e.find("#groups-container"),i=t.data("account-privileges"),a=new s.Groups([],{targetUser:o});t.addClass("loading"),a.fetch({reset:!0,success:function(e){t.removeClass("loading"),e.each(function(e){var t=e.get("owner").username,n=e.get("slug");e.get("owner").is_team&&(e.privilege=new s.GroupAccountPrivilege({group:e,privilege:i["{}/{}".format(t,n)]||null}))}),new r({el:t,collection:e,isTeam:t.data("is-team")}).render();var o=n(location.hash.replace(/:/,"\\:"));o.length&&c(500,function(){var e=o.closest("li").offset().top-20;n(document.body).scrollTop(e)})}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(183),n(149)],r=function(e,t,n,i){e(document).on("keydown",".aui-dialog .button-panel-button, .aui-dialog .button-panel-link",function(t){13===t.keyCode&&e(this).click()});var r=function(t,n){n=n||{},"function"==typeof n&&(n={onUpdateContents:n}),this.useLiveEvents=!!n.useLiveEvents,this.useLiveEvents?this.trigger=t:this.$trigger_=e(t),this.onUpdateContents_=n.onUpdateContents,this.template_=n.template,this.templateData_=n.templateData,this.boundClick_=null,this.timeout_=null,this.success=n.success,this.complete=n.complete,this.error=n.error,this.onSubmit=n.submit,this.isStaticContent=!!n.isStaticContent,this.dataType=n.dataType,this.width=n.width||600,this.height=n.height||"auto",this.urlAttr=n.urlAttr||"href",this.useLiveEvents?this.id=n.id:this.id=n.id||this.$trigger_.attr("id")};return r.prototype=function(){var o=r.prototype;return o.bind=function(){if(this.boundClick_=this.open.bind(this),this.useLiveEvents){var t=e("body");t.off("click.disabled",this.trigger),t.on("click.formdialog",this.trigger,this.boundClick_)}else this.$trigger_.unbind("click.disabled").click(this.boundClick_);return this},o.unbind=function(){return this.boundClick_&&(this.useLiveEvents?e("body").off("click.formdialog",this.trigger,this.boundClick_):this.$trigger_.unbind("click",this.boundClick_),this.boundClick_=null),this},o.disable=function(){this.unbind();var t=function(e){e.preventDefault()};this.useLiveEvents?e("body").on("click.disabled",this.trigger,t()):this.$trigger_.bind("click.disabled",t)},o.open=function(t){var r;if(t.preventDefault(),this.useLiveEvents){if(e(this.trigger).attr("aria-disabled"))return}else if(this.$trigger_.attr("aria-disabled"))return;if(this.$dialog_||(this.$dialog_=new n({width:this.width,height:this.height,id:"bb-"+this.id+"-dialog"}),this.$dialog_.addPanel("main"),this.$element_=this.$dialog_.popup.element,this.$errorContainer_=this.$element_.find(".error-container")),this.$dialog_.initialized&&this.isStaticContent)this.$dialog_.show();else{var o=this.useLiveEvents?e(t.target):this.$trigger_;if(o.addClass("loading"),this.template_)r="function"==typeof this.templateData_?this.templateData_():this.templateData_,this.open_(i.toHtml(this.template_,r||{}),o);else{var a={type:"get",url:o.attr(this.urlAttr),success:this.open_.bind(this)};this.dataType&&(a.dataType=this.dataType),e.ajax(a)}}this.clearErrors()},o.open_=function(e,t){"string"==typeof e&&(e={html:e}),this.useLiveEvents?t.removeClass("loading"):this.$trigger_.removeClass("loading"),e.redirect?window.location=e.redirect:(this.updateContents(e.html,t),this.$dialog_.initialized=!0,this.$dialog_.show())},o.updateContents=function(e,t){this.$dialog_.getCurrentPanel().html(e),this.$form_=this.$element_.find("form"),this.$form_.find(".submit").hide(),this.$originalSubmit_=this.$form_.find("input[type=submit]"),this.$form_.find("input").keypress(this.submitOnEnter.bind(this)),this.$element_.find(".dialog-button-panel").empty(),this.$dialog_.addHeader(this.$form_.attr("title")||this.$form_.attr("data-title")).addButton(this.$originalSubmit_.attr("value")||"Submit",this.submit.bind(this),"aui-button aui-style").addCancel("Cancel",function(e){e.hide()});var n=this.$originalSubmit_.attr("value");this.$submit_=this.$element_.find(".dialog-button-panel").find('button:contains("'+n+'")'),this.$errorContainer_=this.$element_.find(".error-container"),this.onUpdateContents_&&this.onUpdateContents_(this.$dialog_,t)},o.submitOnEnter=function(e){"keypress"===e.type&&13===e.keyCode&&(e.preventDefault(),this.submit())},o.submit=function(){var t=this.$submit_;this.clearErrors(),this.timeout_=setTimeout(function(){t.addClass("loading")},300),t.attr("aria-disabled",!0).addClass("disabled"),this.onSubmit?this.onSubmit(this.$form_):e.ajax({type:this.$form_.attr("method")||"POST",url:this.$form_.attr("action"),data:this.$form_.serialize(),success:this.submit_.bind(this),error:this.error_.bind(this)})},o.complete_=function(){clearTimeout(this.timeout_),this.$dialog_.enable(),this.$submit_.attr("aria-disabled",!1).removeClass("loading disabled");
},o.submit_=function(e){"string"==typeof e&&(e={html:e}),e.success?e.redirect?window.location=e.redirect:this.success&&(this.success(this.$element,e),this.complete?this.complete():this.complete_()):e.html?(this.updateContents(e.html),this.complete?this.complete():this.complete_()):this.success&&(this.success(this.$element,e),this.complete?this.complete():this.complete_())},o.error_=function(e){this.error&&this.error(this.$element,e),this.complete_()},o.close=function(){this.$dialog_.hide()},o.remove=function(){this.$dialog_&&this.$dialog_.remove()},o.displayError=function(e){this.clearErrors(),t.messages.error(this.$errorContainer_,e)},o.clearErrors=function(){this.$errorContainer_.empty()},o}(),r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(187),n(3),n(2),n(145),n(318),n(320),n(314),n(316),n(164),n(327),n(198),n(329),n(147),n(149)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p,f){return e.View.extend({className:"groups-admin",errors_:{400:gettext("A group with that name already exists."),401:gettext("You are not authorized to add a new group."),404:gettext("You user account no longer exists or has been moved.")},groupsView_:null,initialize:function(e){this.isTeam=!!e.isTeam,this.groupsView_=new c.CollectionView({collection:this.collection,view:o,tagName:"ol"});var r=t.user(a);r.invitations(function(e){var t={};i.each(e,function(e){i.each(e.groups,function(n){(t[n]||(t[n]=[])).push(e)})}),this.collection.each(function(e){var r=e.view.$("table.widget.invitations tbody");i.each(i.sortBy(t["{owner.username}/{slug}".format(e.attributes)],function(e){return e.email.toLowerCase()}),function(e){r.append(n(f.toHtml("group-invitation-template",e)))})})}.bind(this)),h("#groups-container > ol > li.group-view","bb:groups:invite",function(t,i){var o=n(this);r.invite(i,o.data("identifier"),function(){for(var e=o.find("table.widget.invitations"),t=e.children(".invitation"),r=0,a=t.length;a>r;r+=1){var s=n(t[r]);if(i.toLowerCase()<s.data("email").toLowerCase())return void s.before(n(f.toHtml("group-invitation-template",{email:i})))}e.append(n(f.toHtml("group-invitation-template",{email:i})))}),p(["atl._trackEvent","Share","Invite To Group - "+(e.isTeam?"Team":"Individual")])}),h('.invitation a[href="#delete"]',"click",function(e){e.preventDefault();var t=n(e.target).closest("tr");r.uninvite(t.data("email"),t.closest("li.group-view").data("identifier"),function(){t.remove()})}),h(".invitation .resend-invitation a","click",function(e){e.preventDefault();var t=n(e.target).closest("tr");r.invite(t.data("email"),t.closest("li.group-view").data("identifier"),function(){n(e.target).closest(".resend-invitation").fadeOut(200,function(){var e=gettext("Invitation sent");n(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">{}</span>'.format(i.escape(e))).fadeIn(200)})})})},addGroup:function(e){this.dialog.$form_.find("div.error").addClass("hidden");var t=e.find(".group-name-input"),i=t.val().trim();if(!i)return t.focus(),void this.showError(gettext("You must provide a group name."));var r={name:i,owner:{username:a,is_team:this.isTeam}};this.collection.create(r,{wait:!0,success:function(e){window.location.hash="#group:"+e.get("slug"),t.val(""),this.dialog.close(),n("#no-groups").hide()}.bind(this),error:this.addGroupError.bind(this)})},addGroupError:function(e,t){this.showError(this.errors_[t.status]||gettext("There was a problem processing your request."))},showError:function(e){var t=this.dialog.$form_.find("div.error");t.removeClass("hidden"),t.find(".message").text(e)},render:function(){var e=this.groupsView_.render().$el;return n("#no-groups").toggle(!e.children().length),e.detach(),this.$el.empty().append(e),this.dialog=new s("#add-group",{id:"add-group",template:"group-form-template",templateData:{isNew:!0},submit:this.addGroup.bind(this)}).bind(),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187),n(1),n(2),n(165),n(317)],r=function(e,t,n,i,r){var o={},a=o.GroupMember=t.Model.extend({idAttribute:"username",group_:null,group:function(){return this.group_},setGroup:function(e){return this.group_=e,this},url:function(){var e,n=this.group();return n?e=n.isMine()?i.toString("groups",n.owner().get("username"),n.get("slug"),"members",this.get("username")):i.toString("group-privileges",n.get("targetUser").username,n.owner().get("username"),n.get("slug"),{"private":!0}):(e=t.Model.prototype.url.call(this),this.isNew()&&(e+=this.get("username"))),e},displayName:function(e){return this.get("display_name")},avatarUrl:function(){return this.get("avatar")||r},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.displayName=this.displayName(),e.avatarUrl=this.avatarUrl(),e}}),s=o.GroupMembers=t.Collection.extend({model:a,group_:null,group:function(){return this.group_},setGroup:function(e){this.group_=e,this.invoke("setGroup",e)},comparator:function(e){return e.displayName().toLowerCase()},url:function(){var e=i.concat("groups",this.group().get("owner").username);return e.toString(this.group().get("slug"),"members")}}),l=o.Repository=t.Model.extend({displayName:function(){return this.get("owner").username+"/"+this.get("slug")}}),u=(o.Repositories=t.Collection.extend({model:l}),o.Group=t.Model.extend({idAttribute:"slug",groupMembers_:null,owner_:null,repositories_:null,initialize:function(e,t){this.parseOwner_(e),this.parseGroupMembers_(e),this.get("owner").is_team&&(this.privilege=new c({group:this,privilege:null}))},parse:function(e){return this.parseGroupMembers_(e),e},parseGroupMembers_:function(e){e.members&&(null===this.groupMembers()&&this.setGroupMembers(new s),this.groupMembers().reset(e.members),delete e.members)},parseOwner_:function(e){this.setOwner(new a(e.owner))},groupMembers:function(){return this.groupMembers_},setGroupMembers:function(e){return this.groupMembers_=e,this.groupMembers_.setGroup(this),this},owner:function(){return this.owner_},setOwner:function(e){return this.owner_=e,this},repositories:function(){return this.repositories_},setRepositories:function(e){return this.repositories_=e,this},displayName:function(){return"{}:{}".format(this.owner().get("username"),this.get("slug"))},isMine:function(){return function(){return this.owner().get("username")===this.get("targetUser").username}}(),toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return this.groupMembers()&&(e.members=this.groupMembers().toJSON()),e.auto_add?e[e.permission]=!0:e.no=!0,e},isLastAccountAdminGroup:function(e){var t=this.collection.accountAdminGroups(e);return 1===t.length&&n.indexOf(t,this)>=0}}));o.Groups=t.Collection.extend({idAttribute:"slug",model:u,initialize:function(e,t){this.targetUser=t.targetUser},url:function(){return i.concat("groups",this.targetUser).toString()},comparator:function(e){return e.displayName().toLowerCase()},accountAdminGroups:function(e){var t=this.filter(function(e){return"admin"===e.privilege.get("privilege")&&e.groupMembers().length});return e?n.filter(t,function(t){return 1===t.groupMembers().filter(function(t){return t.get("username")===e}).length}):t}});var c=(o.Message=t.Model.extend({defaults:{title:null}}),o.GroupAccountPrivilege=t.Model.extend({toJSON:function(){var e={privilege:this.get("privilege")};return e[e.privilege]=!0,e},parse:function(e){return{privilege:e?n.values(e)[0]:null}},url:function(){var e=this.get("group"),t=e.get("owner").username,n=e.get("slug");return i.toString("users",t,"privileges",t,n)},sync:function(e,n,i){"read"!==e&&(e=n.get("privilege")?"update":"delete");var r=i.error;return i.error=function(e,t,n){return 404===e.status?i.success(null,t,e):void r(e)},t.sync.call(this,e,n,i)}}));return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).attr("data-no-avatar-image");return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(319),n(322),n(323),n(320),n(314),n(321),n(293),n(164),n(149)],r=function(e,t,n,i,r,o,a,s,l,u,c){return e.View.extend({tagName:"li",className:"group-view",membersView_:null,privilegeView_:null,forwardEmailView_:null,events:{"click .delete-group":"deleteGroup","change .access":"updatePermission"},initialize:function(){this.membersView_=new r({collection:this.model.groupMembers()}),this.privilegeView_=this.model.privilege?new n({model:this.model.privilege}):null,this.forwardEmailView_=this.model.privilege?new i({model:this.model}):null,this.model.view=this},errors_:{400:gettext("A group with that name already exists."),404:gettext("This group no longer exists.")},deleteGroup:function(e){if(e.preventDefault(),!this.$el.hasClass("waiting")){if(this.model.get("owner").is_team&&u.username!==o&&this.model.isLastAccountAdminGroup(u.username))return void s({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")});if(this.model.get("owner").is_team&&u.username===o&&this.model.isLastAccountAdminGroup())return void s(gettext("You cannot remove the last administrator of this account."));var t=gettext("Are you sure you want to delete the group %(group_name)s?");l({title:gettext("Delete group?"),content:interpolate(t,{group_name:this.model.displayName()},!0)}).done(function(){this.dialog.unbind().remove(),this.model.destroy({wait:!0,error:this.groupError.bind(this)})}.bind(this))}},select:function(e,t){var n=t.auto_add?t.permission:"no",i=this.$(".access ."+n);i.addClass("selected").siblings().removeClass("selected")},groupError:function(e,n){var i=t(n.responseText).find(".errorlist:last li").text();i=i||this.errors_[n.status],s(i||gettext("There was a problem processing your request."))},updatePermission:function(e){var n,i=this.$el.closest("li"),r=t(e.target);if(!r.is(":disabled")){n=setTimeout(function(){i.addClass("loading")},300),r.addClass("waiting").prop({disabled:!0,"aria-disabled":!0});var o=this.model.attributes,a="{owner.username}/{slug}".format(o),s=r.val();"no"===s&&(s=null);var u=function(){r.auiSelect2("val",o.permission||"no")},c=function(e){e?this.model.save({auto_add:!!s,permission:s},{wait:!0,success:this.select.bind(this),error:function(){this.groupError.apply(this,arguments),u()}.bind(this)}):u()}.bind(this),d=function(e){if(clearTimeout(n),i.removeClass("loading"),r.removeClass("waiting").prop({disabled:!1,"aria-disabled":!1}),0===e)c(!0);else{var t=gettext("This will update the group's permissions on %(affected_repos)s of your repositories.");l({title:gettext("Apply permissions to existing repositories?"),content:interpolate(t,{affected_repos:e},!0)}).done(function(){c(!0)}).fail(function(){c(!1)})}};t.ajax({url:"/account/xhr/affected_repositories/{}".format(a),dataType:"json"}).done(function(e){d(e.repo_count)})}},remove:function(){var e=this.$el.slideUp(function(){t("#no-groups").toggle(!e.siblings().length),e.remove()})},editGroupError:function(e,t){var n,i=e.find("div.error");n=t.status?this.errors_[t.status]||gettext("There was a problem processing your request."):t,i.removeClass("hidden"),i.find(".message").text(n)},editGroup:function(e){var t=this.model.get("name"),n=e.find(".group-name-input").val(),i=this.dialog;return n===t?void i.close():n?void this.model.save({name:n},{wait:!0,success:function(){i.unbind().remove()},error:function(t,n){this.editGroupError(e,n)}.bind(this)}):void this.editGroupError(e,gettext("Name is required."))},render:function(){var e=this.$el;return e.attr("id","group:"+this.model.get("slug")).addClass("group-cid-{}".format(this.model.cid)),this.privilegeView_&&(this.privilegeView_.$el.detach(),this.forwardEmailView_.$el.detach()),this.membersView_.$el.detach(),e.html(c.toHtml("group-template",this.model.toJSON())),this.privilegeView_&&(e.find("header").append(this.privilegeView_.render().el),this.privilegeView_.$(".checkbox.admin").after(this.forwardEmailView_.render().el)),e.append(this.membersView_.render().el),e.data("identifier","{owner.username}/{slug}".format(this.model.attributes)),e.find("select").auiSelect2({minimumResultsForSearch:-1}),this.dialog&&this.model.get("slug")===this.dialog.slug?this:(this.dialog=new a("#groups .group-cid-{} .edit-group".format(this.model.cid),{id:"edit-group-"+this.model.get("slug"),useLiveEvents:!0,template:"group-form-template",templateData:{isNew:!1,slug:this.model.get("slug")},submit:this.editGroup.bind(this),onUpdateContents:function(e,t){var n=e.popup.element.find("form"),i=this.model.get("name");n.find(".group-name-input").val(i)}.bind(this)}).bind(),this.dialog.slug=this.model.get("slug"),this)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(320),n(321),n(164),n(149)],r=function(e,t,n,i,r,o){return e.View.extend({className:"group-account-privileges",initialize:function(){this.model.on("change",this.render,this)},events:{"change input":"update"},errors:{403:gettext("You no longer have account admin access.")},render:function(){if(this.$el.children().length)switch(this.model.get("privilege")){case"admin":this.$admin.prop({checked:!0}),this.$collaborator.prop({checked:!0,disabled:!0});break;case"collaborator":this.$admin.prop({checked:!1}),this.$collaborator.prop({checked:!0,disabled:!1});break;default:this.$admin.prop({checked:!1}),this.$collaborator.prop({checked:!1,disabled:!1})}else this.$el.html(o.toHtml("team-privileges-template",this.model.toJSON())),this.$admin=this.$("input[name=admin]"),this.$collaborator=this.$("input[name=collaborator]");return this},update:function(){var e;return e=this.$admin.prop("checked")?"admin":this.$collaborator.prop("checked")?"collaborator":null,"admin"===this.model.get("privilege")&&"admin"!==e&&r.username!==n&&this.model.get("group").isLastAccountAdminGroup(r.username)?(i({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")}),void this.render()):void this.model.save({privilege:e},{wait:!0,error:t.bind(this.error,this,this.model.previousAttributes())})},error:function(e,t,n){i(this.errors[n.status]||gettext("An unexpected error occurred.")),t.set(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e("#groups").attr("data-target-user")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(294)],r=function(e,t){var n={title:"Error"};return function(i){var r,o=new e.Deferred;return r="string"==typeof i?{content:i}:i,t(e.extend(n,r),o).show(),o.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(149),n(321)],r=function(e,t,n,i){return e.View.extend({initialize:function(){this.model.privilege.on("change",this.toggleForwardEmails,this)},events:{"change input":"updateForwardEmails"},render:function(){var e=this.model.toJSON();return e.admin="admin"===this.model.privilege.get("privilege"),this.$el.html(n.toHtml("forward-emails-template",e)),this},updateForwardEmails:function(){this.model.save({email_forwarding_disabled:!this.$el.find("input").is(":checked")},{wait:!0,error:t.bind(this.error,this,this.model.previousAttributes())})},toggleForwardEmails:function(){var e="admin"===this.model.privilege.get("privilege");this.$el.find(".forward-emails").toggleClass("hidden",!e)},error:function(e,t,n){i(this.errors[n.status]||gettext("An unexpected error occurred.")),t.set(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(2),n(326),n(324),n(327),n(149),n(328),n(164)],r=function(e,t,n,i,r,o,a,s,l,u){return t.View.extend({className:"group-members",errors_:{404:gettext("The requested user does not exist."),409:gettext("The user is already in the group."),402:gettext("You are already at your plan limit and must upgrade before adding more users.")},events:{"submit form":"addMember"},collectionView_:null,initialize:function(){this.collectionView_=new a.CollectionView({collection:this.collection,view:r,tagName:"tbody"})},addMember:function(e){e.preventDefault();var t=this.$("input.username"),n=t.val().trim();return n?(this.toggleSpinner(),void this.collection.create({username:n},{wait:!0,success:i.bind(this.addMemberSuccess,this),error:i.bind(this.addMemberError,this)})):void t.focus()},addMemberSuccess:function(){this.toggleSpinner(),this.clearError(),this.$("input.username").val("").blur().focus()},clearError:function(){this.$el.find(".error-bar .aui-message").closeMessage()},addMemberError:function(t,i){if(this.clearError(),404===i.status&&l.email(t.get("username")))this.addMemberSuccess(),this.$el.trigger("bb:groups:invite",[t.get("username")]);else{if(this.toggleSpinner(),this.$("input.username").blur().focus(),402===i.status){var r=n.parseJSON(i.responseText).data;r.extra_users=r.users_required-r.plan_users,r.owner=u.username===r.user.username,o(this.$("button.add-button"),{data:r})}e.messages.error(this.$el.find(".error-bar"),{body:this.errors_[i.status]||i.responseText})}},toggleSpinner:function(){this.$("input.username").toggleClass("loading")},render:function(){return this.collectionView_.el.parentNode?this.collectionView_.render():this.$el.html(s.toHtml("group-members-template",this.collectionView_.collection.group().toJSON())).find("table.widget.users thead").after(this.collectionView_.render().el),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(325),n(312),n(147),n(149)],r=function(e,t,n,i,r,o,a){return function(n,s){function l(e,n,i){e.html(a.toHtml("upgrade-dialog-template",c));var o=e.find(".upgrade-button");o.on("mousedown",function(){r("upgrade_dialog_button_clicked",{user:c.user.username})}),o.on("click",function(e){e.preventDefault();var n=o.loading(t.ajax({type:"POST",url:o.attr("data-upgrade-url"),dataType:"json"}));n.done(function(e){e.href&&(window.location.href=e.href)})}),i&&i()}s=s||{};var u,c=s.data||{};u=e.InlineDialog(n,"upgrade-dialog",l,{closeOthers:!1,hideCallback:function(){t(u).remove()},initCallback:function(){},cacheContent:!1,hideDelay:null,noBind:!0,calculatePositions:s.calculatePositions||i.alignRight()}),u.show(),o(["atl._trackEvent","Account","Upgrade Dialog","Shown"]),t(u).on("click","a",function(){o(["atl._trackEvent","Account","Upgrade Dialog","Clicked"])}),r("upgrade_dialog_shown",{user:c.user.username})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3)],r=function(e,t){function n(t){return function(n,i,r,o){var a=e.InlineDialog.opts.calculatePositions(n,i,r,o),s=i.target,l=s.offset(),u=n.outerWidth(),c=s.outerWidth(),d=l.left+c/2;return a.popupCss.right="auto",a.popupCss.left=t(s,l,u,c,o),a.arrowCss.right="auto",a.arrowCss.left=d-a.popupCss.left-8,a}}var i=34,r=14;return{alignCenter:function(){return n(function(e,t,n,i,r){return t.left+i/2-n/2+r.offsetX})},alignRight:function(){return n(function(e,t,n,i,r){return t.left+i-n+r.offsetX})},alignLeft:function(){return n(function(e,t,n,i,r){return t.left+r.offsetX})},alignTo:function(e){return n(e)},arrowOffsetY:function(e){return e()},sidebarArrowOffsetY:function(e){return-1*(e.height()/2)+r},sidebarOffsetY:function(e,t,n,o){var a=t.target.height()/2,s=e.height()/2,l=1.5*r;return s+l-a-i}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(321),n(316),n(164),n(149)],r=function(e,t,n,i,r,o){return t.View.extend({model:i.GroupMember,tagName:"tr",className:"group-member",errors_:{401:gettext("You must be logged in to remove a member."),403:gettext("You are not authorized to remove this member.")},events:{'click a[href="#delete"]':"removeMember"},removeMember:function(e){e.preventDefault();var t=this.model.collection.group();if(this.model.get("username")===r.username){if(t.get("owner").is_team&&t.isLastAccountAdminGroup(r.username))return void n({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")})}else if(1===this.model.collection.length&&t.get("owner").is_team&&t.isLastAccountAdminGroup())return void n(gettext("You cannot remove the last administrator of this account."));this.toggleSpinner(),this.model.destroy({error:this.removeMemberError.bind(this),wait:!0})},render:function(){return this.$el.html(o.toHtml("group-member-template",this.model.toJSON())),this},remove:function(){this.$el.slideUp(function(){this.$el.remove()}.bind(this)),this.toggleSpinner()},removeMemberError:function(t,n){this.toggleSpinner();var i=this.errors_[n.status],r=this.$el.closest(".group-members").find(".error-bar");e.messages.error(r,{body:i||gettext("There was a problem processing your request.")})},toggleSpinner:function(){this.$('a[href="#delete"]').toggleClass("loading")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3)],r=function(e,t){var n={};return n.CollectionView=e.View.extend({view:null,views_:null,initialize:function(e){e.view&&(this.view=e.view),this.init_(),this.collection.on("add",this.add_,this),this.collection.on("remove",this.remove_,this),this.collection.on("reset",this.refresh_,this)},init_:function(){var e=this;this.views_={},this.collection.each(function(t){var n=e.views_[t.cid]=new e.view({model:t});t.on("change",n.render,n)})},add_:function(e,t,n){var i=this.views_[e.cid]=new this.view({model:e});this.collection.comparator?this.render():this.$el.append(i.render().el)},remove_:function(e,t,n){var i=this.views_[e.cid];i&&(i.remove(),delete this.views_[e.cid])},refresh_:function(){this.init_(),this.render()},render:function(){var e=this,t=this.$el;return t.children().detach(),this.collection.each(function(n){t.append(e.views_[n.cid].render().el)}),this}}),n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[],r=function(){return{email:function(e){return/^[^@\s]+@[^.@\s]+(\.[^.@\s]+)+$/.test(e)},url:function(e){return/^[^.@\s]+(\.[^.@\s]+)+$/.test(e)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(t,n,i){return e(function(){e(document.body).on(n,t,i)}),function(){e(document.body).off(n,t,i)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(145),n(324),n(212),n(149),n(236)],r=function(e,t,n,i,r,o,a){return n(function(n){function r(t){return e.ajax({url:y,type:"POST",data:{username:t}})}function s(t){return e.ajax({url:b.format(t),type:"PUT"})}function l(e,t){return function(n){var i,r;if("user"===e?(i=n,i.avatar=n.links.avatar.href,r="group-member-template"):(i={email:t},r="group-invite-template"),"email"===e)g.append(o.toHtml(r,i));else{var a=g.find("[data-email]");a.length?a.before(o.toHtml(r,i)):g.append(o.toHtml(r,i))}v.val(""),g.find(".empty").addClass("hidden"),m.empty()}}function u(e){m.empty(),t.messages.error(m,{title:JSON.parse(e.responseText).error.message,closeable:!1})}function c(t){t.preventDefault();var n=e(this),i=n.closest("tr"),r=i.attr("data-username");n.loading(e.ajax({url:w.format(r),type:"DELETE"})).done(function(){h(i)}).fail(u)}function d(t){t.preventDefault();var n=e(this),i=n.closest("tr"),r=i.attr("data-email");n.loading(e.ajax({url:b.format(r),type:"DELETE"})).done(function(){h(i)})}function h(e){m.empty(),e.remove();var t=!!g.find(".iterable-item").length,n=g.find(".empty");n.toggleClass("hidden",t)}function p(n){n.preventDefault();var i=e(this),r=i.closest("tr"),o=r.attr("data-email");s(o).done(function(){t.messages.success({body:gettext("Your invitation has been re-sent"),fadeout:!0})})}var f=e("#add-member-form"),m=e("#member-error"),g=f.find("tbody"),v=e("#group-add-member"),y=f.attr("data-group-url"),b=f.attr("data-invite-url"),w=f.attr("data-remove-member-url");n.on("pjax:complete",function(){f=e("#add-member-form"),m=e("#member-error"),g=f.find("tbody"),v=e("#group-add-member")}),n.on("submit",f,function(t){t.preventDefault();var n=v.val();n.trim()&&r(n).done(l("user")).fail(function(t){if(404===t.status&&a.email.test(n))s(n).done(l("email",n)).fail(u);else if(402===t.status){var r=e.parseJSON(t.responseText).data;r.owner=!0,i(f.find(".add-button"),{data:r})}else u(t)})}),n.on("click",".remove-member",c).on("click",".remove-email",d).on("click","[href=#resend]",p)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(145),n(293),n(309)],r=function(e,t,n,i,r){return n(function(){function n(e){e.find("#group-name").val(a.attr("data-name")),e.find(".error").addClass("hidden"),e.find("#group-access").find('option[value="{}"]'.format(a.attr("data-team-access"))).prop("selected",!0).change(),e.find("#default-access").find('option[value="{}"]'.format(a.attr("data-repo-access"))).prop("selected",!0).change(),e.find("#group-emails").prop("checked","True"!==a.attr("data-emails"))}function o(){s.loading(e.ajax({url:s.attr("data-url-delete"),type:"DELETE"})).done(function(){window.location.href=e("#group-heading").find("a").attr("href")}).fail(function(){t.messages.error({body:gettext("There was an error deleting this group")})})}var a=e("#group-data"),s=e("#delete-button");r({$trigger:e("#edit-button"),id:"edit-group-dialog",header:gettext("Edit group"),beforeDialogShow:n,saveOptions:function(e){return{url:e.attr("data-update-url"),type:"PUT"}}}),s.on("click",function(){i({content:gettext("Are you sure you want to delete this group?"),title:gettext("Delete group?"),buttonText:gettext("Delete")}).done(o)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145)],r=function(e,t,n){return n(function(n){n.on("click",function(){var i=n.data("import-url");n.addClass("loading"),t.ajax({url:i,dataType:"json"}).done(function(t){if(n.removeClass("loading"),t.length>0){var i=ngettext("%(key_count)d key imported from GitHub","%(key_count)d keys imported from GitHub",t.length);e.messages.success({body:interpolate(i,{key_count:t.length},!0),fadeout:!0}),setTimeout(function(){window.location.reload(!0)},500)}else e.messages.error({body:gettext("Import failed. Are your keys already associated with another Bitbucket account?")})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145)],r=function(e){return e(function(){var e={"#custom-domain":"/account/cnames/","#email-addresses":"/account/email/","#plans-and-billing":"/account/plans-and-billing/","#ssh-keys":"/account/ssh-keys/"},t=e[window.location.hash];t&&window.location.replace(t)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(183),n(147)],r=function(e,t,n,i,r,o){return n(function(e){function n(e){var t=d.data("languages");return i.indexOf(t,l.val())<0}function a(t){!h&&e.data("banner-referrer")&&(o(["atl._trackEvent","i18n","Language field referrer","banner"]),h=!0)}var s=e.closest("form"),l=t("#id_language_code"),u=t("#translate-progress-content"),c=null,d=t("#help-translate-message");l.on("change",function(){d.is(":visible")?n(l.val())||d.slideUp():n(l.val())&&d.slideDown()});var h=!1;l.on("change",function(){a(),c=t.get(u.attr("data-stats-url"))}),d.on("click",".translate-link",a);var p=l.val();s.on("submit",function(e){if(l.val()!==p){var t=p+" -> "+l.val();o(["atl._trackEvent","i18n","Save language change",t])}});var f=!1,m=new r({width:450,height:"auto",id:"translate-progress-dialog"});m.addPanel("main").addHeader("This translation is incomplete").addButton("Save settings",function(){f=!0,s.submit()},"aui-button aui-button-primary").addCancel("Cancel",function(e){e.hide()}),m.getCurrentPanel().body.append(u.show()),s.on("submit",function(e){var i=l.val();if(i!==p&&n(i)&&!f){e.preventDefault();var r=s.find("button[type=submit]"),o=setTimeout(function(){r.addClass("loading").attr("aria-disabled",!0).attr("disabled",!0)},400);c.done(function(e){clearTimeout(o),r.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");var n=e[i]||0;t("#translate-progress-content").find("span.language").text(l.find(":selected").text()).end().find("span.percent").text(n).end().find(".progress").css("width",n+"%"),m.show()})}}),e.on("click",".translate-link",function(e){var n=t(e.target).attr("data-type");o(["atl._trackEvent","i18n","Translate",n])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(145),n(2),n(183),n(165),n(293),n(149)],r=function(e,t,n,i,r,o,a,s,l){function u(e,t){var n=u.dialog;return n?n.getCurrentPanel().html(t):(n=u.dialog=new o({width:800,height:550,id:"bb-manage-watched-items-dialog"}),n.addPanel("main",t),n.addLink("Close",function(){n.hide()})),n.addHeader(e),d(t),n}function c(e){var t="manage-watched-items-content",i=n(e.target).closest("a"),r=n('<div class="maskable has-mask"></div>').attr("id",t),o=u(i.attr("title"),r),a=o.popup.element.find("#"+t);n.support.pjax&&(n(document).one("pjax:beforeSend","#"+t,function(){o.show()}).one("pjax:complete","#"+t,function(){a.removeClass("has-mask")}),n.pjax.click(e,{url:n(this).attr("href"),push:!1,container:a,timeout:3e4}))}function d(t){var i=n("#account-notifications");t.on("click","a.unwatch-all",function(r){t.addClass("has-mask"),r.preventDefault();var o=n(r.target),a=o.attr("href"),s=t.find("#watched-items").attr("data-type");t.find("#watched-items").attr("data-name");n.ajax({url:a,type:"DELETE",dataType:"json"}).done(function(){e.messages.info({body:g[s],fadeout:!0}),t.find("table tbody tr a.follow").each(function(){n(this).trigger("toggle-follow",{isNowFollowing:!1})}),i.trigger("watched-items:clear",{type:s})}).complete(function(){t.removeClass("has-mask")})});var r={pullrequest:"pullrequests",repo:"repositories",issue:"issues",snippet:"snippets"};t.on("follow:repo follow:pullrequest follow:issue follow:snippet","a.follow",function(e,t){var o=n(e.target).attr("data-type");t?i.trigger("watched-items:increment",{type:r[o]}):i.trigger("watched-items:decrement",{type:r[o]})})}var h={},p=h.EmailPreference=t.Model.extend({idAttribute:"key"}),f=h.EmailPreferences=t.Collection.extend({model:p,initialize:function(e,t){this.prefsApi=t.prefsApi},url:function(){return this.prefsApi.toString()},findByKey:function(e){return this.find(function(t){return t.attributes.key===e})}});h.ui={};var m=h.ui.EmailPreferencesView=t.View.extend({events:{"click input.checkbox":"updatePreferences","click #toggle-email":"toggleEmail"},togglePreference:function(t,n){var i=this.collection.findByKey(t);i?(n&&n(!1),i.destroy({success:function(){e.messages.success({body:gettext("Email preferences updated."),fadeout:!0})},error:function(t){e.messages.error({body:gettext("Email preferences failed to update.")}),this.collection.add(t),n&&n(!0)}.bind(this)})):(i=new p({key:t,value:!0}),this.collection.add(i),n&&n(!0),i.save({},{success:function(){e.messages.success({body:gettext("Email preferences updated."),fadeout:!0})},error:function(){e.messages.error({body:gettext("Email preferences failed to update.")}),this.collection.remove(i),n&&n(!1)}.bind(this)}))},updatePreferences:function(e){var t=n(e.target),i=n(e.target).attr("name");this.togglePreference(i,function(e){e?t.attr("checked","checked"):t.removeAttr("checked")})},toggleEmail:function(e){function t(e){var t=n(l.toHtml("toggle-email-template",{email_enabled:e}));i.toggleClass("disabled",!e),r.replaceWith(t)}e.preventDefault();var i=this.$el.find("form.email-notifications"),r=n("#toggle-email-container"),o=function(){this.togglePreference("enabled",t)}.bind(this);i.hasClass("disabled")?o(!0):s({title:"Okay, we'll be quiet",isSafeContent:!0,content:l.toHtml("disable-email-confirmation-template")}).done(o)}}),g={repositories:gettext("All repositories unwatched."),pullrequests:gettext("All pull requests unwatched."),issues:gettext("All issues unwatched."),snippets:gettext("All snippets unwatched.")};return i(function(){function e(e){return t.find(".type."+e+" .watched-count")}var t=n("#account-notifications"),i=t.find("form.email-notifications"),o={enabled:!i.hasClass("disabled"),mentions:i.find("#id_mentions").is(":checked"),direct_messages:i.find("#id_direct_messages").is(":checked"),access_changes:i.find("#id_access_changes").is(":checked"),bb_updates:i.find("#id_bb_updates").is(":checked")},s=[];r.map(o,function(e,t){e&&s.push(new p({key:t,value:e}))});var l=new f(s,{prefsApi:a.concat("user","emailpreferences",t.attr("data-target-user"))
});new m({el:t[0],collection:l}),i.find("div.description").each(function(e,t){var i=n(t);i.tooltip({title:function(){return i.text()}})}),t.find("a.manage-watched-items").on("click",c),t.bind("watched-items:clear",function(n,i){var r=i.type;e(r).text("0"),t.find(".type."+r+" + .actions a").hide()}),t.bind("watched-items:increment",function(n,i){var r=i.type,o=e(r),a=parseInt(o.text(),10);o.text(++a),a&&t.find(".type."+r+" + .actions a").show()}),t.bind("watched-items:decrement",function(n,i){var r=i.type,o=e(r),a=parseInt(o.text(),10);o.text(--a),a||t.find(".type."+r+" + .actions a").hide()});var u=n("#watched-pull-requests, #watched-issues, #watched-repositories, #watched-snippets");d(u.find(".maskable"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187),n(3),n(145),n(2),n(149)],r=function(e,t,n,i,r){return n(function(){function n(e){if(!e.find("tbody tr").length){var n=t('<tr class="empty"><td colspan="2">You have no consumers configured.</td><td></td></tr>');e.find("tbody").append(n)}}var o=t("#oauth-consumers"),a=o.find("table.widget"),s=o.attr("data-target-user"),l=e.user(s);i.each(o.data("consumers"),function(e){var n=t(r.toHtml("oauth-consumer-template",e)).data(e);a.append(n)}),a.find("tr.loading").remove(),n(a),t(".consumer").on("click",'a[href="#delete"]',function(e){var i=t(this).closest(".consumer").attr("data-consumer"),r=t("#"+i);l.delete_consumer(r.data("id"),{success:function(){r.next().remove(),r.remove(),n(a)}})}),a.on("click","tr a.name",function(e){e.preventDefault(),t(this).closest("tr").toggleClass("revealed"),t(this).children(".expander").toggleClass("aui-iconfont-collapsed").toggleClass("aui-iconfont-expanded")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(187),n(3),n(145),n(2),n(293),n(316),n(338),n(164),n(339),n(165),n(327),n(149),n(215)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p){return r(function(){function r(e,t){var n={},i={},r={},a="{owner.username}:{slug}".format();o.each(t.data("groups"),function(t){t.owner={username:w.username},e.push({group:t})}),o.each(e,function(e){var t=e.group,o=i[a(t)]||function(){return t.targetUser=w,(i[a(t)]=new s.Group(t)).setRepositories(new s.Repositories)}();o.repositories().add(r[e.repo]||new s.Repository(e.repository)),o.groupMembers().each(function(e){if(e.get("username")!==w.username){e.setGroup(o);var t=n[e.get("username")];t||(t=n[e.get("username")]=new l.UserGroupMemberships,t.setUser(e).setMemberships(new l.GroupMemberships)),t.memberships().any(function(t){return a(t.group().attributes)===a(e.group().attributes)})||t.memberships().add(e)}})});var u=new l.AllUsersGroupMemberships;return u.reset(o.values(n)),u}function f(){var e=parseInt(E.text(),10);E.text(e-1)}l.ui={};var m=l.ui.GroupMembershipView=t.View.extend({model:s.GroupMember,tagName:"li",render:function(){return this.$el.html(p.toHtml("account-group-membership-template",this.model.group())),this}}),g=l.ui.UserGroupMembershipsView=t.View.extend({model:l.UserGroupMemberships,tagName:"tr",userView_:null,events:{'click a[href="#delete"]':"deleteAll"},initialize:function(){this.collectionView_=new h.CollectionView({view:m,collection:this.model.memberships(),tagName:"ol",className:"children"})},deleteAll:function(e){e.preventDefault();var t=this.collectionView_.collection,n=function(){var e=t.first();e?e.destroy({wait:!0,success:n}):_()},i=gettext("This will remove %(display_name)s from any groups on your account. In addition, if %(display_name)s is a member of any groups not under your account, those groups will no longer be able to access your private repositories. Do you wish to continue?");a({content:interpolate(i,{display_name:this.model.user().displayName()},!0),buttonText:gettext("Remove"),title:gettext("Remove access?")}).done(n)},render:function(){var e=this.$el,t=this.model.user().get("username");return e.addClass("data-username user").data("username",t).append(i(p.toHtml("account-access-group-template",this.model.toJSON()))),t===u.username&&e.find('a[href="#delete"]').remove(),e.data("groups",this.model.memberships()),this}}),v=l.ui.AccessViaGroupsView=t.View.extend({userGroupViews_:null,el:"#access-via-groups table",initialize:function(){this.userGroupViews_=new h.CollectionView({collection:this.collection,view:g,tagName:"tbody"})},render:function(){this.$("tbody").remove(),this.$el.append(this.userGroupViews_.render().el);var t=function(e,t,r){var o=i(t).closest("tr"),a=new h.CollectionView({view:m,collection:o.data("groups"),tagName:"ol"});e.empty(),e.append(i(a.render().el)),n.refresh(),r&&r()},n=e.InlineDialog('#access-via-groups a[href="#groups"]',"access-groups",t,{useLiveEvents:!0});return this}}),y=i("#plans-and-billing"),b=y.data(),w={username:y.attr("data-target-username"),avatarUrl:b.targetAvatar,isTeam:b.targetIsTeam,displayName:y.attr("data-target-display-name")},x=i("#access-via-groups");if(x.length){var _=function(){var e=d.toString("group-privileges",w.username,{"private":!0});return function(){i.get(e,function(e){new v({collection:r(e,x)}).render()}),x.trigger("bb:account:updatecount")}}();_()}var k=i("#direct-access");if(k.length){var C=k.data("users");o.each(C,function(e){e.displayName=e.display_name}),C=o.sortBy(C,function(e){return e.displayName.toLowerCase()});var $=k.find("table.widget tbody");$.empty();var S=i(p.toHtml("direct-access-user-template",o.extend({},w,{avatar:c.avatar(w.avatarUrl,32)})));S.removeClass("data-username"),S.find("a").remove(),w.isTeam||S.appendTo($),o.each(C,function(e){$.append(i(p.toHtml("direct-access-user-template",o.extend({},e,{avatar:c.avatar(e.avatar,32)}))))});var T=function(e){var t=i("<ol>");return o.each(o.keys(e),function(e){t.append(i(p.toHtml("direct-access-repo-template",{repo:e})))}),t},D=function(e,t,r){var a=i(t),s=a.closest("tr");if(!a.hasClass("loading"))if(e.empty(),s.data("repos"))e.append(T(s.data("repos"))),P.refresh(),r&&r();else{a.addClass("loading");var l=s.data("username"),u=n.user(w.username);u.privileges(n.flags.access.direct,function(t){var n=o.reduce(t,function(e,t,n){var i=t[l];return i&&(e[n]=i),e},{});a.removeClass("loading"),s.data("repos",n),e.append(T(n)),P.refresh(),r&&r()})}},P=e.InlineDialog('#direct-access a[href="#repos"]',"direct-access",D,{useLiveEvents:!0});k.delegate('a[href="#delete"]',"click",function(e){e.preventDefault();var t=i(this),n=t.closest("tr"),r=t.data("confirm-msg")||"Are you sure?";a({title:gettext("Remove access?"),content:r,buttonText:gettext("Remove")}).done(function(){i.ajax({url:d.toString("privileges",w.username,{"private":!0,username:n.data("username")}),type:"DELETE",dataType:"json",success:function(){k.trigger("bb:account:updatecount"),n.slideUp(function(){n.remove()})}})})})}var E=i(".plan-count");k.on("bb:account:updatecount",f),x.on("bb:account:updatecount",f)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(164),n(316)],r=function(e,t,n){var i={},r=(i.GroupMemberships=e.Collection.extend({model:n.GroupMember,url:function(){},comparator:function(e){return e.group().displayName().toLowerCase()}}),i.UserGroupMemberships=e.Model.extend({user_:null,memberships_:null,user:function(){return this.user_},setUser:function(e){return this.user_=e,this},memberships:function(){return this.memberships_},setMemberships:function(e){return this.memberships_=e,this},sync:function(e,t,n){n.success()},toJSON:function(){var e=this.user().toJSON();return e.groupsCount=this.memberships().length,e}}));i.AllUsersGroupMemberships=e.Collection.extend({model:r,comparator:function(e){var n=e.user_;return[n.get("username")===t.username?0:1,n.displayName().toLowerCase()]}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(306),n(165)],r=function(e,t,n,i){function r(e){return"function"!=typeof e?e:{error:function(){alert("An unexpected error occurred.")},success:e}}var o={};return o.avatar=function(e,t){return e.endsWith(/\/default_(team_)?avatar\/([0-9]+)\/(team_|user_)blue[.]png/)?e.replace(/[0-9]+(?=\/(team_|user_)blue[.]png$)/,t):e.replace(/\bs=\d+$/,"s="+t)},o.groupPrivileges=function(n,o){n=r(n);var a=n.success;e.ajax(t.extend(n,{url:i.toString("group-privileges",o),dataType:"json",success:function(e,n,i){var r={};t.each(e,function(e){var t="{owner.username}/{slug}".format(e.group);r[t]||(r[t]={read:[],write:[],admin:[]}),r[t][e.privilege].push(e.repo)}),a(r,n,i)}}))},o.displayName=function(e){return e.display_name},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(304),n(149)],r=function(e,t,n,i,r){return n(function(n){var o=n.attr("data-target-username"),a=e.dialog2("#plans-dialog"),s=n.attr("data-access-url").replace("[[targetUser]]",o),l=t("#user-access-content");n.on("click",".view-access button",function(){var e=t(this);e.loading(t.ajax({type:"GET",url:s,data:{user:e.attr("data-user")}})).done(function(e){e.title=interpolate(gettext("User access for %(user)s"),{user:e.user.display_name},!0),e.hasRepos=!!e.repos.length,e.hasGroups=!!e.groups.length,l.html(r.toHtml("plan-access-template",e)),a.show()})}),t("#close-button").on("click",function(){a.hide()}),i(n,{$pjaxContainer:t("#members-pjax")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(342),n(334)],r=function(e,t,n){return t(function(){var t=e("#change-avatar"),i=e("img.avatar, .aui-avatar-inner img"),r=e(".avatar-container"),o=t.data("submitUrl"),a=t.data("isAtlassianId"),s=t.data("textTitle"),l=t.data("textDelete");new n({analyticsType:"Account",avatars:i,endpointUrl:o,dialogTitle:s,isAtlassianId:a,showDelete:t.hasClass("has-avatar"),templateOptions:{deleteText:l,maskClass:"avatar256"},trigger:t,uploadIndicator:r})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(145),n(343),n(357),n(147),n(212)],r=function(e,t,n,i,r,o){function a(n,i,a,l,u,c){var d="POST"===c.type,h=["atl._trackEvent","Avatar",i],p=function(e){u.attr("src",e.avatarUrl)};t.extend(c,{contentType:"text/plain; charset=UTF-8",dataType:"json"}),n?r.loginStatus().done(function(n,i){t.extend(c,{headers:{"X-CSRF-TOKEN":i},xhrFields:{withCredentials:!0}}),l.loading(e.ajax(c),s).done(p)}):l.loading(e.ajax(c),s).done(p),a.toggleClass("has-avatar",d),h.push(d?"Upload":"Delete"),o(h)}var s={spin:{color:"#fff",shadow:!0,radius:12,length:10,lines:10}};return function(e){e.isAtlassianId&&r.loginStatus().fail(function(){}),new i(t.extend({onDelete:function(){a(e.isAtlassianId,e.analyticsType,e.trigger,e.uploadIndicator,e.avatars,{type:"DELETE",url:e.endpointUrl})},onCrop:function(t){a(e.isAtlassianId,e.analyticsType,e.trigger,e.uploadIndicator,e.avatars,{data:t,type:"POST",url:e.endpointUrl})}},e))}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(2),n(344),n(183),n(149)],r=function(e,t,n,i,r,o){function a(e){if(!a.isSupported())throw new Error("This browser doesn't support AvatarPickerDialog.");return this.init(e)}return a.isSupported=function(){return i.isSupported()},a.prototype.defaults={dialogTitle:gettext("Upload an avatar"),dialogOptions:{width:384,height:610,id:"avatar-picker-dialog",closeOnOutsideClick:!1},templateOptions:{description:gettext("JPG, GIF or PNG image"),deleteText:gettext("Delete avatar")},onCrop:e.noop,onDelete:e.noop,showDelete:!1,trigger:null},a.prototype.init=function(t){n.bindAll(this,"_onImageUpload","_onImageUploadError","_toggleDoneButtonEnabled","chooseAvatar","hide","initDialogContent","show");var o=e.extend(!0,{},this.defaults.templateOptions,t.templateOptions);return this.options=e.extend(!0,{},this.defaults,t,o),this.$dialog=new r(this.options.dialogOptions),this.initDialogContent(),this._toggleDoneButtonEnabled(!1),this.imageUploadAndCrop=new i(this.$dialog.getCurrentPanel().body.find(".image-upload-and-crop-container"),{HiDPIMultiplier:1,onCrop:this.options.onCrop,onImageUpload:this._onImageUpload,onImageUploadError:this._onImageUploadError}),this.options.trigger&&(this.$trigger=e(this.options.trigger),this.$trigger.click(n.bind(function(e){e.preventDefault(),this.show()},this))),this},a.prototype.initDialogContent=function(){this.$dialog.addHeader(this.options.dialogTitle).addPanel().addLink(this.options.templateOptions.deleteText,function(){this.hide(),this.options.onDelete()}.bind(this),this.options.showDelete?"delete-link left":"hidden").addSubmit("Done",this.chooseAvatar).addCancel("Cancel",this.hide).getCurrentPanel().body.append(o.toHtml("avatar-upload-template",this.options.templateOptions)),this.$doneButton=this.$dialog.getCurrentPanel().page.buttonpanel.find(".button-panel-submit-button"),this.$cancelButton=this.$dialog.getCurrentPanel().page.buttonpanel.find(".button-panel-cancel-link")},a.prototype._onImageUpload=function(){this._toggleDoneButtonEnabled(!0)},a.prototype._onImageUploadError=function(){this._toggleDoneButtonEnabled(!1)},a.prototype._toggleDoneButtonEnabled=function(e){null===e&&(e=null!==this.$doneButton.attr("disabled")),e?this.$doneButton.removeAttr("disabled"):this.$doneButton.attr("disabled","disabled")},a.prototype.chooseAvatar=function(){this.imageUploadAndCrop.crop(),this.hide()},a.prototype.hide=function(){this.$dialog.hide(),this.imageUploadAndCrop.resetState()},a.prototype.show=function(){this.$dialog.show()},a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(346),n(351),n(345),n(353),n(354),n(355),n(356)],r=function(e,t,n,i,r,o,a,s,l,u){function c(e,t){if(!c.isSupported())throw new Error("This browser doesn't support ImageUploadAndCrop.");this.init.apply(this,arguments)}return c.isSupported=function(){return l.isSupported()},c.prototype.defaults={HiDPIMultiplier:2,dragDropUploadPrompt:gettext("Drag and drop image here"),onImageUpload:t.noop,onImageUploadError:t.noop,onCrop:t.noop,outputFormat:"image/png",fallbackUploadOptions:{},initialScaleMode:i.scaleModes.containAndFill,scaleMax:1,fileSizeLimit:5242880,maxImageDimension:2048},c.prototype.init=function(e,u){if(this.options=t.extend({},this.defaults,u),this.$container=e,n.bindAll(this,"crop","resetState","_onFileProcessed","setImageSrc","validateImageResolution","_onFilesError","_onFileError","_resetFileUploadField","_onErrorReset"),this.imageExplorer=new i(this.$container.find(".image-explorer-container"),{initialScaleMode:this.options.initialScaleMode,scaleMax:this.options.scaleMax,onErrorReset:this._onErrorReset}),r.isSupported())this.clientFileReader=new r({onRead:this._onFileProcessed,onError:this._onFilesError,fileTypeFilter:r.typeFilters.imageWeb,fileCountLimit:1,fileSizeLimit:this.options.fileSizeLimit}),this.dragDropFileTarget=new o(this.imageExplorer.get$ImageView(),{uploadPrompt:this.options.dragDropUploadPrompt,clientFileHandler:this.clientFileReader});else{this.$container.addClass("filereader-unsupported");var c=t.extend({onUpload:this._onFileProcessed,onError:this._onFileError},this.options.fallbackUploadOptions);this.clientFileReader=new a(c)}this.uploadIntercepter=new s(this.$container.find(".image-upload-field"),{replacementEl:this.$container.find(".image-upload-field-replacement"),clientFileHandler:this.clientFileReader});var d=this.imageExplorer.get$Mask();this.canvasCroppper=new l(d.width()*this.options.HiDPIMultiplier,d.height()*this.options.HiDPIMultiplier,{outputFormat:this.options.outputFormat}),this.options.cropButton&&t(this.options.cropButton).click(this.crop)},c.prototype.crop=function(){var e=this.imageExplorer.getMaskedImageProperties(),t=this.canvasCroppper.cropToDataURI(this.imageExplorer.get$SourceImage()[0],e.maskedAreaImageX,e.maskedAreaImageY,e.maskedAreaWidth,e.maskedAreaHeight);n.isFunction(this.options.onCrop)&&this.options.onCrop(t)},c.prototype.resetState=function(){this.imageExplorer.clearError(),this._resetFileUploadField()},c.prototype._onFileProcessed=function(e){if(e)if(isNaN(this.options.maxImageDimension))this.setImageSrc(e);else{var t=this.validateImageResolution(e);t.done(n.bind(function(t,n){this.setImageSrc(e)},this)).fail(n.bind(function(e,t){var n=gettext("The selected image size is %(image_width)spx * %(image_height)spx. The maximum allowed image size is %(max_dimension)spx * %(max_dimension)spx.");this._onFileError(interpolate(n,{image_width:e,image_height:t,max_dimension:this.options.maxImageDimension},!0))},this))}else this._onFileError()},c.prototype.setImageSrc=function(e){this.imageExplorer.setImageSrc(e),n.isFunction(this.options.onImageUpload)&&this.options.onImageUpload(e),this._resetFileUploadField()},c.prototype.validateImageResolution=function(e){var n=new t.Deferred,i=new Image,r=this;return i.onload=function(){this.naturalWidth>r.options.maxImageDimension||this.naturalHeight>r.options.maxImageDimension?n.reject(this.naturalWidth,this.naturalHeight):n.resolve(this.naturalWidth,this.naturalHeight)},i.src=e,n},c.prototype._onFilesError=function(t){if(t&&t.bySize&&t.bySize.length){var i=n.first(t.bySize),r=gettext('File "%(filename)s" is %(file_size)s which is larger than the maximum allowed size of %(size_limit)s');this._onFileError(e.escapeHtml(interpolate(r,{filename:u.abbreviateText(i.name,50),file_size:u.formatSizeInBytes(i.size),size_limit:u.formatSizeInBytes(this.options.fileSizeLimit)},!0)))}else this._onFileError()},c.prototype._onFileError=function(e){var t=gettext("There was an error uploading your image"),i=e||gettext("Please check that your file is a valid image and try again.");this.imageExplorer.showError(t,i),this._resetFileUploadField(),n.isFunction(this.options.onImageUploadError)&&this.options.onImageUploadError(e)},c.prototype._resetFileUploadField=function(){var e=this.$container.find("#image-upload-and-crop-upload-field").prop("form");e&&e.reset()},c.prototype._onErrorReset=function(e){e&&n.isFunction(this.options.onImageUpload)&&this.options.onImageUpload(e)},c}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(e,t){return this.init.apply(this,arguments)}return n.prototype.getDefaults=function(){return{activeDropTargetClass:"active-drop-target",uploadPrompt:gettext("Drag a file here to upload"),clientFileHandler:null}},n.prototype.init=function(n,i){t.bindAll(this,"onDragOver","onDragEnd","onDrop"),this.$target=e(n),this.options=e.extend({},this.getDefaults(),i),this.$target.attr("data-upload-prompt",this.options.uploadPrompt),this.$target.on("dragover",this.onDragOver),this.$target.on("dragleave",this.onDragEnd),this.$target.on("dragend",this.onDragEnd),this.$target.on("drop",this.onDrop)},n.prototype.onDragOver=function(e){e.preventDefault(),this.$target.addClass(this.options.activeDropTargetClass)},n.prototype.onDragEnd=function(e){e.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass)},n.prototype.onDrop=function(e){e.preventDefault(),e.originalEvent.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass),this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(e.originalEvent.dataTransfer.files,e.originalEvent.target)},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(149),n(222),n(347)],r=function(e,t,n,i,r){function o(e,t){this.init.apply(this,arguments)}return o.scaleModes={fill:"fill",contain:"contain",containAndFill:"containAndFill"},o.zoomModes={localZoom:"localZoom",imageZoom:"imageZoom"},o.prototype.defaults={initialScaleMode:o.scaleModes.containAndFill,zoomMode:o.zoomModes.localZoom,emptyClass:"empty",scaleMax:1},o.prototype.init=function(e,i){this.$container=e,this.$imageView=this.$container.find(".image-explorer-image-view"),this.$sourceImage=this.$container.find(".image-explorer-source"),this.$mask=this.$container.find(".image-explorer-mask"),this.$dragDelegate=this.$container.find(".image-explorer-drag-delegate"),this.$scaleSlider=this.$container.find(".image-explorer-scale-slider"),this.options=t.extend({},this.defaults,i),this.imageProperties={},n.bindAll(this,"getImageSrc","setImageSrc","initImage","initDragDelegate","initScaleSlider","setInitialScale","getFillScale","getContainedScale","getCircularContainedScale","sliderValToScale","scaleToSliderVal","updateImageScale","resetImagePosition","resetScaleSlider","toggleEmpty","get$ImageView","get$SourceImage","get$Mask","get$DragDelegate","getMaskedImageProperties","showError","clearError","hasValidImage","_resetFromError","_removeError"),this.toggleEmpty(!0),this.$sourceImage[0].naturalWidth&&(this.toggleEmpty(!1),this.initImage({target:this.$sourceImage[0]})),this.$sourceImage.on("load",this.initImage),this.initDragDelegate(),this.initScaleSlider()},o.prototype.getImageSrc=function(){return this.$sourceImage?this.$sourceImage.attr("src"):void 0},o.prototype.setImageSrc=function(e){this.$sourceImage&&this.$sourceImage.attr("src","").attr("src",e)},o.prototype.initImage=function(e){var t=e.target;this.imageProperties.naturalWidth=t.naturalWidth,this.imageProperties.naturalHeight=t.naturalHeight,this._removeError(),this.toggleEmpty(!1),this.setInitialScale()},o.prototype.initDragDelegate=function(){var e;this.$dragDelegate.draggable({start:n.bind(function(){e=this.$sourceImage.offset()},this),drag:n.bind(function(t,n){this.$sourceImage.offset({top:e.top+n.position.top-n.originalPosition.top,left:e.left+n.position.left-n.originalPosition.left})},this),revert:!0,revertDuration:0})},o.prototype.initScaleSlider=function(){this.$scaleSlider.on("change",n.bind(function(e){this.updateImageScale(this.sliderValToScale(e.target.value))},this))},o.prototype.setInitialScale=function(){var e=this.$mask.width(),t=this.$mask.height(),n=this.imageProperties.naturalWidth,i=this.imageProperties.naturalHeight,r=1;switch(this.minScale=1,this.options.initialScaleMode){case o.scaleModes.fill:this.minScale=r=this.getFillScale(n,i,e,t);break;case o.scaleModes.contain:this.$mask.hasClass("circle-mask")?this.minScale=r=this.getCircularContainedScale(n,i,e/2):this.minScale=r=this.getContainedScale(n,i,e,t);break;case o.scaleModes.containAndFill:this.$mask.hasClass("circle-mask")?this.minScale=this.getCircularContainedScale(n,i,e/2):this.minScale=this.getContainedScale(n,i,e,t),r=this.getFillScale(n,i,e,t)}this.maxScale=Math.max(r,this.options.scaleMax),this.resetScaleSlider(this.scaleToSliderVal(r)),this.updateImageScale(r,o.zoomModes.imageZoom),this.resetImagePosition()},o.prototype.getFillScale=function(e,t,n,i){var r=n/e,o=i/t;return Math.max(r,o)},o.prototype.getContainedScale=function(e,t,n,i){var r=n/e,o=i/t;return Math.min(r,o)},o.prototype.getCircularContainedScale=function(e,t,n){var i=Math.atan(t/e),r=Math.cos(i)*n*2;return r/e},o.prototype.sliderValToScale=function(e){var t=e/(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"));return this.minScale+t*(this.maxScale-this.minScale)},o.prototype.scaleToSliderVal=function(e){var t=(e-this.minScale)/(this.maxScale-this.minScale);return t*(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"))},o.prototype.updateImageScale=function(e,t){var n,i,r=Math.round(e*this.imageProperties.naturalWidth),a=Math.round(e*this.imageProperties.naturalHeight);switch(t=t||this.options.zoomMode){case o.zoomModes.imageZoom:n=-1*r/2,i=-1*a/2;break;case o.zoomModes.localZoom:var s=this.$sourceImage.width(),l=this.$sourceImage.height(),u=parseInt(this.$sourceImage.css("margin-left"),10),c=parseInt(this.$sourceImage.css("margin-top"),10),d=this.$sourceImage.position(),h=this.$imageView.width()/2,p=this.$imageView.height()/2,f=h-d.left-u,m=p-d.top-c,g=f/s*r,v=m/l*a;n=h-d.left-g,i=p-d.top-v}this.$sourceImage.width(r).height(a).css({"margin-left":Math.round(n)+"px","margin-top":Math.round(i)+"px"})},o.prototype.resetImagePosition=function(){this.$sourceImage.css({top:"50%",left:"50%"})},o.prototype.resetScaleSlider=function(e){this.$scaleSlider.val(e).removeClass("disabled").removeAttr("disabled"),r.updateSlider(this.$scaleSlider.attr("id"))},o.prototype.toggleEmpty=function(e){this.$container.toggleClass(this.options.emptyClass,e)},o.prototype.get$ImageView=function(){return this.$imageView},o.prototype.get$SourceImage=function(){return this.$sourceImage},o.prototype.get$Mask=function(){return this.$mask},o.prototype.get$DragDelegate=function(){return this.$dragDelegate},o.prototype.getMaskedImageProperties=function(){var e=this.$sourceImage.width()/this.imageProperties.naturalWidth,t=this.$sourceImage.height()/this.imageProperties.naturalHeight,n=this.$mask.position(),i=this.$sourceImage.position();return n.top+=parseInt(this.$mask.css("margin-top"),10),n.left+=parseInt(this.$mask.css("margin-left"),10),i.top+=parseInt(this.$sourceImage.css("margin-top"),10),i.left+=parseInt(this.$sourceImage.css("margin-left"),10),{maskedAreaImageX:Math.round((n.left-i.left)/e),maskedAreaImageY:Math.round((n.top-i.top)/t),maskedAreaWidth:Math.round(this.$mask.width()/e),maskedAreaHeight:Math.round(this.$mask.height()/t)}},o.prototype.showError=function(n,r){this._removeError(),this.toggleEmpty(!0),this.$container.addClass("error");var o=t(i.toHtml("avatar-error-template",{title:n,contents:r}));o.appendTo(this.$imageView).css({"margin-top":-1*o.outerHeight()/2}),o.on("messageClose",this._resetFromError),e.messages.setup()},o.prototype.clearError=function(){this._removeError(),this._resetFromError()},o.prototype.hasValidImage=function(){return!(!this.getImageSrc()||!this.$sourceImage.prop("naturalWidth"))},o.prototype._resetFromError=function(){var e=this.hasValidImage();this.toggleEmpty(!e),this.$container.removeClass("error"),n.isFunction(this.options.onErrorReset)&&this.options.onErrorReset(e?this.getImageSrc():void 0)},o.prototype._removeError=function(){this.$imageView.find(".aui-message.error").remove()},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){n(348);/*!
	 * jQuery UI Draggable 1.10.4
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/draggable/
	 *
	 * Depends:
	 *	jquery.ui.core.js
	 *	jquery.ui.mouse.js
	 *	jquery.ui.widget.js
	 */
!function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),i=n[0],void(i&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var n,i,r,o,a=this.options,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,u=t.pageY;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(u=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(u=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,u=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),r=i.options,o=e.extend({},n,{item:i.element});i.sortables=[],e(r.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,o))})},stop:function(t,n){var i=e(this).data("ui-draggable"),r=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,n){var i=e(this).data("ui-draggable"),r=this;e.each(i.sortables,function(){var o=!1,a=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,r=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,r,o,a,s,l,u,c,d,h,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=n.offset.left,v=g+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(d=p.snapElements.length-1;d>=0;d--)s=p.snapElements[d].left,l=s+p.snapElements[d].width,u=p.snapElements[d].top,c=u+p.snapElements[d].height,s-m>v||g>l+m||u-m>b||y>c+m||!e.contains(p.snapElements[d].item.ownerDocument,p.snapElements[d].item)?(p.snapElements[d].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(i=Math.abs(u-b)<=m,r=Math.abs(c-y)<=m,o=Math.abs(s-v)<=m,a=Math.abs(l-g)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:s-p.helperProportions.width}).left-p.margins.left),a&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),h=i||r||o||a,"outer"!==f.snapMode&&(i=Math.abs(u-y)<=m,r=Math.abs(c-b)<=m,o=Math.abs(s-g)<=m,a=Math.abs(l-v)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:s}).left-p.margins.left),a&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[d].snapping&&(i||r||o||a||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=i||r||o||a||h)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery)},function(e,t,n){n(349);/*!
	 * jQuery UI Mouse 1.10.4
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/mouse/
	 *
	 * Depends:
	 *	jquery.ui.widget.js
	 */
!function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,r=1===t.which,o="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return r&&!o&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery)},function(e,t,n){n(350);/*!
	 * jQuery UI Widget 1.10.4
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/jQuery.widget/
	 */
!function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}r(t)},e.widget=function(t,n,i){var r,o,a,s,l={},u=t.split(".")[0];t=t.split(".")[1],r=u+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[u]=e[u]||{},o=e[u][t],a=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:u,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(n){for(var r,o,a=i.call(arguments,1),s=0,l=a.length;l>s;s++)for(r in a[s])o=a[s][r],a[s].hasOwnProperty(r)&&o!==t&&(e.isPlainObject(o)?n[r]=e.isPlainObject(n[r])?e.widget.extend({},n[r],o):e.widget.extend({},o):n[r]=o);return n},e.widget.bridge=function(n,r){var o=r.prototype.widgetFullName||n;e.fn[n]=function(a){var s="string"==typeof a,l=i.call(arguments,1),u=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,s?this.each(function(){var i,r=e.data(this,o);return r?e.isFunction(r[a])&&"_"!==a.charAt(0)?(i=r[a].apply(r,l),i!==r&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new r(a,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,o,a,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},r=n.split("."),n=r.shift(),r.length){for(o=s[n]=e.widget.extend({},this.options[n]),a=0;a<r.length-1;a++)o[r[a]]=o[r[a]]||{},o=o[r[a]];if(n=r.pop(),1===arguments.length)return o[n]===t?null:o[n];o[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,a){function s(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?r.delegate(c,u,s):n.bind(u,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var a,s=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(jQuery)},function(e,t){/*!
	 * jQuery UI Core 1.10.4
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/category/ui-core/
	 */
!function(e,t){function n(t,n){var r,o,a,s=t.nodeName.toLowerCase();return"area"===s?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(a=e("img[usemap=#"+o+"]")[0],!!a&&i(a)):!1):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,r,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function r(t,n,i,r){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?s["inner"+i].call(this):this.each(function(){e(this).css(a,r(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(a,r(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n){var i,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0?!0:(t[i]=1,r=t[i]>0,t[i]=0,r)}})}(jQuery)},function(e,t,n){var i,r;i=[n(3),n(2),n(352)],r=function(e,t,n){function i(e){if(!i.isSupported())throw new Error("ClientFileReader requires FileReaderAPI support");return this.init(e)}var r=!!(window.File&&window.FileList&&window.FileReader),o={ArrayBuffer:"readAsArrayBuffer",BinaryString:"readAsBinaryString",DataURL:"readAsDataURL",Text:"readAsText"};return i.isSupported=function(){return r},e.extend(i.prototype,n.prototype),i.readMethods={ArrayBuffer:"ArrayBuffer",BinaryString:"BinaryString",DataURL:"DataURL",Text:"Text"},i.typeFilters=n.typeFilters,i.prototype.defaults=e.extend({},n.prototype.defaults,{readMethod:i.readMethods.DataURL,onRead:e.noop}),i.prototype.init=function(e){return t.bindAll(this,"onSuccess","readFile"),n.prototype.init.call(this,e),this.options.onSuccess=this.onSuccess,this},i.prototype.onSuccess=function(e){var n=t.has(o,this.options.readMethod)?o[this.options.readMethod]:void 0;n&&t.each(e,t.bind(function(e){var i=new FileReader;i.onload=t.bind(this.readFile,this,e),i[n](e)},this))},i.prototype.readFile=function(e,n){t.isFunction(this.options.onRead)&&this.options.onRead(n.target.result,e)},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(e){return this.init(e)}return n.typeFilters={all:/.*/,application:/^application\/.*/,audio:/^audio\/.*/,image:/^image\/.*/,imageWeb:/^image\/(jpeg|png|gif)$/,text:/^text\/.*/,video:/^video\/.*/},n.prototype.defaults={fileTypeFilter:n.typeFilters.all,fileCountLimit:1/0,fileSizeLimit:20971520,onSuccess:e.noop,onError:e.noop},n.prototype.init=function(n){return this.options=e.extend({},this.defaults,n),n&&!n.fileSizeLimit&&(this.options.fileSizeLimit=this.defaults.fileSizeLimit),n&&!n.fileCountLimit&&(this.options.fileCountLimit=this.defaults.fileCountLimit),t.bindAll(this,"handleFiles","filterFiles"),this},n.prototype.handleFiles=function(e,n){var i=this.filterFiles(e);i.valid.length>0?t.isFunction(this.options.onSuccess)&&this.options.onSuccess(i.valid):t.isFunction(this.options.onError)&&this.options.onError(i.invalid)},n.prototype.filterFiles=function(e){var n=t.isRegExp(this.options.fileTypeFilter)?this.options.fileTypeFilter:this.defaults.fileTypeFilter,i=this.options.fileSizeLimit,r={byType:[],bySize:[],byCount:[]},o=t.filter(e,function(e){return n.test(e.type)?e.size>i?(r.bySize.push(e),!1):!0:(r.byType.push(e),!1)});return o.length>this.options.fileCountLimit&&(r.byCount=o.slice(this.options.fileCountLimit),o=o.slice(0,this.options.fileCountLimit)),{valid:o,invalid:r}},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(352)],r=function(e,t,n){function i(e){return this.init(e)}return e.extend(i.prototype,n.prototype),i.prototype.defaults=e.extend({},n.prototype.defaults,{uploadURL:"",uploadFieldName:"file",onUpload:e.noop,responseHandler:function(t,n){var i;try{i=JSON.parse(e(t).html())}catch(r){n.reject()}i?n.resolve(i):n.reject()}}),i.prototype.states={IN_PROGRESS:"IN_PROGRESS",IDLE:"IDLE"},i.prototype.init=function(n){return t.bindAll(this,"createHiddenIframe","onIframeLoad","handleFiles","setStateInProgress","setStateIdle","cancelUpload"),this.options=e.extend({},this.defaults,n),this.$uploadIframe=this.createHiddenIframe(),this.options.cancelTrigger&&(this.$cancelTrigger=e(this.options.cancelTrigger),this.$cancelTrigger.click(t.bind(function(){this.cancelUpload()},this))),this.state=this.states.IDLE,this},i.prototype.createHiddenIframe=function(){return e("<iframe>").attr("name","hidden-upload-iframe").hide().appendTo(document.body).on("load",this.onIframeLoad)},i.prototype.onIframeLoad=function(e){this.state===this.states.IN_PROGRESS&&(this.requestPromise.done(this.options.onUpload).fail(this.options.onError),this.options.responseHandler(e.target.contentDocument.body,this.requestPromise))},i.prototype.handleFiles=function(n,i){if(this.state===this.states.IN_PROGRESS&&this.cancelUpload(),!this.$fileSourceElem){this.$fileSourceElem=e(i),this.$fileSourceElem.attr("name",this.options.uploadFieldName),this.$fileSourceElem.prop("form")||this.$fileSourceElem.wrap("<form>");var r=e(this.$fileSourceElem.prop("form"));r.addClass("hidden-upload-form").attr("action",this.options.uploadURL).attr("method","post").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data").attr("target",this.$uploadIframe.attr("name")),this.$spinner=e('<div class="spinner"></div>').insertBefore(this.$fileSourceElem),e.isPlainObject(this.options.extraData)&&t.each(this.options.extraData,function(t,n){e('<input type="hidden">').attr("name",n).val(t).appendTo(r)})}this.$fileSourceElem.prop("form").submit(),this.requestPromise=new e.Deferred,this.requestPromise.always(this.setStateIdle),this.setStateInProgress()},i.prototype.setStateInProgress=function(){this.state=this.states.IN_PROGRESS,this.$spinner&&this.$spinner.spin(),this.$fileSourceElem&&this.$fileSourceElem.attr("disabled","disabled")},i.prototype.setStateIdle=function(){this.state=this.states.IDLE,this.$spinner&&this.$spinner.spinStop(),this.$fileSourceElem&&this.$fileSourceElem.removeAttr("disabled"),this.requestPromise=null},i.prototype.cancelUpload=function(){this.$uploadIframe.remove(),this.setStateIdle(),this.$uploadIframe=this.createHiddenIframe()},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(180)],r=function(e,t,n){function i(e,t){return this.init.apply(this,arguments)}return i.prototype.defaults={replacementEl:void 0,clientFileHandler:null},i.prototype.init=function(i,r){t.bindAll(this,"onSelectFile","onReplacementClick"),this.$el=e(i),this.options=e.extend({},this.defaults,r),this.$el.on("change",this.onSelectFile),this.options.replacementEl&&(this.$replacement=e(this.options.replacementEl),this.$el.hide(),"Explorer"===n.browser?this.$replacement.is("label")||(this.$replacement.hide(),this.$el.show()):this.$replacement.on("click",this.onReplacementClick))},i.prototype.onSelectFile=function(t){e(t.target).val()&&this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(t.target.files,this.$el)},i.prototype.onReplacementClick=function(e){e.preventDefault(),this.$el.click()},i.prototype.destroy=function(){this.$el.off("change",this.onSelectFile),this.$replacement.off("click",this.onReplacementClick)},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(e,n){if(!t.isSupported())throw new Error("This browser doesn't support CanvasCropper.");return this.init.apply(this,arguments)}var n=function(){var e=document.createElement("canvas");return"function"==typeof e.getContext&&e.getContext("2d")}();return t.isSupported=function(){return n},t.prototype.defaults={outputFormat:"image/png",backgroundFillColor:void 0},t.prototype.init=function(t,n,i){return this.width=t,this.height=n||t,this.options=e.extend({},this.defaults,i),this.canvas=e("<canvas/>").attr("width",this.width).attr("height",this.height)[0],this},t.prototype.cropToDataURI=function(e,t,n,i,r){return this.crop(e,t,n,i,r).getDataURI(this.options.outputFormat)},t.prototype.crop=function(e,t,n,i,r){var o=this.canvas.getContext("2d"),a=0,s=0,l=this.width,u=this.height;if(o.clearRect(a,s,l,u),this.options.backgroundFillColor&&(o.fillStyle=this.options.backgroundFillColor,o.fillRect(a,s,l,u)),0>t&&(a=Math.round(Math.abs(t)/i*l),t=0),0>n&&(s=Math.round(Math.abs(n)/r*u),n=0),t+i>e.naturalWidth){var c=e.naturalWidth-t;l*=c/i,i=c}if(n+r>e.naturalHeight){var d=e.naturalHeight-n;u*=d/r,r=d}return o.drawImage(e,t,n,i,r,a,s,l,u),this},t.prototype.getDataURI=function(e){return e?this.canvas.toDataURL(e):null},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){var n=3==="a1a".split(/(\d)/).length;return{toSentenceCase:function(e){return e+="",e?e.charAt(0).toUpperCase()+e.substring(1):""},camelCaseToHyphenated:function(e){return"string"!=typeof e?void 0:e.replace(/([^\s\-_])(?=[A-Z])/g,"$1-").replace(/\s/,"-").toLowerCase()},indent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,r="string"==typeof n?n:" ";return"string"!=typeof e?void 0:0>i?e:new Array(i+1).join(r)+e},unindent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,r="string"==typeof n?n:" ";if("string"!=typeof e)return void 0;if(0>i)return e;for(;e.charAt(0)===r&&i;)e=e.substring(1),i--;return e},formatSizeInBytes:function(e){var t=[" bytes","KB","MB","GB","TB","PB"],n=1024,i=0,r=t.length-1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))return"";for(;e>=n&&r>i;)e/=n,i++;return e=Math.floor(10*e)/10,e+t[i]},abbreviateText:function(e,t,n){if("string"!=typeof e)return void 0;if(isNaN(t)||0>t||e.length<=t)return e;var i="string"==typeof n?n:"",r=e.length-t+i.length,o=Math.round(e.length/2);return e.substring(0,o-Math.ceil(r/2))+i+e.substring(o+Math.floor(r/2),e.length)},convertBranchNameToSentence:function(e){if(!e||"string"!=typeof e)return"";if(!n)return e;var i=/([A-Z]{1,10}-\d+)/,r=t.map(e.split(i),function(e,t){return t%2===0?e.replace(/[\-_]/g," "):e});return this.toSentenceCase(r.join(""))},pluralize:function(e,t,n){return 1!==t?void 0!==n?n:e+"s":e}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(){r=e.ajax({type:"GET",url:i.loginStatusUrl,xhrFields:{withCredentials:!0}}),o=new e.Deferred,r.done(function(e,t,n){if(200===n.status){var i=n.getResponseHeader("X-CSRF-TOKEN");o.resolve(e,i)}else o.reject()}).fail(function(e,t,n){o.reject()})}var i=e(document.body).data("atlassianId")||{},r=null,o=null;return t.extend(i,{loginStatus:function(){return null===r&&n(),o.promise()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187),n(3),n(145),n(359)],r=function(e,t,n,i){return n(function(n){var r=n.attr("data-target-user"),o=e.user(r),a=t("#edit-ssh-key");i(n,{onEdit:function(e,t){o.update_ssh_key(a.find("#ssh_pk").val(),e,t)},onCreate:function(e,t){o.add_ssh_key(e,t)},onDelete:function(e,t){o.remove_ssh_key(e,t)}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(321),n(360),n(180),n(212)],r=function(e,t,n,i){return function(r,o){var a=o.onEdit,s=o.onCreate,l=o.onDelete,u=e("#edit-ssh-key"),c=e("#new-ssh-key"),d=r.find("table.widget"),h=n("bb-edit-ssh-key-dialog",u,a);e(".edit-link").click(function(t){t.preventDefault();var n=e(t.target).closest(".ssh-key").data();h.updateForm(n),h.show()});var p=n("bb-new-ssh-key-dialog",c,s);p.updateForm(),e("#add-key").click(function(){p.show()}),r.on("click",'a[href="#delete"]',function(n){n.preventDefault();var i=e(this).closest("tr"),r=i.data().pk,o=i.find("td.actions a[href=#delete]").loading();l(r,{success:function(){o.resolve(),i.remove(),d.find("tbody tr").length||d.find("tbody").html("<tr><td>There are no keys configured</td><td></td><td></td></tr>")},error:function(){o.reject(),t("There was an error communicating with the server, please try again.")}})}),e(".ssh-key-copy-help."+i.os.toLowerCase()).show()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(183),n(361)],r=function(e,t,n,i){var r=function(t,r,o){function a(){document.location.reload()}function s(t){var n=this,r=i(t.responseText);e.each(r,function(t,i){var r=n.find('[name="'+t+'"]');if(0!==r.length){var o=e("<div>").text(i).addClass("error");r.after(o)}}),n.find("button:submit").attr("aria-disabled",!1).removeClass("disabled")}function l(){var e=r.closest(".aui-popup");e.find(".error").remove();var t={key:e.find("#id_key").val(),label:e.find("#id_label").val()};e.find("button:submit").attr("aria-disabled",!0).addClass("disabled"),o(t,{error:s.bind(e),success:a})}var u,c=r.find("button:submit"),d=r.find("h1"),h=new n({width:800,height:"auto",id:t});return h.addPanel("main"),u=h.getCurrentPanel().body,u.append(r),h.addHeader(d.text()).addButton(c.text(),l,"aui-button aui-style").addCancel("Cancel",function(e){e.hide()}),r.submit(function(e){e.preventDefault(),l()}),r.removeClass("hidden"),d.remove(),{show:function(){u.find(".error").remove(),h.show()},hide:function(){h.hide()},updateForm:function(e){e?(u.find("#ssh_pk").val(e.pk),u.find("#id_label").val(e.label),u.find("#id_key").attr("disabled","disabled").val(e.key),u.find("#id_key_group .description").show()):(u.find("#ssh_pk").val(""),u.find("#id_label").val(""),u.find("#id_key").removeAttr("disabled").val(""),u.find("#id_key_group .description").hide())}}};return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){return function(n){return t.reduce(e(n).children(),function(t,n){var i=e(n).children().remove().text();return t[e(n).text().trim()]=i,t},{})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(2),n(149),n(363),n(364),n(215)],r=function(e,t,n,i,r,o){function a(e,t){return e.displayName>t.displayName?1:e.displayName<t.displayName?-1:0}function s(e,t){return e.sortOrder!==t.sortOrder?t.sortOrder-e.sortOrder:a(e,t)}function l(e,i){return function(r,o){var a=r.trim().toUpperCase(),s=new t.Deferred,l=e();return l?(l in f?s.resolve(f[l]):t.ajax({type:"GET",cache:!1,dataType:"json",url:i,data:{country:l}}).done(function(e){f[l]=e.stateNames,s.resolve(e.stateNames)}),void s.done(function(e){return e.length?o.passWhen(n(e).contains(a),gettext("Invalid state")):o.pass()})):o.pass()}}function u(e){return function(t,n){if("US"!==e())return n.pass();var i=/^\d{5}$/;n.passWhen(i.test(t),gettext("Invalid ZIP code"))}}function c(e,n){var i=e(),r=new t.Deferred,o=t("#billing-tax-fields"),a=o.find("input"),s=o.find("label");i in m?r.resolve(m[i]):t.ajax({type:"GET",dataType:"json",url:n.format(i)}).done(function(e){m[i]=e,r.resolve(e)}),r.done(function(e){return s.text(e.taxIdLabel),"Tax"===e.displayName?(a.val(""),o.addClass("hidden")):void o.removeClass("hidden")})}function d(e,n,i,o,a){function s(){return d}var d,h=new r(e,p),f=new r(n,p);return h.addValidation(l(s,i)),f.addValidation(u(s)),h.onValidate(a),f.onValidate(a),function(e){d=t(e.currentTarget).val(),h.validate(),f.validate(),c(s,o)}}var h="cc-error",p=new o({errorClass:h}),f={},m={};return e(function(){function e(){var e=o.hasClass(h),t=!!r.val(),i=!!a.val(),s=a.find(":selected"),c=!!s.data("requiresStates"),d=!c||!!l.val(),p=!!s.data("requiresPostcode"),f=!p||!!u.val(),m=!e&&t&&i&&d&&f;n.trigger("billing-validation",{type:"address",isValid:m})}var n=t(".billing-form"),r=t("#billing-orgname"),o=t(".billing-address").find("input"),a=t("#billing-country"),l=t("#billing-state"),u=t("#billing-postcode"),p=a.attr("data-country-url"),f=a.attr("data-country-tax-url"),m=t.ajax({method:"get",dataType:"json",url:p});o.on("blur input",e),a.disable(!1),a.auiSelect2({placeholder:gettext("Select a country")}),m.done(function(t){var n=a.attr("data-initial-value");t.sort(s).forEach(function(e){e.displayName===n&&(n=e.countryIsoCode),a.append(i.toHtml("address-country-template",e))});var r=d(l,u,p,f,e);a.on("change",r),n&&(a.auiSelect2("val",n),c(function(){return n},f),r({currentTarget:a}),e())})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(t,n){var i=new e.Deferred;return t(n,{pass:function(){i.resolve()},fail:function(e){i.reject(e)},passWhen:function(e,t){e?i.resolve():i.reject(t)}}),i}function i(){return{onValid:function(){},onInvalid:function(){},onClear:function(){}}}function r(o,a){var s=[],l=function(){};if(!o||!o.length)throw new Error("Validated field constructor only accepts non-empty jQuery objects.");this.$field=o,this.decorator=a||i(),this.validateAsync=function(t,i){var r=this.$field.val();if(r||t)return this.decorator.onLoading(this.$field),e.when.apply(null,s.map(function(e){return n(e,r)})).then(function(){i||(this.markValid(),l(!0))}.bind(this),function(e){i||(this.markInvalid(e),l(!1))}.bind(this));this.clearStyle(),l(!0);var o=e.Deferred();return o.resolve(),o.promise()}.bind(this),this.validate=function(e,t,n){return this.validateAsync(t,n),this}.bind(this),this.debouncedValidate=t.debounce(this.validate.bind(this),r.DEBOUNCE_MS),this.addValidation=function(e){return s.push(e),this},this.onValidate=function(e){return l=e.bind(this),this},this.$field.on("input.validated-field change.validated-field",this.debouncedValidate.bind(this))}return r.prototype.markValid=function(){this.decorator.onValid(this.$field)},r.prototype.markInvalid=function(e){this.decorator.onInvalid(this.$field,e)},r.prototype.clearStyle=function(){this.decorator.onClear(this.$field)},r.DEBOUNCE_MS=250,r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(t){this.options=e.extend({errorClass:"aui-error",loadingClass:"loading"},t||{})}return t.prototype.getErrorElement=function(t){var n=t.next(".error");return n.length||(n=e("<div>").addClass("error").insertAfter(t)),n},t.prototype.onValid=function(e){this.onClear(e)},t.prototype.onInvalid=function(e,t){e.removeClass(this.options.loadingClass),e.addClass(this.options.errorClass),this.getErrorElement(e).removeClass("hidden").text(t)},t.prototype.onClear=function(e){e.removeClass(this.options.errorClass),e.removeClass(this.options.loadingClass),this.getErrorElement(e).addClass("hidden").text("")},t.prototype.onLoading=function(e){this.onClear(e),e.addClass(this.options.loadingClass)},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(2),n(366),n(363),n(364)],r=function(e,t,n,i,r,o){function a(e){var t=/^\d{3,}[Xx]{4,}\d{4}$/;return t.test(e)}function s(e,t){var n=/^\d+$/.test(e);return a(e)?t.pass():void t.passWhen(n,gettext("Numbers only"))}function l(e,t){var o=new r(e,d),l=gettext("Invalid card number");o.addValidation(s),o.addValidation(function(e,t){var r=i.getType(e);if(!r)return t.fail(l);var o=r.length;t.passWhen(n.contains(o,e.length),l)}),o.addValidation(function(e,t){if(a(e))return t.pass();var n=i.luhnCheck(e);t.passWhen(n,l)}),o.onValidate(t),o.validate()}function u(e,t,n){var i=new Date,o=new r(t,d);o.addValidation(s),o.addValidation(function(t,n){var r=parseInt(t,10),o=e.val(),a=parseInt(o,10);if(t.length<3&&(r+=2e3),!a||!r||1>a||a>12)return n.fail(gettext("Invalid date"));var s=r>i.getFullYear(),l=r===i.getFullYear()&&a>i.getMonth();n.passWhen(s||l,gettext("Card is expired"))}),e.on("blur",o.validate),o.onValidate(n),o.validate()}var c="cc-error",d=new o({errorClass:c});return e(function(){function e(){var e=[r,o,a,s],t=n.any(e,function(e){return""===e.val()||e.hasClass(c)});i.trigger("billing-validation",{type:"creditCard",isValid:!t})}var i=t(".billing-form"),r=t(".cc-number"),o=t(".cc-exp-month"),a=t(".cc-exp-year"),s=t(".cc-name");l(r,e),u(o,a,e),s.on("input",e)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){function t(t){return e.find(i,function(e){return t.match(e.iin)})}function n(e){for(var t=e.length,n=0,i=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],r=0;t--;)r+=i[n][parseInt(e.charAt(t),10)],n^=1;return r%10===0&&r>0}var i=[{type:"VISA",iin:/^4/,length:[13,16]},{type:"MASTERCARD",iin:/^5[0-5]/,length:[16]},{type:"AMEX",iin:/^(34|37)/,length:[15]}];return{types:i,luhnCheck:n,getType:t}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(368),n(369),n(215),n(212)],r=function(e,t,n,i){return e(function(){var e,r=t(".billing-form"),o=r.find(".error.aui-message"),a=r.attr("data-next-url");t(document).on("paymentDetailsLoaded",function(t,s){var l=r.attr("data-check-task-url").format(s.payload);"process"===s.action?n(l).done(function(){e.resolve(),r.data("isUpgrade")?i.addMessage(gettext("Your billing details have been updated"),"success"):i.addMessage(gettext("Your plan has been changed"),"success"),window.location.href=a}).fail(function(e){i.addMessage(e,"error"),window.location.reload(!0)}):"error"===s.action?(o.find(".error-text").text(s.payload),o.removeClass("hidden"),e.reject()):"reload"===s.action&&window.location.reload(!0)});var s=r.find("[type=submit]"),l={creditCard:!1,address:!1};r.on("billing-validation",function(e,t){l[t.type]=t.isValid,s.disable(!l.creditCard||!l.address)}),s.on("click",function(){e=new t.Deferred,s.loading(e)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=function(n,i){return i=i||new e.Deferred,e.ajax({type:"GET",url:n,dataType:"json",cache:!1}).done(function(e){e.error?i.reject(e.error,e):e.complete?i.resolve(e.url,e):(i.notify(e),setTimeout(function(){t(n,i)},1e3))}).fail(function(){i.reject("An unexpected error occurred.")}),i.done(function(e,t){e&&setTimeout(function(){window.location=e},0)}),i.promise()};return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){var e="bb-messages",t="|";return{addMessage:function(n,i){sessionStorage&&(i=i||"success",n=n+t+i,sessionStorage.setItem(e,n))},getMessage:function(){var n=null;if(sessionStorage){var i=sessionStorage.getItem(e);if(sessionStorage.removeItem(e),i){var r=i.split(t);n={body:r[0],type:r[1]}}}return n}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(145),n(306),n(371),n(372)],r=function(e,t,n,i,r,o,a){return i(function(){function e(e){return e.trim().replace(/[^\w\s\./-]/g,"").replace(/\/\/+/g,"/").replace(/\/$/g,"").replace(/^\//g,"").replace(/\s+/g,"-")}function i(){var t=p.val().trim(),n=e(f.val());t?(m.find(".branch-lozenge.source").removeClass("hidden").find(".name").text(t),n?(m.removeClass("disabled").find(".branch-lozenge.target").removeClass("hidden").find(".name").text(n),g.removeAttr("disabled aria-disabled")):(m.addClass("disabled"),m.find(".branch-lozenge.target").addClass("hidden"),g.attr({disabled:!0,"aria-disabled":!0}))):(m.addClass("disabled").find(".branch-lozenge").addClass("hidden"),g.attr({disabled:!0,"aria-disabled":!0}))}function s(e){var n=t(e.target),i=n.find("option:selected").text(),r="/!api/1.0/repositories/{0}/branches-tags".format(i);p.empty().append(t("<option>Loading&hellip;</option>").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change"),t.getJSON(r).success(function(e){var n=e.branches.sort(o);p.empty();for(var i=0,r=n.length;r>i;i++)p.append(t("<option></option>").text(n[i].name).val(n[i].name));n.length?p.prop({disabled:!1,"aria-disabled":!1}).trigger("change").auiSelect2("enable",!0):p.append(t("<option></option>").text("No branches found").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change")}).error(function(){p.empty().append(t("<option></option>").text("Could not load branches").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change")})}function l(e){window.history.length>1&&(e.preventDefault(),window.history.back())}function u(e){e&&w&&h.val(w)}function c(e){localStorage&&localStorage.setItem(b,h.val())}var d=t("#create-branch-form"),h=t("#id_repository"),p=t("#branch-dropdown"),f=t("#id_branch_name"),m=d.find(".branch-diagram"),g=d.find("button.submit"),v=r.get("issueKey"),y=v&&v.split("-")[0],b="bb-jira-repo-map-"+y,w=localStorage&&localStorage.getItem(b);u(y),f.on("keyup input propertychange",n.debounce(i,200)),p.auiSelect2({formatResult:a,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}).on("change",i),h.auiSelect2({formatResult:a,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}).on("change",s).on("change",c).change(),d.find("a.cancel").on("click",l),d.submit(function(){f.val(e(f.val()))})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e,t){return e.mainbranch&&!t.mainbranch?-1:!e.mainbranch&&t.mainbranch?1:e.name>t.name?1:e.name<t.name?-1:0}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(2)],r=function(e){return function(t,n){return n.attr("title",t.text),e.escape(t.text)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(209),n(374),n(375),n(371),n(149)],r=function(e,t,n,i,r,o,a,s){return n(function(){function n(e,n,u){if(!e.find(".branch-dialog").length){e.addClass("loading");var c=function(e){return t.each(e,function(n,i){e[n].safeName=encodeURIComponent(i.name),i.heads&&i.heads.length>1&&(e[n].hasMultipleHeads=!0),e[n].hasMultipleHeads&&t.each(i.heads,function(t,i){e[n].heads[t]={changeset:i,shortChangeset:i.slice(0,7)}})}),e};t.getJSON(l.data("branches-tags-url")).success(function(n){n.branches=c(n.branches),n.branches.sort(a),l.data("ignoreTags")?n.ignoreTags=!0:(n.tags=c(n.tags),n.ignoreTags=!1);var u="branch-dialog-template";s.clear(u),e.removeClass("loading").html(s.toHtml(u,n)),e.on("click",".filter-list a",function(e){i.vent.trigger("branchDialog:click",e)}),o(e.find(".tabbed-filter-widget")),t(document).trigger("branchDialogReady");var d=e.find("input.filter-box");d.focus(),r.tabbedFilter(d,e)}).error(function(){e.removeClass("loading").addClass("load-error").text(gettext("Unable to load branches and tags"))})}u&&u(),setTimeout(function(){e.find("input.filter-box").focus()},0)}var l=t(".branch-dialog-trigger"),u=e.InlineDialog(l,"branch-dialog",n,{hideDelay:null});i.commands.setHandler("branchDialog:hide",function(){u.hide()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(180)],r=function(e,t){var n=function(n,i){function r(e){return{tab:9===e.which,enter:13===e.which,up:38===e.which,down:40===e.which,j:74===e.which,k:75===e.which,o:79===e.which,home:36===e.which,end:35===e.which}}function o(e,t){i.clear(),e.length&&(e.addClass("focused"),i.scroll(e,t))}function a(){var e=i.getFirstItem();o(e),n.trigger("navigate:first",e)}function s(){var e=i.getLastItem();o(e),n.trigger("navigate:last",e)}function l(){var e,t=i.getSelectedItem();t.length&&(e=i.getNextItem(t)),e&&e.length||(e=i.getFirstItem()),o(e),n.trigger("navigate:next",e)}function u(){var e,t=i.getSelectedItem();t.length&&(e=i.getPrevItem(t)),e&&e.length||(e=i.getLastItem()),o(e,!0),n.trigger("navigate:previous",e)}function c(){n.trigger("navigate:select",i.getSelectedItem())}var d={defaultAction:function(e){},getNextItem:function(e){return e.next()},getPrevItem:function(e){return e.prev()},scroll:function(e){var t=e.offsetParent(),n=t.innerHeight(),i=e.position().top,r=i+e.innerHeight(),o=t.scrollTop();0>i?t.scrollTop(o+i):r>=n&&t.scrollTop(o+r-n)}};return i=e.extend({},d,i),n.on("keyup",function(e){var n=r(e),o="Mac"===t.os,d=o&&e.ctrlKey||!o&&e.altKey,h=n.up||n.k&&d||n.tab&&e.shiftKey,p=n.down||n.j&&d||n.tab&&!e.shiftKey,f=n.enter||n.o&&d,m=n.home,g=n.end;h?u():p?l():f?c():m?a():g?s():i.defaultAction(e)}),{next:l,prev:u,first:a,last:s,select:c}},i=function(t,i,r){var o={getSelectedItem:function(){return i.find(".active-pane .filter-item.focused")},getFirstItem:function(){return i.find(".active-pane .filter-item a:visible").first().parent()},getLastItem:function(){return i.find(".active-pane .filter-item a:visible").last().parent()},getNextItem:function(e){return e.nextAll().find("a:visible").first().parent()},getPrevItem:function(e){return e.prevAll().find("a:visible").first().parent()},clear:function(){i.find(".active-pane .focused").removeClass("focused")}};return t.on("navigate:select",function(t,n){var i=e(n),r=i.find("a");r.length&&r[0].click()}),n(t,e.extend({},o,r))};return{keyNavigation:n,tabbedFilter:i}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(376)],r=function(e,t){return function(n,i){function r(t){var n=e(t.target).closest("a"),i=n.closest("div.tabbed-filter-widget"),r=n.closest("div.filter-tabs"),o=i.find("input.filter-box"),a=n.attr("href").substring(1),s=i.find("#"+a),l=s.data("filter-placeholder");t.preventDefault(),r.find("li.active-tab").removeClass("active-tab"),n.closest("li").addClass("active-tab"),i.find(".tab-pane.active-pane").removeClass("active-pane"),s.addClass("active-pane"),o.attr("placeholder",l),o.val()&&o.val()!==o.attr("placeholder")&&o.trigger("input")}function o(){n.on("click",".filter-tabs li.menu-item a",r),t(n)}o()}}.apply(t,i),!(void 0!==r&&(e.exports=r));
},function(e,t,n){var i,r;i=[n(3),n(377)],r=function(e,t){return function(n,i){function r(e){var n=e.find("input.filter-box"),r=t(e,".filter-item a",i);n.bind("keyup input propertychange",r.handler),n.val()&&n.trigger("input")}i=e.extend({delay:200},i),r(n)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(378)],r=function(e,t){return function(n,i,r){function o(){n.toggleClass("empty",!a.$items.filter(":visible").length)}r=e.extend({delay:200},r);var a={};return{handler:function(s){function l(){function i(t,n){return e(n).text().match(r)}if(u.val()===c){n.trigger("filter",c);var r=t.getRegExp(c);a.$items.addClass("hidden"),a.$items.filter(i).removeClass("hidden"),o()}}var u=e(s.target),c=u.val();return a.$items=a.$items||n.find(i),a.val===c?void o():(a.val=c,void setTimeout(l,r.delay))},update:function(){a.$items=n.find(i),o()}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){function t(e){return e.replace(n,"\\$&")}var n=/[-[\]{}()*+?.,\\^$|#\s]/g;return{getRegExp:function(e){var n=e.split(/[\/\s]/),i=n.map(t),r=i.join(".*[\\/\\s].*");return new RegExp(r,"i")},filterList:function(t,n){var i=this.getRegExp(n);return e.filter(t,function(e){return e.fullSlug.match(i)})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(325),n(380),n(381)],r=function(e,t,n,i,r,o,a){function s(t,n,i,r){var o,a=e.InlineDialog.opts.calculatePositions(t,n,i,r),s=n.target.closest(".aui-inline-dialog, aui-inline-dialog, aui-inline-dialog2"),l=10;return s.length&&(o=s.offset(),a.popupCss.left=o.left+l,a.popupCss.top=o.top),a}var l=360,u={width:l,preHideCallback:a.callback,offsetY:r.sidebarOffsetY,arrowOffsetY:r.sidebarArrowOffsetY,calculatePositions:s,useLiveEvents:!0};return n(function(e){var n=e.attr("id"),i="#"+(e.data("dialog-id")||"repo-clone-dialog"),r=e.data("popup-id")||"repo-clone-dialog",a=o(i,r,u);u.gravity=e.data("gravity")||"w",!e.selector&&n&&(e=t("#"+n)),a(e)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2)],r=function(e,t,n){return function(i,r,o){return function(a){function s(e,i,o){var a=t("aui-inline-dialog:not([hidden]), aui-inline-dialog2:not([hidden])");l.appendTo(e).removeClass("hidden"),o();var s=t(document).on("showLayer",function(e,i,o){if(o.id===r){n.defer(function(){a.each(function(e,t){t.hide?t.hide():t.open=!1}),l.find("input").trigger("select")}),t(document).off("showLayer",s);var u=t(document).on("aui-layer-show",function(e){o.popup.find("[aria-controls="+e.target.id+"]").length||(o.hide(),t(document).off("aui-layer-show",u))})}})}var l=t(i);e.InlineDialog(a,r,s,o)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(){return setTimeout(function(){t=!0},0),t}var t=!0;return{callback:e,setValue:function(e){"undefined"!=typeof e&&(t=e)}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(145),n(164)],r=function(e,t,n){return t(function(e){var t=e.attr("data-https-url"),i=e.attr("data-ssh-url");e.find("button").click(function(){window.location.href="sourcetree://cloneRepo/"+(n.isSshEnabled?i:t)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(380),n(381)],r=function(e,t,n){return e(t("#wiki-clone-dialog","clone-wiki-dialog",{preHideCallback:n.callback}))}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(164),n(381)],r=function(e,t,n,i,r){return n(function(e){function n(t){o.attr("href",t.attr("href")),o.find(".dropdown-text").text(t.text()),s.val(t.attr("data-command")),t.hasClass("ssh")?e.addClass("ssh"):e.removeClass("ssh")}var o=e.find(".aui-dropdown2-trigger"),a=e.find(".aui-dropdown2"),s=e.find("input"),l={onItemClicked:function(){r.setValue(!1)}};e.find("a.item-link").click(function(e){e.preventDefault(),n(t(this)),s.select(),a[0].hide(),l.onItemClicked&&l.onItemClicked()}),i.isSshEnabled&&n(e.find("a.item-link.ssh")),s.focus(function(){var e=t(this);e.one("mouseup",function(e){e.preventDefault()}),e.select()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(386),n(387),n(388),n(416),n(170),n(158),n(440),n(147),n(441),n(306)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h){return n(function(){function n(e,t){var n='[data-repo="{0}"]'.format();return e.filter(n(t))}function l(e,t,i){var r=d(t),o=d(i),a=y.find("#id_source_repo"),s=y.find("#id_dest_repo"),l=e.find('[data-field="source"]'),u=e.find('[data-field="dest"]'),c=n(l,r.repo),h=n(u,o.repo);c.val(t).trigger("change"),h.val(i).trigger("change"),a.val(r.repo).trigger("bb:repo:change").trigger("change"),s.val(o.repo).trigger("bb:repo:change").trigger("change")}function p(e,t,n,i){return t!==e||i?"{0}{1}{2}".format(t,i?"+":":",encodeURIComponent(n)):encodeURIComponent(n)}function f(e,t,n){var i,r,o="{0}/{1}".format(s.owner.username,s.slug),a=d(t.val()),l=d(n.val()),u=t.data("multiple-heads")?a.hash:a.branch,c=n.data("multiple-heads")?l.hash:l.branch;return c?(i=p(o,a.repo,u),r=p(o,l.repo,c)):(i=p(o,a.repo,u,!0),r=l.repo),"{0}{1}{2}{3}".format(e,i,encodeURIComponent("\r"),r)}function m(e,t){var n=e.find('.menu-item a[href="{}"]'.format(t)).closest(".menu-item");0!==n.length&&(e.find(".menu-item.active-tab").removeClass("active-tab"),e.find(".tabs-pane.active-pane").removeClass("active-pane"),n.addClass("active-tab"),e.find(t+".tabs-pane").addClass("active-pane"))}function g(e,t){for(var n=d(e),i=null,r=0;r<t.length;++r){var o=t[r],a=d(o);if(n.repo===a.repo){if(n.hash===a.hash&&n.branch===a.branch)return o;null===i&&n.branch===a.branch&&(i=o)}}return i}var v=t("#compare-toolbar"),y=t("#compare-form");t(".compare-widget-form:not(.deleted)").each(function(){var e=t(this),n=e.find(".repo-field"),r=e.find(".repo-avatar-link"),o=e.find(".branch-field"),a='[data-repo="{0}"]'.format();n.on("bb:compare:repo:change",function(){r.hide().filter(a(n.val())).show()}),n.on("bb:repo:change",function(){t(this).trigger("bb:compare:repo:change")}),o.on("bb:branch:change",function(){t(this).trigger("bb:compare:change")}),i(n.filter(":visible"),o),n.change()});var b=t(".compare-widget-container"),w=t("#compare-content"),x=null,_=!0;w.on("pjax:error",function(e){e.preventDefault()}),w.on("pjax:start",function(){w.addClass("has-mask")}),w.on("pjax:end",function(e,n,i){w.removeClass("has-mask"),w.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var e=t(this),n=e.data("filename"),i=e.data("compare-files-url");new a(n,i).decorate(e.find(".diff-actions")),new o(e.data("expand-context-url")+encodeURI(n),e.data("identifier"),!1).decorate(e)}),b.trigger("bb:compare:loaded"),t(document).trigger("bb:compare")}),b.bind("bb:compare:change",function(){var e=t(this),n=w.attr("data-full-url"),i=e.find('[name="source"] option:selected'),r=e.find('[name="dest"] option:selected'),o=h.get("w"),a=h.get("ts");if(!n){if(!i.val()||!r.val()||e.data("compare-view-disabled"))return;n=f(w.attr("data-base-url"),i,r)}if(n+=window.location.hash,v.removeClass("has-conflicts"),b.data("pjax")&&t.support.pjax)t.pjax({container:"#compare-content",url:n,push:!_,scrollTo:null,timeout:0,state:{source:i.val(),dest:r.val()}});else{x&&x.readyState<4&&(x.onreadystatechange=t.noop,x.abort());var s={},l=function(){w.trigger("pjax:start")},c=function(){w.trigger("pjax:end")},d=function(e){w.html(e),w.trigger("pjax:success"),t(document).trigger("bb:compare");var n=new u({el:"#diff-ignore-whitespace"}).render();n.on("toggle",function(e){h.update("w",e?"1":"0"),window.history.replaceState({},"",h.asUrl(window.location.href)),b.trigger("bb:compare:change")})};null!==o&&(s.w=o),a&&(s.ts=a),x=t.ajax({url:n,data:s,dataType:"html",beforeSend:l,complete:c,success:d})}_=!1}),t(window).on("hashchange",function(){m(t("#compare-tabs"),window.location.hash)}),t(document).bind("bb:compare",function(){t(function(){var n=t("#compare-tabs"),i=t("#compare-metadata"),r=i.data("has-conflicts");t("#compare-toolbar .conflict-warning").tooltip(),v.toggleClass("has-conflicts",r),window.location.hash&&m(n,window.location.hash),e.tabs.setup(),n.find(".menu-item a").on("click",function(){window.location.hash=t(this).attr("href")}),n.on("click",'a[href="#diff"]',function(){c(["atl._trackEvent","Compare","Diff tab"])}).on("click",'a[href="#commits"]',function(){c(["atl._trackEvent","Compare","Commits tab"])})})});var k=t("#compare-create-pr"),C=t("#compare-merge"),$=b.data("pr-source-choices")||[],S=b.data("pr-dest-choices")||[];t(document).bind("bb:compare",function(){var e=t(this),n=e.find('[name="source"]').val(),i=e.find('[name="dest"]').val(),r=t("#compare-metadata").data("hasChanges");if(0!==k.length&&$&&S){var o=g(n,$),a=g(i,S);o&&a&&r?(k[0].search="source={0}&dest={1}".format(o,a),k.removeClass("disabled").removeAttr("aria-disabled")):(k[0].search="",k.addClass("disabled").attr("aria-disabled",!0))}}),t(document).bind("bb:compare",function(){var e=t("#compare-metadata"),n=e.data("hasChanges"),i=e.data("hasWrite"),r=e.data("has-branch-write");i&&n&&r?C.removeClass("disabled").removeAttr("aria-disabled"):C.addClass("disabled").attr("aria-disabled",!0)}),k.bind("click",function(e){t(this).hasClass("disabled")&&e.preventDefault()}),C.length&&r(C,{getData:function(){function e(e){return e.find('[value="{}"]'.format(e.val()))}function n(e,t){return e.filter('[data-repo="{}"]'.format(t)).find("img")}var i,r=y.find('[name="source"]'),o=t("#compare-metadata"),a=e(r),s=a.text(),l=y.find("#id_source_repo").val(),u=y.find('[name="dest"]'),c=e(u),d=c.text(),h=y.find("#id_dest_repo").val(),p=y.find('label[for="id_source_repo"] .repo-avatar-link'),f=n(p,l),m=y.find('label[for="id_dest_repo"] .repo-avatar-link'),g=n(m,h),v=o.data("has-conflicts"),b=!o.data("has-branch-close"),w=!1;return i=l===h?s:c.data("mainbranch")&&s===d?l:"{}/{}".format(l,s),l!==h||a.data("mainbranch")||b||(w=!0),{action:document.location.pathname,source:r.val(),sourceBranch:s,sourceRepo:l,sourceAvatar:f.attr("src"),sourceAvatarAltText:f.attr("alt"),dest:u.val(),destBranch:d,destRepo:h,destAvatar:g.attr("src"),destAvatarAltText:g.attr("alt"),sameRepo:l===h,canCloseBranch:w,hasConflicts:v,mergeCommands:v&&t("#merge-commands-content").html(),commitMessageSlug:i}}}),y.find("#compare-swap-link a").click(function(e){e.preventDefault();var t=y.find('[name="source"]').val(),n=y.find('[name="dest"]').val();l(y,n,t),b.trigger("bb:compare:change")}),b.trigger("bb:compare:change")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(t,n){function i(){var i=n.filter('[data-repo="{0}"]'.format(t.val()));n.each(function(){e(this).removeAttr("name").findWidget().hide()}),i.attr({name:i.attr("data-field")}).findWidget().show(),i.trigger("bb:branch:change")}e.fn.findWidget=function(){var e=this.auiSelect2("container");return e.hasClass("select2-container")?e:this},t.on("change",function(){e(this).trigger("bb:repo:change")}),n.on("change",function(){e(this).trigger("bb:branch:change")}),t.on("bb:repo:change",i),t.auiSelect2(),n.auiSelect2()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(314),n(368)],r=function(e,t,n,i){return function(r,o){o=e.extend({getData:function(){},success:function(e){window.location=e},width:700},o),new n(r,{success:function(e,t){t.result?o.success.call(this,t.result):t.error?this.error(t.error,t):setTimeout(function(){i(t.url).done(o.success.bind(this)).fail(this.error.bind(this))}.bind(this),1e3)},error:function(e,n){if(this.complete_(),n.conflicts&&o.conflictUrl){var i=gettext("View the conflicts");e+=' <a href="{}">{}</a>.'.format(o.conflictUrl,t.escape(i))}this.displayError({title:gettext("Unable to merge"),body:e,closeable:!1})},complete:function(){},onUpdateContents:function(e){var t=e.popup.element,n=-(new Date).getTimezoneOffset(),i=t.find("form").data("hasConflicts");t.find('input[name="tzoffset"]').val(n),i&&(t.find(".dialog-button-panel").empty(),e.addCancel(gettext("Close"),function(e){e.hide()}))},id:o.id,template:"merge-form-template",templateData:o.getData,width:o.width}).bind()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(306),n(389)],r=function(e,t,n,i,r){var o=function(e,t,n,i,r){this.url=e,this.diff=i,this.identifier=t,this.showComments=!!n,this.commentUrlRoot=r,this.$elem=null};return o.prototype.tipsySettings_={title:function(){return gettext("Show more lines")},delayIn:500,gravity:"s",offset:-3,live:!0},o.prototype.decorate=function(e){this.$elem=e,this.enterDocument(),this.loadHiddenContextComments()},o.prototype.enterDocument=function(){this.$elem.on("click",".skipped-container .ellipsis",t.proxy(this.expand,this)),this.$elem.find(".skipped-container .ellipsis").tooltip(this.tipsySettings_)},o.prototype.loadHiddenContextComments=function(){var e=this.$elem.data("linecommentroots")||{},i=this;n.each(n.keys(e),function(r){if(!t("#comment-{}".format(r)).length){var o=e[r],a=i.$elem.find(".skipped-container"),s=n.find(a,function(e){var n,r=t(e),a=i.data(r);return n=o.line_from?a.above_fnum>o.line_from||!a.above_fnum:a.above_tnum>o.line_to||!a.above_tnum});t(s).find(".ellipsis").trigger("click",o)}})},o.prototype.expand=function(e,n){e.preventDefault(),this.$elem.find(".skipped-container .ellipsis").tooltip("hide");var i=t(e.target).closest(".skipped-container");if(!i.hasClass("disabled")){i.addClass("disabled");var o=setTimeout(function(){i.addClass("loading")},300),a=function(){clearTimeout(o),i.removeClass("disabled loading")},s=this;t.ajax({url:s.url,data:s.data(i,n),dataType:"json",complete:a,statusCode:{200:function(e){var n=i.closest(".bb-udiff"),o=n.attr("data-filename"),a=t(e.lines);if(t(".tipsy").remove(),s.setPermalinks(a),i.replaceWith(a),e.thread_ids){var l=r.decorateThreads(s.commentUrlRoot,e.thread_ids,o);s.diff&&s.diff.acceptLineComments(l)}n.trigger("context-expander/load",e)},204:function(){i.remove()}}})}},o.prototype.data=function(e,t){var n=e.prev().find(".line-numbers"),r=e.next().find(".line-numbers"),o={};return n.length&&(o.below_fnum=n.data("fnum"),o.below_tnum=n.data("tnum")),r.length&&(o.above_fnum=r.data("fnum"),o.above_tnum=r.data("tnum")),t&&(t.line_from&&(o.include_fnum=t.line_from),t.line_to&&(o.include_tnum=t.line_to)),this.showComments||(o.nocomments=!0),o.w=i.get("w"),o},o.prototype.setPermalinks=function(e){var n=/(F\d+)?(T\d+)?$/,i=this.identifier;e.find(".line-numbers").each(function(){var e=t(this).closest(".gutter"),r=e.attr("id"),o=r.match(n);if(o[1]||o[2]){var a="L"+i;o[1]&&(a+=o[1]),o[2]&&(a+=o[2]),e.attr({id:a,href:"#"+a})}})},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(321),n(390),n(392),n(293),n(167),n(149),n(404),n(407),n(408),n(415)],r=function(e,t,n,i,r,o,a,s,l,u,c){function d(t,n){l.addInitializer(function(i){var r=i.pullrequest;t.children(".task-list").find(".task").each(function(){var t=e(this);r.tasks.add({id:t.data("taskId"),content:t.find(".description").text().trim(),completed:t.find(".task-status").prop("checked"),comment:n,creator:{username:t.attr("data-creator-username")}})}),n.pullrequest=r,new c({el:t,model:n}).bindUIElements()})}var h=function(e){this.comment=e,this.editCommentForm=new r(e),this.replyCommentForm=new r,this.children=[],this.$elem=null,this.$comment=null,this.$content=null,this.$replies=null,this.$edit=null,this.$reply=null,this.$delete=null};return h.decorateThreads=function(t,n,r){for(var o=[],a=0;a<n.length;a++){var s=n[a],l=e("#comment-{}".format(s));if(l.length){var u={comment_id:l.data("comment-id"),content:l.data("content"),convert_markup:"True"===l.data("convert-markup")};r&&(u.filename=r);var c=new i(u,{urlRoot:t});o.push(new h(c).decorate(l,r,t))}}return o},h.prototype.decorate=function(t,n,r){this.$elem=t.parent(".comment"),this.$elem.data("modelobj",this),this.findInternal(),this.enterDocument();var o=t.parent("li.comment").children(".child-comments").children("li.comment").children("article, .deleted-comment-message"),a=this;return o.each(function(){var t=e(this),o={comment_id:t.data("comment-id"),content:t.data("content"),convert_markup:"True"===t.data("convert-markup")};n&&(o.filename=n);var s=new i(o,{urlRoot:r}),l=new h(s).decorate(t,n,r);a.children.push(l),e(l).bind("line-comment/thread-deleted",e.proxy(a.cleanUpThread,a))}),d(this.$elem,this.comment),this},h.prototype.scrollTo=function(t){var n=e.extend({axis:"y",offset:0-(e(window).height()/2-this.$elem.height()/2)},t);return e.scrollTo(this.$elem,500,n),this},h.prototype.createDom=function(){this.$elem=e('<li class="comment">').html(s.toHtml("comment-template",this.comment.attributes)),this.$elem.data("modelobj",this),this.findInternal()},h.prototype.hasReplies=function(){return!!this.$elem.closest(".child-comments").length},h.prototype.findInternal=function(){this.$comment=this.$elem.children("article"),this.$replies=this.$elem.children(".child-comments"),this.$content=this.$comment.find(".comment-content"),this.$edit=this.$comment.find(".edit-link"),this.$reply=this.$comment.find(".reply-link"),this.$delete=this.$comment.find(".delete-link"),this.$time=this.$comment.find("time")},h.prototype.render=function(e,t){return this.createDom(),"before"===t?this.$elem.insertBefore(e):"after"===t?this.$elem.insertAfter(e):this.$elem.appendTo(e),this.enterDocument(),this.$elem.trigger("comment-count/create"),d(this.$elem,this.comment),this},h.prototype.enterDocument=function(){this.comment.on("change",this.updateContent,this),this.comment.on("destroy",this.removeComment,this),this.$edit.on("click",e.proxy(this.edit,this)),this.$reply.on("click",e.proxy(this.reply,this)),this.$delete.on("click",e.proxy(this.deleteComment,this)),e(this.editCommentForm).bind("comment-form/cancel",e.proxy(this.cancelEdit,this)),e(this.replyCommentForm).bind("comment-form/cancel",e.proxy(this.cancelReply,this)),this.$elem.removeClass("highlight"),a(this.$time)},h.prototype.edit=function(e){e.preventDefault(),this.$comment.addClass("editing"),this.editCommentForm.$elem||this.editCommentForm.render(this.$elem),this.editCommentForm.$textarea.val(this.comment.get("content")),this.editCommentForm.$elem.insertAfter(this.$content),this.editCommentForm.showAndFocus()},h.prototype.reply=function(e){e.preventDefault();var n=new i({parent_id:this.comment.get("comment_id"),filename:this.comment.get("filename"),content:""},{urlRoot:this.comment.urlRoot});this.replyCommentForm.comment=n,this.replyCommentForm.$elem?this.replyCommentForm.$elem.prependTo(this.$replies):this.replyCommentForm.render(this.$replies),this.replyCommentForm.showAndFocus(),n.on("sync",t.once(this.insertReply),this)},h.prototype.insertReply=function(t){this.replyCommentForm.$elem.detach();var n=new h(t).render(this.$replies).scrollTo();e(n).bind("line-comment/deleted",e.proxy(this.cleanUpThread,this)),this.replyCommentForm.clearContents(),this.$elem.trigger("comment-count/create"),e(document).trigger("comment-added")},h.prototype.deleteErrorMessages={404:gettext("Comment has been deleted already."),403:gettext("You do not have permission to delete this message.")},h.prototype.deleteComment=function(e){e.preventDefault(),o({title:gettext("Delete comment"),content:gettext("Are you sure you want to delete this comment?"),buttonText:gettext("Delete")}).done(function(){this.comment.destroy({wait:!0,error:function(e,t){var i=this.deleteErrorMessages[t.status];n(i||gettext("A problem occurred processing your request."))}.bind(this)})}.bind(this))},h.prototype.cleanUpThread=function(){var t;this.$elem.find("article:not(:has(div.deleted-comment-message))").length||(this.$elem.remove(),e(this).trigger("line-comment/thread-deleted")),this.hasReplies()||(t=this.$elem.closest("#comments-list > li.comment:has(.bb-udiff)"),t.find(".bb-udiff .comment").length||t.remove())},h.prototype.removeComment=function(){this.$comment.replaceWith(s.toHtml("comment-template",{deleted:!0,comment_id:this.comment.comment_id})),this.$elem.addClass("deleted"),this.$edit.unbind(),this.$delete.unbind(),this.$reply.unbind(),this.$edit=null,this.$delete=null,this.$reply=null,e(this).trigger("line-comment/deleted"),this.$elem.trigger("comment-count/delete"),this.cleanUpThread()},h.prototype.cancelEdit=function(){this.editCommentForm.$elem.detach(),this.$comment.removeClass("editing")},h.prototype.cancelReply=function(){this.replyCommentForm.$elem.detach()},h.prototype.updateContent=function(e){this.$content.html(e.get("content_rendered")),this.cancelEdit()},h}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(391),n(164)],r=function(e,t,n,i){return t.Model.extend({initialize:function(e,t){this.urlRoot=t.urlRoot},idAttribute:"comment_id",parse:function(t,n){return t.isAuthenticated=i.isAuthenticated,t.isEditable=t.username===i.username,t.isAdmin="admin"===e("#user-repo-privilege-data").data().priv,t.utc_created_on=t.utc_created_on.replace(" ","T"),t.convert_markup="True"===t.convert_markup,t.show_tasks=!!t.pull_request_id,t.allow_task_creation=e("#pullrequest").data("allow-task-creation"),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({defaults:{completed:!1,content:""},toJSON:function(){var e={content:{raw:this.get("content")},comment:{id:this.get("comment").id,path:this.get("comment").path},completed:this.get("completed"),creator:this.get("creator"),state:this.get("completed")?"RESOLVED":"UNRESOLVED"};return this.id&&(e.id=this.id),e},parse:function(e){return{completed:"RESOLVED"===e.state,content:e.content.raw,creator:e.creator,comment:{id:e.comment.id,path:e.comment.inline&&e.comment.inline.path},id:e.id}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(164),n(393),n(401),n(149),n(403)],r=function(e,t,n,i,r){var o=function(e){this.comment=e,this.$elem=null,this.$editor=null,this.$textarea=null,this.$submit=null,this.$cancel=null,this.$preview=null,this.$error=null,this.$convertMarkupWarning=null};return o.prototype.errorMessages={400:gettext("There was a problem submitting your comment."),403:gettext("You are not permitted to comment."),404:gettext("This comment has been deleted.")},o.prototype.decorate=function(e){return this.$elem=e,this.renderInternal(),this.enterDocument(),this},o.prototype.renderInternal=function(){this.$editor=this.$elem.find("form.editor"),this.$textarea=this.$editor.find("textarea"),this.$submit=this.$editor.find("button[type=submit]"),this.$cancel=this.$editor.find("a.cancel"),this.$preview=this.$editor.find("a.preview"),this.$error=this.$elem.find(".error"),this.$convertMarkupWarning=this.$elem.find(".convert-markup")},o.prototype.createDom=function(){var n=e.extend({user_avatar_url:t.avatarUrl,display_name:t.displayName},this.comment?this.comment.attributes:{});this.$elem=e(r.toHtml("new-comment-template",n))},o.prototype.render=function(e){return this.createDom(),this.renderInternal(),e.prepend(this.$elem),this.enterDocument(),this},o.prototype.enterDocument=function(){this.$textarea.on("focus",e.proxy(this.expandSize,this)),this.$submit.on("click keydown",e.proxy(this.save,this)),this.$cancel.on("click",e.proxy(this.cancel,this)),this.$preview.on("click",e.proxy(this.preview,this))},o.prototype.expandSize=function(){var e=this.$textarea;this.$editor.addClass("focused"),this.$textarea.hasClass("markItUpEditor")||(this.$editor.addClass("textarea-preview"),this.$textarea.markItUp(n()),setTimeout(function(){e.trigger("focus")},0))},o.prototype.shrinkSize=function(){this.$textarea.markItUpRemove(),this.$editor.removeClass("textarea-preview"),this.$editor.removeClass("focused")},o.prototype.cancel=function(t){t&&t.preventDefault(),this.clearContents(),i(this.$preview,this.$editor),this.shrinkSize(),e(this).trigger("comment-form/cancel")},o.prototype.clearContents=function(){this.$textarea.val(""),this.clearError()},o.prototype.showAndFocus=function(){this.$editor.show(),this.$elem.show(),this.$textarea.focus(),this.$convertMarkupWarning.toggle(this.comment.get("convert_markup"))},o.prototype.isSubmitDisabled=function(){return this.$submit.prop("disabled")},o.prototype.disableSubmit=function(){this.$submit.prop("disabled",!0).attr("aria-disabled","true")},o.prototype.enableSubmit=function(){this.$submit.prop("disabled",!1).removeAttr("aria-disabled")},o.prototype.save=function(e){if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var t=this;if(!t.isSubmitDisabled()){var n=setTimeout(function(){t.clearError(),t.$editor.addClass("loading")},300);t.disableSubmit();var r=function(){clearTimeout(n),t.$editor.removeClass("loading"),t.enableSubmit(),i(t.$preview,t.$editor)};t.comment.save({content:t.$textarea.val()},{wait:!0,complete:r,error:function(e,n,i){t.displayError(t.errorMessages[n.status])}})}}},o.prototype.displayError=function(e){this.$error.text(e)},o.prototype.clearError=function(){this.$error.text("")},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(2),n(394),n(395),n(170),n(164),n(183),n(396),n(399),n(149),n(400),n(402)],r=function(e,t,n,i,r,o,a,s,l,u,c,d){function h(e,t,n){var i=Array(e+1).join(t.header);return{name:"Heading "+e,className:[t.classname,"heading-"+e,n].join(" "),openWith:i+" ",closeWith:" "+i,placeHolder:"Your title here..."}}function p(e){return{name:"Section",className:[e.classname,"heading-single","first","last"].join(" "),placeHolder:"Section",closeWith:function(t){var n=7;t.selection&&t.selection.length&&(n=t.selection.length);var i=Array(n+1).join(e.header);return"\n"+i+"\n"}}}function f(e,t,n){return{name:"Heading "+e,className:[t.classname,"heading-"+e,n].join(" "),openWith:"h"+e+". ",placeHolder:"Your title here..."}}function m(e){return{name:"Bold",className:[e.classname,"bold","first","separator"].join(" "),openWith:e.bold,closeWith:e.bold}}function g(e){return{name:"Italic",className:[e.classname,"italic","last"].join(" "),openWith:e.italic,closeWith:e.italic}}function v(e){return{name:"Bulleted list",className:[e.classname,"bulleted-list","first","separator"].join(" "),openWith:e.ul,multiline:!0}}function y(e){return{name:"Numeric list",className:[e.classname,"numeric-list","last"].join(" "),openWith:e.ol,multiline:!0}}function b(e){return{name:"Code",className:[e.classname,"code","first","last","separator"].join(" "),openBlockWith:e.codeOpenBlock,closeBlockWith:e.codeCloseBlock,openWith:e.codeOpen,closeWith:e.codeClose,multiline:!0}}function w(e,t,n,i){return i.unshift(e.classname),{name:t,className:i.join(" "),replaceWith:n}}function x(e){return{name:"Image",className:[e.classname,"image","last"].join(" "),replaceWith:$(e)}}function _(){return M||(M=C()),M}function k(e){var t=e.originalEvent.dataTransfer;return n.contains(t.types,"Files")}function C(){function t(){p.closest("form").submit()}function i(){g.hide(),p.val(""),a.remove(),d.removeClass("hidden error")}var o=e(c.toHtml("image-upload-template")),a=e("<img>").addClass("preview centered"),u=o.find(".drop-target"),d=u.find("p"),h=o.find(".click-target"),p=o.find(".file-target"),f=p.attr("accept").split(", "),m=r(p,{$dropTarget:u,complete:function(e){200===e.status?(i(),L(e)):e.status>=400&&e.status<500&&d.addClass("error").text(e.response)},canSelect:k,fileSelected:function(e){if(e){if(e.size>1048576)return d.addClass("error").removeClass("hidden").text(gettext("File cannot be larger than 1 MB.")),m.selectFile(null),void a.remove();if(!n.contains(f,e.type))return d.addClass("error").removeClass("hidden").text(gettext("Only images are allowed.")),m.selectFile(null),void a.remove();d.removeClass("error").addClass("hidden"),a.attr("src",window.URL.createObjectURL(e)),u.prepend(a)}}});l||(u.addClass("hidden"),p.removeClass("hidden")),h.on("click",function(e){e.preventDefault(),p.click()});var g=new s({id:"upload-image",width:450,height:"auto"});return g.addHeader("Upload image"),g.addPanel("main",o),g.addButton("Upload",t),g.addLink("Cancel",i,"left"),g.selectFile=m.selectFile,g}function $(e){return function(t){var n=t.textarea,i=n.selectionStart,r=n.selectionEnd,o=n.value.substring(i,r);L=function(t){var a=JSON.parse(t.response),s=e.customImage.replace("url",a.href).replace("name",o||a.filename);if(document.selection){var l=document.selection.createRange();l.text=s}else n.value=n.value.substring(0,i)+s+n.value.substring(r,n.value.length)},_().show()}}function S(){return{name:"Preview",className:"preview first last right no-icon",beforeInsert:function(t){var n=e(t.textarea),i=n.closest(".textarea-preview"),r=i.find(".markItUpHeader .markItUpButton.preview a");r.attr("aria-pressed")?r.text("Preview"):r.text("Edit"),d(r,i)}}}function T(){return{name:"Language",className:"language first last right no-icon hidden",call:function(){e("#dropdown-wiki-lang ul").show()}}}function D(e,t){return{name:"Help",className:[e.classname,"help","first","last","right"].join(" "),call:function(){var e="https://confluence.atlassian.com/x/jIAuEg";t&&(e="https://confluence.atlassian.com/x/FA4zDQ"),window.open(e,"_blank")}}}function P(){return[h(1,N,"first"),h(2,N),h(3,N,"last"),m(N),g(N),v(N),y(N),b(N),w(N,"Link",N.link,["first","link"])]}function E(){return[h(1,O,"first"),h(2,O),h(3,O,"last"),m(O),g(O),v(O),y(O),b(O),w(O,"Link",O.link,["first","link"])]}function A(){return[p(U),m(U),g(U),v(U),y(U),b(U),w(U,"Link",U.link,["first","link"])]}function I(){return[f(1,H,"first"),f(2,H),f(3,H,"last"),m(H),g(H),v(H),y(H),b(H),w(H,"Link",H.link,["first","link"])]}function R(t,n){var r=[];return r=n.isWiki?r.concat(P(),E(),A(),I()):F[n.syntax](),u&&a.isAuthenticated?(r.push(x(N)),n.isWiki&&(r.push(x(O)),r.push(x(U)),r.push(x(H))),t.each(function(t,n){i(e(n),{canDrop:k,onDrop:function(e){var t=e.originalEvent.dataTransfer;_().selectFile(t.files[0]),$(N)({textarea:n})}})})):(r.push(w(N,"Image",N.image,["image","last"])),n.isWiki&&(r.push(w(O,"Image",O.image,["image","last"])),r.push(w(U,"Image",U.image,["image","last"])),r.push(w(H,"Image",H.image,["image","last"])))),r.push(S()),n.isWiki&&r.push(T()),r.push(D(N,n.isWiki)),n.isWiki&&(r.push(D(O,!0)),r.push(D(U,!0)),r.push(D(H,!0))),r}e.fn.editable.defaults.placeholder="";var M,j=o.pygmentsLanguage||"python",L=function(){},N={classname:"markdown",header:"#",bold:"**",italic:"*",ul:"(!(* |!|*)!)",ol:"(!(1. |!|1.)!)",codeOpenBlock:"(!(\n```\n#![![Language:!:"+j+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"\n```\n",link:function(e){var t=prompt(gettext("Link Text"),e.selection);if(null!=t){var n=prompt(gettext("Link URL"));if(null!=n)return"["+t+"]("+n+")"}},image:"![[![Image Alt Text]!]]([![Image URL]!])",customImage:"![name](url)"},O={classname:"creole",header:"=",bold:"**",italic:"//",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"(!({{{\n#![![Language:!:"+j+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"(!(\n}}}|!|</pre>)!)",link:"[[[![Link URL]!]|[![Link Text]!]]]",image:"{{[![Image URL]!]|[![Image Title]!]}}",customImage:"{{url|name}}"},U={classname:"rest",header:"=",bold:"**",italic:"*",ul:"(!(* |!|*)!)",ol:"(!(#. |!|#.)!)",codeOpenBlock:"\n.. sourcecode:: [![Language:!:"+j+"]!]\n\n",codeOpen:"    ",codeCloseBlock:"\n",link:"`[![Link Text]!] <[![Link URL]!]>`_",image:".. image:: [![Image URL]!]\n   :alt: [![Image Alt Text]!]",customImage:".. image:: url\n   :alt: name"},H={classname:"textile",bold:"*",italic:"_",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"\npre. \n",codeCloseBlock:"\n",link:'"[![Link Text]!]":[![Link URL]!]',image:"![![Image URL]!]([![Image Title:!: ]!])!",customImage:"!url(title)!"},F={markdown:P,creole:E,rest:A,textile:I};return function(e){return e=e||{},e.syntax=e.syntax||"markdown",function(t){return{nameSpace:"markup-type-"+e.syntax,previewParserPath:"",resizeHandle:!1,onShiftEnter:{keepDefault:!1,replaceWith:"\n\n"},markupSet:R(t.element,e)}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e,t){t=t||{},t.onDrop=t.onDrop||function(){},t.canDrop=t.canDrop||function(){return!0},e.on("dragover dragenter",function(n){t.canDrop(n)&&(e.addClass("file-hover"),n.preventDefault(),n.stopPropagation())}),e.on("dragend dragleave",function(n){
t.canDrop(n)&&(e.removeClass("file-hover"),n.preventDefault(),n.stopPropagation())}),e.on("drop",function(n){t.canDrop(n)&&(e.removeClass("file-hover"),t.onDrop(n),n.preventDefault(),n.stopPropagation())})}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(394),n(396),n(397),n(398)],r=function(e,t,n,i,r){return function(o,a){function s(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);c(t.toString())}}function l(t){var n=e('<div class="upload-progress-container"></div>');return e('<div class="progress-bar"><div class="progress"></div></div>').appendTo(n),e('<div class="filename"></div>').text(t).appendTo(n),n}function u(){var e=o.parent();e.toggleClass("hidden"),l(y.name).insertAfter(e),b.find(".error-container").empty()}function c(e){b.find(".progress-bar .progress").css("width",(e||0)+"%")}function d(){o.parent().removeClass("hidden"),b.find(".upload-progress-container").remove()}function h(t){var n=b.find(".error-container");n.length||(n=e('<div class="error-container"></div>').insertBefore(o.parent())),d(),n.empty().text(t)}function p(e){d(),a.complete&&a.complete(e.target)}function f(e){a.error&&a.error(e.target),h("There was an error attempting to upload the file.")}function m(e){a.cancel&&a.cancel(e.target),h("The upload has been canceled by the user or the browser dropped the connection.")}function g(e){if(!y)return void e.preventDefault();var t=new XMLHttpRequest;if(t.upload){var n=o.parent();o.detach();var i=new FormData(b[0]);return n.append(o),i.append(o.attr("name"),y),u(),t.upload.addEventListener("progress",s,!1),t.addEventListener("load",p,!1),t.addEventListener("error",f,!1),t.addEventListener("abort",m,!1),t.open("POST",b.attr("action")),t.send(i),e.preventDefault(),!1}}function v(e){var t=e.originalEvent.dataTransfer,n=t.files;y=n[0],a.fileSelected&&a.fileSelected(y),a.uploadOnDrop&&g(e)}a=a||{};var y,b=o.closest("form"),w=a.$dropTarget||e();return n&&o.on("change",function(){y=o.prop("files")[0],a.fileSelected&&a.fileSelected(y)}),i&&b.on("submit",g),w.length&&r&&t(w,{canDrop:a.canSelect,onDrop:v}),{selectFile:function(e){y=e,a.fileSelected&&a.fileSelected(y)}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return!!window.FileReader}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return"upload"in new XMLHttpRequest}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return"draggable"in document.createElement("span")}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return!!window.FormData}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(321),n(170),n(165),n(401)],r=function(e,t,n,i,r){return function(o,a){if(o.attr("aria-pressed"))r(o,a);else{var s=setTimeout(function(){a.find(".mask").show()},300),l={content:a.find("textarea").val()};n.id&&(l.repo_id=n.id),l.markup_type=a.attr("data-markup-type"),e.ajax({type:"POST",url:i.toString("content-preview"),data:l,dataType:"json",success:function(e){a.addClass("previewing"),o.attr("aria-pressed",!0),a.find(".preview-container").html(e.markup),window.MathJax&&window.MathJax.Hub.Typeset(),clearTimeout(s),a.find(".mask").hide()},error:function(e){t("There was an error rendering your preview."),clearTimeout(s),a.find(".mask").hide()}})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return function(e,t){t.removeClass("previewing"),e.removeAttr("aria-pressed")}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){!function($){$.fn.editable=function(e,t){if("disable"==e)return void $(this).data("disabled.editable",!0);if("enable"==e)return void $(this).data("disabled.editable",!1);if("destroy"==e)return void $(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");var n=$.extend({},$.fn.editable.defaults,{target:e},t),i=$.editable.types[n.type].plugin||function(){},r=$.editable.types[n.type].submit||function(){},o=$.editable.types[n.type].buttons||$.editable.types.defaults.buttons,a=$.editable.types[n.type].content||$.editable.types.defaults.content,s=$.editable.types[n.type].element||$.editable.types.defaults.element,l=$.editable.types[n.type].reset||$.editable.types.defaults.reset,u=n.callback||function(){},c=n.onedit||function(){},d=n.onsubmit||function(){},h=n.onreset||function(){},p=n.onerror||l;return n.tooltip&&$(this).attr("title",n.tooltip),n.autowidth="auto"==n.width,n.autoheight="auto"==n.height,this.each(function(){var e=this,t=$(e).width(),f=$(e).height();$(this).data("event.editable",n.event),$.trim($(this).html())||$(this).html(n.placeholder),$(this).bind(n.event,function(h){if(!0!==$(this).data("disabled.editable")&&!e.editing&&!1!==c.apply(this,[n,e])){h.preventDefault(),h.stopPropagation(),n.tooltip&&$(e).removeAttr("title"),0==$(e).width()?(n.width=t,n.height=f):("none"!=n.width&&(n.width=n.autowidth?$(e).width():n.width),"none"!=n.height&&(n.height=n.autoheight?$(e).height():n.height)),$(this).html().toLowerCase().replace(/(;|"|\/)/g,"")==n.placeholder.toLowerCase().replace(/(;|"|\/)/g,"")&&$(this).html(""),e.editing=!0,e.revert=$(e).html(),$(e).html("");var m=$("<form />");n.cssclass&&("inherit"==n.cssclass?m.attr("class",$(e).attr("class")):m.attr("class",n.cssclass)),n.style&&("inherit"==n.style?(m.attr("style",$(e).attr("style")),m.css("display",$(e).css("display"))):m.attr("style",n.style));var g,v=s.apply(m,[n,e]);if(n.loadurl){var y=setTimeout(function(){v.disabled=!0,a.apply(m,[n.loadtext,n,e])},100),b={};b[n.id]=e.id,$.isFunction(n.loaddata)?$.extend(b,n.loaddata.apply(e,[e.revert,n])):$.extend(b,n.loaddata),$.ajax({type:n.loadtype,url:n.loadurl,data:b,async:!1,success:function(e){window.clearTimeout(y),g=e,v.disabled=!1}})}else n.data?(g=n.data,$.isFunction(n.data)&&(g=n.data.apply(e,[e.revert,n]))):g=e.revert;a.apply(m,[g,n,e]),v.attr("name",n.name),o.apply(m,[n,e]),$(e).append(m),i.apply(m,[n,e]),$(":input:visible:enabled:first",m).focus(),n.select&&v.select(),v.keydown(function(t){27==t.keyCode&&(t.preventDefault(),l.apply(m,[n,e]))});var y;"cancel"==n.onblur?v.blur(function(t){y=setTimeout(function(){l.apply(m,[n,e])},500)}):"submit"==n.onblur?v.blur(function(e){y=setTimeout(function(){m.submit()},200)}):$.isFunction(n.onblur)?v.blur(function(t){n.onblur.apply(e,[v.val(),n])}):v.blur(function(e){}),m.submit(function(t){if(y&&clearTimeout(y),t.preventDefault(),!1!==d.apply(m,[n,e])&&!1!==r.apply(m,[n,e]))if($.isFunction(n.target)){var i=n.target.apply(e,[v.val(),n]);$(e).html(i),e.editing=!1,u.apply(e,[e.innerHTML,n]),$.trim($(e).html())||$(e).html(n.placeholder)}else{var o={};o[n.name]=v.val(),o[n.id]=e.id,$.isFunction(n.submitdata)?$.extend(o,n.submitdata.apply(e,[e.revert,n])):$.extend(o,n.submitdata),"PUT"==n.method&&(o._method="put"),$(e).html(n.indicator);var a={type:"POST",data:o,dataType:"html",url:n.target,success:function(t,i){"html"==a.dataType&&$(e).html(t),e.editing=!1,u.apply(e,[t,n]),$.trim($(e).html())||$(e).html(n.placeholder)},error:function(t,i,r){p.apply(m,[n,e,t])}};$.extend(a,n.ajaxoptions),$.ajax(a)}return $(e).attr("title",n.tooltip),!1})}}),this.reset=function(t){this.editing&&!1!==h.apply(t,[n,e])&&($(e).html(e.revert),e.editing=!1,$.trim($(e).html())||$(e).html(n.placeholder),n.tooltip&&$(e).attr("title",n.tooltip))}})},$.editable={types:{defaults:{element:function(e,t){var n=$('<input type="hidden"></input>');return $(this).append(n),n},content:function(e,t,n){$(":input:first",this).val(e)},reset:function(e,t){t.reset(this)},buttons:function(e,t){var n=this;if(e.submit){if(e.submit.match(/>$/))var i=$(e.submit).click(function(){"submit"!=i.attr("type")&&n.submit()});else{var i=$('<button type="submit" />');i.html(e.submit)}$(this).append(i)}if(e.cancel){if(e.cancel.match(/>$/))var r=$(e.cancel);else{var r=$('<button type="cancel" />');r.html(e.cancel)}$(this).append(r),$(r).click(function(i){if($.isFunction($.editable.types[e.type].reset))var r=$.editable.types[e.type].reset;else var r=$.editable.types.defaults.reset;return r.apply(n,[e,t]),!1})}}},text:{element:function(e,t){var n=$("<input />");return"none"!=e.width&&n.width(e.width),"none"!=e.height&&n.height(e.height),n.attr("autocomplete","off"),$(this).append(n),n}},textarea:{element:function(e,t){var n=$("<textarea />");return e.rows?n.attr("rows",e.rows):"none"!=e.height&&n.height(e.height),e.cols?n.attr("cols",e.cols):"none"!=e.width&&n.width(e.width),$(this).append(n),n}},select:{element:function(e,t){var n=$("<select />");return $(this).append(n),n},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}if($("select",this).children().each(function(){($(this).val()==json.selected||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")}),!settings.submit){var form=this;$("select",this).change(function(){form.submit()})}}}},addInputType:function(e,t){$.editable.types[e]=t}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery)},function(module,exports){!function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;return ctrlKey=shiftKey=altKey=!1,"string"==typeof settings&&(method=settings,params=extraSettings),"function"==typeof settings&&(settings=settings({element:this})),options={id:"",nameSpace:"",root:"",previewHandler:!1,previewInWindow:"",previewInElement:"",previewAutoRefresh:!0,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:!1,previewParserPath:"",previewParserVar:"data",resizeHandle:!0,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},preventShiftTab:!1,markupSet:[{}]},$.extend(options,settings,extraSettings),options.root||$("script").each(function(e,t){miuScript=$(t).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/),null!==miuScript&&(options.root=miuScript[1])}),this.each(function(){function localize(e,t){return t?e.replace(/("|')~\//g,"$1"+options.root):e.replace(/^~\//,options.root)}function init(){id="",nameSpace="",options.id?id='id="'+options.id+'"':$$.attr("id")&&(id='id="markItUp'+$$.attr("id").substr(0,1).toUpperCase()+$$.attr("id").substr(1)+'"'),options.nameSpace&&(nameSpace='class="'+options.nameSpace+'"'),$$.wrap("<div "+nameSpace+"></div>"),$$.wrap("<div "+id+' class="markItUp"></div>'),$$.wrap('<div class="markItUpContainer"></div>'),$$.addClass("markItUpEditor"),header=$('<div class="markItUpHeader"></div>').insertBefore($$),$(dropMenus(options.markupSet)).appendTo(header),footer=$('<div class="markItUpFooter"></div>').insertAfter($$),options.resizeHandle===!0&&$.browser.safari!==!0&&(resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",function(e){var t,n,i=$$.height(),r=e.clientY;t=function(e){return $$.css("height",Math.max(20,e.clientY+i-r)+"px"),!1},n=function(e){return $("html").unbind("mousemove.markItUp",t).unbind("mouseup.markItUp",n),!1},$("html").bind("mousemove.markItUp",t).bind("mouseup.markItUp",n)}),footer.append(resizeHandle)),$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed),$$.bind("insertion.markItUp",function(e,t){t.target!==!1&&get(),textarea===$.markItUp.focused&&markup(t)}),$$.bind("focus.markItUp",function(){$.markItUp.focused=this}),options.previewInElement&&refreshPreview()}function dropMenus(markupSet){var ul=$("<ul></ul>"),i=0;return $("li:hover > ul",ul).css("display","block"),$.each(markupSet,function(){var button=this,t="",title,li,j;if(title=button.key?(button.name||"")+" [Ctrl+"+button.key+"]":button.name||"",key=button.key?'accesskey="'+button.key+'"':"",button.separator)li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul);else{for(i++,j=levels.length-1;j>=0;j--)t+=levels[j]+"-";li=$('<li class="markItUpButton '+(button.className||"")+'"><a href="" '+key+' title="'+title+'" tabindex="-1">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",function(){return!1}).bind("mouseup.markItUp",function(e){e.preventDefault()}).bind("focusin.markItUp",function(){$$.focus()}).bind("click.markItUp",function(e){e.preventDefault(),button.call?eval(button.call)():setTimeout(function(){markup(button)},1)}).bind("mouseenter.markItUp",function(){$("> ul",this).show(),$(document).one("click",function(){$("ul ul",header).hide()})}).bind("mouseleave.markItUp",function(){$("> ul",this).hide()}).appendTo(ul),button.dropMenu&&(levels.push(i),$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu)))}}),levels.pop(),ul}function magicMarkups(e){if(e){e=e.toString(),e=e.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(e,t){var n=t.split("|!|");return altKey===!0?void 0!==n[1]?n[1]:n[0]:void 0===n[1]?"":n[0]});var t={};return e=e.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(e,n){var i=n.split(":!:"),r=i[0];return Object.prototype.hasOwnProperty.call(t,r)?t[r]:abort===!0?!1:(value=prompt(i[0],i[1]?i[1]:""),null===value&&(abort=!0),t[r]=value,value)})}return""}function prepare(e){return $.isFunction(e)&&(e=e(hash)),magicMarkups(e)}function build(e){var t=prepare(clicked.openWith),n=prepare(clicked.placeHolder),i=prepare(clicked.replaceWith),r=prepare(clicked.closeWith),o=prepare(clicked.openBlockWith),a=prepare(clicked.closeBlockWith),s=clicked.multiline;if(""!==i)block=t+i+r;else if(""===selection&&""!==n)block=t+n+r;else{e=e||selection;var l=[e],u=[];s===!0&&(l=e.split(/\r?\n/));for(var c=0;c<l.length;c++){line=l[c];var d;(d=line.match(/ *$/))?u.push(t+line.replace(/ *$/g,"")+r+d):u.push(t+line+r)}block=u.join("\n")}return block=o+block+a,{block:block,openBlockWith:o,openWith:t,replaceWith:i,placeHolder:n,closeWith:r,closeBlockWith:a}}function markup(e){var t,n,i,r,o;if(hash=clicked=e,get(),$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:selection||"",caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey}),prepare(options.beforeInsert),prepare(clicked.beforeInsert),(ctrlKey===!0&&shiftKey===!0||e.multiline===!0)&&prepare(clicked.beforeMultiInsert),$.extend(hash,{line:1}),ctrlKey===!0&&shiftKey===!0){for(lines=selection.split(/\r?\n/),n=0,i=lines.length,r=0;i>r;r++)""!==$.trim(lines[r])?($.extend(hash,{line:++n,selection:lines[r]}),lines[r]=build(lines[r]).block):lines[r]="";string={block:lines.join("\n")},o=caretPosition,t=string.block.length+($.browser.opera?i-1:0)}else ctrlKey===!0?(string=build(selection),o=caretPosition+string.openWith.length,t=string.block.length-string.openWith.length-string.closeWith.length,t-=string.block.match(/ $/)?1:0,t-=fixIeBug(string.block)):shiftKey===!0?(string=build(selection),o=caretPosition,t=string.block.length,t-=fixIeBug(string.block)):(string=build(selection),o=caretPosition+string.block.length,t=0,o-=fixIeBug(string.block));""===selection&&""===string.replaceWith&&(caretOffset+=fixOperaBug(string.block),o=caretPosition+string.openBlockWith.length+string.openWith.length,t=string.block.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length-string.openBlockWith.length,caretOffset=$$.val().substring(caretPosition,$$.val().length).length,caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))),$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition}),string.block!==selection&&abort===!1?(insert(string.block),set(o,t)):caretOffset=-1,get(),$.extend(hash,{line:"",selection:selection}),(ctrlKey===!0&&shiftKey===!0||e.multiline===!0)&&prepare(clicked.afterMultiInsert),prepare(clicked.afterInsert),prepare(options.afterInsert),previewWindow&&options.previewAutoRefresh&&refreshPreview(),shiftKey=altKey=ctrlKey=abort=!1}function fixOperaBug(e){return $.browser.opera?e.length-e.replace(/\n*/g,"").length:0}function fixIeBug(e){return $.browser.msie?e.length-e.replace(/\r*/g,"").length:0}function insert(e){if(document.selection){var t=document.selection.createRange();t.text=e}else textarea.value=textarea.value.substring(0,caretPosition)+e+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}function set(e,t){if(textarea.createTextRange){if($.browser.opera&&$.browser.version>=9.5&&0==t)return!1;range=textarea.createTextRange(),range.collapse(!0),range.moveStart("character",e),range.moveEnd("character",t),range.select()}else textarea.setSelectionRange&&textarea.setSelectionRange(e,e+t);textarea.scrollTop=scrollPosition,textarea.focus()}function get(){if(textarea.focus(),scrollPosition=textarea.scrollTop,document.selection)if(selection=document.selection.createRange().text,$.browser.msie){var e=document.selection.createRange(),t=e.duplicate();for(t.moveToElementText(textarea),caretPosition=-1;t.inRange(e);)t.moveStart("character"),caretPosition++}else caretPosition=textarea.selectionStart;else caretPosition=textarea.selectionStart,selection=textarea.value.substring(caretPosition,textarea.selectionEnd);return selection}function preview(){"function"==typeof options.previewHandler?previewWindow=!0:options.previewInElement?previewWindow=$(options.previewInElement):!previewWindow||previewWindow.closed?options.previewInWindow?(previewWindow=window.open("","preview",options.previewInWindow),$(window).unload(function(){previewWindow.close()})):(iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>'),"after"==options.previewPosition?iFrame.insertAfter(footer):iFrame.insertBefore(header),previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]):altKey===!0&&(iFrame?iFrame.remove():previewWindow.close(),previewWindow=iFrame=!1),options.previewAutoRefresh||refreshPreview(),options.previewInWindow&&previewWindow.focus()}function refreshPreview(){renderPreview()}function renderPreview(){if(options.previewHandler&&"function"==typeof options.previewHandler)options.previewHandler($$.val());else if(options.previewParser&&"function"==typeof options.previewParser){var e=options.previewParser($$.val());writeInPreview(localize(e,1))}else""!==options.previewParserPath?$.ajax({type:"POST",dataType:"text",global:!1,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(e){writeInPreview(localize(e,1))}}):template||$.ajax({url:options.previewTemplatePath,dataType:"text",global:!1,success:function(e){writeInPreview(localize(e,1).replace(/<!-- content -->/g,$$.val()))}});return!1}function writeInPreview(e){if(options.previewInElement)$(options.previewInElement).html(e);else if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(t){sp=0}previewWindow.document.open(),previewWindow.document.write(e),previewWindow.document.close(),previewWindow.document.documentElement.scrollTop=sp}}function keyPressed(e){if(shiftKey=e.shiftKey,altKey=e.altKey,ctrlKey=e.altKey&&e.ctrlKey?!1:e.ctrlKey||e.metaKey,"keydown"===e.type){if(ctrlKey===!0&&(li=$('a[accesskey="'+(13==e.keyCode?"\\n":String.fromCharCode(e.keyCode))+'"]',header).parent("li"),0!==li.length))return ctrlKey=!1,setTimeout(function(){li.triggerHandler("mouseup")},1),!1;if(13===e.keyCode||10===e.keyCode)return ctrlKey===!0?(ctrlKey=!1,markup(options.onCtrlEnter),options.onCtrlEnter.keepDefault):shiftKey===!0?(shiftKey=!1,markup(options.onShiftEnter),options.onShiftEnter.keepDefault):(markup(options.onEnter),options.onEnter.keepDefault);if(9===e.keyCode)return!options.preventShiftTab||1!=shiftKey&&1!=ctrlKey&&1!=altKey?-1!==caretOffset?(get(),caretOffset=$$.val().length-caretOffset,console.log("caret offset"),set(caretOffset,0),caretOffset=-1,!1):(markup(options.onTab),options.onTab.keepDefault):!1}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor"),$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$),$$.data("markItUp",null)}var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;if($$=$(this),textarea=this,levels=[],abort=!1,scrollPosition=caretPosition=0,caretOffset=-1,options.previewParserPath=localize(options.previewParserPath),options.previewTemplatePath=localize(options.previewTemplatePath),method)switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}else init()})},$.fn.markItUpRemove=function(){return this.each(function(){$(this).markItUp("remove")})},$.markItUp=function(e){var t={target:!1};return $.extend(t,e),t.target?$(t.target).each(function(){$(this).focus(),$(this).trigger("insertion",[t])}):void $("textarea").trigger("insertion",[t])}}(jQuery)},function(e,t,n){var i,r;i=[n(405)],r=function(e){return new e.Application}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,function(e,t,n){var i,r;i=[n(1),n(391),n(170)],r=function(e,t,n){return e.Collection.extend({model:t,initialize:function(e,t){t=t||{},this.pullrequest=t.pullrequest},parse:function(e){return e.values},getUnsaved:function(){return this.findWhere({id:void 0})},url:function(){return"/!api/internal/repositories/{owner}/{slug}/pullrequests/{pullRequestId}/tasks/".format({owner:n.owner.username,slug:n.slug,pullRequestId:this.pullrequest.id})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405),n(409)],r=function(e,t,n){return t.ItemView.extend({template:!1,tagName:"li",className:"comment",events:{"click @ui.createTask":"createTask"},ui:{createTask:"> article .task-link"},initialize:function(){new n({el:this.$("> .task-list"),comment:this.model,collection:this.model.pullrequest.tasks}).render()},_getSelectedText:function(){var t=window.getSelection();if(t.isCollapsed)return"";var n=e(t.anchorNode),i=!!n.closest(".comment-content").length,r=this.$el.is(n.closest(".comment"));return i&&r?t.toString():""},createTask:function(e){e&&e.preventDefault(),this.model.pullrequest.createTask({content:this._getSelectedText(),comment:this.model})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(410),n(414)],r=function(e,t){return t.extend({childView:e,initialize:function(e){this.comment=e.comment},shouldCreateChild:function(e){return e.get("comment").id===this.comment.id},getChildElement:function(e){return this.$("#task-{}".format(e.id))},addChild:function(e){if(this.shouldCreateChild(e)){var n=this.getChildElement(e);if(n.length){var i=new this.childView({el:n,model:e});this.proxyChildEvents(i),this.children.add(i),i.bindUIElements()}else t.prototype.addChild.apply(this,arguments)}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(411)],r=function(e){return e.extend({id:function(){return this.model.id?"task-{}".format(this.model.id):void 0},initialize:function(){e.prototype.initialize.call(this,arguments),this.listenTo(this.model,"sync",function(){this.$el.attr("id",this.id())})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405),n(2),n(164),n(412),n(413)],r=function(e,t,n,i,r,o){return t.ItemView.extend({tagName:"li",template:"#task-template",className:function(){var e=["task","iterable-item"];return e=e.concat(this.getClassNames()),e.join(" ")},getClassNames:function(){var e=[];return this.model.get("completed")&&e.push("completed"),e},initialize:function(){this.listenTo(r.vent,"keypress:32",this.toggleStatusWithSpacebar),this.listenTo(r.vent,"keypress:111",this.goToContextWithOKey)},events:{"click @ui.contextLink":"goToTaskContext","click @ui.deleteLink":"deleteTask","click @ui.editLink":"editTask","click @ui.saveLink":"saveTask","click @ui.cancelLink":"cancelEdit","click @ui.status":"changeCompleted","input @ui.input":"setInputHeight","keydown @ui.input":"keyInput"},modelEvents:{"change:completed":"onChangeCompleted","change:content":"render",edit:"editTask"},editing:!1,ui:{status:".task-status",contextLink:".context-link",deleteLink:".delete-task",editLink:".edit-task",saveLink:".save-task",cancelLink:".cancel-edit",input:".edit-description"},templateHelpers:function(){var t=this.model.get("creator");return{editing:this.editing,isAuthenticated:i.isAuthenticated,isEditable:t&&i.username===t.username||o,hasReadAccess:"None"!==e("#user-repo-privilege-data").data("priv")}},goToTaskContext:function(){var e="task-{}".format(this.model.id);window.location.hash.substr(1)!==e&&(window.location.hash=e),r.vent.trigger("taskContextLinkClicked",this.model)},deleteTask:function(){this.model.destroy()},editTask:function(){this.editing||(this.editing=!0,this.$el.toggleClass("editing",!0),this.render()),this.focusDescription()},stopEditing:function(){this.editing=!1,this.$el.toggleClass("editing",!1),this.render()},saveTask:function(){return this.ui.input.val()?(this.model.set("content",this.ui.input.val()),this.model.hasChanged("content")&&(this.model.get("creator")||this.model.set("creator",{username:i.username}),this.model.save({},{wait:!0})),void this.stopEditing()):void this.model.destroy()},cancelEdit:function(){return this.model.get("content")?void this.stopEditing():void this.model.destroy()},setInputHeight:n.debounce(function(){var e=this.ui.input[0];e.clientHeight===e.scrollHeight&&(e.style.height=""),e.scrollHeight>e.clientHeight&&(e.style.height=e.scrollHeight+"px")},50),focusDescription:function(){this.editing&&(this.setInputHeight(),this.ui.input.focus())},changeCompleted:function(e){return this.editing?void e.preventDefault():void this.model.save("completed",this.ui.status.is(":checked"))},onChangeCompleted:function(){var e=this.model.get("completed");this.$el.toggleClass("completed",e),this.ui.status.prop("checked",e)},keyInput:function(e){13===e.which&&this.saveTask()},isFocusedForKBShortcuts:function(){return this.$el.hasClass("focused")},toggleStatusWithSpacebar:function(e){!this.editing&&this.isFocusedForKBShortcuts()&&(this.model.save("completed",!this.ui.status.is(":checked")),e.preventDefault())},goToContextWithOKey:function(){!this.editing&&this.isFocusedForKBShortcuts()&&this.goToTaskContext()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(210)],r=function(e){return e.radio.channel("pullrequests")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t="admin"===e("#user-repo-privilege-data").attr("data-priv"),n=e("#pullrequest-author").data("currentUserIsAuthor");return t||n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(411)],r=function(e,t){return e.CollectionView.extend({tagName:"ul",className:"task-list",childView:t,onAddChild:function(e){e.model.get("content")||e.editTask()},attachHtml:function(e,t){t.model.id?e.$el.append(t.el):e.$el.prepend(t.el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r,o;!function(a){r=[n(3)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e){function t(t){return e.isFunction(t)||"object"==typeof t?t:{top:t,left:t}}var n=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};return n.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},n.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(i,r,o){return"object"==typeof r&&(o=r,r=0),"function"==typeof o&&(o={onAfter:o}),"max"==i&&(i=9e9),o=e.extend({},n.defaults,o),r=r||o.duration,o.queue=o.queue&&o.axis.length>1,o.queue&&(r/=2),o.offset=t(o.offset),o.over=t(o.over),this._scrollable().each(function(){function a(e){u.animate(d,r,o.easing,e&&function(){e.call(this,c,o)})}if(null!=i){var s,l=this,u=e(l),c=i,d={},h=u.is("html,body");switch(typeof c){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(c)){c=t(c);break}if(c=h?e(c):e(c,this),!c.length)return;case"object":(c.is||c.style)&&(s=(c=e(c)).offset())}var p=e.isFunction(o.offset)&&o.offset(l,c)||o.offset;e.each(o.axis.split(""),function(e,t){var i="x"==t?"Left":"Top",r=i.toLowerCase(),f="scroll"+i,m=l[f],g=n.max(l,t);if(s)d[f]=s[r]+(h?0:m-u.offset()[r]),o.margin&&(d[f]-=parseInt(c.css("margin"+i))||0,d[f]-=parseInt(c.css("border"+i+"Width"))||0),d[f]+=p[r]||0,o.over[r]&&(d[f]+=c["x"==t?"width":"height"]()*o.over[r]);else{var v=c[r];d[f]=v.slice&&"%"==v.slice(-1)?parseFloat(v)/100*g:v}o.limit&&/^\d+$/.test(d[f])&&(d[f]=d[f]<=0?0:Math.min(d[f],g)),!e&&o.queue&&(m!=d[f]&&a(o.onAfterFirst),delete d[f])}),a(o.onAfter)}}).end()},n.max=function(t,n){var i="x"==n?"Width":"Height",r="scroll"+i;if(!e(t).is("html,body"))return t[r]-e(t)[i.toLowerCase()]();var o="client"+i,a=t.ownerDocument.documentElement,s=t.ownerDocument.body;return Math.max(a[r],s[r])-Math.min(a[o],s[o])},n})},function(e,t,n){var i,r;i=[n(3),n(2),n(306),n(417),n(429),n(147),n(439)],r=function(e,t,n,i,r,o){var a=function(e,n){this.filename_=e,this.endpoint=n,this.id_=t.uniqueId("side-by-side-")};return a.prototype.decorate=function(t){var n=e('meta[name="tab-size"]').attr("content");this.$elem_=t,this.$elem_.attr("id",this.id_),this.$container_=e('<div class="bb-sbs-patch"></div>').appendTo(this.$elem_),this.$container_.attr("id",this.id_+"-content"),n&&this.$container_.addClass("tab-size-{}".format(n)),this.enterDocument()},a.prototype.withDiff=function(t){if(this.diff_)t(this.diff_);else{var r=this;e.ajax({type:"GET",data:{filename:r.filename_,meta:!0,w:n.get("w")},dataType:"json",url:r.endpoint,success:function(e){r.diff_=i.sideBySideFromData(e[0]),r.diff_.url=r.endpoint,t(r.diff_)}})}},a.prototype.withSbsDiff=function(e){var t=this;t.sbsDiff_?e(t.sbsDiff_):t.withDiff(function(n){t.sbsDiff_=new r(n),e(t.sbsDiff_)})},a.prototype.enterDocument=function(){var t=this;this.$elem_.find("a.sbs").attr("href","#"+t.id_+"-content").fancybox({autoSize:!1,margin:30,width:"97%",height:"97%",scrolling:"no",afterShow:function(){e(this.element).trigger("sbsOpen")},afterClose:function(t){e(this.element).trigger("sbsClose")}}).bind("sbsOpen",function(e){t.onDialogOpen_.apply(t)}).bind("sbsClose",function(e){t.onDialogClose_.apply(t)})},a.prototype.handleResize=t.debounce(function(){var e=this;e.withSbsDiff(function(t){e.withDiff(function(n){t.setHeight(e.$container_.parent().height()-60-(n.hasNote()?59:0)),t.setWidth(e.$container_.parent().width())})})},400),a.prototype.onDialogOpen_=function(){var t=this;o(["atl._trackEvent","Code","Invoke SBS diff"]),e("#fancybox-wrap").css({position:"fixed",top:15,left:15}),t.withSbsDiff(function(n){t.withDiff(function(i){t.$container_.show(),n.setHeight(t.$container_.parent().height()-60-(i.hasNote()?59:0)),n.setWidth(t.$container_.parent().width()),0===t.$container_.children().length&&n.render(t.$container_),setTimeout(e.proxy(n.scrollToFirstHunk,n),0)})}),e(window).on("resize",t.handleResize.bind(t))},a.prototype.onDialogClose_=function(){this.$container_.hide(),e(window).off("resize",this.handleResize)},a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(421),n(422),n(424),n(418),n(427),n(420),n(426),n(428)],r=function(e,t,n,i,r,o,a,s,l,u){var c=function(e,t,i,r,o,a,s,l){if(!(this instanceof c))return new c(e,t,i,r,o,a,s,l);this.hunks=e,this.pagesPerBlock=t,this.linesPerPage=i,this.from=r,this.to=o,this.unifiedMap=a,this.note=s,this.url=l,this.elem_=null;try{this.diffHighlighting_(new n,e)}catch(u){}return this};return c.sideBySideFromData=function(e){for(var t=[],n=0,i=e.hunks.length;i>n;n++){var r,u=e.hunks[n];r="add"===u.type?new a(s.pointBeforeLine(u.from_start),s.ofLength(u.to_start,u.to_count),u.from_lines,u.to_lines):"mod"===u.type?a.ofLengths(u.from_start,u.from_count,u.to_start,u.to_count,u.from_lines,u.to_lines):new a(s.ofLength(u.from_start,u.from_count),s.pointBeforeLine(u.to_start),u.from_lines,u.to_lines),
u.conflict&&r.conflict(),t[n]=r}var d=e.from_pages_per_block,h=e.from_lines_per_page,p=l.unzip(t),f=new o(d,h,e.from_file,p[0]),m=new o(d,h,e.to_file,p[1]),g=e.unified_map,v=e.note;return new c(t,d,h,f,m,g,v)},c.unified=function(e){return new c(e.hunks,e.pagesPerBlock,e.linesPerPage,new u(e.hunks,e.unifiedMap,e.from,e.to,"from"),new u(e.hunks,e.unifiedMap,e.from,e.to,"to"),e.unifiedMap,e.note,e.url)},c.ofContext=function(e,t){t=Math.max(0,t);var n=new r(e.to,t);if(e.from.exists()){var i=new r(e.from,t),o=e.contextScrollPositions_(i,n);i.position=o[0],n.position=o[1]}var a=e.hunks,s=new c(e.from.exists()?e.hunksWithContext_(a,i,n):e.hunks,e.pagesPerBlock,e.linesPerPage,e.from.exists()?i:{exists:function(){return!1}},n,e.unifiedMap,e.note,e.url);return s.zeroContextHunks=a,s},c.expandSkippedSection=function(e,t){var n=e.from,i=e.to,o=new r(n.file_,l.expandAtIndex(n.rangesWithContext_,t,10,e.isUnified()?e.unifiedMap.length:n.maxLineNum)),a=new r(i.file_,l.expandAtIndex(i.rangesWithContext_,t,10,e.isUnified()?e.unifiedMap.length:i.maxLineNum)),s=e.contextScrollPositions_(o,a);o.position=s[0],a.position=s[1];var u=e.zeroContextHunks,d=new c(e.hunksWithContext_(u,o,a),e.pagesPerBlock,e.linesPerPage,o,a,e.unifiedMap,e.note,e.url);return d.zeroContextHunks=u,d},c.expandToInclude=function(t,n,i){function r(e){return e.overlaps(s.ofLine(l))}var o=t.to.file_.file_,a="from"===n?o.from2unified_:o.to2unified_,l=a[i],u=t[n].rangesWithContext_;if(e.grep(u,r).length>0)return t;for(var d=0,h=0;h<u.length;h++){var p=u[h];if(l<p.low)break;d+=1}return c.expandToInclude(c.expandSkippedSection(t,d),n,i)},c.CONTEXT_LOW=3,c.CONTEXT_MED=20,c.CONTEXT_FULL=-1,c.prototype=function(){var n=c.prototype;return n.setElement=function(e){this.elem_=e},n.getElement=function(){return this.elem_},n.ensureVisible=function(e,t){var n=this,r=new i(n.url,n.pagesPerBlock,n.linesPerPage);n.from.exists()&&n.from.queueBlocks(r,e.fromRange),n.to.queueBlocks(r,e.toRange),r.load(function(){n.from.exists()&&n.from.ensureVisible(e.fromRange),n.to.ensureVisible(e.toRange),t&&t()})},n.isUnified=function(){return this.to.isUnified()},n.filename=function(){return this.from.filename||this.to.filename},n.hasConflicts=function(){for(var e=this.zeroContextHunks||this.hunks,t=0;t<e.length;t++)if(e[t].isConflict())return!0;return!1},n.hasNote=function(){return!!this.note},n.hasDiffContent=function(){return this.hunks.length>0},n.numContext=function(){return this.from.numContext()},n.contextScrollPositions_=function(e,t){var n,i,r=[0],o=[0];for(n=1;n<=e.numLines;n++)if(i=e.viewport2file[n],"number"==typeof i){var a=e.file_.position[i];r[n]=t.file2viewport[a]}else r[n]=r[n-1]+1;for(n=1;n<=t.numLines;n++)if(i=t.viewport2file[n],"number"==typeof i){var s=t.file_.position[i];o[n]=e.file2viewport[s]}else o[n]=o[n-1]+1;return[r,o]},n.hunksWithContext_=function(e,t,n){for(var i=t.file2viewport,r=n.file2viewport,o=[],l=0;l<e.length;l++){var u=e[l],c=u.fromRange,d=u.toRange;o.push(new a(new s(i[c.low],i[c.high]),new s(r[d.low],r[d.high])))}return o},n.diffHighlighting_=function(t,n){function i(e){return r.html(e),r.text()}for(var r=e("<div>"),o=0;o<n.length;o++){var a=n[o];if(a.fromLines&&a.toLines&&a.isChange()&&!a.isConflict()){var s=t.diff_main(i(a.fromLines.join("\n")),i(a.toLines.join("\n")));t.diff_cleanupSemantic(s),a.fromRange.linesHtml=e.map(e.grep(s,e.proxy(this.isFrom_,this)),e.proxy(this.markup_,this)).join("").split("\n"),a.toRange.linesHtml=e.map(e.grep(s,e.proxy(this.isTo_,this)),e.proxy(this.markup_,this)).join("").split("\n")}}},n.isFrom_=function(e){var t=e[0];return t===DIFF_DELETE||t===DIFF_EQUAL},n.isTo_=function(e){var t=e[0];return t===DIFF_EQUAL||t===DIFF_INSERT},n.markup_=function(n){var i=n[0];return i===DIFF_EQUAL?t.escape(n[1]):e.map(n[1].split("\n"),i===DIFF_DELETE?e.proxy(this.markupRemoved_,this):e.proxy(this.markupAdded_,this)).join("\n")},n.markupRemoved_=function(e){return"<del>"+t.escape(e)+"</del>"},n.markupAdded_=function(e){return"<ins>"+t.escape(e)+"</ins>"},n.hunkBefore=function(t){var n=e.inArray(t,this.hunks);return 0>=n?null:this.hunks[n-1]},n.hunkAfter=function(t){var n=e.inArray(t,this.hunks);return 0>n||n===this.hunks.length-1?null:this.hunks[n+1]},n.hunkAfterFromLine=function(e){return this.searchHunksAfter_(function(t){return e<t.fromRange.low})},n.hunkBeforeFromLine=function(e){return this.searchHunksBefore_(function(t){return t.fromRange.low<e})},n.hunkAfterToLine=function(e){return this.searchHunksAfter_(function(t){return e<t.toRange.low})},n.hunkBeforeToLine=function(e){return this.searchHunksBefore_(function(t){return t.toRange.low<e})},n.searchHunksAfter_=function(e){for(var t=this.zeroContextHunks||this.hunks,n=0,i=t.length-1,r=null;i>=n;){var o=Math.floor((n+i)/2),a=t[o];e(a)?(r=a,i=o-1):n=o+1}return r},n.searchHunksBefore_=function(e){for(var t=this.zeroContextHunks||this.hunks,n=0,i=t.length-1,r=null;i>=n;){var o=Math.floor((n+i)/2),a=t[o];e(a)?(r=a,n=o+1):i=o-1}return r},n}(),c}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(419),n(420),n(180)],r=function(e,t,n,i){function r(t){"undefined"==typeof a&&(a=e(".gutter-box"));for(var n=0,i=a.length;i>n;++n)t(n,a.eq(n))}function o(e,t,n,i){if(!(this instanceof o))return new o(e,t,rawFileData,i);var r=n.meta;return this.numLines||(this.numLines=0),r?(this.name=r.name,this.filename=r.filename,this.position=r.position,this.numLines=r.numLines,this.maxLineNum=r.numLines,this.longestLine=r.longestLine,this.longestRevisionBlameLength=r.longestRevisionBlameLength,this.longestAuthorBlameLength=r.longestAuthorBlameLength,this.pagesPerBlock=e,this.linesPerPage=t,this.gutterWidths=r.gutterWidths,this.zeroContextRanges_=i,this.blocks={},this.blocksRendered={},this.merge(n),this.scrollBoxDom=null,this.numbersBoxDom=null,this.revisionBlameBoxDom=null,this.lineHeightPx=null,this):null}var a;return o.DELIMITER=">",o.prototype=function(){function a(t){return t.scrollBoxDom||(t.scrollBoxDom=e("#"+t.name+"-box")[0]),t.scrollBoxDom}function s(t){return t.numbersBoxDom||(t.numbersBoxDom=e("#"+t.name+"-numbers-box")[0]),t.numbersBoxDom}function l(t){return t.revisionBlameBoxDom||(t.revisionBlameBoxDom=e("#"+t.name+"-revision-blame-box")[0]),t.revisionBlameBoxDom}function u(t){return t.authorBlameBoxDom||(t.authorBlameBoxDom=e("#"+t.name+"-auth-blame-box")[0]),t.authorBlameBoxDom}function c(e,t,n,i,r){e.id=t.name+"-"+r+"-"+n+"-"+i}function d(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].numbersDom}function h(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].revBlameDom}function p(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].authBlameDom}function f(e,t,n,i){return e.pageDom_(t,n),e.blocks[t][n].gutterDom[i]}var m=o.prototype;m.isUnified=function(){return!1},m.numContext=function(){return-1},m.exists=function(){return!!this.blocks},m.merge=function(e){var t=e.block_num;t>=0&&(this.blocks[t]=e.pages)},m.queueBlocks=function(e,t){var n=this;e[n.name](n.blocksToFetch(t),n.filename).incremental(function(e,t){n.merge("from"===n.name?e:t)})},m.ensureVisible=function(e){if(this.numLines>0)for(var t=this.pagesPerBlock*this.linesPerPage,n=Math.floor((e.low-1)/t),i=Math.floor((e.high-1)/t),r=n;i>=r;r++)for(var o=r*t,a=e.low-1-o,s=Math.min(e.high-1-o,(r+1)*t-1),l=Math.floor(a/this.linesPerPage),u=Math.floor(s/this.linesPerPage),c=l;u>=c;c++)(this.isNotInDom_(r,c)||!this.pageDom_(r,c).parentNode)&&this.insertPage_(r,c)},m.blocksToFetch=function(e){for(var t=this.linesPerPage*this.pagesPerBlock,n=Math.floor(e.low/t),i=Math.floor(e.high/t),r=[],o=n;i>=o;o++)this.blocks[o]||(this.blocks[o]=this.blocksToFetch.loadingSentinel,r.push(o));return r},m.blocksToFetch.loadingSentinel={loading:!0},m.isNotInDom_=function(e,t){return this.blocks[e]&&this.blocks[e][t]&&(!this.blocksRendered[e]||!this.blocksRendered[e][t])},m.zeroContextRanges=function(){return this.zeroContextRanges_},m.coords_=function(e){var t=e-1,n=this.pagesPerBlock*this.linesPerPage,i=Math.floor(t/n),r=t%n,o=Math.floor(r/this.linesPerPage),a=r%this.linesPerPage;return{block:i,page:o,lineIndex:a}},m.insertPage_=function(t,n){var i=e(a(this)),o=e(s(this)),c=e(l(this)),m=e(u(this)),g=(t*this.pagesPerBlock+n)*this.linesPerPage*this.lineHeightPx;i[0].appendChild(e(this.pageDom_(t,n)).css("top",g).css("width",i.data("width"))[0]),o[0].appendChild(e(d(this,t,n)).css("top",g)[0]),0!==c.length&&c.children(".content-box")[0].appendChild(e(h(this,t,n)).css("top",g)[0]),0!==m.length&&m.children(".content-box")[0].appendChild(e(p(this,t,n)).css("top",g)[0]),r(function(i,r){r.children(".content-box")[0].appendChild(e(f(this,t,n,i)).css("top",g)[0])})},m.pageDom_=function(e,t){var n=this.blocks[e];if(this.isNotInDom_(e,t)){var i=this.evalPage_(e,t),r=this.createPageDom_(i),o=g(this,e,t,i),a=e*this.pagesPerBlock+t;r.className+=0===a?" page-first ":"",o.className+=0===a?" page-first ":"",c(r,this,e,a,"page"),c(o,this,e,a,"numbers");var s;l(this)?(s=v(this,e,t,i),c(s,this,e,a,"revision-blame")):s=document.createElement("div");var d;u(this)?(d=y(this,e,t,i),c(d,this,e,a,"auth-blame")):d=document.createElement("div");var h=b(this,e,t,i);n[t]={pageDom:r,numbersDom:o,revBlameDom:s,authBlameDom:d,gutterDom:h}}return n[t].pageDom},m.evalPage_=function(t,i){for(var r=(t*this.pagesPerBlock+i)*this.linesPerPage+1,o=n.ofLength(r,this.linesPerPage),a=e.grep(this.zeroContextRanges(),function(e){return o.overlaps(e)}),s=this.blocks[t][i],l=0;l<a.length;l++){var u=a[l];if(u.linesHtml)for(var c=0;c<u.length;c++){var d=u.low+c,h=d-r;h>=0&&h<this.linesPerPage&&(s[d-r].html=u.linesHtml[c])}}return this.blocksRendered[t]=this.blocksRendered[t]||{},this.blocksRendered[t][i]=!0,s},m.createPageDom_=function(e){var t=document.createElement("div");t.className="page";for(var n=0,i=e.length;i>n;n++)t.appendChild(w(e[n]));return t},m.permalinker_=new t;var g=function(e,t,n,i){var r=document.createElement("div"),o=(t*e.pagesPerBlock+n)*e.linesPerPage+1;r.className="page line-numbers";for(var a=0,s=i.length;s>a;a++){var l=o+a,u=e.permalinker_.url(e.name,e.filename,l),c=w(i[a],'<a href="'+u+'">'+l+"</a>");r.appendChild(c)}return r},v=function(){return function(e,t,n,i){var r=document.createElement("div");r.className="page revision-blame";for(var o=0,a=i.length;a>o;o++){var s=w(i[o],"<span>"+(i[o].start?i[o].revision:"&nbsp;")+"</span>",[i[o].blameclass]);r.appendChild(s)}return r}}(),y=function(){return function(e,t,n,i){var r=document.createElement("div");r.className="page author-blame";for(var o=0,a=i.length;a>o;o++){var s=w(i[o],"<span>"+(i[o].start?i[o].author:"&nbsp;")+"</span>");r.appendChild(s)}return r}}(),b=function(){return function(e,t,n,i){for(var r=[],o=0;o<i[0].gutters.length;++o){r[o]=document.createElement("div");for(var a=0,s=i.length;s>a;a++){var l=w(i[a],i[a].gutters[o]);r[o].appendChild(l)}}return r}}(),w=function(){var e=["addition","change","deletion","conflict","start","end"],t=null,n=null;if(t=function(){var e=document.createElement("div");return"undefined"!=typeof e.innerText?"innerText":"textContent"}(),"Explorer"===i.browser){var r=document.createElement("div");n=function(e){var t=r;return t.innerHTML="<pre>"+e+"</pre>",t.removeChild(t.firstChild)}}else n=function(e){var t=document.createElement("pre");return t.innerHTML=e,t};return function(t,i,r){for(var o=n((i||t.html)+"\n"),a=[],s=0,l=e.length;l>s;s++){var u=e[s];t[u]&&a.push(u)}for(r=r||[],s=0,l=r.length;l>s;s++)a.push(r[s]);var c=a.join(" ");return c&&(o.className=c),o}}();return m.longestLineDom=function(){return w(this.longestLine)},m}(),o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){var e=function(){this.baseUrl_=window.top.location.href.replace(location.hash,"")};return e.prototype.regex_=/^#chg_(.*)_(newline|oldline)(\d+)$/,e.prototype.parse=function(e){var t=this.regex_.exec(e);return t?{path:t[1],file:"oldline"===t[2]?"from":"to",line:parseInt(t[3],10)}:void 0},e.prototype.url=function(e,t,n){return this.baseUrl_+"#chg_"+encodeURIComponent(t)+"_"+("from"===e?"oldline":"newline")+n},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){var e=function(t,n){return this instanceof e?(this.low=t,this.high=n,this.length=n-t+1,this):new e(t,n)};return e.ofLength=function(t,n){return new e(t,t+n-1)},e.ofLine=function(t){return e.ofLength(t,1)},e.ofLines=function(t,n){return new e(t,n)},e.pointAfterLine=function(t){return new e(t,t-1)},e.pointBeforeLine=function(t){return e.pointAfterLine(t-1)},e.prototype={constructor:e,isPoint:function(){return this.low-1===this.high},before:function(e){return this.isPoint()&&e.isPoint()?this.high<e.low:this.isPoint()?this.low<=e.low-1:e.isPoint()?this.high<=e.low:this.high<e.low},after:function(e){return e.before(this)},overlaps:function(e){return this.isPoint()&&e.isPoint()?this.equals(e):this.isPoint()?e.overlaps(this):e.isPoint()?this.low-1<=e.low&&e.low<=this.high:this.low<=e.high&&e.low<=this.high},adjacent:function(e){return this.isPoint()&&e.isPoint()?this.equals(e):this.isPoint()?this.low+1===e.low||this.low===e.high:e.isPoint()?e.adjacent(this):this.high+1===e.low||e.low+1===this.high},expand:function(t){if(0===t)return this;var n,i;return this.isPoint()?(n=Math.max(1,this.low-(t-1)),i=this.low+t):(n=Math.max(1,this.low-t),i=this.high+t),new e(n,i)},merge:function(t){if(this.isPoint()&&t.isPoint())return this.equals(t)?this:null;if(this.isPoint())return t.merge(this);if(t.isPoint())return this.overlaps(t)||this.adjacent(t)?this:null;if(this.overlaps(t)||this.adjacent(t)){var n=Math.min(this.low,t.low),i=Math.max(this.high,t.high);return new e(n,i)}return null},equals:function(e){return this.low===e.low&&this.high===e.high},toString:function(){return"["+this.low+", "+this.high+"]"}},e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t){!function(){function e(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}e.prototype.diff_main=function(e,t,n,i){if("undefined"==typeof i&&(i=0>=this.Diff_Timeout?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout),null==e||null==t)throw Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];"undefined"==typeof n&&(n=!0);var r=n,o=this.diff_commonPrefix(e,t);n=e.substring(0,o),e=e.substring(o),t=t.substring(o);var o=this.diff_commonSuffix(e,t),a=e.substring(e.length-o);return e=e.substring(0,e.length-o),t=t.substring(0,t.length-o),e=this.diff_compute_(e,t,r,i),n&&e.unshift([0,n]),a&&e.push([0,a]),this.diff_cleanupMerge(e),e},e.prototype.diff_compute_=function(e,t,n,i){if(!e)return[[1,t]];if(!t)return[[-1,e]];var r=e.length>t.length?e:t,o=e.length>t.length?t:e,a=r.indexOf(o);return-1!=a?(n=[[1,r.substring(0,a)],[0,o],[1,r.substring(a+o.length)]],e.length>t.length&&(n[0][0]=n[2][0]=-1),n):1==o.length?[[-1,e],[1,t]]:(r=this.diff_halfMatch_(e,t))?(o=r[0],e=r[1],a=r[2],t=r[3],r=r[4],o=this.diff_main(o,a,n,i),n=this.diff_main(e,t,n,i),o.concat([[0,r]],n)):n&&100<e.length&&100<t.length?this.diff_lineMode_(e,t,i):this.diff_bisect_(e,t,i)},e.prototype.diff_lineMode_=function(e,t,n){var i=this.diff_linesToChars_(e,t);e=i.chars1,t=i.chars2,i=i.lineArray,e=this.diff_main(e,t,!1,n),this.diff_charsToLines_(e,i),this.diff_cleanupSemantic(e),e.push([0,""]);for(var r=i=t=0,o="",a="";t<e.length;){switch(e[t][0]){case 1:r++,a+=e[t][1];break;case-1:i++,o+=e[t][1];break;case 0:if(i>=1&&r>=1){for(e.splice(t-i-r,i+r),t=t-i-r,i=this.diff_main(o,a,!1,n),r=i.length-1;r>=0;r--)e.splice(t,0,i[r]);t+=i.length}i=r=0,a=o=""}t++}return e.pop(),e},e.prototype.diff_bisect_=function(e,t,n){for(var i=e.length,r=t.length,o=Math.ceil((i+r)/2),a=o,s=2*o,l=Array(s),u=Array(s),c=0;s>c;c++)l[c]=-1,u[c]=-1;l[a+1]=0,u[a+1]=0;for(var c=i-r,d=0!=c%2,h=0,p=0,f=0,m=0,g=0;o>g&&!((new Date).getTime()>n);g++){for(var v=-g+h;g-p>=v;v+=2){var y,b=a+v;y=v==-g||v!=g&&l[b-1]<l[b+1]?l[b+1]:l[b-1]+1;for(var w=y-v;i>y&&r>w&&e.charAt(y)==t.charAt(w);)y++,w++;if(l[b]=y,y>i)p+=2;else if(w>r)h+=2;else if(d&&(b=a+c-v,b>=0&&s>b&&-1!=u[b])){var x=i-u[b];if(y>=x)return this.diff_bisectSplit_(e,t,y,w,n)}}for(v=-g+f;g-m>=v;v+=2){for(b=a+v,x=v==-g||v!=g&&u[b-1]<u[b+1]?u[b+1]:u[b-1]+1,y=x-v;i>x&&r>y&&e.charAt(i-x-1)==t.charAt(r-y-1);)x++,y++;if(u[b]=x,x>i)m+=2;else if(y>r)f+=2;else if(!d&&(b=a+c-v,b>=0&&s>b&&-1!=l[b]&&(y=l[b],w=a+y-b,x=i-x,y>=x)))return this.diff_bisectSplit_(e,t,y,w,n)}}return[[-1,e],[1,t]]},e.prototype.diff_bisectSplit_=function(e,t,n,i,r){var o=e.substring(0,n),a=t.substring(0,i);return e=e.substring(n),t=t.substring(i),o=this.diff_main(o,a,!1,r),r=this.diff_main(e,t,!1,r),o.concat(r)},e.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,a=i.length;o<e.length-1;){o=e.indexOf("\n",n),-1==o&&(o=e.length-1);var s=e.substring(n,o+1),n=o+1;(r.hasOwnProperty?r.hasOwnProperty(s):void 0!==r[s])?t+=String.fromCharCode(r[s]):(t+=String.fromCharCode(a),r[s]=a,i[a++]=s)}return t}var i=[],r={};i[0]="";var o=n(e),a=n(t);return{chars1:o,chars2:a,lineArray:i}},e.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var i=e[n][1],r=[],o=0;o<i.length;o++)r[o]=t[i.charCodeAt(o)];e[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(o,r)==t.substring(o,r)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;if(n>i?e=e.substring(n-i):i>n&&(t=t.substring(0,n)),n=Math.min(n,i),e==t)return n;for(var i=0,r=1;;){var o=e.substring(n-r),o=t.indexOf(o);if(-1==o)return i;r+=o,(0==o||e.substring(n-r)==t.substring(0,r))&&(i=r,r++)}},e.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var i,r,o,s,l=e.substring(n,n+Math.floor(e.length/4)),u=-1,c="";-1!=(u=t.indexOf(l,u+1));){var d=a.diff_commonPrefix(e.substring(n),t.substring(u)),h=a.diff_commonSuffix(e.substring(0,n),t.substring(0,u));c.length<h+d&&(c=t.substring(u-h,u)+t.substring(u,u+d),i=e.substring(0,n-h),r=e.substring(n+d),o=t.substring(0,u-h),s=t.substring(u+d))}return 2*c.length>=e.length?[i,r,o,s,c]:null}if(0>=this.Diff_Timeout)return null;var i=e.length>t.length?e:t,r=e.length>t.length?t:e;if(4>i.length||2*r.length<i.length)return null;var o,a=this,s=n(i,r,Math.ceil(i.length/4)),i=n(i,r,Math.ceil(i.length/2));if(!s&&!i)return null;o=i?s&&s[4].length>i[4].length?s:i:s;var l;return e.length>t.length?(s=o[0],i=o[1],r=o[2],l=o[3]):(r=o[0],l=o[1],s=o[2],i=o[3]),o=o[4],[s,i,r,l,o]},e.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],i=0,r=null,o=0,a=0,s=0,l=0,u=0;o<e.length;)0==e[o][0]?(n[i++]=o,a=l,s=u,u=l=0,r=e[o][1]):(1==e[o][0]?l+=e[o][1].length:u+=e[o][1].length,r&&r.length<=Math.max(a,s)&&r.length<=Math.max(l,u)&&(e.splice(n[i-1],0,[-1,r]),e[n[i-1]+1][0]=1,i--,i--,o=i>0?n[i-1]:-1,u=l=s=a=0,r=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;)-1==e[o-1][0]&&1==e[o][0]&&(t=e[o-1][1],n=e[o][1],i=this.diff_commonOverlap_(t,n),r=this.diff_commonOverlap_(n,t),i>=r?(i>=t.length/2||i>=n.length/2)&&(e.splice(o,0,[0,n.substring(0,i)]),e[o-1][1]=t.substring(0,t.length-i),e[o+1][1]=n.substring(i),o++):(r>=t.length/2||r>=n.length/2)&&(e.splice(o,0,[0,t.substring(0,r)]),e[o-1][0]=1,e[o-1][1]=n.substring(0,n.length-r),e[o+1][0]=-1,e[o+1][1]=t.substring(r),o++),o++),o++},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),o=i.match(e.nonAlphaNumericRegex_),a=r.match(e.nonAlphaNumericRegex_),s=o&&i.match(e.whitespaceRegex_),l=a&&r.match(e.whitespaceRegex_),i=s&&i.match(e.linebreakRegex_),r=l&&r.match(e.linebreakRegex_),u=i&&t.match(e.blanklineEndRegex_),c=r&&n.match(e.blanklineStartRegex_);return u||c?5:i||r?4:o&&!s&&l?3:s||l?2:o||a?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],o=t[i][1],a=t[i+1][1],s=this.diff_commonSuffix(r,o);if(s)var l=o.substring(o.length-s),r=r.substring(0,r.length-s),o=l+o.substring(0,o.length-s),a=l+a;for(var s=r,l=o,u=a,c=n(r,o)+n(o,a);o.charAt(0)===a.charAt(0);){var r=r+o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1),d=n(r,o)+n(o,a);d>=c&&(c=d,s=r,l=o,u=a)}t[i-1][1]!=s&&(s?t[i-1][1]=s:(t.splice(i-1,1),i--),t[i][1]=l,u?t[i+1][1]=u:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\s/,e.linebreakRegex_=/[\r\n]/,e.blanklineEndRegex_=/\n\r?\n$/,e.blanklineStartRegex_=/^\r?\n\r?\n/,e.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],i=0,r=null,o=0,a=!1,s=!1,l=!1,u=!1;o<e.length;)0==e[o][0]?(e[o][1].length<this.Diff_EditCost&&(l||u)?(n[i++]=o,a=l,s=u,r=e[o][1]):(i=0,r=null),l=u=!1):(-1==e[o][0]?u=!0:l=!0,r&&(a&&s&&l&&u||r.length<this.Diff_EditCost/2&&3==a+s+l+u)&&(e.splice(n[i-1],0,[-1,r]),e[n[i-1]+1][0]=1,i--,r=null,a&&s?(l=u=!0,i=0):(i--,o=i>0?n[i-1]:-1,l=u=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},e.prototype.diff_cleanupMerge=function(e){e.push([0,""]);for(var t,n=0,i=0,r=0,o="",a="";n<e.length;)switch(e[n][0]){case 1:r++,a+=e[n][1],n++;break;case-1:i++,o+=e[n][1],n++;break;case 0:i+r>1?(0!==i&&0!==r&&(t=this.diff_commonPrefix(a,o),0!==t&&(n-i-r>0&&0==e[n-i-r-1][0]?e[n-i-r-1][1]+=a.substring(0,t):(e.splice(0,0,[0,a.substring(0,t)]),n++),a=a.substring(t),o=o.substring(t)),t=this.diff_commonSuffix(a,o),0!==t&&(e[n][1]=a.substring(a.length-t)+e[n][1],a=a.substring(0,a.length-t),o=o.substring(0,o.length-t))),0===i?e.splice(n-r,i+r,[1,a]):0===r?e.splice(n-i,i+r,[-1,o]):e.splice(n-i-r,i+r,[-1,o],[1,a]),n=n-i-r+(i?1:0)+(r?1:0)+1):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=r=0,a=o=""}for(""===e[e.length-1][1]&&e.pop(),i=!1,n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),i=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),i=!0)),n++;i&&this.diff_cleanupMerge(e)},e.prototype.diff_xIndex=function(e,t){var n,i=0,r=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(i+=e[n][1].length),-1!==e[n][0]&&(r+=e[n][1].length),!(i>t));n++)o=i,a=r;return e.length!=n&&-1===e[n][0]?a:a+(t-o)},e.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,r=/>/g,o=/\n/g,a=0;a<e.length;a++){var s=e[a][0],l=e[a][1],l=l.replace(n,"&amp;").replace(i,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(s){case 1:t[a]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case-1:t[a]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[a]="<span>"+l+"</span>"}}return t.join("")},e.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},e.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},e.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var o=e[r][0],a=e[r][1];switch(o){case 1:n+=a.length;break;case-1:i+=a.length;break;case 0:t+=Math.max(n,i),i=n=0}}return t+=Math.max(n,i)},e.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("	").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(e,t){for(var n=[],i=0,r=0,o=t.split(/\t/g),a=0;a<o.length;a++){var s=o[a].substring(1);switch(o[a].charAt(0)){case"+":try{n[i++]=[1,decodeURI(s)]}catch(l){throw Error("Illegal escape in diff_fromDelta: "+s)}break;case"-":case"=":var u=parseInt(s,10);if(isNaN(u)||0>u)throw Error("Invalid number in diff_fromDelta: "+s);s=e.substring(r,r+=u),"="==o[a].charAt(0)?n[i++]=[0,s]:n[i++]=[-1,s];break;default:if(o[a])throw Error("Invalid diff operation in diff_fromDelta: "+o[a])}}if(r!=e.length)throw Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return n},e.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},e.prototype.match_bitap_=function(e,t,n){function i(e,i){var r=e/t.length,a=Math.abs(n-i);return o.Match_Distance?r+a/o.Match_Distance:a?1:r}if(t.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),o=this,a=this.Match_Threshold,s=e.indexOf(t,n);-1!=s&&(a=Math.min(i(0,s),a),s=e.lastIndexOf(t,n+t.length),-1!=s&&(a=Math.min(i(0,s),a)));for(var l,u,c,d=1<<t.length-1,s=-1,h=t.length+e.length,p=0;p<t.length;p++){for(l=0,u=h;u>l;)i(p,n+u)<=a?l=u:h=u,u=Math.floor((h-l)/2+l);h=u,l=Math.max(1,n-u+1);var f=Math.min(n+u,e.length)+t.length;for(u=Array(f+2),u[f+1]=(1<<p)-1;f>=l;f--){var m=r[e.charAt(f-1)];if(u[f]=0===p?(u[f+1]<<1|1)&m:(u[f+1]<<1|1)&m|((c[f+1]|c[f])<<1|1)|c[f+1],u[f]&d&&(m=i(p,f-1),a>=m)){if(a=m,s=f-1,!(s>n))break;l=Math.max(1,2*n-s)}}if(i(p+1,n)>a)break;c=u}return s},e.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},e.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin,(n=t.substring(e.start2-i,e.start2))&&e.diffs.unshift([0,n]),(i=t.substring(e.start2+e.length1,e.start2+e.length1+i))&&e.diffs.push([0,i]),e.start1-=n.length,e.start2-=n.length,e.length1+=n.length+i.length,e.length2+=n.length+i.length}},e.prototype.patch_make=function(t,n,i){var r;if("string"==typeof t&&"string"==typeof n&&"undefined"==typeof i)r=t,n=this.diff_main(r,n,!0),2<n.length&&(this.diff_cleanupSemantic(n),this.diff_cleanupEfficiency(n));else if(t&&"object"==typeof t&&"undefined"==typeof n&&"undefined"==typeof i)n=t,r=this.diff_text1(n);else if("string"==typeof t&&n&&"object"==typeof n&&"undefined"==typeof i)r=t;else{if("string"!=typeof t||"string"!=typeof n||!i||"object"!=typeof i)throw Error("Unknown call format to patch_make.");r=t,n=i}if(0===n.length)return[];i=[],t=new e.patch_obj;for(var o=0,a=0,s=0,l=r,u=0;u<n.length;u++){var c=n[u][0],d=n[u][1];switch(!o&&0!==c&&(t.start1=a,t.start2=s),c){case 1:t.diffs[o++]=n[u],t.length2+=d.length,r=r.substring(0,s)+d+r.substring(s);break;case-1:t.length1+=d.length,t.diffs[o++]=n[u],r=r.substring(0,s)+r.substring(s+d.length);break;case 0:d.length<=2*this.Patch_Margin&&o&&n.length!=u+1?(t.diffs[o++]=n[u],t.length1+=d.length,t.length2+=d.length):d.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(t,l),i.push(t),t=new e.patch_obj,o=0,l=r,a=s)}1!==c&&(a+=d.length),-1!==c&&(s+=d.length)}return o&&(this.patch_addContext_(t,l),i.push(t)),i},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],o=new e.patch_obj;o.diffs=[];for(var a=0;a<r.diffs.length;a++)o.diffs[a]=r.diffs[a].slice();o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,n[i]=o}return n},e.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,r=[],o=0;o<e.length;o++){var a,s=e[o].start2+i,l=this.diff_text1(e[o].diffs),u=-1;if(l.length>this.Match_MaxBits?(a=this.match_main(t,l.substring(0,this.Match_MaxBits),s),-1!=a&&(u=this.match_main(t,l.substring(l.length-this.Match_MaxBits),s+l.length-this.Match_MaxBits),-1==u||a>=u)&&(a=-1)):a=this.match_main(t,l,s),-1==a)r[o]=!1,i-=e[o].length2-e[o].length1;else if(r[o]=!0,i=a-s,s=-1==u?t.substring(a,a+l.length):t.substring(a,u+this.Match_MaxBits),l==s)t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+l.length);else if(s=this.diff_main(l,s,!1),l.length>this.Match_MaxBits&&this.diff_levenshtein(s)/l.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(s);for(var c,l=0,u=0;u<e[o].diffs.length;u++){var d=e[o].diffs[u];0!==d[0]&&(c=this.diff_xIndex(s,l)),1===d[0]?t=t.substring(0,a+c)+d[1]+t.substring(a+c):-1===d[0]&&(t=t.substring(0,a+c)+t.substring(a+this.diff_xIndex(s,l+d[1].length))),-1!==d[0]&&(l+=d[1].length)}}}return t=t.substring(n.length,t.length-n.length),[t,r]},e.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",i=1;t>=i;i++)n+=String.fromCharCode(i);for(i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var i=e[0],r=i.diffs;if(0==r.length||0!=r[0][0])r.unshift([0,n]),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>r[0][1].length){var o=t-r[0][1].length;r[0][1]=n.substring(r[0][1].length)+r[0][1],i.start1-=o,i.start2-=o,i.length1+=o,i.length2+=o}return i=e[e.length-1],r=i.diffs,0==r.length||0!=r[r.length-1][0]?(r.push([0,n]),i.length1+=t,i.length2+=t):t>r[r.length-1][1].length&&(o=t-r[r.length-1][1].length,r[r.length-1][1]+=n.substring(0,o),i.length1+=o,i.length2+=o),n},e.prototype.patch_splitMax=function(t){for(var n=this.Match_MaxBits,i=0;i<t.length;i++)if(!(t[i].length1<=n)){var r=t[i];t.splice(i--,1);for(var o=r.start1,a=r.start2,s="";0!==r.diffs.length;){var l=new e.patch_obj,u=!0;for(l.start1=o-s.length,l.start2=a-s.length,""!==s&&(l.length1=l.length2=s.length,l.diffs.push([0,s]));0!==r.diffs.length&&l.length1<n-this.Patch_Margin;){var s=r.diffs[0][0],c=r.diffs[0][1];1===s?(l.length2+=c.length,a+=c.length,l.diffs.push(r.diffs.shift()),u=!1):-1===s&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*n?(l.length1+=c.length,o+=c.length,u=!1,l.diffs.push([s,c]),r.diffs.shift()):(c=c.substring(0,n-l.length1-this.Patch_Margin),l.length1+=c.length,o+=c.length,0===s?(l.length2+=c.length,a+=c.length):u=!1,l.diffs.push([s,c]),c==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(c.length))}s=this.diff_text2(l.diffs),s=s.substring(s.length-this.Patch_Margin),c=this.diff_text1(r.diffs).substring(0,this.Patch_Margin),""!==c&&(l.length1+=c.length,l.length2+=c.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=c:l.diffs.push([0,c])),u||t.splice(++i,0,l)}}},e.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},e.prototype.patch_fromText=function(t){var n=[];if(!t)return n;t=t.split("\n");for(var i=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<t.length;){var o=t[i].match(r);if(!o)throw Error("Invalid patch string: "+t[i]);var a=new e.patch_obj;for(n.push(a),a.start1=parseInt(o[1],10),""===o[2]?(a.start1--,a.length1=1):"0"==o[2]?a.length1=0:(a.start1--,a.length1=parseInt(o[2],10)),a.start2=parseInt(o[3],10),""===o[4]?(a.start2--,a.length2=1):"0"==o[4]?a.length2=0:(a.start2--,a.length2=parseInt(o[4],10)),i++;i<t.length;){o=t[i].charAt(0);try{var s=decodeURI(t[i].substring(1))}catch(l){throw Error("Illegal escape in patch_fromText: "+s)}if("-"==o)a.diffs.push([-1,s]);else if("+"==o)a.diffs.push([1,s]);else if(" "==o)a.diffs.push([0,s]);else{if("@"==o)break;if(""!==o)throw Error('Invalid patch mode "'+o+'" in: '+s)}i++}}return n},e.patch_obj=function(){this.diffs=[],this.start2=this.start1=null,this.length2=this.length1=0},e.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2,e=["@@ -"+e+" +"+t+" @@\n"];var n;for(t=0;t<this.diffs.length;t++){switch(this.diffs[t][0]){case 1:n="+";break;case-1:n="-";break;case 0:n=" "}e[t+1]=n+encodeURI(this.diffs[t][1])+"\n"}return e.join("").replace(/%20/g," ")},this.diff_match_patch=e,this.DIFF_DELETE=-1,this.DIFF_INSERT=1,this.DIFF_EQUAL=0}()},function(e,t,n){
var i,r;i=[n(3),n(423),n(170),n(165)],r=function(e,t,n,i){function r(o,a,s){if(!(this instanceof r))return new r(o,a,s);this.pagesPerBlock_=a,this.linesPerPage_=s,this.blocks_={from:[],to:[]},this.filename_={from:"",to:""},this.incremental_=[];var l=i.concat("repositories",n.owner.username,n.slug,"changesets",t,"diff");return e("#compare")&&e("#compare").data("compare-files-url")&&(l=e("#compare").data("compare-files-url")),this.url_=o||l.toString(),this}return r.prototype=function(){var t=r.prototype;return t.queueBlocks_=function(t,n){for(var i=0;i<n.length;i++){var r=n[i],o=this.blocks_[t];e.inArray(r,o)<0&&o.push(r)}},t.from=function(e,t){return this.queueBlocks_("from",e),this.filename_.from=t,this},t.to=function(e,t){return this.queueBlocks_("to",e),this.filename_.to=t,this},t.incremental=function(e){return this.incremental_.push(e),this},t.load=function(t){if(this.complete_=t,0===this.blocks_.from.length&&0===this.blocks_.to.length)t&&t();else{var n=this.filename_.from||this.filename_.to;e(document).trigger("diff-load-start",[n]),e.ajax({type:"GET",url:this.url_,data:{linesPerPage:this.linesPerPage_,fromBlock:this.blocks_.from.shift(),toBlock:this.blocks_.to.shift(),filename:n},dataType:"json",success:e.proxy(this.success_,this)})}},t.success_=function(t){var n=this.filename_.from||this.filename_.to;e(document).trigger("diff-load-end",[n]);for(var i=t[0],r=i.from_file,o=i.to_file,a=0;a<this.incremental_.length;a++)this.incremental_[a](r,o);this.load(this.complete_)},t}(),r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).attr("data-current-cset");return t||""}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(418),n(425),n(420),n(426)],r=function(e,t,n,i,r){function o(e,t){if(!(this instanceof o))return new o(e,i);if("number"==typeof t){var i=Math.max(0,t);this.rangesWithContext_=r.expand(e.zeroContextRanges(),i)}else this.rangesWithContext_=t;return this.file_=n.of(e),this.viewport2file=this.calculateViewport2File(),this.file2viewport=this.calculateFile2Viewport(this.viewport2file),this.name=e.name,this.filename=e.filename,this.position=null,this.pagesPerBlock=e.pagesPerBlock,this.linesPerPage=e.linesPerPage,this.numLines=this.viewport2file.length-1,this.maxLineNum=this.viewport2file[this.viewport2file.length-1],"number"!=typeof this.maxLineNum&&(this.maxLineNum=this.viewport2file[this.viewport2file.length-2]),this.lineHeightPx=this.file_.lineHeightPx,this.blocks={},this}return o.prototype=function(){function n(e,t,n,i,r){e.id=t.name+"-"+r+"-"+n+"-"+i}var r=o.prototype;return r.isUnified=function(){return this.file_.isUnified()},r.numContext=function(){return this.context},r.calculateViewport2File=function(){for(var e=this.rangesWithContext_,t=[0],n=0,i=0;i<e.length;i++){var r=e[i];0===i&&r.low>1&&t.push({type:"top",index:n++});for(var o=0;o<r.length;o++)r.low+o<=this.file_.numLines&&t.push(r.low+o);i===e.length-1?r.high<this.file_.numLines&&t.push({type:"bottom",index:n++}):e.length>1&&t.push({type:"skipped",index:n++})}return t},r.calculateFile2Viewport=function(e){var t,n,i,r,o=[0];for(i=1;i<e.length;i++){var a=e[i];if("number"==typeof a)o[a]=i;else if("top"===a.type)for(n=e[i+1],r=1;n>r;r++)o[r]=1;else if("skipped"===a.type)for(t=e[i-1],n=e[i+1],r=t+1;n>r;r++)o[r]=i;else if("bottom"===a.type)for(t=e[i-1],r=t+1;r<=this.file_.numLines;r++)o[r]=i}return o},r.exists=function(){return this.file_.file_.exists()},r.merge=function(e){return this.file_.merge(e)},r.fileRange_=function(e){var t=this.viewport2file[e];"number"!=typeof t&&(t=this.viewport2file[e.low+1]);var n=this.viewport2file[Math.min(e.high,this.numLines)];return"number"!=typeof n&&(n=this.viewport2file[Math.min(e.high-1,this.numLines-1)]),new i(t,n)},r.queueBlocks=function(e,t){var n=Math.max(1,Math.floor(t.low/this.linesPerPage)*this.linesPerPage),r=Math.ceil(t.high/this.linesPerPage)*this.linesPerPage,o=this.fileRange_(new i(n,r));return this.file_.queueBlocks(e,o)},r.ensureVisible=function(e){try{return t.prototype.ensureVisible.call(this,e)}catch(n){}},r.insertPage_=function(e,n){return t.prototype.insertPage_.call(this,e,n)},r.isNotInDom_=function(e,t){return!this.blocks[e]||!this.blocks[e][t]},r.zeroContextRanges=function(){return this.file_.zeroContextRanges()},r.pageDom_=function(t,i){this.blocks[t]=this.blocks[t]||[];var r=this.blocks[t],o=(t*this.pagesPerBlock+i)*this.linesPerPage+1,a=Math.min(o+this.linesPerPage-1,this.numLines);if(this.isNotInDom_(t,i)){var s=document.createElement("div"),l=document.createElement("div"),u=t*this.pagesPerBlock+i;n(s,this,t,u,"page"),n(l,this,t,u,"numbers"),s.className="page"+(0===u?" page-first ":""),l.className="page line-numbers"+(0===u?" page-first ":"");for(var c=o;a>=c;c++){var d=this.viewport2file[c];if("number"==typeof d){var h=this.file_.coords_(d),p=e(this.file_.pageDom_(h.block,h.page)),f=p.children()[h.lineIndex].cloneNode(!0);s.appendChild(f);var m=e(this.file_.blocks[h.block][h.page].numbersDom),g=m.children()[h.lineIndex].cloneNode(!0);l.appendChild(g)}else"top"===d.type?(s.appendChild(e('<div class="skipped-container skipped-top"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-top"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0])):"skipped"===d.type?(s.appendChild(e('<div class="skipped-container skipped-middle"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-middle"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0])):"bottom"===d.type&&(s.appendChild(e('<div class="skipped-container skipped-bottom"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-bottom"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0]))}r[i]={pageDom:s,numbersDom:l,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return r[i].pageDom},r.coords_=function(e){return t.prototype.coords_.call(this,e)},r.longestLineDom=function(){return this.file_.longestLineDom()},r}(),o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){function e(t){return this instanceof e?(this.file_=t,this.name=this.file_.name,this.filename=this.file_.filename,this.position=this.file_.position,this.numLines=this.file_.numLines,this.maxLineNum=this.file_.maxLineNum,this.pagesPerBlock=this.file_.pagesPerBlock,this.linesPerPage=this.file_.linesPerPage,this.blocks=this.file_.blocks,this.lineHeightPx=this.file_.lineHeightPx,this):new e(t)}return e.of=function(t){return t instanceof e?t:new e(t)},e.prototype=function(){var t=e.prototype;return t.isUnified=function(){return this.file_.isUnified()},t.numContext=function(){return this.file_.numContext()},t.exists=function(){return!1},t.merge=function(e){return this.file_.merge(e)},t.queueBlocks=function(e,t){return this.file_.queueBlocks(e,t)},t.ensureVisible=function(e){},t.pageDom_=function(e,t){return this.file_.pageDom_(e,t)},t.coords_=function(e){return this.file_.coords_(e)},t.blocksToFetch=function(e){return this.file_.blocksToFetch(e)},t.longestLineDom=function(){return this.file_.longestLineDom()},t.zeroContextRanges=function(){return this.file_.zeroContextRanges()},t}(),e}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(420)],r=function(e){var t={unzip:function(e){for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i];t.push(r.fromRange),n.push(r.toRange)}return[t,n]},nonEmpty:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i.length>0&&t.push(i)}return t},expand:function(e,n){for(var i=[],r=0;r<e.length;r++)i.push(e[r].expand(n));return t.merge(i)},mergeAdjacent:function(t,n,i){var r,o,a,s;return t[0].low>1?0===n?(r=[new e(1,t[0].high)],r.concat(t.slice(1))):n===t.length?(o=t[t.length-1],r=t.slice(0,t.length-1),r.push(new e(o.low,i)),r):(r=t.slice(0,n-1),a=t[n-1],s=t[n],r.push(new e(a.low,s.high)),r.concat(t.slice(n+1))):n===t.length-1?(o=t[t.length-1],r=t.slice(0,t.length-1),r.push(new e(o.low,i)),r):(r=t.slice(0,n),a=t[n],s=t[n+1],r.push(new e(a.low,s.high)),r.concat(t.slice(n+2)))},expandAtIndex:function(n,i,r,o){var a,s,l,u,c;return n[0].low>1?0===i?(s=new e(Math.max(1,n[0].low-r),n[0].high),[s].concat(n.slice(1))):i===n.length?(l=n[n.length-1],a=n.slice(0,n.length-1),a.push(new e(l.low,Math.min(l.high+r,o))),a):(a=n.slice(0,i-1),u=n[i-1],c=n[i],a.push(new e(u.low,Math.min(u.high+r,o))),a.push(new e(Math.max(c.low-r,Math.min(u.high+r,o)),c.high)),t.merge(a.concat(n.slice(i)))):i===n.length-1?(l=n[n.length-1],a=n.slice(0,n.length-1),a.push(new e(l.low,Math.min(l.high+r,o))),a):(a=n.slice(0,i),u=n[i],c=n[i+1],a.push(new e(u.low,Math.min(u.high+r,o))),a.push(new e(Math.max(c.low-r,Math.min(u.high+r,o)),c.high)),t.merge(a.concat(n.slice(i+2))))},merge:function(e){var t,n=[];if(e.length>0){for(var i=e[0],r=1;r<e.length;r++){var o=e[r];null!==(t=i.merge(o))?i=t:(n.push(i),i=o)}n.push(i)}return n}};return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(420)],r=function(e){var t=function(e,n,i,r){return this instanceof t?(this.fromRange=e,this.toRange=n,this.fromLines=i,this.toLines=r,this.conflict_=!1,this):new t(e,n)};return t.ofLengths=function(n,i,r,o,a,s){return new t(e.ofLength(n,i),e.ofLength(r,o),a,s)},t.addition=function(n,i,r){return new t(e.pointAfterLine(n),i,[],r)},t.change=function(e,n,i,r){return new t(e,n,i,r)},t.deletion=function(n,i,r){return new t(n,e.pointAfterLine(i),r,[])},t.prototype=function(){function e(e,t){for(var n=0,i=e.length-1;i>=n;){var r=Math.floor((n+i)/2),o=e[r];if(t.overlaps(o))return r;if(t.before(o))i=r-1;else{if(!t.after(o))return-1;n=r+1}}return-1}var n=t.prototype;return n.isAddition=function(){return 0===this.fromRange.length},n.isChange=function(){return this.fromRange.length>0&&this.toRange.length>0},n.isDeletion=function(){return 0===this.toRange.length},n.conflict=function(){return this.conflict_=!0,this},n.isConflict=function(){return this.conflict_},n.before=function(e){return this.fromRange.before(e.fromRange)&&this.toRange.before(e.toRange)},n.after=function(e){return this.fromRange.after(e.fromRange)&&this.toRange.after(e.toRange)},n.overlaps=function(e){return this.fromRange.overlaps(e.fromRange)||this.toRange.overlaps(e.toRange)},n.overlapping=function(t){var n=[],i=e(t,this);if(i>=0){var r,o,a;for(o=i-1;o>=0&&(r=t[o]).overlaps(this);o-=1)n.push(r);for(n.push(t[i]),o=i+1,a=t.length;a>o&&(r=t[o]).overlaps(this);o++)n.push(r)}return n},n.equals=function(e){return this.fromRange.equals(e.fromRange)&&this.toRange.equals(e.toRange)},n.toString=function(){function e(e){return 1===e.length?e.low+"":e.low+","+e.length}return function(){return"-"+e(this.fromRange)+" +"+e(this.toRange)}}(),n}(),t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(418),n(425),n(427),n(420)],r=function(e,t,n,i,r){function o(e,t,i,r,a){return this instanceof o?(this.diffHunks_=e,this.unifiedMap=t,this.from2unified_=this.calculateLineMappings_(t,0),this.to2unified_=this.calculateLineMappings_(t,1),this.zeroContextRanges_=null,this.from_=n.of(i),this.to_=n.of(r),this.renderFile_=this.from_.name===a?this.from_:this.to_,this.name=this.renderFile_.name,this.filename=this.renderFile_.filename,this.position=this.renderFile_.position,this.pagesPerBlock=this.renderFile_.pagesPerBlock,this.linesPerPage=this.renderFile_.linesPerPage,this.numLines=this.unifiedMap.length-1,this.maxLineNum=Math.max(this.from_.maxLineNum,this.to_.maxLineNum),this.lineHeightPx=this.to_.lineHeightPx,this.blocks={},this):new o(e,t,i,r,a)}return o.prototype=function(){var n=o.prototype;return n.isUnified=function(){return!0},n.numContext=function(){return this.renderFile_.numContext()},n.calculateLineMappings_=function(e,t){for(var n=[0],i=1;i<e.length;i++){var r=e[i][t];r&&(n[r]=i)}return n},n.exists=function(){return!0},n.merge=function(e){},n.queueBlocks=function(e,t){var n=this,i=Math.max(1,Math.floor(t.low/this.linesPerPage)*this.linesPerPage),o=Math.ceil(t.high/this.linesPerPage)*this.linesPerPage,a=n.diffHunk_(new r(i,o));e.from(n.from_.blocksToFetch(a.fromRange),n.from_.filename).to(n.to_.blocksToFetch(a.toRange),n.to_.filename).incremental(function(e,t){n.from_.merge(e),n.to_.merge(t)})},n.diffHunk_=function(e){for(var t=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MAX_VALUE,a=Number.MIN_VALUE,s=Math.min(this.renderFile_.numLines,e.high),l=e.low;s>=l;l++){var u=this.unifiedMap[l],c=u[0],d=u[1];c&&(t=t>c?c:t,n=c>n?c:n),d&&(o=o>d?d:o,a=d>a?d:a)}return t===Number.MAX_VALUE&&(t=0,n=0),o===Number.MAX_VALUE&&(o=0,a=0),new i(new r(t,n),new r(o,a))},n.ensureVisible=function(e){try{return t.prototype.ensureVisible.call(this,e)}catch(n){}},n.insertPage_=function(e,n){return t.prototype.insertPage_.call(this,e,n)},n.isNotInDom_=function(e,t){return!this.blocks[e]||!this.blocks[e][t]},n.zeroContextRanges=function(){if(null===this.zeroContextRanges_){for(var e=[],t=0;t<this.diffHunks_.length;t++){var n,i=this.diffHunks_[t],o=i.fromRange,a=i.toRange;i.isDeletion()?n=new r(this.from2unified_[o.low],this.from2unified_[o.high]):i.isChange()?n=new r(this.from2unified_[o.low],this.to2unified_[a.high]):i.isAddition()&&(n=new r(this.to2unified_[a.low],this.to2unified_[a.high])),e.push(n)}this.zeroContextRanges_=e}return this.zeroContextRanges_},n.pageDom_=function(t,n){this.blocks[t]=this.blocks[t]||[];var i=this.blocks[t],r=(t*this.pagesPerBlock+n)*this.linesPerPage+1,o=r+this.linesPerPage-1;if(this.isNotInDom_(t,n)){var a=document.createElement("div"),s=document.createElement("div"),l=t*this.pagesPerBlock+n;a.className+="page"+(0===l?" page-first ":""),s.className+="page line-numbers"+(0===l?" page-first ":"");for(var u=r;o>=u;u++){var c=this.unifiedMap[u];if(c){var d=null,h=null;(h=c[0])?d=this.from_:(h=c[1])&&(d=this.to_);var p=d.coords_(h),f=e(d.pageDom_(p.block,p.page)),m=f.children()[p.lineIndex].cloneNode(!0);/\bchange\b/.test(m.className)&&(m.className+=" "+d.name),a.appendChild(m);var g=c["from"===this.renderFile_.name?0:1];if(g){var v=this.renderFile_.coords_(g);this.renderFile_.pageDom_(v.block,v.page);var y=e(this.renderFile_.blocks[v.block][v.page].numbersDom),b=y.children()[v.lineIndex].cloneNode(!0);/\bchange\b/.test(b.className)&&(b.className+=" "+this.renderFile_.name),1!==u&&1===g&&e(b).removeClass("start"),s.appendChild(b)}else{var w="from"===this.renderFile_.name?this.to_:this.from_,x=c["from"===this.renderFile_.name?1:0],_=w.coords_(x);w.pageDom_(_.block,_.page);var k=e(w.blocks[_.block][_.page].numbersDom),C=k.children()[_.lineIndex].cloneNode(!0);C.innerHTML=" ",/\bchange\b/.test(C.className)&&(C.className+=" "+w.name),1!==u&&1===x&&e(C).removeClass("start"),s.appendChild(C)}}}i[n]={pageDom:a,numbersDom:s,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return i[n].pageDom},n.coords_=function(e){return t.prototype.coords_.call(this,e)},n.longestLineDom=function(){var t=e(this.from_.longestLineDom()),n=e(this.to_.longestLineDom());return t.text().length>n.text().length?t[0]:n[0]},n}(),o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(430),n(431),n(432)],r=function(e,t,n,i){var r=function(e){this.diff_=e,this.heading_=new t(e.filename(),e.hasConflicts()),this.note_=e.hasNote()?new n(e.note):null,this.sbsDiff_=new i(e,18),this.$elem_=null};return r.prototype.createDom=function(){this.$elem_=e('<section class="bb-sbs-diff"></section>')},r.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.heading_.render(this.$elem_),this.note_&&this.note_.render(this.$elem_),this.sbsDiff_.render(this.$elem_),this.enterDocument()},r.prototype.enterDocument=function(){e(document).bind("diff-load-start",e.proxy(this.loadingStart_,this)).bind("diff-load-end",e.proxy(this.loadingEnd_,this))},r.prototype.exitDocument=function(){},r.prototype.loadingStart_=function(e,t){t===this.diff_.filename()&&this.$elem_.addClass("loading-diff")},r.prototype.loadingStart_=function(e,t){t===this.diff_.filename()&&this.$elem_.removeClass("loading-diff")},r.prototype.setWidth=function(e){this.sbsDiff_.setWidth(e)},r.prototype.setHeight=function(e){this.sbsDiff_.setHeight(e)},r.prototype.scrollToFirstHunk=function(){this.sbsDiff_.scrollToFirstHunk()},r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=function(e,t){this.filename_=e,this.conflicts_=t};return t.prototype.createDom=function(){var t=this.filename_.split("/");t=t.join('<span class="slash">/</span>'),this.$elem_=e(['<div class="heading">',"<h1></h1>","</div>"].join("")),this.$elem_.attr("id","chg-"+this.filename_).toggleClass("conflicts",this.conflicts_).find("h1").html(t)},t.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=function(e){this.note_=e,this.$elem_=null};return t.prototype.createDom=function(){this.$elem_=e(['<div class="message">',"<p></p>","</div>"].join("")),this.setNote(this.note_)},t.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t.prototype.setNote=function(e){this.note_=e,this.$elem_&&this.$elem_.find("p").text(e)},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(427),n(433),n(435),n(438)],r=function(e,t,n,i,r){var o=function(e,t){this.sbsdiff_=e,this.lineHeight=t,this.focusOffset=5,this.width_=null,this.height_=null,this.fromHunkMap_=new n(this.sbsdiff_.hunks,"from",this.sbsdiff_.from.numLines,t),this.fromFile_=new i(this.sbsdiff_.from,t),this.segments_=new r(e,t),this.toFile_=new i(this.sbsdiff_.to,t),this.toHunkMap_=new n(this.sbsdiff_.hunks,"to",this.sbsdiff_.to.numLines,t),this.$elem_=null};return o.prototype.createDom=function(){this.$elem_=e('<div class="diffract diffract-sbsdiff">'),null!==this.height_&&this.setHeight(this.height_)},o.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.fromHunkMap_.render(this.$elem_),this.fromFile_.render(this.$elem_),this.segments_.render(this.$elem_),this.toFile_.render(this.$elem_),this.toHunkMap_.render(this.$elem_),this.setWidth(this.width_),this.enterDocument()},o.prototype.setWidth=function(e){if(this.width_=e,this.$elem_){var t=30,n=18,i=e-t-n;this.fromFile_.setPaneWidth(Math.floor(i/2)-1),this.segments_.setPaneWidth(t),this.toFile_.setPaneWidth(Math.ceil(i/2)-1),1===this.$elem_.parent().length&&this.scrollbars()}},o.prototype.setHeight=function(e){this.height_=e,this.$elem_&&(this.$elem_.height(e),1===this.$elem_.parent().length&&this.scrollbars())},o.prototype.scrollbars=function(){this.fromHunkMap_.scrollbars(this.fromFile_.scrollx(),this.fromFile_.scrolly()),this.toHunkMap_.scrollbars(this.toFile_.scrollx(),this.toFile_.scrolly()),this.fromFile_.$elem_.toggleClass("all-lines-visible",!this.fromFile_.scrolly()),this.toFile_.$elem_.toggleClass("all-lines-visible",!this.toFile_.scrolly())},o.prototype.enterDocument=function(){e([this.fromFile_,this.toFile_]).bind("scrollable-file-pane/scroll",e.proxy(this.onScroll_,this)),e([this.fromHunkMap_,this.toHunkMap_]).bind("hunk-map/click",e.proxy(this.onHunkMapClick_,this))},o.prototype.exitDocument=function(){e([this.fromFile_,this.toFile_]).unbind("scrollable-file-pane/scroll"),e([this.fromHunkMap_,this.toHunkMap_]).unbind("hunk-map/click"),this.fromHunkMap_.exitDocument(),this.fromFile_.exitDocument(),this.segments_.exitDocument(),this.toFile_.exitDocument(),this.toHunkMap_.exitDocument()},o.prototype.onScroll_=function(e,n,i,r){var o=e.target,a=o===this.fromFile_?this.toFile_:this.fromFile_,s=o.file_.position,l=Math.min(n+this.focusOffset,o.numLines),u=s[l],c=s[l-1]===u,d=c?this.lineHeight:r,h=Math.max(c?0:1,u-this.focusOffset),p=a.scrollToLine(h,i,d);h=p[0],d=p[2];var f=new t(this.fromFile_.visibleRange(),this.toFile_.visibleRange());this.sbsdiff_.ensureVisible(f);var m=o===this.fromFile_;this.segments_.draw(f.overlapping(this.sbsdiff_.hunks),m?n:h,m?r:d,m?h:n,m?d:r)},o.prototype.onHunkMapClick_=function(e,t){var n=e.target===this.fromHunkMap_?this.fromFile_:this.toFile_;n.scrollToLineAndFire(t-this.focusOffset,0,0)},o.prototype.scrollToFirstHunk=function(){var e=this.sbsdiff_.hunks[0];e.isAddition()?this.toFile_.scrollToLineAndFire(e.toRange.low-this.focusOffset,0,0):this.fromFile_.scrollToLineAndFire(e.fromRange.low-this.focusOffset,0,0)},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(434)],r=function(e,t){var n=function(e,n,i,r){this.hunks=t.filter(e,function(e){return"from"===n?e.isDeletion()||e.isChange():e.isAddition()||e.isChange()}),this.numLines=i,this.lineHeight=r,this.side=n,this.$window_=null,this.$elem_=null};return n.prototype.createDom=function(){this.$window_=e(window),this.$elem_=e('<div class="hunk-map">');for(var t="from"===this.side,n=t?"<del>":"<ins>",i=0;i<this.hunks.length;i++){var r=this.hunks[i],o=t?r.fromRange:r.toRange,a=e(n).toggleClass("change",r.isChange()).toggleClass("conflict",r.isConflict()).css({top:this.percent(o.low-1)+"%",height:this.percent(o.length)+"%"});this.$elem_.append(a)}},n.prototype.percent=function(e){return e/this.numLines*100},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.enterDocument()},n.prototype.enterDocument=function(){this.$elem_.bind("click.hunk-map",e.proxy(this.onClick_,this))},n.prototype.exitDocument=function(){this.$elem_.unbind("click.hunk-map")},n.prototype.onClick_=function(t){var n=t.clientY-(this.$elem_.offset().top-this.$window_.scrollTop()),i=Math.round(n/this.$elem_.height()*this.numLines);i=Math.min(Math.max(1,i),this.numLines),e(this).trigger("hunk-map/click",[i])},n.prototype.scrollbars=function(t,n){var i=this.$elem_.parent().height(),r=e.getScrollbarWidth(),o=n?r:0,a=o+(t?r:0);this.$elem_.css({marginTop:o,height:Math.min(this.numLines*this.lineHeight,i-o-a)})},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){/*! Copyright (c) 2008 Brandon Aaron (brandon.aaron@gmail.com || http://brandonaaron.net)
	 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) 
	 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
	 */
!function(e){var t=0;e.getScrollbarWidth=function(){if(!t)if(e.browser.msie){var n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body"),i=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body");t=n.width()-i.width(),n.add(i).remove()}else{var r=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});t=100-r.width(),r.parent().remove()}return t}}(jQuery)},function(e,t,n){var i,r;i=[n(3),n(436)],r=function(e,t){var n=function(e,n){this.file_=e,this.lineHeight=n,this.numLines=e.numLines;var i=35;this.numbers_=t.scrollable(e.numLines,i,n),this.lines_=t.scrollable(e.numLines,this.file_.longestLineDom(),n),this.$elem_=null};return n.prototype.createDom=function(){this.$elem_=e('<div class="scrollable-file-pane">')},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.numbers_.render(this.$elem_),this.lines_.render(this.$elem_),this.numbers_.$elem_.addClass("scrollable-file-pane-numbers"),this.numbers_.$content().addClass("file-numbers"),this.lines_.$elem_.addClass("scrollable-file-pane-lines"),this.lines_.$content().addClass("file-lines"),this.file_.lineHeightPx=this.lineHeight,this.file_.numbersBoxDom=this.numbers_.$content()[0],this.file_.scrollBoxDom=this.lines_.$content()[0],this.enterDocument()},n.prototype.setPaneWidth=function(e){var t=35;this.numbers_.setPaneWidth(t),this.lines_.setPaneWidth(e-t)},n.prototype.scrollx=function(){return this.lines_.scrollx()},n.prototype.scrolly=function(){return this.lines_.scrolly()},n.prototype.enterDocument=function(){e(this.lines_).bind("aperture-lined-pane/scroll",e.proxy(this.onScroll_,this))},n.prototype.exitDocument=function(){e(this.lines_).unbind("aperture-lined-pane/scroll"),this.numbers_.exitDocument(),this.lines_.exitDocument()},n.prototype.onScroll_=function(t,n,i,r){this.numbers_.scrollToLine(n,i,r),e(this).trigger("scrollable-file-pane/scroll",[n,i,r])},n.prototype.scrollToLine=function(e,t,n){var i=this.lines_.scrollToLine(e,t,n);return this.numbers_.scrollToLine(i[0],i[1],i[2]),i},n.prototype.scrollToLineAndFire=function(t,n,i){var r=this.scrollToLine(t,n,i);e(this).trigger("scrollable-file-pane/scroll",r)},n.prototype.visibleRange=function(){return this.lines_.visibleRange()},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(437),n(420)],r=function(e,t,n){var i=function(e,t,n,i){this.numLines=t,this.lineHeight=i,this.pane_=new e(n,t*i)};return i.window=function(e,t,n){return new i(WindowPane,e,t,n)},i.scrollable=function(e,n,r){return new i(t,e,n,r)},i.prototype.createDom=function(){},i.prototype.render=function(e){this.createDom(),this.pane_.render(e),this.$elem_=this.pane_.$elem_,this.enterDocument()},i.prototype.enterDocument=function(){e(this.pane_).bind("aperture-pane/scroll",e.proxy(this.onScroll_,this))},i.prototype.exitDocument=function(){e(this.pane_).unbind("aperture-pane/scroll"),this.pane_.exitDocument()},i.prototype.$content=function(){return this.pane_.$content()},i.prototype.onScroll_=function(t,n,i){var r=Math.floor(i/this.lineHeight)+1,o=i-this.lineTopPx(r);e(this).trigger("aperture-lined-pane/scroll",[r,n,o])},i.prototype.setPaneWidth=function(e){this.pane_.setPaneWidth(e)},i.prototype.scrollx=function(){return this.pane_.scrollx()},i.prototype.scrolly=function(){return this.pane_.scrolly()},i.prototype.lineTopPx=function(e){return(e-1)*this.lineHeight},i.prototype.scrollToLine=function(e,t,n){var i=this.pane_.setScrollLeftNoEvent(t),r=this.pane_.setScrollTopNoEvent(this.lineTopPx(e)+n);return[Math.floor(r/this.lineHeight)+1,i,r%this.lineHeight]},i.prototype.isVisible=function(){return this.pane_.isVisible()},i.prototype.visibleRange=function(){var e=this.pane_.visibleRange();if(null===e)return null;var t=Math.floor(e.low/this.lineHeight)+1,i=Math.min(this.numLines,Math.ceil(e.high/this.lineHeight));return new n(t,i)},i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(420)],r=function(e,t){var n=function(e,t){this.contentWidth=e,this.contentHeight=t,this.scrollLeft_=0,this.scrollTop_=0,this.maxScrollLeft_=0,this.maxScrollTop_=0,this.ignoreHorizontalScrolls_=0,this.ignoreVerticalScrolls_=0,this.$elem_=null,this.$scroller_=null,this.$content_=null};return n.template_=['<div class="aperture-pane">','<div class="aperture-pane-scroller">','<div class="aperture-pane-content"></div>',"</div>","</div>"].join(""),n.prototype.createDom=function(){this.$elem_=e(n.template_),this.$scroller_=this.$elem_.find(".aperture-pane-scroller"),this.$content_=this.$scroller_.find(".aperture-pane-content")},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),"number"!=typeof this.contentWidth&&(this.$content().append(this.contentWidth),this.contentWidth=this.$elem_.width(),this.$content().empty()),this.$content().width(this.contentWidth),"number"!=typeof this.contentHeight&&(this.$content().append(this.contentHeight),this.contentHeight=this.$elem_.height(),this.$content().empty()),this.$content().height(this.contentHeight),this.setScrollBounds_(),this.enterDocument()},n.prototype.setPaneWidth=function(e){this.$elem_.width(e),this.contentWidth=this.$elem_.width(),this.setScrollBounds_()},n.prototype.setPaneHeight=function(e){this.$elem_.height(e),this.contentHeight=this.$elem_.height(),this.setScrollBounds_()},n.prototype.scrollx=function(){return this.maxScrollLeft_>0},n.prototype.scrolly=function(){return this.maxScrollTop_>0},n.prototype.setScrollBounds_=function(){var e=this.$scroller_.scrollLeft()||0,t=this.$scroller_.scrollTop()||0;this.$scroller_.scrollLeft(this.contentWidth).scrollTop(this.contentHeight),this.maxScrollLeft_=this.$scroller_.scrollLeft(),this.maxScrollTop_=this.$scroller_.scrollTop(),this.$scroller_.scrollLeft(e).scrollTop(t)},n.prototype.enterDocument=function(){this.$scroller_.bind("scroll.pane",e.proxy(this.onScroll_,this))},n.prototype.exitDocument=function(){this.$scroller_.unbind("scroll.pane")},n.prototype.$content=function(){return this.$content_},n.prototype.onScroll_=function(t){var n=this.$scroller_.scrollLeft(),i=this.$scroller_.scrollTop(),r=n!==this.scrollLeft_,o=i!==this.scrollTop_;this.scrollLeft_=n,this.scrollTop_=i,this.ignoreHorizontalScrolls_||this.ignoreVerticalScrolls_?(this.ignoreHorizontalScrolls_&&r&&(this.ignoreHorizontalScrolls_-=1),this.ignoreVerticalScrolls_&&o&&(this.ignoreVerticalScrolls_-=1)):e(this).trigger("aperture-pane/scroll",[n,i])},n.prototype.setScrollLeftNoEvent=function(e){return e=Math.max(0,Math.min(this.maxScrollLeft_,e)),this.scrollLeft_!==e&&(this.ignoreHorizontalScrolls_+=1,this.$scroller_.scrollLeft(e)),e},n.prototype.setScrollTopNoEvent=function(e){return e=Math.max(0,Math.min(this.maxScrollTop_,e)),this.scrollTop_!==e&&(this.ignoreVerticalScrolls_+=1,this.$scroller_.scrollTop(e)),e},n.prototype.isVisible=function(){return!0},n.prototype.visibleRange=function(){return t.ofLength(this.$scroller_.scrollTop(),this.$elem_.height())},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=window.SegmentPane=function(e,t){this.sbsdiff=e,this.lineHeight=t,this.width=null,this.$elem_=null,this.canvas_=null,this.visiblePaths_=[]};return t.prototype.createDom=function(){this.$elem_=e('<div class="segment-pane">');var t=document.createElement("canvas");this.$elem_.append(t),this.canvas_=t,null!==this.width&&this.setPaneWidth(this.width)},t.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t.prototype.setPaneWidth=function(e){this.width!==e&&(this.width=e,null!==this.$elem_&&(this.$elem_.width(e),this.height=this.$elem_.height(),this.canvas_.width=e,this.canvas_.height=this.$elem_.height()))},t.STROKE="#ccc",t.prototype.add_={stroke:"#ddffdd",fill:"#ddffdd"},t.prototype.del_={stroke:"#fee8e9",fill:"#fee8e9"},t.prototype.mod_={stroke:"#f5f5f5",fill:"#f5f5f5"},t.prototype.con_={stroke:"#ffffdf",fill:"#ffffdf"},t.prototype.border_={stroke:"#ccc",fill:"#ccc"},t.prototype.rangeY=function(e,t,n){var i=this.lineHeight,r=(e.low-t)*i-n+1,o=(e.high-t)*i-n+1+i;return r===o&&(r+=i,o=r),[r,o]},t.prototype.draw=function(e,t,n,i,r){var o,a,s=this.canvas_.getContext("2d"),l=this.width,u=this.height;for(s.clearRect(0,0,l+1,u+1),s.setTransform(1,0,0,1,-.5,-.5),o=0,a=e.length;a>o;o++){var c=e[o],d=(c.fromRange,c.toRange,this.rangeY(c.fromRange,t,n)),h=this.rangeY(c.toRange,i,r);if(c.isConflict()){var p=this.sbsdiff.hunkBefore(c),f=this.sbsdiff.hunkAfter(c);if(c.isConflictStart=f&&f.isConflict()&&f.isChange(),c.isEntireConflict=!(p&&p.isConflict()&&p.isChange()||f&&f.isConflict()&&f.isChange()),c.isConflictStart){var m=this.rangeY(f.fromRange,t,n),g=this.rangeY(f.toRange,i,r);d[1]=m[1],h[1]=g[1]}else if(!c.isEntireConflict)continue}c.isConflict()?s.fillStyle=this.con_.fill:c.isAddition()?s.fillStyle=this.add_.fill:c.isDeletion()?s.fillStyle=this.del_.fill:s.fillStyle=this.mod_.fill,s.strokeStyle=this.border_.stroke,s.beginPath(),s.moveTo(0,d[0]),s.bezierCurveTo(l/2,d[0],l/2,h[0],l+1,h[0]),s.lineTo(l+1,h[1]),s.bezierCurveTo(l/2,h[1],l/2,d[1],0,d[1]),s.lineTo(0,d[0]),s.fill(),s.beginPath(),s.moveTo(0,d[0]),s.bezierCurveTo(l/2,d[0],l/2,h[0],l+1,h[0]),s.moveTo(l+1,h[1]),s.bezierCurveTo(l/2,h[1],l/2,d[1],0,d[1]),s.stroke()}},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){!function(e,t,n,i){"use strict";var r=n("html"),o=n(e),a=n(t),s=n.fancybox=function(){s.open.apply(this,arguments)},l=navigator.userAgent.match(/msie/i),u=null,c=t.createTouch!==i,d=function(e){return e&&e.hasOwnProperty&&e instanceof n},h=function(e){return e&&"string"===n.type(e)},p=function(e){return h(e)&&e.indexOf("%")>0},f=function(e){return e&&!(e.style.overflow&&"hidden"===e.style.overflow)&&(e.clientWidth&&e.scrollWidth>e.clientWidth||e.clientHeight&&e.scrollHeight>e.clientHeight)},m=function(e,t){var n=parseInt(e,10)||0;return t&&p(e)&&(n=s.getViewport()[t]/100*n),Math.ceil(n)},g=function(e,t){return m(e,t)+"px"};n.extend(s,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!c,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(l?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>',loading:'<div id="fancybox-loading"><div></div></div>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeChange:n.noop,beforeClose:n.noop,afterClose:n.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(e,t){return e&&(n.isPlainObject(t)||(t={}),!1!==s.close(!0))?(n.isArray(e)||(e=d(e)?n(e).get():[e]),n.each(e,function(r,o){var a,l,u,c,p,f,m,g={};"object"===n.type(o)&&(o.nodeType&&(o=n(o)),d(o)?(g={href:o.data("fancybox-href")||o.attr("href"),title:n("<div/>").text(o.data("fancybox-title")||o.attr("title")||"").html(),isDom:!0,element:o},n.metadata&&n.extend(!0,g,o.metadata())):g=o),a=t.href||g.href||(h(o)?o:null),l=t.title!==i?t.title:g.title||"",u=t.content||g.content,c=u?"html":t.type||g.type,!c&&g.isDom&&(c=o.data("fancybox-type"),c||(p=o.prop("class").match(/fancybox\.(\w+)/),c=p?p[1]:null)),h(a)&&(c||(s.isImage(a)?c="image":s.isSWF(a)?c="swf":"#"===a.charAt(0)?c="inline":h(o)&&(c="html",u=o)),"ajax"===c&&(f=a.split(/\s+/,2),a=f.shift(),m=f.shift())),u||("inline"===c?a?u=n(h(a)?a.replace(/.*(?=#[^\s]+$)/,""):a):g.isDom&&(u=o):"html"===c?u=a:c||a||!g.isDom||(c="inline",u=o)),n.extend(g,{href:a,type:c,content:u,title:l,selector:m}),e[r]=g}),s.opts=n.extend(!0,{},s.defaults,t),t.keys!==i&&(s.opts.keys=t.keys?n.extend({},s.defaults.keys,t.keys):!1),s.group=e,s._start(s.opts.index)):void 0},cancel:function(){var e=s.coming;e&&!1===s.trigger("onCancel")||(s.hideLoading(),e&&(s.ajaxLoad&&s.ajaxLoad.abort(),s.ajaxLoad=null,s.imgPreload&&(s.imgPreload.onload=s.imgPreload.onerror=null),e.wrap&&e.wrap.stop(!0,!0).trigger("onReset").remove(),s.coming=null,s.current||s._afterZoomOut(e)))},close:function(e){s.cancel(),!1!==s.trigger("beforeClose")&&(s.unbindEvents(),s.isActive&&(s.isOpen&&e!==!0?(s.isOpen=s.isOpened=!1,s.isClosing=!0,n(".fancybox-item, .fancybox-nav").remove(),s.wrap.stop(!0,!0).removeClass("fancybox-opened"),s.transitions[s.current.closeMethod]()):(n(".fancybox-wrap").stop(!0).trigger("onReset").remove(),s._afterZoomOut())))},play:function(e){var t=function(){clearTimeout(s.player.timer)},n=function(){t(),s.current&&s.player.isActive&&(s.player.timer=setTimeout(s.next,s.current.playSpeed))},i=function(){t(),a.unbind(".player"),s.player.isActive=!1,s.trigger("onPlayEnd")},r=function(){s.current&&(s.current.loop||s.current.index<s.group.length-1)&&(s.player.isActive=!0,a.bind({"onCancel.player beforeClose.player":i,"onUpdate.player":n,"beforeLoad.player":t}),n(),s.trigger("onPlayStart"))};e===!0||!s.player.isActive&&e!==!1?r():i()},next:function(e){var t=s.current;t&&(h(e)||(e=t.direction.next),s.jumpto(t.index+1,e,"next"))},prev:function(e){var t=s.current;t&&(h(e)||(e=t.direction.prev),s.jumpto(t.index-1,e,"prev"))},jumpto:function(e,t,n){var r=s.current;r&&(e=m(e),s.direction=t||r.direction[e>=r.index?"next":"prev"],s.router=n||"jumpto",r.loop&&(0>e&&(e=r.group.length+e%r.group.length),e%=r.group.length),r.group[e]!==i&&(s.cancel(),s._start(e)))},reposition:function(e,t){var i,r=s.current,o=r?r.wrap:null;o&&(i=s._getPosition(t),e&&"scroll"===e.type?(delete i.position,o.stop(!0,!0).animate(i,200)):(o.css(i),r.pos=n.extend({},r.dim,i)))},update:function(e){var t=e&&e.originalEvent&&e.originalEvent.type,n=!t||"orientationchange"===t;n&&(clearTimeout(u),u=null),s.isOpen&&!u&&(u=setTimeout(function(){var i=s.current;i&&!s.isClosing&&(s.wrap.removeClass("fancybox-tmp"),(n||"load"===t||"resize"===t&&i.autoResize)&&s._setDimension(),"scroll"===t&&i.canShrink||s.reposition(e),s.trigger("onUpdate"),u=null)},n&&!c?0:300))},toggle:function(e){s.isOpen&&(s.current.fitToView="boolean"===n.type(e)?e:!s.current.fitToView,c&&(s.wrap.removeAttr("style").addClass("fancybox-tmp"),s.trigger("onUpdate")),s.update())},hideLoading:function(){a.unbind(".loading"),n("#fancybox-loading").remove()},showLoading:function(){var e,t;s.hideLoading(),e=n(s.opts.tpl.loading).click(s.cancel).appendTo("body"),a.bind("keydown.loading",function(e){27===(e.which||e.keyCode)&&(e.preventDefault(),s.cancel())}),s.defaults.fixed||(t=s.getViewport(),e.css({position:"absolute",top:.5*t.h+t.y,left:.5*t.w+t.x})),s.trigger("onLoading")},getViewport:function(){var t=s.current&&s.current.locked||!1,n={x:o.scrollLeft(),y:o.scrollTop()};return t&&t.length?(n.w=t[0].clientWidth,n.h=t[0].clientHeight):(n.w=c&&e.innerWidth?e.innerWidth:o.width(),n.h=c&&e.innerHeight?e.innerHeight:o.height()),n},unbindEvents:function(){s.wrap&&d(s.wrap)&&s.wrap.unbind(".fb"),a.unbind(".fb"),o.unbind(".fb")},bindEvents:function(){var e,t=s.current;t&&(o.bind("orientationchange.fb"+(c?"":" resize.fb")+(t.autoCenter&&!t.locked?" scroll.fb":""),s.update),e=t.keys,e&&a.bind("keydown.fb",function(r){var o=r.which||r.keyCode,a=r.target||r.srcElement;return 27===o&&s.coming?!1:void(r.ctrlKey||r.altKey||r.shiftKey||r.metaKey||a&&(a.type||n(a).is("[contenteditable]"))||n.each(e,function(e,a){return t.group.length>1&&a[o]!==i?(s[e](a[o]),r.preventDefault(),!1):n.inArray(o,a)>-1?(s[e](),r.preventDefault(),!1):void 0}))}),n.fn.mousewheel&&t.mouseWheel&&s.wrap.bind("mousewheel.fb",function(e,i,r,o){for(var a=e.target||null,l=n(a),u=!1;l.length&&!(u||l.is(".fancybox-skin")||l.is(".fancybox-wrap"));)u=f(l[0]),l=n(l).parent();0===i||u||s.group.length>1&&!t.canShrink&&(o>0||r>0?s.prev(o>0?"down":"left"):(0>o||0>r)&&s.next(0>o?"up":"right"),e.preventDefault())}))},trigger:function(e,t){var i,r=t||s.coming||s.current;if(r){if(n.isFunction(r[e])&&(i=r[e].apply(r,Array.prototype.slice.call(arguments,1))),i===!1)return!1;r.helpers&&n.each(r.helpers,function(t,i){i&&s.helpers[t]&&n.isFunction(s.helpers[t][e])&&s.helpers[t][e](n.extend(!0,{},s.helpers[t].defaults,i),r)})}a.trigger(e)},isImage:function(e){return h(e)&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(e){return h(e)&&e.match(/\.(swf)((\?|#).*)?$/i)},_start:function(e){var t,i,r,o,a,l={};if(e=m(e),t=s.group[e]||null,!t)return!1;if(l=n.extend(!0,{},s.opts,t),o=l.margin,a=l.padding,"number"===n.type(o)&&(l.margin=[o,o,o,o]),"number"===n.type(a)&&(l.padding=[a,a,a,a]),l.modal&&n.extend(!0,l,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),l.autoSize&&(l.autoWidth=l.autoHeight=!0),"auto"===l.width&&(l.autoWidth=!0),"auto"===l.height&&(l.autoHeight=!0),l.group=s.group,l.index=e,s.coming=l,!1===s.trigger("beforeLoad"))return void(s.coming=null);if(r=l.type,i=l.href,!r)return s.coming=null,s.current&&s.router&&"jumpto"!==s.router?(s.current.index=e,s[s.router](s.direction)):!1;if(s.isActive=!0,("image"===r||"swf"===r)&&(l.autoHeight=l.autoWidth=!1,l.scrolling="visible"),"image"===r&&(l.aspectRatio=!0),"iframe"===r&&c&&(l.scrolling="scroll"),l.wrap=n(l.tpl.wrap).addClass("fancybox-"+(c?"mobile":"desktop")+" fancybox-type-"+r+" fancybox-tmp "+l.wrapCSS).appendTo(l.parent||"body"),n.extend(l,{skin:n(".fancybox-skin",l.wrap),outer:n(".fancybox-outer",l.wrap),inner:n(".fancybox-inner",l.wrap)}),n.each(["Top","Right","Bottom","Left"],function(e,t){l.skin.css("padding"+t,g(l.padding[e]))}),s.trigger("onReady"),"inline"===r||"html"===r){if(!l.content||!l.content.length)return s._error("content")}else if(!i)return s._error("href");"image"===r?s._loadImage():"ajax"===r?s._loadAjax():"iframe"===r?s._loadIframe():s._afterLoad()},_error:function(e){n.extend(s.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:e,content:s.coming.tpl.error}),s._afterLoad()},_loadImage:function(){var e=s.imgPreload=new Image;e.onload=function(){this.onload=this.onerror=null,s.coming.width=this.width/s.opts.pixelRatio,s.coming.height=this.height/s.opts.pixelRatio,s._afterLoad()},e.onerror=function(){this.onload=this.onerror=null,s._error("image")},e.src=s.coming.href,e.complete!==!0&&s.showLoading()},_loadAjax:function(){var e=s.coming;s.showLoading(),s.ajaxLoad=n.ajax(n.extend({},e.ajax,{url:e.href,error:function(e,t){s.coming&&"abort"!==t?s._error("ajax",e):s.hideLoading()},success:function(t,n){"success"===n&&(e.content=t,s._afterLoad())}}))},_loadIframe:function(){var e=s.coming,t=n(e.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",c?"auto":e.iframe.scrolling).attr("src",e.href);n(e.wrap).bind("onReset",function(){try{n(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),e.iframe.preload&&(s.showLoading(),t.one("load",function(){n(this).data("ready",1),c||n(this).bind("load.fb",s.update),n(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),s._afterLoad()})),e.content=t.appendTo(e.inner),e.iframe.preload||s._afterLoad()},_preloadImages:function(){var e,t,n=s.group,i=s.current,r=n.length,o=i.preload?Math.min(i.preload,r-1):0;for(t=1;o>=t;t+=1)e=n[(i.index+t)%r],"image"===e.type&&e.href&&((new Image).src=e.href)},_afterLoad:function(){var e,t,i,r,o,a,l=s.coming,u=s.current,c="fancybox-placeholder";if(s.hideLoading(),l&&s.isActive!==!1){if(!1===s.trigger("afterLoad",l,u))return l.wrap.stop(!0).trigger("onReset").remove(),void(s.coming=null);switch(u&&(s.trigger("beforeChange",u),u.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),s.unbindEvents(),e=l,t=l.content,i=l.type,r=l.scrolling,n.extend(s,{wrap:e.wrap,skin:e.skin,outer:e.outer,inner:e.inner,current:e,previous:u}),o=e.href,i){case"inline":case"ajax":case"html":e.selector?t=n("<div>").html(t).find(e.selector):d(t)&&(t.data(c)||t.data(c,n('<div class="'+c+'"></div>').insertAfter(t).hide()),t=t.show().detach(),e.wrap.bind("onReset",function(){n(this).find(t).length&&t.hide().replaceAll(t.data(c)).data(c,!1)}));break;case"image":t=e.tpl.image.replace(/\{href\}/g,o);break;case"swf":t='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+o+'"></param>',a="",n.each(e.swf,function(e,n){t+='<param name="'+e+'" value="'+n+'"></param>',a+=" "+e+'="'+n+'"'}),t+='<embed src="'+o+'" type="application/x-shockwave-flash" width="100%" height="100%"'+a+"></embed></object>"}d(t)&&t.parent().is(e.inner)||e.inner.append(t),s.trigger("beforeShow"),e.inner.css("overflow","yes"===r?"scroll":"no"===r?"hidden":r),s._setDimension(),s.reposition(),s.isOpen=!1,s.coming=null,s.bindEvents(),s.isOpened?u.prevMethod&&s.transitions[u.prevMethod]():n(".fancybox-wrap").not(e.wrap).stop(!0).trigger("onReset").remove(),s.transitions[s.isOpened?e.nextMethod:e.openMethod](),s._preloadImages()}},_setDimension:function(){var e,t,i,r,o,a,l,u,c,d,h,f,v,y,b,w=s.getViewport(),x=0,_=!1,k=!1,C=s.wrap,$=s.skin,S=s.inner,T=s.current,D=T.width,P=T.height,E=T.minWidth,A=T.minHeight,I=T.maxWidth,R=T.maxHeight,M=T.scrolling,j=T.scrollOutside?T.scrollbarWidth:0,L=T.margin,N=m(L[1]+L[3]),O=m(L[0]+L[2]);if(C.add($).add(S).width("auto").height("auto").removeClass("fancybox-tmp"),e=m($.outerWidth(!0)-$.width()),t=m($.outerHeight(!0)-$.height()),i=N+e,r=O+t,o=p(D)?(w.w-i)*m(D)/100:D,a=p(P)?(w.h-r)*m(P)/100:P,"iframe"===T.type){if(y=T.content,T.autoHeight&&1===y.data("ready"))try{y[0].contentWindow.document.location&&(S.width(o).height(9999),b=y.contents().find("body"),j&&b.css("overflow-x","hidden"),a=b.outerHeight(!0))}catch(U){}}else(T.autoWidth||T.autoHeight)&&(S.addClass("fancybox-tmp"),T.autoWidth||S.width(o),T.autoHeight||S.height(a),T.autoWidth&&(o=S.width()),T.autoHeight&&(a=S.height()),S.removeClass("fancybox-tmp"));if(D=m(o),P=m(a),c=o/a,E=m(p(E)?m(E,"w")-i:E),I=m(p(I)?m(I,"w")-i:I),A=m(p(A)?m(A,"h")-r:A),R=m(p(R)?m(R,"h")-r:R),l=I,u=R,T.fitToView&&(I=Math.min(w.w-i,I),R=Math.min(w.h-r,R)),f=w.w-N,v=w.h-O,T.aspectRatio?(D>I&&(D=I,P=m(D/c)),P>R&&(P=R,D=m(P*c)),E>D&&(D=E,P=m(D/c)),A>P&&(P=A,D=m(P*c))):(D=Math.max(E,Math.min(D,I)),T.autoHeight&&"iframe"!==T.type&&(S.width(D),P=S.height()),P=Math.max(A,Math.min(P,R))),T.fitToView)if(S.width(D).height(P),C.width(D+e),d=C.width(),h=C.height(),T.aspectRatio)for(;(d>f||h>v)&&D>E&&P>A&&!(x++>19);)P=Math.max(A,Math.min(R,P-10)),D=m(P*c),E>D&&(D=E,P=m(D/c)),D>I&&(D=I,P=m(D/c)),S.width(D).height(P),C.width(D+e),d=C.width(),h=C.height();else D=Math.max(E,Math.min(D,D-(d-f))),P=Math.max(A,Math.min(P,P-(h-v)));j&&"auto"===M&&a>P&&f>D+e+j&&(D+=j),S.width(D).height(P),C.width(D+e),d=C.width(),h=C.height(),_=(d>f||h>v)&&D>E&&P>A,k=T.aspectRatio?l>D&&u>P&&o>D&&a>P:(l>D||u>P)&&(o>D||a>P),n.extend(T,{dim:{width:g(d),height:g(h)},origWidth:o,origHeight:a,canShrink:_,canExpand:k,wPadding:e,hPadding:t,wrapSpace:h-$.outerHeight(!0),skinSpace:$.height()-P}),!y&&T.autoHeight&&P>A&&R>P&&!k&&S.height("auto")},_getPosition:function(e){var t=s.current,n=s.getViewport(),i=t.margin,r=s.wrap.width()+i[1]+i[3],o=s.wrap.height()+i[0]+i[2],a={position:"absolute",top:i[0],left:i[3]};return t.autoCenter&&t.fixed&&!e&&o<=n.h&&r<=n.w?a.position="fixed":t.locked||(a.top+=n.y,a.left+=n.x),a.top=g(Math.max(a.top,a.top+(n.h-o)*t.topRatio)),a.left=g(Math.max(a.left,a.left+(n.w-r)*t.leftRatio)),a},_afterZoomIn:function(){var e=s.current;e&&(s.isOpen=s.isOpened=!0,s.wrap.css("overflow","visible").addClass("fancybox-opened").hide().show(0),s.update(),(e.closeClick||e.nextClick&&s.group.length>1)&&s.inner.css("cursor","pointer").bind("click.fb",function(t){n(t.target).is("a")||n(t.target).parent().is("a")||(t.preventDefault(),s[e.closeClick?"close":"next"]())}),e.closeBtn&&n(e.tpl.closeBtn).appendTo(s.skin).bind("click.fb",function(e){e.preventDefault(),s.close()}),e.arrows&&s.group.length>1&&((e.loop||e.index>0)&&n(e.tpl.prev).appendTo(s.outer).bind("click.fb",s.prev),(e.loop||e.index<s.group.length-1)&&n(e.tpl.next).appendTo(s.outer).bind("click.fb",s.next)),s.trigger("afterShow"),e.loop||e.index!==e.group.length-1?s.opts.autoPlay&&!s.player.isActive&&(s.opts.autoPlay=!1,s.play(!0)):s.play(!1))},_afterZoomOut:function(e){e=e||s.current,n(".fancybox-wrap").trigger("onReset").remove(),n.extend(s,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),s.trigger("afterClose",e)}}),s.transitions={getOrigPosition:function(){var e=s.current,t=e.element,n=e.orig,i={},r=50,o=50,a=e.hPadding,l=e.wPadding,u=s.getViewport();return!n&&e.isDom&&t.is(":visible")&&(n=t.find("img:first"),n.length||(n=t)),d(n)?(i=n.offset(),n.is("img")&&(r=n.outerWidth(),o=n.outerHeight())):(i.top=u.y+(u.h-o)*e.topRatio,i.left=u.x+(u.w-r)*e.leftRatio),("fixed"===s.wrap.css("position")||e.locked)&&(i.top-=u.y,i.left-=u.x),i={top:g(i.top-a*e.topRatio),left:g(i.left-l*e.leftRatio),width:g(r+l),height:g(o+a)}},step:function(e,t){var n,i,r,o=t.prop,a=s.current,l=a.wrapSpace,u=a.skinSpace;("width"===o||"height"===o)&&(n=t.end===t.start?1:(e-t.start)/(t.end-t.start),s.isClosing&&(n=1-n),i="width"===o?a.wPadding:a.hPadding,r=e-i,s.skin[o](m("width"===o?r:r-l*n)),s.inner[o](m("width"===o?r:r-l*n-u*n)))},zoomIn:function(){var e=s.current,t=e.pos,i=e.openEffect,r="elastic"===i,o=n.extend({opacity:1},t);delete o.position,r?(t=this.getOrigPosition(),e.openOpacity&&(t.opacity=.1)):"fade"===i&&(t.opacity=.1),s.wrap.css(t).animate(o,{duration:"none"===i?0:e.openSpeed,easing:e.openEasing,step:r?this.step:null,complete:s._afterZoomIn})},zoomOut:function(){var e=s.current,t=e.closeEffect,n="elastic"===t,i={opacity:.1};n&&(i=this.getOrigPosition(),e.closeOpacity&&(i.opacity=.1)),s.wrap.animate(i,{duration:"none"===t?0:e.closeSpeed,easing:e.closeEasing,step:n?this.step:null,complete:s._afterZoomOut})},changeIn:function(){var e,t=s.current,n=t.nextEffect,i=t.pos,r={opacity:1},o=s.direction,a=200;i.opacity=.1,"elastic"===n&&(e="down"===o||"up"===o?"top":"left","down"===o||"right"===o?(i[e]=g(m(i[e])-a),r[e]="+="+a+"px"):(i[e]=g(m(i[e])+a),r[e]="-="+a+"px")),"none"===n?s._afterZoomIn():s.wrap.css(i).animate(r,{duration:t.nextSpeed,easing:t.nextEasing,complete:s._afterZoomIn})},changeOut:function(){var e=s.previous,t=e.prevEffect,i={opacity:.1},r=s.direction,o=200;"elastic"===t&&(i["down"===r||"up"===r?"top":"left"]=("up"===r||"left"===r?"-":"+")+"="+o+"px"),e.wrap.animate(i,{duration:"none"===t?0:e.prevSpeed,easing:e.prevEasing,complete:function(){n(this).trigger("onReset").remove()}})}},s.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!c,fixed:!0},overlay:null,fixed:!1,el:n("html"),create:function(e){var t;e=n.extend({},this.defaults,e),this.overlay&&this.close(),t=s.coming?s.coming.parent:e.parent,this.overlay=n('<div class="fancybox-overlay"></div>').appendTo(t&&t.length?t:"body"),this.fixed=!1,e.fixed&&s.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(e){var t=this;e=n.extend({},this.defaults,e),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(e),this.fixed||(o.bind("resize.overlay",n.proxy(this.update,this)),this.update()),e.closeClick&&this.overlay.bind("click.overlay",function(e){return n(e.target).hasClass("fancybox-overlay")?(s.isActive?s.close():t.close(),!1):void 0}),this.overlay.css(e.css).show()},close:function(){o.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(n(".fancybox-margin").removeClass("fancybox-margin"),this.el.removeClass("fancybox-lock"),o.scrollTop(this.scrollV).scrollLeft(this.scrollH)),n(".fancybox-overlay").remove().hide(),n.extend(this,{overlay:null,fixed:!1})},update:function(){var e,n="100%";this.overlay.width(n).height("100%"),l?(e=Math.max(t.documentElement.offsetWidth,t.body.offsetWidth),a.width()>e&&(n=a.width())):a.width()>o.width()&&(n=a.width()),this.overlay.width(n).height(a.height())},onReady:function(e,t){var i=this.overlay;n(".fancybox-overlay").stop(!0,!0),i||this.create(e),e.locked&&this.fixed&&t.fixed&&(t.locked=this.overlay.append(t.wrap),t.fixed=!1),e.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(e,t){t.locked&&!this.el.hasClass("fancybox-lock")&&(this.fixPosition!==!1&&n("*").filter(function(){return"fixed"===n(this).css("position")&&!n(this).hasClass("fancybox-overlay")&&!n(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin"),this.scrollV=o.scrollTop(),this.scrollH=o.scrollLeft(),this.el.addClass("fancybox-lock"),o.scrollTop(this.scrollV).scrollLeft(this.scrollH)),this.open(e)},onUpdate:function(){this.fixed||this.update()},afterClose:function(e){this.overlay&&!s.coming&&this.overlay.fadeOut(e.speedOut,n.proxy(this.close,this))}},s.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(e){var t,i,r=s.current,o=r.title,a=e.type;if(n.isFunction(o)&&(o=o.call(r.element,r)),h(o)&&""!==n.trim(o)){switch(t=n('<div class="fancybox-title fancybox-title-'+a+'-wrap">'+o+"</div>"),a){case"inside":i=s.skin;break;case"outside":i=s.wrap;break;case"over":i=s.inner;break;default:i=s.skin,t.appendTo("body"),l&&t.width(t.width()),t.wrapInner('<span class="child"></span>'),s.current.margin[2]+=Math.abs(m(t.css("margin-bottom")))}t["top"===e.position?"prependTo":"appendTo"](i)}}},n.fn.fancybox=function(e){var t,i=n(this),r=this.selector||"",o=function(o){var a,l,u=n(this).blur(),c=t;o.ctrlKey||o.altKey||o.shiftKey||o.metaKey||u.is(".fancybox-wrap")||(a=e.groupAttr||"data-fancybox-group",l=u.attr(a),l||(a="rel",l=u.get(0)[a]),l&&""!==l&&"nofollow"!==l&&(u=r.length?n(r):i,u=u.filter("["+a+'="'+l+'"]'),c=u.index(this)),e.index=c,s.open(u,e)!==!1&&o.preventDefault())};return e=e||{},t=e.index||0,r&&e.live!==!1?a.undelegate(r,"click.fb-start").delegate(r+":not('.fancybox-item, .fancybox-nav')","click.fb-start",o):i.unbind("click.fb-start").bind("click.fb-start",o),this.filter("[data-fancybox-start=1]").trigger("click"),this},a.ready(function(){var t,o;n.scrollbarWidth===i&&(n.scrollbarWidth=function(){var e=n('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),i=t.innerWidth()-t.height(99).innerWidth();
return e.remove(),i}),n.support.fixedPosition===i&&(n.support.fixedPosition=function(){var e=n('<div style="position:fixed;top:20px;"></div>').appendTo("body"),t=20===e[0].offsetTop||15===e[0].offsetTop;return e.remove(),t}()),n.extend(s.defaults,{scrollbarWidth:n.scrollbarWidth(),fixed:n.support.fixedPosition,parent:n("body")}),t=n(e).width(),r.addClass("fancybox-lock-test"),o=n(e).width(),r.removeClass("fancybox-lock-test"),n("<style type='text/css'>.fancybox-margin{margin-right:"+(o-t)+"px;}</style>").appendTo("head")})}(window,document,jQuery)},function(e,t,n){var i,r;i=[n(405),n(2)],r=function(e,t){return e.ItemView.extend({tagName:"button",className:"aui-button",attributes:function(){return{"aria-pressed":this.isPressed}},template:function(e){return e.text},templateHelpers:function(){var e={};return this.isPressed&&this.pressedText?e.text=this.pressedText:e.text=this.text,e},events:{click:"toggle"},initialize:function(e){e=e||{},t.isBoolean(e.isPressed)?this.isPressed=e.isPressed:this.isPressed="true"===this.$el.attr("aria-pressed"),this.text=e.text||this.text||this.$el.text(),this.pressedText=e.pressedText||this.pressedText||this.$el.data("pressed-text"),this.on("toggle",function(){this.render()})},onRender:function(){this.$el.attr(this.attributes())},toggle:function(e){return t.isBoolean(e)?this.isPressed=e:this.isPressed=!this.isPressed,this.trigger("toggle",this.isPressed),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){var t=e.split(":");return{repo:t.shift(),hash:t.shift()||null,branch:t.join(":")||null}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(){window.MathJax?window.MathJax.Hub.Typeset():(window.MathJax={TeX:{extensions:["mhchem.js"]}},e.getScript("https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(180),n(164),n(206),n(163)],r=function(e,t,n,i,r,o,a){return e.I18n.keys=e.I18n.keys||{},e.I18n.keys["aui.sidebar.expand.tooltip"]=gettext("Expand sidebar ( [ )"),e.I18n.keys["aui.sidebar.collapse.tooltip"]=gettext("Collapse sidebar ( [ )"),n(function(){function n(){return s.isCollapsed()?"Collapsed":"Expanded"}var s=e.sidebar(".aui-sidebar"),l=t(document),u=o("Repo Sidebar");t("#repo-avatar-link").on("click",function(){u("Repo Avatar - Clicked",n())}),t("#repo-owner-link").on("click",function(){u("Repo Owner - Clicked",n())}),l.on("click","#repo-clone-button",function(){u("Clone Dialog",n())}),l.on("click","#repo-fork-link",function(){u("Fork",n())}),l.on("click","#repo-compare-link",function(){u("Compare",n())}),l.on("click","#repo-create-pull-request-link",function(){u("Create Pull Request",n())}),l.on("click","#repo-create-branch-link",function(){u("Create Branch",n())}),l.on("click","#repo-clone-dialog .clone-in-sourcetree button",function(){u("Clone in Sourcetree",i.os)}),t("#repo-overview-link").on("click",function(){u("Overview",n())}),t("#repo-source-link").on("click",function(){u("Source",n())}),t("#repo-commits-link").on("click",function(){u("Commits",n())}),t("#repo-branches-link").on("click",function(){u("Branches",n())}),t("#repo-pullrequests-link").on("click",function(){u("Pull Requests",n())}),t("#repo-patch-series-link").on("click",function(){u("Patch Queue",n())}),t("#repo-issues-link").on("click",function(){u("Issues",n())}),t("#repo-wiki-link").on("click",function(){u("Wiki",n())}),t("#repo-downloads-link").on("click",function(){u("Downloads",n())}),t("#repo-settings-link").on("click",function(){u("Settings",n())}),r.isAuthenticated&&("false"!==s.$el.attr("data-aui-responsive")&&s.isViewportNarrow()&&a.set("sidebar-collapsed",s.isCollapsed()),s.on("expand-end collapse-end",function(){a.set("sidebar-collapsed",s.isCollapsed()),u("Sidebar Toggled",n())}))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(445)],r=function(e,t,n){return t(function(e){var t=e.find("a.follow");new n.Widget({el:e,repository:t.attr("data-repository")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(1),n(2),n(447),n(446),n(183),n(325),n(147),n(149)],r=function(e,t,n,i,r,o,a,s,l,u){var c=n.View.extend({events:{'click input[type="checkbox"]':"togglePreference","follow:repo a.follow":"toggleWatching"},initialize:function(n){i.bindAll(this,"togglePreference","toggleWatching","toggleDialog","watchingChanged","onHideWatchDialog"),this.watchState=n.watchState,this.listenTo(this.watchState,"change:watching",function(){setTimeout(this.watchingChanged,0)}.bind(this)),this.watchId="watch-info-"+this.model.repository.replace(/\//,"-");var r={width:450,cacheContent:!1,calculatePositions:s.alignRight()};this.watchDialog=e.InlineDialog(n.target,this.watchId,this.toggleDialog,r),this.dialogLoaded=!1,this.dataLoaded=!1,this.model.once("sync",function(){this.dataLoaded=!0}.bind(this)),this.model.once("error",function(){this.dataLoaded=!0,this.showError=!0}.bind(this)),this.unsubscribed={},t(document).bind("hideLayer",this.onHideWatchDialog)},renderDialog:function(e,t){this.setElement(e),this.showError?this.renderError():this.render(),this.dialogLoaded=!0,t()},toggleDialog:function(t,n,i){if(e.InlineDialog.current){if(e.InlineDialog.current.id===this.watchId)return setTimeout(this.watchDialog.hide,0);e.InlineDialog.current.hide()}if(this.dialogLoaded)return void i();if(this.dataLoaded)this.renderDialog(t,i);else{var r=setTimeout(function(){this.trigger("loading")}.bind(this),300),o=function(){this.renderDialog(t,i),this.trigger("loaded"),clearTimeout(r)}.bind(this);this.model.once("sync",o),this.model.once("error",function(){this.showError=!0,o()}.bind(this))}},onHideWatchDialog:function(e,t,n){"inlineDialog"===t&&n===this.watchDialog[0].popup&&((this.unsubscribed.issues||this.unsubscribed.pullrequests)&&this.model.trigger("unsubscribe"),this.unsubscribed={})},render:function(){var e=i.extend({showRepo:this.model.get("has_repo"),showWiki:this.model.get("has_wiki"),showIssues:this.model.get("has_issues")},this.watchState.attributes);return this.watchState.get("watching")&&i.extend(e,this.model.attributes),this.$el.html(u.toHtml("watch-preferences-template",e)),this.$('input[type="checkbox"]').attr("disabled",!this.watchState.get("watching")),this.$("h4.subscribe-title").toggleClass("disabled",!this.watchState.get("watching")),this.$("a.follow").attr("href",this.watchState.watchUrl),this},renderError:function(){this.$el.html(u.toHtml("preference-error-template"))},togglePreference:function(e){var n=t(e.target),i=n.attr("name"),r=n.is(":checked");n.addClass("loading"),this.model.set(i,r),this.model.save(),this.unsubscribed[i]=!r,setTimeout(function(){n.removeClass("loading")},300),l(["atl._trackEvent","Repo Preferences",i,r?"Enabled":"Disabled"])},hideDialog:function(){this.watchDialog.hide()},watchingChanged:function(){this.render()},toggleWatching:function(){this.watchState.toggle()}}),d=n.View.extend({events:{"click a.unwatch":"unwatchObjects"},initialize:function(e){i.bindAll(this,"unwatchObjects","watchingChanged","createDialogContent","unsubscribed"),this.unwatchId="unwatch-info-"+this.model.repository.replace(/\//,"-"),this.unwatchDialog=new a({width:500,height:"auto",id:this.unwatchId,closeOnOutsideClick:!1}),this.setElement("#"+this.unwatchId,!0),this.unwatchDialog.addHeader(gettext("You're still watching a few things")),this.unwatchDialog.addPanel("panel-watching"),this.unwatchDialog.addLink(gettext("Manage all notifications"),function(){return!0},"link-manage-all"),this.unwatchDialog.addButton(gettext("Okay"),function(){this.unwatchDialog.hide()}.bind(this),"confirm-stop-watch"),this.watchState=e.watchState,this.dataLoaded=!1,this.watchState.on("change:watching",this.watchingChanged),this.watchState.on("load:unwatch",this.createDialogContent),this.model.on("unsubscribe",this.unsubscribed)},createDialogContent:function(e){var n=i.extend({},e,this.watchState.attributes),r=t(u.toHtml("stop-watching-template",n));r.appendTo(this.unwatchDialog.getCurrentPanel().body),this.$(".link-manage-all").attr("href",r.data("manageAllUrl")),this.dataLoaded=!0},showUnwatchDialog:function(){if(!this.dataLoaded||0!==this.$(".watching li:not(.hidden)").length)if(this.dataLoaded)this.trigger("show:unwatch"),this.unwatchDialog.show();else{var e=setTimeout(function(){this.trigger("loading")}.bind(this),300);this.watchState.once("load:unwatch",function(){this.trigger("loaded"),clearTimeout(e),this.trigger("show:unwatch"),this.unwatchDialog.show()}.bind(this))}},unsubscribed:function(){(!this.model.get("pullrequests")||this.model.get("has_issues")&&!this.model.get("issues"))&&this.showUnwatchDialog()},watchingChanged:function(){this.watchState.get("watching")||this.showUnwatchDialog()},unwatchObjects:function(e){function n(){clearTimeout(i),r.removeClass("loading"),r.prop("disabled",!1),r.closest("li").addClass("hidden");var e=t("."+o+"-list .follow");e.length&&e.each(function(){t(this).trigger("toggle-follow",{isNowFollowing:!1})})}e.preventDefault();var i,r=t(e.target),o=r.data("kind");r.prop("disabled")||(r.prop("disabled",!0),i=setTimeout(function(){r.addClass("loading")},300),this.watchState.unwatchKind(o).done(n))}}),h=n.View.extend({events:{mouseover:"loadData","follow:repo a.follow":"toggleWatching"},initialize:function(e){i.bindAll(this,"render","loadData","toggleWatching"),this.preferencesLoaded=!1,this.$follow=this.$("a.follow"),this.model=new o.RepoPreferences({},{url:this.$follow.data("prefsUrl"),repository:e.repository}),this.watchState=new o.RepoWatchState({watching:this.$follow.hasClass("following"),urlPullrequests:this.$follow.data("urlPullrequests"),urlIssues:this.$follow.data("urlIssues")},{watchUrl:this.$follow.attr("href"),unwatchUrl:this.$follow.data("unwatchUrl")}),this.watchState.on("change:watching",this.render)},render:function(){var e=this.watchState.get("watching"),t=e?gettext("Stop watching this repository"):gettext("Watch this repository");return this.$follow.toggleClass("following",e).attr("title",t),this},loadData:function(){this.preferencesLoaded||(this.watchView=new c({model:this.model,watchState:this.watchState,target:this.$("a.repo-watch")}),this.unwatchView=new d({model:this.model,watchState:this.watchState}),this.unwatchView.on("show:unwatch",function(){this.watchView.hideDialog()}.bind(this)),this.model.fetch(),this.watchView.once("loading",function(){this.$follow.addClass("loading")}.bind(this)),this.watchView.once("loaded",function(){this.$follow.removeClass("loading")}.bind(this)),this.watchState.loadUnwatch(),this.unwatchView.once("loading",function(){this.$follow.addClass("loading")}.bind(this)),this.unwatchView.once("loaded",function(){this.$follow.removeClass("loading")}.bind(this)),this.preferencesLoaded=!0)},toggleWatching:function(){this.watchState.toggle()}});return{Widget:h,UnwatchView:d,PreferencesView:c}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1)],r=function(e,t){var n=t.Model.extend({initialize:function(e,t){this.url=t.url,this.repository=t.repository}}),i=t.Model.extend({initialize:function(e,t){this.watchUrl=t.watchUrl,this.unwatchUrl=t.unwatchUrl},loadUnwatch:function(){return e.get(this.unwatchUrl).done(function(e){this.trigger("load:unwatch",e)}.bind(this))},unwatchKind:function(t){return e.ajax({url:this.unwatchUrl+"/"+t,type:"DELETE",data:{kind:[t]},dataType:"json"})},watch:function(){this.set("watching",!0),e.post(this.watchUrl)},toggle:function(){this.set("watching",!this.get("watching"))}});return{RepoPreferences:n,RepoWatchState:i}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e(document.body).hasClass("aui-page-sidebar")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(449),n(450),n(451),n(230)],r=function(e,t,n,i,r){return e(function(){var e=new i([],{model:t,matcher:t.matcher,queryEndpoint:"/emoji/all.json"});new n({el:document.body,source:e,results:new r({suggestionTemplate:"emoji-result",transformModelId:function(e){return parseInt(e,10)}})}).render()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(238)],r=function(e,t){return t.extend({replacementText:function(){return this.get("name")},highlightAttrs:function(){return["name"]},sortKeys:function(e){var t=this.get("name").toLowerCase(),n=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),i=new RegExp("(\\b|_)"+n),r=new RegExp(n+"(\\b|_)");return[e.toLowerCase()!==t,!(i.test(t)&&r.test(t)),!(i.test(t)||r.test(t)),t.indexOf(e),t]},highlightSubstring:function(t,n){if(n=n.toLowerCase(),!n.length)return e.escape(t);var i=t.indexOf(n);return[e.escape(t.slice(0,i)),"<em>",e.escape(t.slice(i,i+n.length)),"</em>",e.escape(t.slice(i+n.length))].join("")},matches:function(e){return e?-1!==this.get("name").indexOf(e):!0}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(234)],r=function(e){return e.extend({prefix:":",replaceText:function(t,n){var i=t.selectionStart===t.value.length?": ":":";e.prototype.replaceText.call(this,t,":"+n+i)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(2),n(452)],r=function(e,t){return e.ProgressiveDataSet.extend({initialize:function(t,n){e.ProgressiveDataSet.prototype.initialize.apply(this,arguments),this.imageType=n.imageType||"svg"},addQueryCache:function(t,n){e.ProgressiveDataSet.prototype.addQueryCache.apply(this,arguments),this.cachedResults=n},hasQueryCache:function(){return!!this.cachedResults},findQueryCache:function(){return this.cachedResults},getQueryData:function(){return{}},shouldGetMoreResults:function(){return!this.cachedResults},getFilteredResults:function(e){var n=this.filter(function(t){return this.matcher(t,e)},this);return n=t.sortBy(n,function(t){return t.sortKeys(e)}),n=t.first(n,this._maxResults)},parse:function(e){var t,n=[],i=0;for(var r in e)t=e[r],n.push({id:i++,name:r,src:t[this.imageType]});return n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){AJS.ProgressiveDataSet=Backbone.Collection.extend({initialize:function(e,t){t||(t={}),t.matcher&&(this.matcher=t.matcher),t.model&&(this.model=t.model),this._idAttribute=(new this.model).idAttribute,this._maxResults=t.maxResults||5,this._queryData=t.queryData||{},this._queryParamKey=t.queryParamKey||"q",this._queryEndpoint=t.queryEndpoint||"",this.value=null,this.queryCache={},this.activeQueryCount=0,_.bindAll(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(e){var t,n;this.value=e,n=this.getFilteredResults(e),this.respond(e,n),e&&this._queryEndpoint&&!this.hasQueryCache(e)&&this.shouldGetMoreResults(n)&&(t=this.fetch(e),this.activeQueryCount++,this.trigger("activity",{activity:!0}),t.always(_.bind(function(){this.activeQueryCount--,this.trigger("activity",{activity:!!this.activeQueryCount})},this)),t.done(_.bind(function(t,n,i){this.addQueryCache(e,t,i)},this)),t.done(_.bind(function(){e=this.value,n=this.getFilteredResults(e),this.respond(e,n)},this)))},getQueryData:function(e){var t=_.isFunction(this._queryData)?this._queryData(e):this._queryData,n=_.extend({},t);return n[this._queryParamKey]=e,n},fetch:function(e){var t=this.getQueryData(e),n={add:!0,update:!0,remove:!1,data:t},i=Backbone.Collection.prototype.fetch.call(this,n);return i},respond:function(e,t){return this.trigger("respond",{query:e,results:t}),t},matcher:function(e,t){},getFilteredResults:function(e){var t=[];return e?(t=this.filter(function(t){return!!this.matcher(t,e)},this),this._maxResults&&(t=_.first(t,this._maxResults)),t):t},addQueryCache:function(e,t,n){var i=this.queryCache,r=this.parse(t,n);i[e]=_.pluck(r,this._idAttribute)},hasQueryCache:function(e){return this.queryCache.hasOwnProperty(e)},findQueryCache:function(e){return this.queryCache[e]},shouldGetMoreResults:function(e){return e.length<this._maxResults},setMaxResults:function(e){this._maxResults=e,this.value&&this.respond(this.value,this.getFilteredResults(this.value))}})},function(e,t,n){var i,r;i=[n(3),n(145),n(209),n(159)],r=function(e,t,n,i){var r=function(){var t=this;e.ajax(t.attr("data-ad-feature-url")).done(function(e){t.html(e),n.vent.trigger("change:content",t),t.removeClass("hidden-module")})};return t(function(e){i(r.bind(e))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(147),n(455),n(456),n(457),n(188),n(158)],r=function(e,t,n){return t(function(t){var i=e("#dashboard-tabs"),r=i.find("ul.aui-nav > li");t.on("click","ul.filter-status a",function(t){var r=i.find("li.aui-nav-selected"),o=/(\w+)-tab/.exec(r.attr("id")),a=o?o[1]:"",s=e(t.target).text();n(["atl._trackEvent","Dashboard","Filter - "+s,a])}),t.on("click","ol.paginator a",function(n){n.preventDefault(),e("body, html").animate({scrollTop:0},400),e.pjax(e.extend({url:e(this).attr("href"),push:!0},{container:t,scrollTo:null,timeout:3e4}))}),t.on("pjax:end",function(n){if(this===n.target){var i=t.find(".dashboard-section:first").attr("id"),o=t.find('ul.filter-status > li[aria-pressed="true"]').attr("id");i.indexOf("dashboard-")>-1&&(i=i.substr("dashboard-".length,i.length)),r.removeClass("aui-nav-selected"),e("#"+i+"-tab").addClass("aui-nav-selected"),e.cookie("dashboard-tab",i?i:""),e.cookie("dashboard-filter",o?o:"")}}).on("pjax:error",function(e,n,i){return n.readyState>0&&"abort"!==i?(t.html("<h2>Error</h2><p>We were unable to load this page.</p>"),!1):void 0}).on("pjax:send",function(e){this===e.target&&t.addClass("has-mask")}).on("pjax:complete",function(e){this===e.target&&t.removeClass("has-mask")}),e.support.pjax&&r.on("click","a",function(i){i.preventDefault();var o=e(i.target).closest("li"),a=/(\w+)-tab/.exec(o.attr("id")),s=a?a[1]:"";n(["atl._trackEvent","Dashboard","Tab - "+s]),e.pjax(e.extend({url:e(this).attr("href"),push:!0},{container:t,scrollTo:null,timeout:3e4})),r.removeClass("aui-nav-selected"),o.addClass("aui-nav-selected")}),t.on("click","#import-all-github-repos",function(t){t.preventDefault();var n=e(t.target);n.attr("aria-disabled","true").attr("disabled","disabled").addClass("loading"),e.post(n.attr("data-api-url"),{type:"github"},function(){window.location=n.attr("href")})}),n(["atl._trackPageview","/profile/frontpage/"])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(307),n(305),n(304),n(206),n(158)],r=function(e,t,n,i,r,o){return e(function(e){var a=t("#repositories-container"),s=t("#repositories-pjax"),l=o("Dashboard");n({$pjaxContainer:s,$controls:t("#repo-filter"),ignoreQuery:"page"}),i({$container:a,$pjaxContainer:s,ignoreQuery:"page"}),r(a,{$pjaxContainer:s,setMask:!1}),e.on("click",".newsfeed a",function(){l("Newsfeed - Link Clicked")}).on("click",".activity .rss",function(){l("Newsfeed - Subscribe Link Clicked")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(305),n(304),n(158)],r=function(e,t,n,i){return e(function(){var e=t("#issues"),r=t("#dashboard-container");n({$container:e,$pjaxContainer:r,ignoreQuery:"page"}),i(e,{$pjaxContainer:r,setMask:!1})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(458),n(305),n(304),n(158)],r=function(e,t,n,i,r){return e(function(){var e=t("#pullrequests"),o=t("#dashboard-container"),a=t("#team-select");i({$container:e,$pjaxContainer:o,ignoreQuery:"page"}),n({$pjaxContainer:o,$select:a,filterTerm:a.attr("data-filter-term"),selectOptions:{dropdownAutoWidth:!1},ignoreQuery:"page"}),r(e,{$pjaxContainer:o,setMask:!1})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(306),n(158)],r=function(e,t,n){return function(e){var i=e.$select,r=i.attr("data-url"),o=e.selectOptions||{},a=e.$pjaxContainer,s=t.extend({},e.pjaxOptions,{scrollTo:null,timeout:3e4});a.on("pjax:start",function(){a.find(".maskable").addClass("has-mask")}),a.on("pjax:end",function(){a.find(".maskable").removeClass("has-mask")}),n.ignore(e.ignoreQuery),i.auiSelect2(t.extend({dropdownAutoWidth:!0},o)),i.on("change",function(i){t.pjax(t.extend({},s,{container:a,url:n.update(e.filterTerm,i.val).asUrl(r)}))})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(182)],r=function(e,t,n,i){return n(function(e){var n=t("#keyboard-shortcuts-link"),r=t("#super-touch-point-dialog")[0];n.on("click",function(e){e.preventDefault(),r.isVisible()&&r.hide(),i()}),skate.init(t("#ace-stp-menu-link").get(0)),skate.init(t("#super-touch-point-dialog").get(0))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(){var t=e("#notification-compose-form");t.on("click","#notification-compose-form a.cancel",function(){window.history.back()}),t.find("#id_recipient").addClass("bb-user-team-typeahead")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(368),n(369),n(149)],r=function(e,t,n,i,r,o){return n(function(){function n(){h.length&&(p.empty(),d.prop("checked")&&e.messages.info(p,{body:o.toHtml("select-all-message-template",{page_count:c.length,count:f}),closeable:!1,fadeout:!0}))}function a(){t("#aui-message-bar").empty(),m.prop("disabled",!1),e.messages.error({body:"An error occurred while updating"})}var s=t("#notification-body"),l=t("#notification-form"),u=l.find("header"),c=s.find("input[type=checkbox]"),d=u.find("#select-page"),h=u.find("#select-all"),p=t("#notification-message-bar"),f=u.attr("data-total-messages"),m=u.find("button");p.on("click",".select-all-link",function(e){e.preventDefault(),h.prop("checked",!0),c.prop("disabled",!0),p.find(".undo-select-all").removeClass("hidden"),p.find(".select-all").addClass("hidden")}),p.on("click",".undo-select-all-link",function(e){e.preventDefault(),h.prop("checked",!1),c.prop("disabled",!1),p.find(".select-all").removeClass("hidden"),p.find(".undo-select-all").addClass("hidden")}),u.find("#select-page").prop("checked")&&n(),d.on("change",function(){var e=d.prop("checked");c.prop("checked",e).change(),e?n():(p.empty(),h.prop("checked",!1),c.prop("disabled",!1))}),s.on("change","input[type=checkbox]",function(){var e=t(this),n=e.parent().parent();e.prop("checked")?n.addClass("selected"):(n.removeClass("selected"),d.prop("checked",!1),h.prop("checked",!1),p.empty()),m.prop("disabled",0===s.find(":checked").length)}),l.find(":submit").click(function(n){n.preventDefault();var o=l.serialize();o+="&action={}".format(t(this).val()),m.prop("disabled",!0),t.ajax({type:"POST",url:l.attr("action"),data:o,dataType:"json",error:function(){a()},success:function(n){n.errors?a():n.result?window.location=n.result:setTimeout(function(){i(n.url).done(function(e,t){r.addMessage("{} messages updated.".format(t.count),"success")}).progress(function(n){n.count!==n.total&&(t("#aui-message-bar").empty(),e.messages.info({body:"{} of {} messages updated.".format(n.count,n.total),fadeout:!0}))}).fail(a)},1e3)}})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(150),n(145),n(295),n(463),n(212)],r=function(e,t,n,i,r){return n(function(n){function o(e){e.preventDefault(),c.show()}function a(){var t=e.get(n.attr("data-url"));u.loading(t,{mask:!0}).done(s)}function s(e){u.html(t.render(r,{statuses:e.values.map(l)}))}function l(e){return"SUCCESSFUL"===e.state?(e.iconClass="aui-iconfont-approve commit-status--success",e.iconText=gettext("Success")):"INPROGRESS"===e.state?(e.iconClass="aui-iconfont-devtools-task-in-progress commit-status--inprogress",e.iconText=gettext("In Progress")):(e.iconClass="aui-iconfont-error commit-status--fail",e.iconText=gettext("Failure")),e}var u=e("<div></div>").addClass("maskable"),c=new i({title:gettext("Builds"),contentClass:"commit-status-dialog-content",buttonText:gettext("Close"),contents:u});n.on("click",o),c.on("show",a)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports='<ul class="commit-status-list unstyled-list">\n  [[#statuses]]\n    <li class="commit-status--item">\n      <span class="aui-icon aui-icon-small [[iconClass]]">\n        [[iconText]]\n      </span>\n\n      <div class="commit-status-content">\n        <div class="commit-status-title with-ellipsis">\n          [[name]]\n        </div>\n        <div class="commit-status-description with-ellipsis">\n          [[description]]\n        </div>\n      </div>\n\n      <div class="commit-status-time">[[timestamp]]</div>\n    </li>\n  [[/statuses]]\n</ul>\n'},function(e,t,n){var i,r;i=[n(8),n(145),n(474),n(475),n(476),n(477),n(465),n(478),n(479),n(480),n(484)],r=function(e,t,n,i,r,o,a,s,l,u,c){return t(function(e){function t(e){return m=new i,g=new l({el:e}).render(),v=new u({el:e.find(".omnibar-form"),collection:m}).render(),n.register(r,{weight:200}),n.register(s,{weight:120}),n.register(a,{weight:110}),n.register(o,{weight:100}),g.on("before:open",function(){v.query(!0)}),g.on("open",function(){v.focus()}),g}function d(){g||(g=t(e)),g.open()}function h(){e.attr("title",gettext('You can now search for files from the Omnibar. Press "." to open this dialog from any page.')),e.tipsy({gravity:"n",trigger:"manual"})}function p(){e.tipsy("show")}function f(){e.tipsy("hide")}var m,g,v;c([{section:gettext("Global actions"),shortcuts:[{keys:["."],description:gettext("Open the Omnibar"),op:"execute",params:[d]}]}]),c([{section:gettext("Repository actions"),shortcuts:[{keys:["f"],description:gettext("Search for file"),op:"execute",params:[function(){d(),h(),g.once("open",p),m.on("update",p),g.once("before:close",function(){f(),m.off("update",p)})}]}]}])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(466),n(471),n(472)],r=function(e,t,n,i){return t.extend({label:gettext("Your pull requests"),url:"/!api/internal/my/pull-requests",transformData:function(t,r){return e.map(t,function(e){var t=i(e.title,r);return e.weight=t.score,e.label="#{}: {}".format(e.localId,n(e.title,t.matchGroups)),e.context=e.repo,e}).filter(function(e){return!!e.weight})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(467)],r=function(e,t,n){return n.extend({initialize:function(e){n.prototype.initialize.apply(this,arguments),this.asyncDeferredCache={}},getUrl:function(e){return t.isFunction(this.url)?this.url(e):this.url},getAsyncDeferred:function(t){return e.ajax(this.getUrl(t))},getCacheKey:function(e){return this.getUrl(e)},getCachedAsyncDeferred:function(e){var n=this.getCacheKey(e),i=t.has(this.asyncDeferredCache,n);if(!i){var r=this.getAsyncDeferred(e);return this.asyncDeferredCache[n]=r,r}return this.asyncDeferredCache[n]},_fetchData:function(t){var n=new e.Deferred;return this.fetchData(n,t),n.promise()},fetchData:function(e,t){this.getCachedAsyncDeferred(t).done(function(n){e.resolve(this.transformData(n,t))}.bind(this)).fail(e.reject)},onExecute:function(e){window.location=e.url}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405),n(2),n(468),n(470),n(471),n(472)],r=function(e,t,n,i,r,o,a){return t.Controller.extend({maxResults:5,minQueryLength:1,initialize:function(e){this.options=e,this.weight=e.weight||0},transformData:function(e,t){return n.map(e,function(e){var n=a(e.label,t);return e.weight=n.score,e.label=o(e.label,n.matchGroups),e}).filter(function(e){return e.weight&&e.$el.length})},onExecute:function(e){e.$el[0].click()},_fetchData:function(t){var i=new e.Deferred;return i.resolve(this.transformData(n.result(this,"data"),t)),i.promise()},_getResults:function(e){return this.maxResults&&(e=e.slice(0,this.maxResults)),n.each(e,function(e){e.onExecute=this.onExecute,e.weight=-e.weight||0}.bind(this)),new r({label:n.result(this,"label"),context:n.result(this,"context"),weight:-this.weight,results:new i(e)})},onBeforeQuery:function(e){return!0},query:function(t){var n=new e.Deferred;return t.length<this.minQueryLength||!this.onBeforeQuery(t)?n.resolve(null):this._fetchData(t).done(function(e){n.resolve(this._getResults(e))}.bind(this)).fail(n.reject),n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(469)],r=function(e,t){return e.Collection.extend({model:t,comparator:"weight"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({hasResult:function(e){return!!this.get("results").get(e)},findFirstResult:function(){return this.get("results").first()},findLastResult:function(){return this.get("results").last()},findNextResult:function(e){var t=this.get("results");return t.at(t.indexOf(e)+1)},findPreviousResult:function(e){var t=this.get("results");return t.at(t.indexOf(e)-1)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){return function(t,n){if(!n.length)return t;var i=e.escape(t.substring(0,n[0][0]));return e.each(n,function(r,o){i+="<strong>"+e.escape(t.substring(r[0],r[1]))+"</strong>",n[o+1]&&(i+=e.escape(t.substring(r[1],n[o+1][0])))}),i+=e.escape(t.substring(n[n.length-1][1],t.length))}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(473),n(2)],r=function(e,t){function n(e,n){n=n||[];var i=[];return t.each(n,function(e,t){1===e&&i.push(t)}),i}function i(e){for(var t=e[0],n=[],i=0;i<e.length;i++)e[i+1]-e[i]!==1&&(n.push([t,e[i]+1]),t=e[i+1]);return n}return function(r,o){r=r||"",o=o||"";var a=t.clone(e),s=a.score(r.toLowerCase(),o.toLowerCase()),l=n(r,a.lastScoreArray);return{score:s,matchGroups:i(l)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;!function(r){function o(e,t){var n=e.charAt(t);return n>="A"&&"Z">=n}function a(e,t){var n=e.charAt(t-1);return-1!=p.indexOf(n)}function s(e,t,n,i){for(var r=n;i>r;r++)e[r]=t;return e}var l=0,u=1,c=.8,d=.9,h=.85,p=" 	_-",f={lastScore:null,lastScoreArray:null,score:function(e,t){if(0===t.length)return c;if(t.length>e.length)return l;var n=[],i=e.toLowerCase();if(t=t.toLowerCase(),this._scoreAll(e,i,t,-1,0,[],n),0==n.length)return 0;for(var r=0,o=[],a=0;a<n.length;a++){for(var s=n[a],u=0,d=0;d<e.length;d++)u+=s[d];u>r&&(r=u,o=s)}return r/=e.length,this.lastScore=r,this.lastScoreArray=o,r},_scoreAll:function(e,t,n,i,r,p,f){if(r==n.length){var m=t.charAt(0)==n.charAt(0),g=m?d:c;return s(p,g,p.length,e.length),void f.push(p.slice(0))}var v=n.charAt(r);r++;var y=t.indexOf(v,i);if(-1!=y)for(var b=i;-1!=(y=t.indexOf(v,i+1));)a(e,y)?(p[y-1]=1,s(p,h,b+1,y-1)):o(e,y)?s(p,h,b+1,y):s(p,l,b+1,y),p[y]=u,i=y,this._scoreAll(e,t,n,i,r,p,f)}};i=function(){return f}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}("undefined"!=typeof window?window:this)},function(e,t,n){var i,r;i=[n(2)],r=function(e){var t=[];return{register:function(e,n){n=n||{},t.push(new e(n))},unregister:function(n){t=e.reject(t,function(e){return e instanceof n})},get:function(n){return e.find(t,function(e){return e instanceof n})},getAll:function(){return t}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(474),n(468),n(470)],r=function(e,t,n,i,r,o){return e.Collection.extend({model:o,comparator:"weight",initialize:function(e,t){this.promises=[]},update:function(e){n.invoke(this.promises,"reject"),this.promises=[],this.reset(),this.trigger("before:update"),n.each(i.getAll(),function(t){var n=t.query(e);n.done(function(e){e&&e.get("results").length&&this.add(e)}.bind(this)),this.promises.push(n)}.bind(this)),t.when.apply(this,this.promises).always(function(){this.trigger("update")}.bind(this))},findNextResultGroup:function(e){return this.at(this.indexOf(e)+1)},findPreviousResultGroup:function(e){return this.at(this.indexOf(e)-1)},findResultGroup:function(e){return this.find(function(t){return t.hasResult(e)})},findNextResult:function(e){var t=this.findResultGroup(e),n=t.findNextResult(e);if(n)return n;var i=this.findNextResultGroup(t);return i?i.findFirstResult():this.first().findFirstResult()},findPreviousResult:function(e){var t=this.findResultGroup(e),n=t.findPreviousResult(e);if(n)return n;
var i=this.findPreviousResultGroup(t);return i?i.findLastResult():this.last().findLastResult()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(467)],r=function(e,t){return t.extend({label:gettext("Actions"),minQueryLength:0,maxResults:!1,data:function(){return[{label:gettext("Create repository"),$el:e("#repo-create-cta")},{label:gettext("Import repository"),$el:e("#import-repo-link")},{label:gettext("Create snippet"),$el:e("#snippet-create-cta")}]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(466),n(471),n(472)],r=function(e,t,n,i){return t.extend({label:gettext("Your issues"),url:"/!api/internal/my/issues",transformData:function(t,r){return e.map(t,function(e){var t=i(e.title,r);return e.weight=t.score,e.label="#{}: {}".format(e.localId,n(e.title,t.matchGroups)),e.context=e.repo,e}).filter(function(e){return!!e.weight})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(466),n(378)],r=function(e,t,n){return t.extend({label:gettext("Your repositories"),url:"/!api/internal/my/repositories",transformData:function(t,i){return t=n.filterList(t,i),e.each(t,function(e){e.label=e.fullSlug}),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405),n(2),n(209)],r=function(e,t,n,i){return t.ItemView.extend({animationSpeed:100,template:!1,events:{mousedown:"mousedownHandler"},initialize:function(t){i.commands.setHandler("omnibar:close",function(){this.close()}.bind(this)),e(document).on("mousedown.omnibar",function(e){this.$(e.target).length||e.target===this.el||this.close()}.bind(this))},onDestroy:function(){e(document).off(".omnibar")},open:function(){return this.trigger("before:open"),this.$el.slideDown(this.animationSpeed,function(){this.trigger("open")}.bind(this)),this},close:function(){return this.trigger("before:close"),this.$el.slideUp(this.animationSpeed,function(){this.trigger("close")}.bind(this)),this},mousedownHandler:function(e){this.$(e.target).not(":text")&&e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(405),n(2),n(481),n(482),n(209)],r=function(e,t,n,i,r,o,a){var s=250;return n.CompositeView.extend({template:"#omnibar-form-template",childViewContainer:".omnibar-result-group-list",childView:o,emptyView:r,ui:{input:".omnibar-input",resultGroupList:".omnibar-result-group-list"},events:{"input @ui.input":"inputHandler","keydown @ui.input":"keydownHandler",submit:"submitHandler"},initialize:function(e){this.listenTo(this.collection,"before:update",this.beforeUpdateHandler),this.listenTo(this.collection,"update",this.updateHandler),this.on("query",this.collection.update.bind(this.collection)),a.commands.setHandler("omnibar:set:activeResult",this.setActiveResult.bind(this)),t(document).on("pjax:end.omnibar",function(){this.$el.is(":visible")&&this.focus()}.bind(this)),this.lastQuery=null},isEmpty:function(){return this.ui.input.val()&&n.CompositeView.prototype.isEmpty.call(this)},onDestroy:function(){t(document).off(".omnibar")},onAddChild:function(){this.hasNavigated?this.adjustListScrollTop():i.defer(this.selectFirstResult.bind(this))},focus:function(){return this.ui.input[0].setSelectionRange(0,this.ui.input.val().length),this.ui.input.trigger("focus"),this},getListScrollTop:function(){return this.ui.resultGroupList.scrollTop()},getListHeight:function(){return this.ui.resultGroupList.height()},setActiveResult:function(e){return this.activeResult&&this.activeResult.toggleActive(!1),e.toggleActive(!0),this.activeResult=e,this},getFirstResult:function(){return this.findResultView(this.collection.first().findFirstResult())},getLastResult:function(){return this.findResultView(this.collection.last().findLastResult())},selectFirstResult:function(){return this.collection.length&&this.setActiveResult(this.getFirstResult()),this},findResultView:function(e){var t;return this.children.find(function(n){var i=n.children.findByModel(e);return i&&(t=i),i}),t},_adjustListScrollTop:function(e){var t,n,i,r,o;this.activeResult===this.getFirstResult()?this.ui.resultGroupList.scrollTop(0):this.activeResult===this.getLastResult()?(o=this.activeResult.getTop()+this.activeResult.getHeight()+this.getListScrollTop(),n=this.getListHeight(),this.ui.resultGroupList.scrollTop(o-n)):e?(t=this.getListScrollTop(),r=this.activeResult.getTop()+t,t>r&&this.ui.resultGroupList.scrollTop(r)):(t=this.getListScrollTop(),o=this.activeResult.getTop()+this.activeResult.getHeight()+t,n=this.getListHeight(),i=t+n,o>i&&this.ui.resultGroupList.scrollTop(o-n))},adjustListScrollTop:function(e){return this.activeResult?(a.vent.trigger("omnibar:before:adjustListScrollTop"),this._adjustListScrollTop(e),a.vent.trigger("omnibar:adjustListScrollTop"),this):this},selectNextResult:function(){if(!this.collection.length)return this;var e=this.findResultView(this.collection.findNextResult(this.activeResult.model));return this.setActiveResult(e).adjustListScrollTop(),this.hasNavigated=!0,this},selectPreviousResult:function(){if(!this.collection.length)return this;var e=this.findResultView(this.collection.findPreviousResult(this.activeResult.model));return this.setActiveResult(e).adjustListScrollTop(!0),this.hasNavigated=!0,this},toggleLoading:function(e){return this.ui.input.toggleClass("loading",e),this},toggleListDisplay:function(e){return this.ui.resultGroupList.toggle(e),this},query:function(e){var t=this.ui.input.val();return(e||t!==this.lastQuery)&&(this.hasNavigated=!1,this.lastQuery=t,this.trigger("query",t)),this},inputHandler:i.debounce(function(e){this.query()},s),keydownHandler:function(t){t.keyCode===e.keyCode.ESCAPE?a.commands.execute("omnibar:close"):t.keyCode===e.keyCode.DOWN||!t.shiftKey&&t.keyCode===e.keyCode.TAB?(t.preventDefault(),this.selectNextResult()):t.keyCode===e.keyCode.UP||t.shiftKey&&t.keyCode===e.keyCode.TAB?(t.preventDefault(),this.selectPreviousResult()):t.keyCode===e.keyCode.ENTER&&(t.preventDefault(),this.activeResult&&this.activeResult.execute())},submitHandler:function(e){e.preventDefault()},beforeUpdateHandler:function(){this.toggleLoading(!0)},updateHandler:function(){this.toggleLoading(!1),this.isEmpty()||this.toggleListDisplay(!!this.collection.length)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405)],r=function(e){return e.ItemView.extend({template:"#omnibar-blank-slate-template"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(483)],r=function(e,t){return e.CompositeView.extend({template:"#omnibar-result-group-list-item-template",tagName:"li",className:"omnibar-result-group-list-item",childViewContainer:".omnibar-result-list",childView:t,initialize:function(e){this.collection=this.model.get("results")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(2),n(209)],r=function(e,t,n){return e.ItemView.extend({template:"#omnibar-result-list-item-template",tagName:"li",className:"omnibar-result-list-item",attributes:function(){return{title:this.model.get("title")||this.model.get("label")}},events:{mouseover:"mouseoverHandler",click:"clickHandler"},initialize:function(e){this.listenTo(n.vent,"omnibar:before:adjustListScrollTop",this.undelegateEvents),this.listenTo(n.vent,"omnibar:adjustListScrollTop",function(){t.delay(this.delegateEvents.bind(this),100)})},toggleActive:function(e){return this.$el.toggleClass("active",e),this},execute:function(){return this.model.get("onExecute")(this.model.toJSON()),n.commands.execute("omnibar:close"),this},getTop:function(){return this.$el.position().top},getHeight:function(){return this.$el.height()},mouseoverHandler:function(e){n.commands.execute("omnibar:set:activeResult",this)},clickHandler:function(e){this.execute()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(164),n(179)],r=function(e,t){return function(n){e.isKbdShortcutsEnabled&&t.fromJSON(n)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(2)],r=function(e,t,n,i){function r(e){return{id:e.key,text:e.name}}return function(e){var t=e.attr("data-owner"),o="/!api/internal/teams/{}/projects/".format(t);return e.auiSelect2({placeholder:gettext("Select project"),minimumResultsForSearch:-1,allowClear:!0,ajax:{url:o,cache:!0,data:function(e,t){return{page:t}},results:function(e,t){return{results:e.values.map(r),more:t<Math.ceil(e.size/e.pagelen)}}},initSelection:function(e,t){n.getJSON(o).done(function(n){var o=i.findWhere(n.values,{key:e.val()});o?t(r(o)):n.values.length&&t(r(n.values[0]))})}}),e}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(487),n(506),n(512)],r=function(e,t,n,i){return e(function(e){var r=new t;r.fetch({wait:!0}).done(function(){i.unmask(e)}),i.mask(e,{spinner:"tiny"}),new n({collection:r,el:e,autofocus:!0}).render()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(488),n(490),n(170),n(503),n(504),n(505)],r=function(e,t,n,i,r,o){return e.extend({apiVersion:"internal",model:o,parse:function(e){return e.values},url:function(){switch(i){case"repository":var e=t.load(n.fullslug);return"{}/repositories/{}/addons/?pagelen=100".format(this.getApiRoot(),e.id);case"account":return"{}/account/{}/addons/?pagelen=100".format(this.getApiRoot(),r);default:throw"No context."}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(489)],r=function(e,t){return e.Collection.extend({apiVersion:2,getApiRoot:function(){return t[this.apiVersion]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return{internal:"/!api/internal",1:"/!api/1.0",2:"/!api/2.0"}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(491)],r=function(e){return new e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(488),n(492)],r=function(e,t){return e.extend({apiVersion:1,model:t,initialize:function(e,t){t=t||{},this.owner=t.owner||null},url:function(){return"{}/repositories".format(this.getApiRoot())},load:function(e,n){if(this.get(e))return this.get(e);var i=t.fromFullSlug(e,n);return this.add(i),i}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(493),n(489),n(494),n(497)],r=function(e,t,n,i,r,o){var a=n.extend({apiVersion:1,urlRoot:function(){return"{}/repositories".format(this.getApiRoot())},url:function(){return"{}/repositories/{}".format(this.getApiRoot(),this.id)},initialize:function(){this.id="{}/{}".format(this.get("owner","username"),this.get("slug")),this.pullRequests=new o([],{repository:this})},parse:function(e){return e.owner=r.load(e.owner),e.fork_of&&(e.fork_of=a.fromFullSlug("{}/{}".format(e.fork_of.owner,e.fork_of.slug))),e},fork:function(t){var n=new e.Deferred,r={name:null};t&&(r.name=t);var o=function(e){e.fetch({success:function(t){"available"===t.get("state")?n.resolve(e):setTimeout(function(){o(e)},1e3)},error:function(){n.reject()}})};return e.ajax({url:"{}/repositories/{}/fork".format(i.internal,this.id),type:"POST",data:JSON.stringify(r),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){var t=a.fromFullSlug(e.full_name);o(t)}).fail(function(e,t,i){n.reject()}),n},toJSON:function(){return{full_name:this.get("owner").get("username")+"/"+this.get("slug")}},pull:function(t){var n="{}/repositories/{}/pull".format(i.internal,this.id);return t&&(n="{}/{}".format(n,encodeURIComponent(t))),e.ajax({url:n,type:"PUT",dataType:"json"})},diff:function(e,t){return this.revspec(e,this,t)},twoway:function(t,n,r){var o=this.createRevSpec(t,n,r);return e.ajax({url:"{}/repositories/{}/twoway/{}?context=0".format(i.internal,this.id,o),type:"GET",dataType:"json",contentType:"application/json; charset=utf-8"})},revspec:function(t,n,r){var o=this.createRevSpec(t,n,r);return e.ajax({url:"{}/repositories/{}/revspec/{}?context=0".format(i.internal,this.id,o),type:"GET",dataType:"json",contentType:"application/json; charset=utf-8"})},createRevSpec:function(e,t,n){return"{}:{}..{}:{}".format(this.id,e,t.id,n)}},{fromFullSlug:function(e,n){var i=e.split("/"),o=i.pop(),a=i.length?i.pop():null,s=r.load(a),l=t.defaults({owner:s,slug:o},n);return new this(l)}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(1),n(489)],r=function(e,t,n){return t.Model.extend({apiVersion:2,getApiRoot:function(){return n[this.apiVersion]},get:function(n){if(arguments.length>1){var i=this;return e.each(arguments,function(e){i=i.get(e)}),i}return t.Model.prototype.get.call(this,n)},toJSON:function(){if(this._isSerializing)return this.id||this.cid;this._isSerializing=!0;var t=e.clone(this.attributes);return e.each(t,function(n,i){n&&e.isFunction(n.toJSON)&&(t[i]=n.toJSON())}),this._isSerializing=!1,t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(495)],r=function(e){return new e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(488),n(496)],r=function(e,t){return e.extend({apiVersion:1,model:t,url:function(){return"{}/users".format(this.getApiRoot())},load:function(e){if(this.get(e))return this.get(e);var n=new t({username:e});return this.add(n),n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(493)],r=function(e){return e.extend({apiVersion:1,urlRoot:function(){return"{}/users".format(this.getApiRoot())},idAttribute:"username"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(498),n(499),n(500)],r=function(e,t,n,i){return t.extend({apiVersion:2,model:n,url:function(){return"{}/repositories/{}/pullrequests".format(this.getApiRoot(),this.repository.id)},load:function(e){var t=this.find(function(t){return t===e});if(void 0===t){var r=new i({repository:this.repository});t=new n({destination:r,local_id:e})}return t},initialize:function(e,t){t=t||{},this.repository=t.repository},updateRefs:function(){var t=new e.Deferred,n=this.length,i=0,r=0;return this.each(function(e){e.updateRef().done(function(){t.notify(++i,n),i===n&&t.resolve()}).always(function(){++r===n&&i!==n&&t.reject()})}),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(488)],r=function(e,t){return t.extend({constructor:function(e,n){this._page=1,t.apply(this,arguments)},_fetch:t.prototype.fetch,fetch:function(t){var n=e.clone(t||{});n.data=e.extend({page:this._page},n.data||{}),this._pagelen&&(n.data.pagelen=this._pagelen),this._fetch(n)},_parse:function(e){return this._size=e.size,this._pagelen||(this._pagelen=e.pagelen),this._pages=((this._size-1)/this._pagelen|0)+1,e.values},parse:function(e){return this._parse(e)},more:function(){return this.hasMore()?(this._page+=1,this.fetch({update:!0,remove:!1})):void 0},hasMore:function(){return this._pages&&this._page<this._pages}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(493),n(489),n(501),n(502),n(500),n(490),n(494),n(368)],r=function(e,t,i,r,o,a,s,l,u,c){return i.extend({apiVersion:2,idAttribute:"global_id",url:function(){return"{}/repositories/{}/pullrequests/{}".format(this.getApiRoot(),this.get("destination","repository").id,this.get("local_id"))},parse:function(e){return e.local_id=e.id,e.closed_by&&(e.closed_by=u.load(e.closed_by.username)),e.user=u.load(e.author.username),t.each(["destination","source"],function(t){if(null===e[t].repository)e[t]=null;else{var i=n(490),r=i.load(e[t].repository.full_name);e[t]=new s({repository:r,commit:new o({repository:r,hash:e[t].commit.hash}),branch:new a({repository:r,name:e[t].branch.name})})}}),e},diff:function(){var t=new e.Deferred;return this._revspec?t.resolve(this._revspec.diff):this.get("source","repository").revspec(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash")).done(function(e){this._revspec=e,t.resolve(this._revspec.diff)}.bind(this)),t},mergebase:function(){var t=new e.Deferred;return this._revspec?t.resolve(this._revspec.mergebase.hash):this.get("source","repository").revspec(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash")).done(function(e){this._revspec=e,t.resolve(this._revspec.mergebase.hash)}.bind(this)),t},sourceDiff:function(){return this.get("source","repository").twoway(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash"))},destDiff:function(){var t=new e.Deferred;return this.mergebase().done(function(e){this.get("destination","repository").revspec(this.get("destination","commit","hash"),this.get("source","repository"),e).done(function(e){t.resolve(e.diff)})}.bind(this)),t},getComments:function(){var t=new e.Deferred;return e.ajax({url:"{}/repositories/{}/pullrequests/{}/comments".format(r[1],this.get("destination","repository").id,this.get("local_id")),type:"GET",dataType:"json"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t},toJSON:function(){return{source:this.get("source").toJSON(),destination:this.get("destination").toJSON(),title:this.get("title"),description:this.get("description"),close_source_branch:!!this.get("close_source_branch"),reviewers:t.map(this.get("reviewers"),function(e){return{username:e}})}},updateRef:function(){var t=new e.Deferred;return e.ajax({url:"/{}/pull-requests/update/{}".format(this.get("destination","repository").id,this.get("local_id")),type:"POST",data:{_quick_update:1},dataType:"json"}).done(function(e){e.errors?t.reject():e.result?t.resolve(e.result):setTimeout(function(){c(e.url,t)},1e3)}).fail(t.reject),t.promise()},toRevSpec:function(){return"{}..{}".format(this.get("source").toSpecString(),this.get("destination").toSpecString())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(493)],r=function(e){return e.extend({initialize:function(){this.hash=this.get("commit")?this.get("commit","hash"):null,this.branch=this.get("branch")?this.get("branch","name"):null,this.repo=this.get("repository").id},toSpecString:function(){var e=this.get("commit")?this.get("commit","hash"):null,t=this.get("branch")?this.get("branch","name"):null;return"{}:{}".format(this.get("repository").id,e||t)},toJSON:function(){return{branch:this.get("branch").toJSON(),repository:this.get("repository").toJSON()}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(493),n(502),n(490)],r=function(e,t,i,r){return t.extend({apiVersion:"internal",url:function(){return"{}/repositories/{}/oecommits/{}".format(this.getApiRoot(),this.get("repository").id,this.get("hash"))},parse:function(e){var t=n(490);return e.repository=t.load(e.repository.full_name),e},save:function(){return this.has("timestamp")||this.set("timestamp",new Date),t.prototype.save.apply(this,arguments)},merge:function(t,n){return e.ajax({url:"/!api/{}/repositories/{}/merge".format(this.getApiRoot(),this.get("repository").id),type:"POST",data:JSON.stringify({parents:[this.get("hash"),t],message:n}),dataType:"json",contentType:"application/json; charset=utf-8"})},addFile:function(e){var t=this.get("files")||[];return t.push(e),this.set("files",t),this},setBranch:function(e){return this.set({branch:new i({repository:this.get("repository"),name:e})}),this},toJSON:function(){return{branch:this.get("branch","name"),files:this.get("files"),message:this.get("message"),parents:this.get("parents"),repository:this.get("repository").toJSON(),timestamp:this.get("timestamp"),"transient":!!this.get("transient")}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(493)],r=function(e){return e.extend({apiVersion:"internal",url:function(){return"{}/repositories/{}/branches/{}".format(this.getApiRoot(),this.get("repository").id,encodeURIComponent(this.get("name")))},initialize:function(){this.id="{}/branches/{}".format(this.get("repository").id,this.get("name"))},toJSON:function(){return{name:this.get("name")}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e("#connect-admin").data("connect-admin-context")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return e("#connect-admin").data("target-user")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(493),n(490),n(170),n(503),n(504)],r=function(e,t,n,i,r,o){return t.extend({apiVersion:"internal",validateDescriptor:function(){var t=this,n=t.get("url");return n=n&&n.trim()||t.getDescriptorUrl(),e.ajax({url:t.urlRoot()+"/validate",data:{url:n},success:function(e){t.set("descriptor",e)}})},getDescriptorUrl:function(){var e=this.get("links");return e&&e.descriptor&&e.descriptor.source_url&&e.descriptor.source_url.href},urlRoot:function(){switch(r){case"repository":var e=n.load(i.fullslug);return"{}/repositories/{}/addons".format(this.getApiRoot(),e.id);case"account":return"{}/account/{}/addons".format(this.getApiRoot(),o);default:throw"No context."}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(405),n(507),n(510),n(511)],r=function(e,t,n,i,r,o){return n.CompositeView.extend({template:"#custom-add-ons-table-template",childView:r,childViewContainer:"tbody",initialize:function(e){this.mergeOptions(e,["autofocus"])},onRender:function(){this.autofocus&&this.focusUrlInput()},events:{submit:"onSubmit"},ui:{urlInput:"#connect-url",containerTable:"table.widget"},getUrlInputValue:function(){return this.ui.urlInput.val()},clearUrlInput:function(){this.ui.urlInput.val("")},focusUrlInput:function(){this.ui.urlInput.focus()},onSubmit:function(e){e.preventDefault(),this.installAddOn(this.getUrlInputValue())},installAddOn:function(e){var t=this,n=new this.collection.model({url:e});n.validateDescriptor().fail(o).done(function(r){i(n,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).done(function(){n.save({url:e,descriptor:r},{wait:!0,success:function(e){t.collection.add(n),t.clearUrlInput(),t.displayInstalledMessage(e)},error:o})})})},displayInstalledMessage:function(t){var n=t.get("name"),i=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);e.messages.success({body:i,fadeout:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(150),n(2),n(293),n(508),n(509)],r=function(e,t,n,i,r){function o(e,n){var i=gettext("Upon installation, the add-on <strong>%(addon_name)s</strong> will receive access to:");return r({scopes:n,accessRequestBeforeMessage:interpolate(i,{addon_name:t.escape(e)},!0)}).trim()}return r=e.compile(r),function(e,r){var a=e.get("descriptor"),s=a.scopes,l=a.name;return i(s).then(function(e){return e&&e.length?(t.extend(r,{content:o(l,e),isSafeContent:!0}),n(r)):void 0})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(e,n){return e.filter(function(e){return t.contains(n,e.name)})}var i=t.once(function(){return e.ajax("/site/oauth2/scopes")});return function(t){var r=e.Deferred();return i().done(function(e){t&&t.length&&(e=n(e,t)),r.resolve(e)}),r.promise()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports='\n[[#accessRequestBeforeMessage]]\n  <p>[[&accessRequestBeforeMessage]]</p>\n[[/accessRequestBeforeMessage]]\n<ul class="access-request-scopes-list">\n  [[#scopes]]\n    <li>[[description]]</li>\n  [[/scopes]]\n</ul>\n[[#accessRequestAfterMessage]]\n  <p>[[&accessRequestAfterMessage]]</p>\n[[/accessRequestAfterMessage]]'},function(e,t,n){var i,r;i=[n(405),n(293),n(507),n(511)],r=function(e,t,n,i){return e.ItemView.extend({tagName:"tr",template:"#custom-add-on-template",className:function(){var e="connect-add-on-row";return this.model.get("enabled")||(e+=" connect-add-on-disabled"),e},ui:{actionsDropdown:".connect-add-on-actions"},modelEvents:{change:"render"},onRender:function(){this.$el.attr("class",this.className()),this.ui.actionsDropdown.on("click.addOnActions",".connect-add-on-uninstall",this.uninstallAddOn.bind(this)).on("click.addOnActions",".connect-add-on-enable",this.enableAddOn.bind(this)).on("click.addOnActions",".connect-add-on-disable",this.disableAddOn.bind(this)).on("click.addOnActions",".connect-add-on-update",this.updateAddOn.bind(this))},onDestroy:function(){this.ui.actionsDropdown.off(".addOnActions")},uninstallAddOn:function(e){e.preventDefault();var n=this,r=this.model,o=r.get("name"),a=gettext('Are you sure you wish to uninstall the add-on "%(addOnName)s"?  You may lose any settings and this cannot be undone.'),s=interpolate(a,{addOnName:o},!0),l=interpolate(gettext('Add-on "%(addOnName)s" has been uninstalled. You may need to refresh the page to see changes to navigation.'),{addOnName:o},!0);t({id:"remove-addon",title:gettext("Uninstall add-on"),content:s,buttonText:gettext("Uninstall")}).done(function(){r.destroy({wait:!0,success:function(){n.success(l)},error:i})})},updateAddOn:function(e){e.preventDefault();var t=this,r=this.model,o=r.get("name"),a=gettext("Are you sure you wish to update the add-on %(addOnName)s?  The descriptor will be re-fetched from the same url and this cannot be undone.  Any existing settings will remain."),s=interpolate(a,{addOnName:o},!0),l=interpolate(gettext('Add-on "%(addOnName)s" has been updated. You may need to refresh the page to see changes to navigation.'),{addOnName:o},!0);r.validateDescriptor().fail(i).done(function(e){n(r,{id:"update-addon",title:gettext("Update add-on"),content:s,buttonText:gettext("Update")}).done(function(){r.save({},{url:r.url()+"/descriptor",data:JSON.stringify(r.get("descriptor")),wait:!0,success:function(){t.success(l)},error:i})})})},enableAddOn:function(e){e.preventDefault();var t=this.model,n=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been enabled. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);t.save({enabled:!0},{wait:!0,success:function(){this.success(r)}.bind(this),error:i})},disableAddOn:function(e){e.preventDefault();var t=this.model,n=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been disabled. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);t.save({enabled:!1},{wait:!0,success:function(){this.success(r)}.bind(this),error:i})},success:function(e){AJS.messages.success({body:e,fadeout:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(2)],r=function(e,t){var n=gettext("There was a problem processing your request."),i=function(i){var r,o=null;if(i)if("string"==typeof i)o=i;else{if(i.responseText)try{r=JSON.parse(i.responseText),o=r.error&&r.error.message}catch(a){}o=o||n}else o=n;e.messages.error({body:t.escape(o),fadeout:!1})};return function(){var e=Array.prototype.slice.apply(arguments);if(0===e.length)return i();for(var t=0,n=e.length;n>t;++t)if(e[t].responseText)return i(e[t]);return i(e[0])}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return{mask:function(t,n){this.unmask(t);var i=e('<div class="plain-mask"></div>');t.append(i),n&&(n.backgroundColor&&i.css("background-color",n.backgroundColor),n.spinner&&i.spin(n.spinner))},unmask:function(e){var t=e.find(".plain-mask");t.spin(!1).remove()},spinnerSizes:{TINY:"tiny",SMALL:"small",LARGE:"large"}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(514),n(517),n(518),n(521),n(159)],r=function(e,t,n,i,r,o){e(document).ready(t.init),e(document).on("pjax:end",function(n){var i=e(n.target);t.init({context:i}),t.initOnload({context:i})}),o(t.initOnload)}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(515),n(516)],r=function(e,t,n){function i(t,n){return t=t||{},void 0!==t.containers?t.containers:void 0!==t.context?t.context.find(n):e(n)}function r(n){function r(e,t){var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return n?n[1]||"":""}var o=i(n,".ap-container");o.each(function(){var n=e(this).data("source"),i=e(this).data("width"),o=e(this).data("height"),a=r(n,"xdm_c").replace(/^channel-/,""),s={ns:a,key:e(this).data("key"),dlg:e(this).data("dlg"),general:e(this).data("general"),src:n,cp:e(this).data("cp")||"",productCtx:JSON.stringify({encContext:e(this).data("enc-context")})};i&&(s.w=i),o&&(s.h=o),e(this).attr("id","ap-"+a),e(this).find(".ap-content").attr("id","embedded-"+a),t.create(s)})}function o(e){var t=i(e,".ap-container-onload");t.removeClass("ap-container-onload").addClass("ap-container"),r({containers:t})}return window._AP.contentResolver=n,{init:r,initOnload:o}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,i;(function(t){!function(t){e.exports=t()}(function(){var e;return function n(e,t,r){function o(s,l){if(!t[s]){if(!e[s]){var u="function"==typeof i&&i;if(!l&&u)return i(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return o(n?n:t)},d,d.exports,n,e,t,r)}return t[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./addons"),o=i(r),a=e("./content"),s=i(a),l=e("./create"),u=i(l),c=e("./dialog/api"),d=i(c),h=e("./dialog/binder"),p=i(h),f=e("./dialog/rpc"),m=i(f),g=e("./env"),v=i(g),y=e("./inline-dialog/rpc"),b=i(y),w=e("./inline-dialog/binder"),x=i(w),_=e("./loading-indicator"),k=i(_),C=e("./messages/rpc"),$=i(C),S=e("./resize"),T=i(S),D=e("./rpc"),P=i(D),E=e("./status-helper"),A=i(E),I=e("../common/ui-params"),R=i(I),M=e("../common/uri"),j=i(M),L=e("./propagate/rpc"),N=i(L);window._AP||(window._AP={}),AJS.toInit(p["default"]),AJS.toInit(x["default"]),P["default"].extend(o["default"]),P["default"].extend(m["default"]),P["default"].extend(v["default"]),P["default"].extend(b["default"]),P["default"].extend(k["default"]),P["default"].extend($["default"]),P["default"].extend(T["default"]),P["default"].extend(N["default"]),n["default"]={extend:P["default"].extend,init:P["default"].init,uiParams:R["default"],create:u["default"],_uriHelper:j["default"],_statusHelper:A["default"],webItemHelper:s["default"],dialog:d["default"]},t.exports=n["default"]},{"../common/ui-params":10,"../common/uri":11,"./addons":13,"./content":15,"./create":16,"./dialog/api":17,"./dialog/binder":18,"./dialog/rpc":21,"./env":23,"./inline-dialog/binder":24,"./inline-dialog/rpc":25,"./loading-indicator":28,"./messages/rpc":30,"./propagate/rpc":31,"./resize":32,"./rpc":33,"./status-helper":34}],2:[function(n,i,r){(function(t){!function(n){var o="object"==typeof r&&r,a="object"==typeof i&&i&&i.exports==o&&i,s="object"==typeof t&&t;(s.global===s||s.window===s)&&(n=s);var l=function(e){this.message=e};l.prototype=new Error,l.prototype.name="InvalidCharacterError";var u=function(e){throw new l(e)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=/[\t\n\f\r ]/g,h=function(e){e=String(e).replace(d,"");var t=e.length;t%4==0&&(e=e.replace(/==?$/,""),t=e.length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&u("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,o="",a=-1;++a<t;)i=c.indexOf(e.charAt(a)),n=r%4?64*n+i:i,r++%4&&(o+=String.fromCharCode(255&n>>(-2*r&6)));return o},p=function(e){e=String(e),/[^\0-\xFF]/.test(e)&&u("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,i,r,o=e.length%3,a="",s=-1,l=e.length-o;++s<l;)t=e.charCodeAt(s)<<16,n=e.charCodeAt(++s)<<8,i=e.charCodeAt(++s),r=t+n+i,a+=c.charAt(r>>18&63)+c.charAt(r>>12&63)+c.charAt(r>>6&63)+c.charAt(63&r);return 2==o?(t=e.charCodeAt(s)<<8,n=e.charCodeAt(++s),r=t+n,a+=c.charAt(r>>10)+c.charAt(r>>4&63)+c.charAt(r<<2&63)+"="):1==o&&(r=e.charCodeAt(s),a+=c.charAt(r>>2)+c.charAt(r<<4&63)+"=="),a},f={encode:p,decode:h,version:"0.1.0"};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return f});else if(o&&!o.nodeType)if(a)a.exports=f;else for(var m in f)f.hasOwnProperty(m)&&(o[m]=f[m]);else n.base64=f;
}(this)}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,n,i){/*!
	 * jsUri
	 * https://github.com/derek-watson/jsUri
	 *
	 * Copyright 2013, Derek Watson
	 * Released under the MIT license.
	 *
	 * Includes parseUri regular expressions
	 * http://blog.stevenlevithan.com/archives/parseuri
	 * Copyright 2007, Steven Levithan
	 * Released under the MIT license.
	 */
!function(t){function i(e){return e&&(e=e.toString().replace(s.pluses,"%20"),e=decodeURIComponent(e)),e}function r(e){var t=s.uri_parser,n=["source","protocol","authority","userInfo","user","password","host","port","isColonUri","relative","path","directory","file","query","anchor"],i=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=i[t]||""}),r}function o(e){var t,n,r,o,a,l,u,c=[];if("undefined"==typeof e||null===e||""===e)return c;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(s.query_separator),t=0,u=n.length;u>t;t++)r=n[t],o=r.indexOf("="),0!==o&&(a=i(r.substring(0,o)),l=i(r.substring(o+1)),c.push(-1===o?[r,null]:[a,l]));return c}function a(e){this.uriParts=r(e),this.queryPairs=o(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var s={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;o>i;){var a;i in r&&(a=r[i],e.call(n,a,i,r)),i++}}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){a.prototype[e]=function(t){return"undefined"!=typeof t&&(this.uriParts[e]=t),this.uriParts[e]}}),a.prototype.hasAuthorityPrefix=function(e){return"undefined"!=typeof e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},a.prototype.isColonUri=function(e){return"undefined"==typeof e?!!this.uriParts.isColonUri:void(this.uriParts.isColonUri=!!e)},a.prototype.query=function(e){var t,n,i,r="";for("undefined"!=typeof e&&(this.queryPairs=o(e)),t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:(r+=n[0],r+="=","undefined"!=typeof n[1]&&(r+=encodeURIComponent(n[1])));return r.length>0?"?"+r:r},a.prototype.getQueryParamValue=function(e){var t,n,i;for(n=0,i=this.queryPairs.length;i>n;n++)if(t=this.queryPairs[n],e===t[0])return t[1]},a.prototype.getQueryParamValues=function(e){var t,n,i,r=[];for(t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],e===n[0]&&r.push(n[1]);return r},a.prototype.deleteQueryParam=function(e,t){var n,r,o,a,s,l=[];for(n=0,s=this.queryPairs.length;s>n;n++)r=this.queryPairs[n],o=i(r[0])===i(e),a=r[1]===t,(1!==arguments.length||o)&&(2!==arguments.length||o&&a)||l.push(r);return this.queryPairs=l,this},a.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},a.prototype.hasQueryParam=function(e){var t,n=this.queryPairs.length;for(t=0;n>t;t++)if(this.queryPairs[t][0]==e)return!0;return!1},a.prototype.replaceQueryParam=function(e,t,n){var r,o,a=-1,s=this.queryPairs.length;if(3===arguments.length){for(r=0;s>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)&&decodeURIComponent(o[1])===i(n)){a=r;break}a>=0&&this.deleteQueryParam(e,i(n)).addQueryParam(e,t,a)}else{for(r=0;s>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)){a=r;break}this.deleteQueryParam(e),this.addQueryParam(e,t,a)}return this},["protocol","hasAuthorityPrefix","isColonUri","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);a.prototype[t]=function(t){return this[e](t),this}}),a.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},a.prototype.origin=function(){var e=this.scheme();return this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),(this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(e+=":"+this.port())),e},a.prototype.addTrailingSlash=function(){var e=this.path()||"";return"/"!==e.substr(-1)&&this.path(e+"/"),this},a.prototype.toString=function(){var e,t=this.origin();return this.isColonUri()?this.path()&&(t+=":"+this.path()):this.path()?(e=this.path(),s.ends_with_slashes.test(t)||s.starts_with_slashes.test(e)?(t&&t.replace(s.ends_with_slashes,"/"),e=e.replace(s.starts_with_slashes,"/")):t+="/",t+=e):this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},a.prototype.clone=function(){return new a(this.toString())},"function"==typeof e&&e.amd?e(function(){return a}):"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=a:t.Uri=a}(this)},{}],4:[function(n,i,r){(function(t){!function(n){function o(e){for(var t,n,i=[],r=0,o=e.length;o>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&o>r?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function a(e){for(var t,n=e.length,i=-1,r="";++i<n;)t=e[i],t>65535&&(t-=65536,r+=w(t>>>10&1023|55296),t=56320|1023&t),r+=w(t);return r}function s(e){if(e>=55296&&57343>=e)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function l(e,t){return w(e>>t&63|128)}function u(e){if(0==(4294967168&e))return w(e);var t="";return 0==(4294965248&e)?t=w(e>>6&31|192):0==(4294901760&e)?(s(e),t=w(e>>12&15|224),t+=l(e,6)):0==(4292870144&e)&&(t=w(e>>18&7|240),t+=l(e,12),t+=l(e,6)),t+=w(63&e|128)}function c(e){for(var t,n=o(e),i=n.length,r=-1,a="";++r<i;)t=n[r],a+=u(t);return a}function d(){if(b>=y)throw Error("Invalid byte index");var e=255&v[b];if(b++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(){var e,t,n,i,r;if(b>y)throw Error("Invalid byte index");if(b==y)return!1;if(e=255&v[b],b++,0==(128&e))return e;if(192==(224&e)){var t=d();if(r=(31&e)<<6|t,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=d(),n=d(),r=(15&e)<<12|t<<6|n,r>=2048)return s(r),r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=d(),n=d(),i=d(),r=(15&e)<<18|t<<12|n<<6|i,r>=65536&&1114111>=r))return r;throw Error("Invalid UTF-8 detected")}function p(e){v=o(e),y=v.length,b=0;for(var t,n=[];(t=h())!==!1;)n.push(t);return a(n)}var f="object"==typeof r&&r,m="object"==typeof i&&i&&i.exports==f&&i,g="object"==typeof t&&t;(g.global===g||g.window===g)&&(n=g);var v,y,b,w=String.fromCharCode,x={version:"2.0.0",encode:c,decode:p};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return x});else if(f&&!f.nodeType)if(m)m.exports=x;else{var _={},k=_.hasOwnProperty;for(var C in x)k.call(x,C)&&(f[C]=x[C])}else n.utf8=x}(this)}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("base-64"),o=i(r),a=e("utf8"),s=i(a);n["default"]={encode:function(e){return o["default"].encode(s["default"].encode(e))},decode:function(e){return s["default"].decode(o["default"].decode(e))}},t.exports=n["default"]},{"base-64":2,utf8:4}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i;i=e("../host/dollar"),n["default"]=i,t.exports=n["default"]},{"../host/dollar":22}],7:[function(e,t,n){"use strict";function i(e,t){p.forEach(function(n){document.addEventListener(n,function(n){n.channelKey!==e&&t(e,n.type,o(n))})}),f.forEach(function(n){document.addEventListener(n,function(n){n.channelKey!==e&&c(n.keyCode)&&t(e,n.type,a(n))})})}function r(e,t,n){var i=s(e,t,n);i&&l(i)}function o(e){return{bubbles:!0,cancelable:!0,button:e.button,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey}}function a(e){return{bubbles:!0,cancelable:!0,key:e.key,code:e.code,keyCode:e.keyCode,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,locale:null}}function s(e,t,n){n.view=window;var i=void 0;return p.indexOf(t)>-1?"function"==typeof window.Event?i=new MouseEvent(t,n):(i=document.createEvent("MouseEvent"),i.initMouseEvent(t,n.bubbles,n.cancelable,n.view,0,0,0,0,0,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,null)):f.indexOf(t)>-1?"function"==typeof window.Event?i=new KeyboardEvent(t,n):(i=document.createEvent("KeyboardEvent"),i.initKeyboardEvent(t,n.bubbles,n.cancelable,n.view,n.key,0,u(n),!1,n.locale)):h("Event "+t+" not supported"),i&&(i.channelKey=e),i}function l(e){if(document.body.dispatchEvent(e),AJS&&"click"===e.type){var t=AJS.$(".aui-blanket");t.length>0&&t[0]&&t[0].dispatchEvent(e)}}function u(e){var t=[];return e.shiftKey&&t.push("Shift"),e.ctrlKey&&t.push("Ctrl"),e.metaKey&&t.push("Meta"),e.altKey&&t.push("Alt"),t.join(",")}function c(e){return m.indexOf(e)>-1}Object.defineProperty(n,"__esModule",{value:!0});var d=window,h=d.AJS&&d.AJS.log||d.console&&d.console.log||function(){},p=["click"],f=["keydown","keyup"],m=[27];n["default"]={bindListeners:i,receiveEvent:r,constructLegacyModifierString:u,supportedMouseEvents:p,supportedKeyboardEvents:f,isAllowedKeyCode:c,createEvent:s},t.exports=n["default"]},{}],8:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){this._key=e,this._origin=t,this._events={},this._any=[]}function o(e,t){for(var n=0;n<e.length;++n)try{e[n].apply(null,t)}catch(i){u(i.stack||i.message||i)}}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./dollar"),s=i(a),l=window,u=l.AJS&&l.AJS.log||l.console&&l.console.log||function(){},c=r.prototype;c.on=function(e,t){return e&&t&&this._listeners(e).push(t),this},c.once=function(e,t){var n=this,i=function r(){n.off(e,r),t.apply(null,arguments)};return this.on(e,i),this},c.onAny=function(e){return this._any.push(e),this},c.off=function(e,t){var n=this._events[e];if(n){var i=s["default"].inArray(t,n);i>=0&&n.splice(i,1),0===n.length&&delete this._events[e]}return this},c.offAll=function(e){return e?delete this._events[e]:this._events={},this},c.offAny=function(e){var t=this._any,n=s["default"].inArray(e,t);return n>=0&&t.splice(n,1),this},c.emit=function(e){return this._emitEvent(this._event.apply(this,arguments))},c._event=function(e){return{name:e,args:[].slice.call(arguments,1),attrs:{},source:{key:this._key,origin:this._origin}}},c._emitEvent=function(e){var t=e.args.concat(e);return o(this._listeners(e.name),t),o(this._any,[e.name].concat(t)),this},c._listeners=function(e){return this._events[e]=this._events[e]||[]},n["default"]={Events:r},t.exports=n["default"]},{"./dollar":6}],9:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return o(e).iss}function o(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(0>t||t>=n)throw'Invalid JWT: must contain 2 period (".") characters.';var i=e.substring(t+1,n);if(null===i||""===i)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var r=l["default"].decode.call(window,i);return JSON.parse(r)}function a(e,t){void 0===t&&(t=60);var n=o(e),i=0,r=Math.floor(Date.now()/1e3);return n&&n.exp&&(i=n.exp),t>i-r?!0:!1}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./base64"),l=i(s);n["default"]={parseJwtIssuer:r,parseJwtClaims:o,isJwtExpired:a},t.exports=n["default"]},{"./base64":5}],10:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base64"),o=i(r),a=e("./uri"),s=i(a);n["default"]={encode:function(e){if(e){var t=JSON.stringify(e);return o["default"].encode.call(window,t)}},fromUrl:function(e){var t=new s["default"].init(e).getQueryParamValue("ui-params");return this.decode(t)},fromWindowName:function(e,t){e=e||window;var n=this.decode(e.name);return t?n?n[t]:void 0:n},decode:function(e){var t={};if(e&&e.length>0)try{t=JSON.parse(o["default"].decode.call(window,e))}catch(n){console&&console.log&&console.log("Cannot decode passed ui params",e)}return t}},t.exports=n["default"]},{"./base64":5,"./uri":11}],11:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("jsuri"),o=i(r);n["default"]={init:o["default"]},t.exports=n["default"]},{jsuri:3}],12:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){function i(e,t,n){try{T.postMessage(JSON.stringify({c:P,i:e,t:t,m:n}),D)}catch(i){k(x(i))}}function o(e,t,n,r){var o=Math.floor(1e9*Math.random()).toString(16);U.add(o,n,r),i(o,"request",{n:e,a:t})}function s(e,t){i(e,"done",t)}function u(e,t){i(e,"fail",t)}function d(e){try{var t=JSON.parse(e.data),n=t.i,i=t.c,r=t.t,o=t.m;if(e.source!==T&&e.origin.toLowerCase()===D&&i===P&&(T=e.source),e.source!==T||e.origin.toLowerCase()!==D||i!==P)return;if("request"===r){var a,l,c,d=o.n,h=o.a,p=L[d];if(p){a=function(e){s(n,e)},l=function(e){u(n,e)},c=(h?h.length:0)<p.length;var f=L;$.isHost===!0?(f=$,f.analytics&&f.analytics.trackBridgeMethod(d)):f.isHost=!1;try{c?p.apply(f,h.concat([a,l])):a(p.apply(f,h))}catch(m){l(x(m)),C(m)}}else _("Unhandled request:",t)}else("done"===r||"fail"===r)&&(U.invoke(r,n,o)||_("Unhandled response:",r,n,o))}catch(m){k(x(m))}}function p(t){return function(){function n(){return e.isFunction(a[a.length-1])?a.pop():void 0}var i,r,a=[].slice.call(arguments);r=n(),i=n(),i||(i=r,r=void 0),o(t,a,i,r)}}function m(e){$.isActive()?d(e.originalEvent?e.originalEvent:e):v()}function g(){e(window).bind("message",m)}function v(){e(window).unbind("message",m)}function y(e,t){return new c["default"].init(e).getQueryParamValue(t)}function b(e){return new c["default"].init(e).origin()}function w(t){if(!t.container)throw new Error("config.container must be defined");var n=document.createElement("iframe"),i="easyXDM_"+t.container+"_provider",r="";return t.uiParams&&(r=h["default"].encode(t.uiParams)),e.extend(n,{id:i,name:r,frameBorder:"0"},t.props),n.setAttribute("rel","nofollow"),e(document.getElementById(t.container)).append(n),e(n).trigger("ra.iframe.create"),n.src=t.remote,n}function x(e){return e.message||e.toString()}function _(){r.debug&&k.apply(M,["DEBUG:"].concat([].slice.call(arguments)))}function k(){var t=e.log||M.AJS&&M.AJS.log;t&&t.apply(M,arguments)}function C(){var e=M.AJS&&M.AJS.error;e&&e.apply(M,arguments)}var $,S,T,D,P,E,A,I,R,M=window,j=M.location.toString(),L=n.local||{},N=n.remote||[],O=b(j),U=function(){var e={};return{add:function(t,n,i){e[t]={done:n||null,fail:i||null,async:!!n}},invoke:function(t,n,i){var r;return e[n]&&(e[n][t]?(e[n][t](i),r=!0):r=!e[n].async&&"fail"!==t,delete e[n]),r}}}();if(/xdm_e/.test(j)){T=M.parent,A="local";var H=y(j,"jwt");I=H?l["default"].parseJwtIssuer(H):y(j,"oauth_consumer_key"),null===I&&(I=Math.random()),R=A,D=y(j,"xdm_e").toLowerCase(),P=y(j,"xdm_c"),E={isHost:!1,isActive:function(){return!0}}}else{e(document.getElementById(t.container)).find("iframe").trigger("ra.iframe.destroy");var F=w(t);T=F.contentWindow,A=y(t.remote,"oauth_consumer_key")||y(t.remote,"jwt"),I=t.remoteKey,R=I,D=b(t.remote).toLowerCase(),P=t.channel,E={isHost:!0,iframe:F,uiParams:t.uiParams,destroy:function(){window.clearTimeout($.timeout),v(),$.iframe&&(e($.iframe).remove(),delete $.iframe)},isActive:function(){return e.contains(document.documentElement,$.iframe)}},e(F).on("ra.iframe.destroy",E.destroy)}S=R+"|"+(f+=1),$=e.extend({id:S,remoteOrigin:D,channel:P,addonKey:R},E),e.each(N,function(e,t){"number"==typeof e&&(e=t),$[e]=p(e)});var q=$.events=new a["default"].Events(A,O);return q.onAny(function(){var t=arguments[arguments.length-1],n=t.trace=t.trace||{},i=$.id+"|xdm";($.isHost&&!n[i]&&t.source.channel!==$.id||!$.isHost&&t.source.key===A)&&(n[i]=!0,t=e.extend({},t),delete t.trace,_("Forwarding "+($.isHost?"host":"addon")+" event:",t),o("_event",[t]))}),L._event=function(e){delete e.trace,this.isHost&&(e.source={channel:this.id||S,key:this.addonKey,origin:this.remoteOrigin||D}),_("Receiving as "+(this.isHost?"host":"addon")+" event:",e),q._emitEvent(e)},g(),$}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./events"),a=i(o),s=e("./jwt"),l=i(s),u=e("./uri"),c=i(u),d=e("./ui-params"),h=i(d),p=e("../host/util"),f=(i(p),0);n["default"]=r,t.exports=n["default"]},{"../host/util":35,"./events":8,"./jwt":9,"./ui-params":10,"./uri":11}],13:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),a=e("./rpc"),s=(i(a),{});n["default"]=function(){var e={_emitEvent:function(e){o["default"].each(s[e.source.key],function(t,n){n.bus._emitEvent(e)})},remove:function(e){var t=s[e.addonKey][e.id];return t&&t.bus.offAny(t.listener),delete s[e.addonKey][e.id],this},init:function(t,n){s[n.addonKey]||(s[n.addonKey]={});var i=s[n.addonKey][n.id]={bus:n.events,listener:function(){var t=arguments[arguments.length-1],i=t.trace=t.trace||{},r=n.id+"|addon";i[r]||(i[r]=!0,e._emitEvent(t))}};i.bus.onAny(i.listener),i.bus.on("ra.iframe.destroy",function(){e.remove(n)})}};return e},t.exports=n["default"]},{"./dollar":22,"./rpc":33}],14:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function o(e,t){var n={};this.addonKey=e,this.moduleKey=t,this.iframePerformance={start:function(){n.startLoading=r()},end:function(){var i=r()-n.startLoading;d.track("iframe.performance.load",{addonKey:e,moduleKey:t,value:i>u?"x":Math.ceil(i/c)}),delete n.startLoading},timeout:function(){d.track("iframe.performance.timeout",{addonKey:e,moduleKey:t}),this.end()},cancel:function(){d.track("iframe.performance.cancel",{addonKey:e,moduleKey:t})}}}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./dollar"),s=i(a),l=["resize","init"],u=2e4,c=100,d=o.prototype;d.getKey=function(){return this.addonKey+":"+this.moduleKey},d.track=function(e,t){var n="connect.addon."+e;if(AJS.Analytics)AJS.Analytics.triggerPrivacyPolicySafeEvent(n,t);else{if(!AJS.trigger)return!1;AJS.trigger("analyticsEvent",{name:n,data:t})}return!0},d.trackBridgeMethod=function(e){return-1!==s["default"].inArray(e,l)?!1:void this.track("bridge.invokemethod",{name:e,addonKey:this.addonKey,moduleKey:this.moduleKey})},n["default"]={get:function(e,t){return new o(e,t)}},t.exports=n["default"]},{"./dollar":22}],15:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.attr("class"),n=t?t.match(/ap-plugin-key-([^\s]*)/):null;return c["default"].isArray(n)?n[1]:!1}function o(e){var t=e.attr("class"),n=t?t.match(/ap-module-key-([^\s]*)/):null;return c["default"].isArray(n)?n[1]:!1}function a(e){var t=o(e),n=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog";return window._AP[n+"Options"][t]||{}}function s(e){var t=new h["default"].init(e).queryPairs,n={};return c["default"].each(t,function(e,t){n[t[0]]=t[1]}),n}function l(e,t,n){function i(e){e.preventDefault();var i=c["default"](e.target).closest(t),o=i.attr("href"),a=new h["default"].init(o),l={bindTo:i,header:i.text(),width:a.getQueryParamValue("width"),height:a.getQueryParamValue("height"),cp:a.getQueryParamValue("cp"),key:r(i),productContext:s(o)};n(o,l,e.type)}c["default"](window.document).on(e,t,i)}Object.defineProperty(n,"__esModule",{value:!0});var u=e("./dollar"),c=i(u),d=e("../common/uri"),h=i(d);n["default"]={eventHandler:l,getOptionsForWebItem:a,getWebItemPluginKey:r,getWebItemModuleKey:o},t.exports=n["default"]},{"../common/uri":11,"./dollar":22}],16:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(!e)throw new Error("ns undefined");return s["default"](document.getElementById("embedded-"+e))}function o(e){"object"!=typeof e.uiParams&&(e.uiParams=p["default"].fromUrl(e.src));var t=e.ns,n="embedded-"+t,i="channel-"+t,r=e.w||"100%",o=e.h||"0";"object"!=typeof e.uiParams&&(e.uiParams={}),e.general&&(e.uiParams.isGeneral=!0);var a={remote:e.src,remoteKey:e.key,container:n,channel:i,props:{width:r,height:o},uiParams:e.uiParams};e.productCtx&&!e.productContext&&(e.productContext=JSON.parse(e.productCtx)),d["default"].extend({init:function(n,i){i.analytics=u["default"].get(i.addonKey,t),i.analytics.iframePerformance.start(),i.productContext=e.productContext}}),d["default"].init(e,a)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./dollar"),s=i(a),l=e("./analytics"),u=i(l),c=e("./rpc"),d=i(c),h=e("../common/ui-params"),p=i(h),f=e("./util"),m=(i(f),window.requestAnimationFrame||function(e){setTimeout(e,10)});n["default"]=function(e){function t(){return 0===r(e.ns).length&&10>n?void setTimeout(function(){n++,t()},50):void o(e)}var n=0;AJS.$.isReady?m(t):s["default"](t)},t.exports=n["default"]},{"../common/ui-params":10,"./analytics":14,"./dollar":22,"./rpc":33,"./util":35}],17:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){27===e.keyCode&&c&&c.hide&&(c.hide(),b["default"](document).unbind("keydown",r))}function o(e,t,n){function i(e){e.isEnabled()&&e.$el.trigger("ra.dialog.click",e.dispatch)}var r=b["default"]("#"+e.id),o=["ap-aui-dialog2"];if(n&&o.push("ap-aui-dialog2-chromeless"),0===r.length?r=b["default"](aui.dialog.dialog2({id:e.id,titleText:e.header,titleId:e.titleId,size:e.size,extraClasses:o,removeOnHide:!0,footerActionContent:!0,modal:!0})):(r=b["default"](r[0]),r.find(".aui-dialog2-header-main").text(e.header),o&&r.addClass(o.join(" "))),n)r.find("header, footer").hide();else{_.submit.setText(e.submitText),_.cancel.setText(e.cancelText);var a=r.find(".aui-dialog2-footer-actions");a.find("button").remove(),a.append(_.submit.$el,_.cancel.$el),t.data("ra.dialog.buttons",_)}return b["default"].each(_,function(e,t){t.$el.click(function(){i(t)})}),r}function a(e,t){e.append('<div id="embedded-'+t.ns+'" class="ap-dialog-container ap-content"/>')}function s(e,t){if("string"==typeof e){var n=e.indexOf("%")===e.length-1;e=parseInt(e,10),n&&(e=e/100*t)}return e}function l(){u&&(u.find("iframe").trigger("ra.iframe.destroy").removeData("ra.dialog.buttons").unbind(),u=null),c.hide()}Object.defineProperty(n,"__esModule",{value:!0});var u,c,d,h=e("../create"),p=i(h),f=e("./button"),m=i(f),g=e("../status-helper"),v=i(g),y=e("../dollar"),b=i(y),w=b["default"](window),x=0,_={submit:m["default"].submit({done:l}),cancel:m["default"].cancel({done:l})};n["default"]={id:d,getButton:function(e){var t=u?u.data("ra.dialog.buttons"):null;return e&&t?t[e]:t},create:function(e,t){var n,i={width:"50%",height:"50%"},d=e.id||"ap-dialog-"+(x+=1),h=b["default"].extend(!0,{id:d},i,e,{uiParams:{isDialog:!0,isInlineAddon:!0}});"100%"===h.width&&"100%"===h.height&&(h.size="maximum"),h.w=s(h.width,w.width()),h.h=s(h.height,w.height()),u=b["default"]("<div />").addClass("ap-servlet-placeholder ap-container").attr("id","ap-"+e.ns).bind("ra.dialog.close",l),n=e.chrome?o(h,u):o(h,u,!0),e.size?(h.w="100%",h.h="100%"):(AJS.layer(n).changeSize(h.w,h.h),n.removeClass("aui-dialog2-medium")),n.find(".aui-dialog2-content").append(u),c=AJS.dialog2(n),c.on("hide",l),b["default"](document).on("keydown",r),b["default"].each(_,function(e,t){t.click(function(){t.dispatch(!0)})}),a(u,h),t!==!1&&u.append(v["default"].createStatusMessages()),e.src&&p["default"](h),n.on("ra.iframe.create","iframe",function(){this.focus()});var f=b["default"]("#"+n.attr("id"));return 0===f.length&&c.show(),c},close:l},t.exports=n["default"]},{"../create":16,"../dollar":22,"../status-helper":34,"./button":19}],18:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../content"),o=i(r),a=e("./api"),s=(i(a),e("./factory")),l=i(s),u=e("../dollar"),c=i(u);n["default"]=function(){function e(e,t){var n=o["default"].getOptionsForWebItem(t.bindTo),i=o["default"].getWebItemModuleKey(t.bindTo),r=o["default"].getWebItemPluginKey(t.bindTo);c["default"].extend(t,n),t.ns||(t.ns=i),t.container||(t.container=t.ns),"string"==typeof t.chrome&&(t.chrome="false"===t.chrome.toLowerCase()?!1:!0),void 0===t.chrome&&(t.chrome=!0),l["default"]({key:r,moduleKey:i},t,t.productContext)}var t="click",n=".ap-dialog";o["default"].eventHandler(t,n,e)},t.exports=n["default"]},{"../content":15,"../dollar":22,"./api":17,"./factory":20}],19:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){this.$el=a["default"]("<button />").text(e.text).addClass("aui-button aui-button-"+e.type).addClass(e.additionalClasses),this.isEnabled=function(){return!("true"===this.$el.attr("aria-disabled"))},this.setEnabled=function(t){return e.noDisable===!0?!1:(this.$el.attr("aria-disabled",!t),!0)},this.setEnabled(!0),this.click=function(e){e?(this.$el.unbind("ra.dialog.click"),this.$el.bind("ra.dialog.click",e)):this.dispatch(!0)},this.dispatch=function(t){var n=t?"done":"fail";e.actions&&e.actions[n]&&e.actions[n]()},this.setText=function(e){e&&this.$el.text(e)}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("../dollar"),a=i(o);n["default"]={submit:function(e){return new r({type:"primary",text:"Submit",additionalClasses:"ap-dialog-submit",actions:e})},cancel:function(e){return new r({type:"link",text:"Cancel",noDisable:!0,additionalClasses:"ap-dialog-cancel",actions:e})}},t.exports=n["default"]},{"../dollar":22}],20:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),a=e("../dollar"),s=i(a);n["default"]=function(e,t,n){var i,r,a=s["default"].extend({isDialog:1},e.uiParams);if(o["default"].create({id:e.id,ns:e.moduleKey||e.key,chrome:t.chrome||e.chrome,header:t.header,width:t.width,height:t.height,size:t.size,submitText:t.submitText,cancelText:t.cancelText},!1),r=s["default"](".ap-dialog-container"),e.url)throw new Error("Cannot retrieve dialog content by URL");return i=window._AP.contentResolver.resolveByParameters({addonKey:e.key,moduleKey:e.moduleKey,productContext:n,uiParams:a}),i.done(function(e){var t=s["default"](e);t.addClass("ap-dialog-container"),r.replaceWith(t)}).fail(function(e,t,n){var i=s["default"]('<p class="title" />').text("Unable to load add-on content. Please try again later."),o=t+(n?": "+n.toString():"");r.html('<div class="aui-message error ap-aui-message"></div>'),r.find(".error").text(o),r.find(".error").prepend(i),AJS.log(o)}),o["default"]},t.exports=n["default"]},{"../dollar":22,"./api":17}],21:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),a=e("./factory"),s=i(a),l=e("../dollar"),u=i(l);n["default"]=function(){return{stubs:["dialogMessage"],init:function(e,t){if("1"===e.dlg&&(t.uiParams.isDialog=!0),t.uiParams.isDialog){var n=o["default"].getButton();n&&u["default"].each(n,function(e,n){n.click(function(n,i){t.isActive()&&t.buttonListenerBound?t.dialogMessage(e,i):i(!0)})})}},internals:{dialogListenerBound:function(){this.buttonListenerBound=!0},setDialogButtonEnabled:function(e,t){o["default"].getButton(e).setEnabled(t)},isDialogButtonEnabled:function(e,t){var n=o["default"].getButton(e);t(n?n.isEnabled():void 0)},createDialog:function(e){var t={key:this.addonKey};if(e.key)t.moduleKey=e.key;else if(e.url)throw new Error("Cannot open dialog by URL, please use module key");if(0!==u["default"](".aui-dialog2 :visible").length)throw new Error("Cannot open dialog when a layer is already visible");s["default"](t,e,this.productContext)},closeDialog:function(){o["default"].close()}}}},t.exports=n["default"]},{"../dollar":22,"./api":17,"./factory":20}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=AJS.$,t.exports=n["default"]},{}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){return{internals:{getLocation:function(){return window.location.href}}}},t.exports=n["default"]},{}],24:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../content"),o=i(r),a=e("./simple"),s=i(a),l=e("../dollar"),u=i(l);n["default"]=function(){function e(e,t,n){var i=o["default"].getOptionsForWebItem(t.bindTo);u["default"].extend(t,i),("true"===t.onHover||"click"===n)&&(t.onHover===!0&&t.bindTo.hasClass("active")||s["default"](e,t).show())}var t=".ap-inline-dialog",n="click mouseover mouseout";o["default"].eventHandler(n,t,e)},t.exports=n["default"]},{"../content":15,"../dollar":22,"./simple":26}],25:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return e.closest(".contents").data("inlineDialog")}function o(e,t,n){e.closest(".contents").css({width:t,height:n}),a(e)}function a(e){r(e).refresh()}function s(e){r(e).hide()}Object.defineProperty(n,"__esModule",{value:!0});var l=e("../dollar"),u=i(l);n["default"]=function(){return{init:function(e,t){t.uiParams.isInlineDialog&&u["default"](t.iframe).closest(".ap-container").on("resized",function(e,n){o(u["default"](t.iframe),n.width,n.height)})},internals:{hideInlineDialog:function(){s(u["default"](this.iframe))}}}},t.exports=n["default"]},{"../dollar":22}],26:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../dollar"),o=i(r),a=e("../content"),s=i(a);n["default"]=function(e,t){function n(e,n,r){n=o["default"](n),e.data("inlineDialog",i);var a=s["default"].getWebItemPluginKey(n),l=s["default"].getWebItemModuleKey(n),u=window._AP.contentResolver.resolveByParameters({addonKey:a,moduleKey:l,isInlineDialog:!0,productContext:t.productContext,uiParams:{isInlineDialog:!0}});u.done(function(n){e.empty().append(n),(t.width||t.height)&&e.css({width:t.width,height:t.height})}).fail(function(t,n,i){var r=o["default"]('<p class="title" />').text("Unable to load add-on content. Please try again later.");e.html('<div class="aui-message error ap-aui-message"></div>'),e.find(".error").append(r);var a=n+(i?": "+i.toString():"");e.find(".error").text(a),AJS.log(a)}).always(function(){r()})}var i;if(t.bindTo&&t.bindTo.jquery){var r=t.bindTo.hasClass("ap-inline-dialog")?t.bindTo:t.bindTo.closest(".ap-inline-dialog"),a=r.attr("id");if(a){var l="ap-inline-dialog-content-"+a;return i=o["default"](document.getElementById("inline-dialog-"+l)),0!==i.length&&i.remove(),i=AJS.InlineDialog(t.bindTo,l,n,t),{id:i.attr("id"),show:function(){i.show()},hide:function(){i.hide()}}}}},t.exports=n["default"]},{"../content":15,"../dollar":22}],27:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=a["default"].Deferred(function(t){var n=window._AP.contentResolver.resolveByParameters({addonKey:e.addonKey,moduleKey:e.moduleKey,productContext:e.productContext,uiParams:e.uiParams,width:e.width,height:e.height,classifier:"json"});n.done(function(e){var n=JSON.parse(e);t.resolve(n.src)})});return t}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./dollar"),a=i(o),s=e("../common/jwt"),l=i(s);n["default"]={updateUrl:r,isExpired:l["default"].isJwtExpired},t.exports=n["default"]},{"../common/jwt":9,"./dollar":22}],28:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),a=e("./rpc"),s=(i(a),e("./status-helper")),l=i(s);n["default"]=function(){return{init:function(e,t){var n=o["default"](t.iframe).closest(".ap-container");l["default"].showLoadingStatus(n,0),n.find(".ap-load-timeout a.ap-btn-cancel").click(function(){
l["default"].showLoadErrorStatus(n),t.analytics&&t.analytics.iframePerformance&&t.analytics.iframePerformance.cancel()}),t.timeout=setTimeout(function(){t.timeout=null,l["default"].showloadTimeoutStatus(n),t.isActive()&&t.analytics&&t.analytics.iframePerformance&&t.analytics.iframePerformance.timeout()},2e4)},internals:{init:function(){this.analytics&&this.analytics.iframePerformance&&this.analytics.iframePerformance.end();var e=o["default"](this.iframe).closest(".ap-container");l["default"].showLoadedStatus(e),clearTimeout(this.timeout),e.find(".ap-content").addClass("iframe-init")}}}},t.exports=n["default"]},{"./dollar":22,"./rpc":33,"./status-helper":34}],29:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return 0==e.search(/^ap\-message\-[0-9]+$/)}function o(){var e=l["default"]("#"+u);return e.length<1&&(e=l["default"]('<div id="'+u+'" />').appendTo("body")),e}function a(e){var t,n,i={},r=["closeable","fadeout","delay","duration","id"];for(t in r)n=r[t],n in e&&(i[n]=e[n]);return i}Object.defineProperty(n,"__esModule",{value:!0});var s=e("../dollar"),l=i(s),u="ac-message-container",c=["generic","error","warning","success","info","hint"];n["default"]={showMessage:function(e,t,n,i){var s=o();if(i=a(i),l["default"].extend(i,{title:t,body:AJS.escapeHtml(n)}),l["default"].inArray(e,c)<0)throw"Invalid message type. Must be: "+c.join(", ");r(i.id)&&(AJS.messages[e](s,i),s.css("margin-left","-"+s.innerWidth()/2+"px"))},clearMessage:function(e){r(e)&&l["default"]("#"+e).remove()}},t.exports=n["default"]},{"../dollar":22}],30:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r);n["default"]=function(){return{internals:{showMessage:function(e,t,n,i){return o["default"].showMessage(e,t,n,i)},clearMessage:function(e){return o["default"].clearMessage(e)}}}},t.exports=n["default"]},{"./api":29}],31:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../common/dom-events.js"),o=i(r);n["default"]=function(){return{init:function(e,t){e.uiParams.isGeneral&&o["default"].bindListeners(t.channel,t.propagateToPlugin)},internals:{propagateToHost:o["default"].receiveEvent},stubs:["propagateToPlugin"]}},t.exports=n["default"]},{"../../common/dom-events.js":7}],32:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),a=e("./rpc");i(a);n["default"]=function(){var e=AJS.debounce||o["default"].debounce;return{init:function(t,n){n.resize=e(function(e,t,n){e(this.iframe).css({width:t,height:n});var i=e(this.iframe).closest(".ap-container");i.trigger("resized",{width:t,height:n})})},internals:{resize:function(e,t){this.resize(o["default"],e,t)},sizeToParent:e(function(){function e(e){var t=o["default"](document).height()-o["default"]("#header > nav").outerHeight()-o["default"]("#footer").outerHeight()-20;o["default"](e).css({width:"100%",height:t+"px"})}this.uiParams.isGeneral?(o["default"](this.iframe).addClass("full-size-general-page"),o["default"](window).on("resize",function(){e(this.iframe)}),e(this.iframe)):o["default"](this.iframe).addClass("full-size-general-page-fail")})}}},t.exports=n["default"]},{"./dollar":22,"./rpc":33}],33:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),a=e("../common/xdm-rpc"),s=i(a),l=e("./jwt-keep-alive"),u=i(l),c=e("../common/uri"),d=i(c),h=o["default"].each,p=o["default"].extend,f=o["default"].isFunction,m=[],g={},v=[],y={},b=[];n["default"]={extend:function(e){f(e)&&(e=e()),p(g,e.apis),p(y,e.internals),v=v.concat(e.stubs||[]);var t=e.init;return f(t)&&b.push(t),e.apis},init:function(e,t){var n,i=new d["default"].init(t.remote),r=i.getQueryParamValue("jwt");e=e||{},h(g,function(e){v.push(e)}),r&&u["default"].isExpired(r)&&(n=u["default"].updateUrl({addonKey:t.remoteKey,moduleKey:e.ns,productContext:e.productContext||{},uiParams:t.uiParams,width:t.props.width,height:t.props.height})),o["default"].when(n).always(function(n){n&&(t.remote=n);var i=new s["default"](o["default"],t,{remote:v,local:o["default"].extend({},y)});m[i.id]=i,h(b,function(t,n){try{n(p({},e),i)}catch(r){console.log(r)}})})}},t.exports=n["default"]},{"../common/uri":11,"../common/xdm-rpc":12,"./dollar":22,"./jwt-keep-alive":27}],34:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){e.data("loadingStatusTimer")&&(clearTimeout(e.data("loadingStatusTimer")),e.removeData("loadingStatusTimer")),e.find(".ap-status").addClass("hidden")}function o(e,t){r(e),e.closest(".ap-container").removeClass("hidden"),e.find(".ap-stats").removeClass("hidden"),e.find(".ap-"+t).removeClass("hidden"),setTimeout(function(){var n=e.find(".small-spinner",".ap-"+t);n.length&&n.spin&&n.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})},10)}function a(e){r(e)}function s(e,t){if(t){var n=setTimeout(o.bind(null,e,"loading"),t);e.data("loadingStatusTimer",n)}else o(e,"loading")}function l(e){o(e,"load-timeout")}function u(e){o(e,"load-error")}function c(){var e,t=h["default"]('<div class="ap-stats" />');for(e in p){var n=h["default"]('<div class="ap-'+e+' ap-status hidden" />');n.append("<small>"+p[e].descriptionHtml+"</small>"),t.append(n)}return t}Object.defineProperty(n,"__esModule",{value:!0});var d=e("./dollar"),h=i(d),p={loading:{descriptionHtml:'<div class="small-spinner"></div>Loading add-on...'},"load-timeout":{descriptionHtml:'<div class="small-spinner"></div>Add-on is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?'},"load-error":{descriptionHtml:"Add-on failed to load."}};n["default"]={createStatusMessages:c,showLoadingStatus:s,showloadTimeoutStatus:l,showLoadErrorStatus:u,showLoadedStatus:a},t.exports=n["default"]},{"./dollar":22}],35:[function(e,t,n){"use strict";function i(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={escapeSelector:i},t.exports=n["default"]},{}]},{},[1])(1)})}).call(t,function(){return this}())},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(e){return"/!api/plugins/servlet/ac/"+encodeURIComponent(e)}return{resolveByUrl:function(t){var n=e.Deferred(function(e){e.resolve(t)}).promise();return n},resolveByParameters:function(n){return e.ajax(t(n.moduleKey),{dataType:"html",data:{encContext:n.productCtx.encContext,key:n.moduleKey,uiParams:JSON.stringify(n.uiParams),width:n.width||"100%",height:n.height||"100%",classifier:n.classifier||"raw"}})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(178),n(515)],r=function(e,t,n){function i(e){return e.split(" ").filter(s.test.bind(s))}function r(e){e.indexOf("ace-stp-icon-message")>-1?l.addClass("active"):l.removeClass("active")}var o="stp-icon-set",a=t.get(o),s=/^(aui-|ace-stp-)/i,l=e("#ace-stp-menu-icon-notification");a&&r(i(a)),n.extend(function(){function n(t,n){e("#super-touch-point-dialog").on("aui-layer-show",function(){n.notify("show")}).on("aui-layer-hide",function(){n.notify("hide")})}function a(e){r(i(e))}function s(e){e&&""!==e?t.set(o,e):t.remove(o)}return{init:n,internals:{setTouchPointClasses:a,cacheTouchPointClasses:s},stubs:["notify"]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(515),n(519),n(520)],r=function(e,t,n){return e.extend(t),e.extend(n),e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,i;!function(t){e.exports=t()}(function(){var e;return function t(e,n,r){function o(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof i&&i;if(!l&&u)return i(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return o(n?n:t)},d,d.exports,t,e,n,r)}return n[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./rpc"),o=i(r);n["default"]=o["default"],t.exports=n["default"]},{"./rpc":5}],2:[function(t,n,i){/*!
	 * jsUri
	 * https://github.com/derek-watson/jsUri
	 *
	 * Copyright 2013, Derek Watson
	 * Released under the MIT license.
	 *
	 * Includes parseUri regular expressions
	 * http://blog.stevenlevithan.com/archives/parseuri
	 * Copyright 2007, Steven Levithan
	 * Released under the MIT license.
	 */
!function(t){function i(e){return e&&(e=e.toString().replace(s.pluses,"%20"),e=decodeURIComponent(e)),e}function r(e){var t=s.uri_parser,n=["source","protocol","authority","userInfo","user","password","host","port","isColonUri","relative","path","directory","file","query","anchor"],i=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=i[t]||""}),r}function o(e){var t,n,r,o,a,l,u,c=[];if("undefined"==typeof e||null===e||""===e)return c;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(s.query_separator),t=0,u=n.length;u>t;t++)r=n[t],o=r.indexOf("="),0!==o&&(a=i(r.substring(0,o)),l=i(r.substring(o+1)),c.push(-1===o?[r,null]:[a,l]));return c}function a(e){this.uriParts=r(e),this.queryPairs=o(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var s={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;o>i;){var a;i in r&&(a=r[i],e.call(n,a,i,r)),i++}}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){a.prototype[e]=function(t){return"undefined"!=typeof t&&(this.uriParts[e]=t),this.uriParts[e]}}),a.prototype.hasAuthorityPrefix=function(e){return"undefined"!=typeof e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},a.prototype.isColonUri=function(e){return"undefined"==typeof e?!!this.uriParts.isColonUri:void(this.uriParts.isColonUri=!!e)},a.prototype.query=function(e){var t,n,i,r="";for("undefined"!=typeof e&&(this.queryPairs=o(e)),t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:(r+=n[0],r+="=","undefined"!=typeof n[1]&&(r+=encodeURIComponent(n[1])));return r.length>0?"?"+r:r},a.prototype.getQueryParamValue=function(e){var t,n,i;for(n=0,i=this.queryPairs.length;i>n;n++)if(t=this.queryPairs[n],e===t[0])return t[1]},a.prototype.getQueryParamValues=function(e){var t,n,i,r=[];for(t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],e===n[0]&&r.push(n[1]);return r},a.prototype.deleteQueryParam=function(e,t){var n,r,o,a,s,l=[];for(n=0,s=this.queryPairs.length;s>n;n++)r=this.queryPairs[n],o=i(r[0])===i(e),a=r[1]===t,(1!==arguments.length||o)&&(2!==arguments.length||o&&a)||l.push(r);return this.queryPairs=l,this},a.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},a.prototype.hasQueryParam=function(e){var t,n=this.queryPairs.length;for(t=0;n>t;t++)if(this.queryPairs[t][0]==e)return!0;return!1},a.prototype.replaceQueryParam=function(e,t,n){var r,o,a=-1,s=this.queryPairs.length;if(3===arguments.length){for(r=0;s>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)&&decodeURIComponent(o[1])===i(n)){a=r;break}a>=0&&this.deleteQueryParam(e,i(n)).addQueryParam(e,t,a)}else{for(r=0;s>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)){a=r;break}this.deleteQueryParam(e),this.addQueryParam(e,t,a)}return this},["protocol","hasAuthorityPrefix","isColonUri","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);a.prototype[t]=function(t){return this[e](t),this}}),a.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},a.prototype.origin=function(){var e=this.scheme();return this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),(this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(e+=":"+this.port())),e},a.prototype.addTrailingSlash=function(){var e=this.path()||"";return"/"!==e.substr(-1)&&this.path(e+"/"),this},a.prototype.toString=function(){var e,t=this.origin();return this.isColonUri()?this.path()&&(t+=":"+this.path()):this.path()?(e=this.path(),s.ends_with_slashes.test(t)||s.starts_with_slashes.test(e)?(t&&t.replace(s.ends_with_slashes,"/"),e=e.replace(s.starts_with_slashes,"/")):t+="/",t+=e):this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},a.prototype.clone=function(){return new a(this.toString())},"function"==typeof e&&e.amd?e(function(){return a}):"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=a:t.Uri=a}(this)},{}],3:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return void 0===e||null===e?"":e.toString().replace(new RegExp("^"+g),"")}function o(e){if(void 0===e||null===e)throw"You must supply text to prefix";return g+r(e)}function a(e,t){var n=new m["default"].init(window.location.href),i=new m["default"].init(window.location.href);return i.anchor(o(e)),i.anchor()!==n.anchor()?(p=i.anchor(),t?window.location.replace("#"+i.anchor()):window.location.assign("#"+i.anchor()),i.anchor()):void 0}function s(e){a(e)}function l(e){a(e,!0)}function u(e){history.go(e)}function c(e,t){var n=new m["default"].init(e.newURL),i=new m["default"].init(e.oldURL);n.anchor()!==i.anchor()&&p!==n.anchor()&&t(d(e)),p=null}function d(e){return{newURL:r(new m["default"].init(e.newURL).anchor()),oldURL:r(new m["default"].init(e.oldURL).anchor())}}function h(){var e=new m["default"].init(window.location.href),t=r(e.anchor());return t}Object.defineProperty(n,"__esModule",{value:!0});var p,f=e("./uri"),m=i(f),g="!";n["default"]={pushState:s,replaceState:l,go:u,hashChange:c,getState:h},t.exports=n["default"]},{"./uri":6}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=AJS.$,t.exports=n["default"]},{}],5:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),a=e("./dollar"),s=i(a);n["default"]=function(){return{init:function(e,t){e.uiParams.isGeneral&&s["default"](window).on("hashchange",function(e){o["default"].hashChange(e.originalEvent,t.historyMessage)})},internals:{historyPushState:function(e){return this.uiParams.isGeneral?o["default"].pushState(e):void AJS.log("History is only available to page modules")},historyReplaceState:function(e){return this.uiParams.isGeneral?o["default"].replaceState(e):void AJS.log("History is only available to page modules")},historyGo:function(e){return this.uiParams.isGeneral?o["default"].go(e):void AJS.log("History is only available to page modules")}},stubs:["historyMessage"]}},t.exports=n["default"]},{"./api":3,"./dollar":4}],6:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("jsuri"),o=i(r);n["default"]={init:o["default"]},t.exports=n["default"]},{jsuri:2}]},{},[1])(1)})},function(e,t,n){var i,i;!function(t){e.exports=t()}(function(){return function e(t,n,r){function o(s,l){if(!n[s]){if(!t[s]){var u="function"==typeof i&&i;if(!l&&u)return i(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./rpc"),o=i(r);n["default"]=o["default"],t.exports=n["default"]},{"./rpc":3}],2:[function(e,t,n){"use strict";function i(e,t){if(!e||0===e.length)throw new Error("addon key must be defined on cookies");if(!t||0===t.length)throw new Error("Name must be defined");return e+"$$"+t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={saveCookie:function(e,t,n,r){AJS.Cookie.save(i(e,t),n,r)},readCookie:function(e,t,n){var r=AJS.Cookie.read(i(e,t));"function"==typeof n&&n(r)},eraseCookie:function(e,t){AJS.Cookie.erase(i(e,t))}},t.exports=n["default"]},{}],3:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r);n["default"]=function(){return{internals:{saveCookie:function(e,t,n){o["default"].saveCookie(this.addonKey,e,t,n)},readCookie:function(e,t){o["default"].readCookie(this.addonKey,e,t)},eraseCookie:function(e){o["default"].eraseCookie(this.addonKey,e)}}}},t.exports=n["default"]},{"./api":2}]},{},[1])(1)})},function(e,t,n){var i,r;i=[n(8),n(3),n(150),n(2),n(164),n(515),n(508),n(522),n(523),n(524)],r=function(e,t,i,r,o,a,s,l,u,c){function d(e,t){var n=gettext("The add-on <strong>%(addon_name)s</strong> is requesting access to:");return l({scopes:t,accessRequestLabel:interpolate(n,{addon_name:r.escape(e)},!0),grantAccessLabel:gettext("Grant access"),denyAccessLabel:gettext("Deny access")}).trim()}function h(e){var t=gettext("The add-on <strong>%(addon_name)s</strong> has been granted access.");return u({accessGrantedLabel:interpolate(t,{addon_name:r.escape(e)},!0),managePermissionsLabel:gettext("Manage permissions"),username:o.username}).trim()}function p(e){var t=gettext("The add-on <strong>%(addon_name)s</strong> has been denied access.");return c({accessDeniedLabel:interpolate(t,{addon_name:r.escape(e)},!0),managePermissionsLabel:gettext("Manage permissions"),username:o.username}).trim()}function f(e,i){function r(e){var t={code:e,message:g[e]};v[f].fail.forEach(function(e){e(t)}),delete v[f]}function a(e,t){v[f].success.forEach(function(n){n({accessToken:e,refreshToken:t})}),delete v[f]}function l(e){a(e.access_token,e.refresh_token),y&&(y.close(),n.e(1,function(e){var t=[e(77)];(function(e){e({close:"auto",type:"success",body:h(w)})}).apply(null,t)}))}function u(){r("access_token_request_failed"),y&&y.close()}function c(e){var n={url:"/site/oauth2/access_token",type:"POST",data:{client_id:x,grant_type:"urn:bitbucket:oauth2:session",redirect_uri:D,disallow_creation:e}};t.ajax(n).done(l).fail(u)}var f=this.addonKey;if(v[f])return v[f].success.push(e),void v[f].fail.push(i);v[f]={},v[f].success=[e],v[f].fail=[i];var y,b=t(this.iframe).closest(".ap-container"),w=b.attr("data-name"),x=b.attr("data-client-id"),_=b.attr("data-scopes"),k=b.data("userDenied"),C=b.attr("data-refresh-token"),$=b.attr("data-access-token"),S=b.data("accessTokenExpiresIn"),T=b.attr("data-callback-url"),D=this.iframe.src;_=_?_.split(" "):[];var P=S?m+1e3*S:null;return o.isAuthenticated?x?k?void r("user_already_denied_access"):0!==D.indexOf(T)?void r("frame_src_consumer_callback_mismatch"):void($&&C?P>Date.now()?a($,C):c(!0):n.e(1,function(e){var n=[e(77)];(function(e){s(_).done(function(n){function i(){c()}function o(){t.ajax({url:"/!api/internal/consumers/{}/denials".format(x),type:"PUT"}),y.close(),e({close:"auto",type:"error",body:p(w)}),r("user_denied_access")}y=e({type:"info",close:"never",body:d(w,n)}),t(y).on("click",".grant-access-button",i).on("click",".deny-access-button",o)})}).apply(null,n)})):void r("no_oauth_consumer_client_id"):void r("user_not_authenticated")}l=i.compile(l),u=i.compile(u),c=i.compile(c);var m=Date.now(),g={user_not_authenticated:gettext("User is not authenticated"),access_token_request_failed:gettext("Request for access token failed"),no_oauth_consumer_client_id:gettext("Add-on does not have an OAuth consumer client ID"),user_already_denied_access:gettext("User has already denied access to add-on"),user_denied_access:gettext("User denied access to add-on"),frame_src_consumer_callback_mismatch:gettext("Module URL must start with the OAuth consumer callback URL")},v={};a.extend(function(){return{internals:{requestAccessToken:f}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports='<p>[[&accessRequestLabel]]</p>\n<ul class="access-request-scopes-list">\n  [[#scopes]]\n    <li>[[description]]</li>\n  [[/scopes]]\n</ul>\n<ul class="aui-nav-actions-list">\n  <li>\n    <button class="grant-access-button aui-button aui-button-link">\n      [[grantAccessLabel]]\n    </button>\n  </li>\n  <li>\n    <button class="deny-access-button aui-button aui-button-link">\n      [[denyAccessLabel]]\n    </button>\n  </li>\n</ul>\n'},function(e,t){e.exports='<p>[[&accessGrantedLabel]]</p>\n<ul class="aui-nav-actions-list">\n  <li><a href="/account/user/[[username]]/api">[[managePermissionsLabel]]</a></li>\n</ul>\n'},function(e,t){e.exports='<p>[[&accessDeniedLabel]]</p>\n<ul class="aui-nav-actions-list">\n  <li><a href="/account/user/[[username]]/api">[[managePermissionsLabel]]</a></li>\n</ul>\n'},function(e,t,n){var i,r;i=[n(145),n(170),n(164),n(3),n(306),n(514),n(178)],r=function(e,t,n,i,r,o,a){return e(function(e){var o=e.attr("data-fileview-file-extension"),s=e.attr("data-fileview-file-name"),l=i(e.attr("data-fileview-container")),u=s?"filename":"fileext",c=a.get("fileviewer")||{},d=c[t.id]||{};c[t.id]=d;var h=d[u]||{};d[u]=h;var p=function(u){var d=e.find(".aui-dropdown2-checked"),p=d.attr("data-fileview-module-key"),f=d.attr("data-fileview-connection-key");p||(p="file-view-default");var m=p;f&&(m=f+":"+p);var g=i(d.attr("data-fileview-target")),v=i(e.attr("data-fileview-button")),y=d.attr("data-fileview-id");if(v.text(d.text()),l.find(".fileview").addClass("hidden"),g.removeClass("hidden"),r.update("fileviewer",m),window.history.pushState({},null,r.asUrl("")+window.location.hash),u&&(n.isAuthenticated?i.post("/xhr/"+t.owner.username+"/"+t.slug+"/fileview_default",{file_extension:o,file_name:s,fileview_id:y}):(h[s||o]=m,a.set("fileviewer",c))),!d.data("fileview-loaded")){var b=g.find(".ap-container-disabled, .ac-bootstrapped-container > .ap-container"),w={moduleKey:d.data("fileview-module-key"),productCtx:{encContext:b.data("enc-context")}};window._AP.contentResolver.resolveByParameters(w).then(function(e){g.html(e),d.data("fileview-loaded",!0)})}},f=e.find(".aui-dropdown2-checked"),m=f.attr("data-fileview-module-key"),g=h[s||o];if(!n.isAuthenticated&&g&&"file-view-default"===m&&-1!=g.indexOf(":")){var v=g.split(":",2);connectionKey=v[0],m=v[1];var y=e.find('[data-fileview-module-key="'+m+'"][data-fileview-connection-key="'+connectionKey+'"]');y.length&&(f.removeClass("aui-dropdown2-checked"),y.addClass("aui-dropdown2-checked"))}e.on("aui-dropdown2-hide",p),p(!1)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(514)],r=function(e){$(function(){$("#super-touch-point-dialog").on("aui-layer-show",function(t){e.initOnload({context:$(t.target)})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(474),n(528)],r=function(e,t,n){return e(function(e){t.register(n,{weight:400,localId:e.attr("data-local-id")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(467)],r=function(e,t){return t.extend({label:gettext("Issue actions"),minQueryLength:0,maxResults:!1,data:function(){var t=e("#issue-vote-count").hasClass("aui-badge-active"),n=e("#issue-watch-count").hasClass("aui-badge-active"),i=e("#issue-view").hasClass("is-spam"),r=[{label:gettext("Edit issue"),$el:e("#edit-issue")},{label:t?gettext("Remove vote"):gettext("Vote for issue"),$el:e("#issue-vote-trigger")},{label:n?gettext("Stop watching issue"):gettext("Watch issue"),$el:e("#issue-watch-trigger")},{label:i?gettext("Approve issue"):gettext("Mark as spam"),$el:e("#issue-flag-spam")},{label:gettext("Delete issue"),$el:e("#issue-delete-link")},{label:gettext("Attach files"),$el:e(".issue-attach-link")}];return e("#workflow-dropdown li").each(function(){r.push({label:e(this).attr("title"),$el:e(this).find("a")})}),r},context:function(){return interpolate(gettext("Issue #%(issue_id)s"),{issue_id:this.options.localId},!0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(405),n(145),n(530)],r=function(e,t,n,i,r){return i(function(e){var t=n.ItemView.extend({behaviors:{disablesOnSubmission:{behaviorClass:r}}});new t({el:e})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(405)],r=function(e,t,n){return n.Behavior.extend({events:{submit:"disableSubmission"},disableSubmission:function(t){e(this.el).find('[type="submit"]').attr("disabled",!0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(170),n(532),n(534),n(536),n(539)],r=function(e,t,n,i,r,o){return e(function(e){var a=e.find(".addon-filters"),s=e.find(".directory-list"),l=new i(a.data("categories")),u=new n(s.data("addons"),{connectContext:"account",targetUser:s.attr("data-target-user"),repositoryFullSlug:t.fullslug}),c=new o({el:a,categories:l}),d=new r({el:s,collection:u,manageUrl:s.attr("data-manage-url")});c.render(),s.empty(),d.render(),c.on("change:category",function(e){d.filterResults(e)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(488),n(490),n(533)],r=function(e,t,n){return e.extend({apiVersion:"internal",model:n,parse:function(e){return e.values},initialize:function(e,n){if(this.connectContext=n.connectContext,"account"===this.connectContext)this.targetUser=n.targetUser,this.urlRoot="{}/account/{}/addons".format(this.getApiRoot(),this.targetUser);else{if("repository"!==this.connectContext)throw"No context provided.";this.repository=t.load(n.repositoryFullSlug),this.urlRoot="{}/repositories/{}/addons".format(this.getApiRoot(),this.repository.id)}},url:function(){return this.urlRoot+"?pagelen=100"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(493)],r=function(e,t){return t.extend({apiVersion:"internal",validateDescriptor:function(){var t=this,n=t.get("url")||t.getDescriptorUrl();return e.ajax({url:t.urlRoot()+"/validate",data:{url:n},success:function(e){t.set("descriptor",e)}})},getDescriptorUrl:function(){var e=this.get("descriptor_url");if(!e){var t=this.get("links");e=t&&t.descriptor&&t.descriptor.source_url&&t.descriptor.source_url.href}return e},urlRoot:function(){return this.collection.urlRoot}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(535)],r=function(e,t){return e.Collection.extend({model:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(2),n(537)],r=function(e,t,n){return e.CollectionView.extend({childView:n,childViewOptions:function(){return{manageUrl:this.manageUrl,collection:this.collection}},addChild:function(n,i,r){(!this.category||t.contains(n.get("categories"),this.category))&&e.CollectionView.prototype.addChild.apply(this,arguments)},initialize:function(e){this.targetUser=e.targetUser,this.manageUrl=e.manageUrl},filterResults:function(e){this.category=e,this.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(405),n(2),n(321),n(538),n(507),n(533),n(215),n(511)],r=function(e,t,n,i,r,o,a,s,l,u){function c(e,t){return"/"===e.slice(-1)&&(e=e.slice(0,-1)),0!==t.indexOf("/")&&(t="/"+t),e+t}return n.ItemView.extend({behaviors:{expandableBoxedListItem:{behaviorClass:o}},template:"#addon-directory-list-item-template",tagName:"li",className:"directory-list--item boxed-list--item",ui:{installButton:".install-button",instanceUrl:"#id_instance_url"},events:{"click @ui.installButton":"installAddOn"},initialize:function(e){this.manageUrl=e.manageUrl,this.collection=e.collection,this.listenTo(this.model,"change:installed",this.render)},templateHelpers:function(){return{isInstalled:!!this.model.get("installed"),expanded:this.expanded,manageUrl:this.manageUrl}},displayInstalledMessage:function(t){var n=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:i.escape(n)},!0);e.messages.success({body:r,fadeout:!0})},installAddOn:function(e){var t=this,n=t.model.get("template")?c(t.ui.instanceUrl.val(),t.model.get("descriptor_url")):t.model.get("descriptor_url"),i=new s({url:n},{collection:this.collection}),o=t.ui.installButton.text();i.validateDescriptor().fail(u).fail(function(){t.ui.installButton.disable(!1,{text:o})}).done(function(e){t.model.get("template")&&0!==e.key.indexOf(t.model.get("connection_key"))?(r({size:"small",title:gettext("URL not found"),content:gettext("There is not a valid instance for this add-on at that URL."),dialog2:!0,warning:!0,showCloseIcon:!0,hideFooter:!0}),t.ui.installButton.disable(!1,{text:o})):a(i,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).fail(function(){t.ui.installButton.disable(!1,{text:o})}).done(function(){i.save({descriptor:e},{wait:!0,success:function(e){t.model.set({installed:(t.model.get("installed")||0)+1}),t.displayInstalledMessage(e)},error:function(){t.ui.installButton.disable(!1,{text:o}),u.apply(t,arguments)}})})}),t.ui.installButton.disable(!0,{text:gettext("Installing")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405)],r=function(e){return e.Behavior.extend({ui:{trigger:".boxed-list--expandable--trigger"},events:{"click @ui.trigger":"triggerHandler"},triggerHandler:function(e){this.triggerMethod("ToggleExpandedState")},onToggleExpandedState:function(){this.$el.toggleClass("boxed-list--item--expanded"),this.view.expanded=this.$el.hasClass("boxed-list--item--expanded"),this.view.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(405)],r=function(e,t){return t.ItemView.extend({template:"#addon-filters-template",ui:{categoryFilter:".category-filter"},events:{"change @ui.categoryFilter":"categoryChangeHandler"},initialize:function(e){this.categories=e.categories},onRender:function(){this.ui.categoryFilter.auiSelect2()},serializeData:function(){return{categories:this.categories.toJSON()}},categoryChangeHandler:function(e){this.trigger("change:category",this.ui.categoryFilter.val())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(170),n(532),n(534),n(539),n(541),n(544),n(306)],r=function(e,t,n,i,r,o,a,s){return e(function(e){var l=e.find(".addon-filters"),u=e.find(".management-list"),c=new i(l.data("categories")),d=new n(u.data("addons"),{connectContext:"account",targetUser:u.attr("data-target-user"),repositoryFullSlug:t.fullslug}),h=new r({el:l,categories:c}),p=(new a({el:e.find(".custom-addons"),collection:d}),new o({el:u,collection:d,defaultLogo:e.attr("data-default-logo")}));if(h.render(),u.empty(),p.render(),h.on("change:category",function(e){p.filterResults(e)}),s.get("template")&&s.get("addon"))d.filter(function(e){return 0===e.get("connection_key").indexOf(s.get("addon"))}).forEach(function(e){p.toggleAddonExpandedState(e)});else if(s.get("addon")){var f=d.findWhere({connection_key:s.get("addon")});f&&p.toggleAddonExpandedState(f)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(2),n(542),n(543)],r=function(e,t,n,i){return e.CollectionView.extend({childView:i,childViewOptions:function(){return{defaultLogo:this.defaultLogo}},emptyView:n,addChild:function(n,i,r){(!this.category||t.contains(n.get("categories"),this.category))&&e.CollectionView.prototype.addChild.apply(this,arguments)},initialize:function(e){this.targetUser=e.targetUser,this.defaultLogo=e.defaultLogo,this.listenTo(this,"render remove:child",this.toggleBlankSlateClass)},toggleBlankSlateClass:function(){this.$el.toggleClass("blank-slate",0===this.collection.length)},filterResults:function(e){this.category=e,this.render()},toggleAddonExpandedState:function(e){this.children.findByModel(e).triggerMethod("ToggleExpandedState")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405)],r=function(e){return e.ItemView.extend({template:"#addon-management-blank-slate-template",tagName:"li",className:"management-list--item boxed-list--item"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(405),n(2),n(293),n(538),n(507),n(533),n(511),n(215)],r=function(e,t,n,i,r,o,a,s,l){return t.ItemView.extend({behaviors:{expandableBoxedListItem:{behaviorClass:r}},template:"#addon-management-list-item-template",tagName:"li",className:"management-list--item boxed-list--item",ui:{uninstallButton:".uninstall-button",updateButton:".update-button"},events:{"click @ui.uninstallButton":"uninstallAddOn","click @ui.updateButton":"updateAddOn"},templateHelpers:function(){return{logo:this.model.get("logo")||this.defaultLogo}},initialize:function(e){this.defaultLogo=e.defaultLogo},uninstallAddOn:function(e){e.preventDefault();var t=this,r=this.model,o=n.escape(r.get("name")),a=gettext('Are you sure you wish to remove the add-on "%(addOnName)s"?  You may lose any settings and this cannot be undone.'),l=interpolate(a,{addOnName:n.escape(o)},!0),u=interpolate(gettext('Add-on "%(addOnName)s" has been removed. You may need to refresh the page to see changes to navigation.'),{addOnName:n.escape(o)},!0),c=this.ui.uninstallButton.text();i({id:"remove-addon",title:gettext("Remove add-on"),content:l,buttonText:gettext("Remove")}).fail(function(){t.ui.uninstallButton.disable(!1,{text:c})}).done(function(){r.destroy({wait:!0,success:function(){t.success(u)},error:function(){t.ui.uninstallButton.disable(!1,{text:c}),s.apply(t,arguments)}})}),t.ui.uninstallButton.disable(!0,{text:gettext("Removing")})},updateAddOn:function(e){e.preventDefault();var t=this,i=this.model,r=n.escape(i.get("name")),a=gettext("Are you sure you wish to update the add-on %(addOnName)s?  The descriptor will be re-fetched from the same URL and this cannot be undone.  Any existing settings will remain."),l=interpolate(a,{addOnName:r},!0),u=interpolate(gettext('Add-on "%(addOnName)s" has been updated. You may need to refresh the page to see changes to navigation.'),{addOnName:r},!0),c=this.ui.updateButton.text();i.validateDescriptor(i.get("descriptor_url")).fail(s).done(function(){o(i,{id:"update-addon",title:gettext("Update add-on"),content:l,buttonText:gettext("Update")}).always(function(){t.ui.updateButton.disable(!1,{text:c})}).done(function(){i.save({},{url:i.url()+"/descriptor",data:JSON.stringify(i.get("descriptor")),wait:!0,success:function(){t.success(u)},error:function(){t.ui.updateButton.disable(!1,{text:c}),s.apply(t,arguments)}})})}),t.ui.updateButton.disable(!0,{text:gettext("Updating")})},success:function(t){e.messages.success({body:t,fadeout:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(545)],r=function(e,t,n){return t.View.extend({events:{"click .custom-addon-button":"showCustomAddonDialog"},showCustomAddonDialog:function(){this.dialog||(this.dialog=e.dialog2("#marketplace-custom-addon-dialog"),new n({el:this.dialog.$el,dialog:this.dialog,collection:this.collection})),this.dialog.show()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(405),n(2),n(507),n(511)],r=function(e,t,n,i,r){return t.ItemView.extend({template:!1,ui:{dialogForm:".dialog-form",dialogCancelButton:".dialog-cancel-button",dialogInstallButton:".dialog-install-button",urlInput:"#custom-descriptor-url"},events:{"click @ui.dialogCancelButton":"cancelDialog","submit @ui.dialogForm":"installAddOn","click @ui.dialogInstallButton":"installAddOn"},initialize:function(e){this.bindUIElements(),this.dialog=e.dialog,this.collection=e.collection},cancelDialog:function(){this.clearUrlInput(),this.dialog.hide()},clearUrlInput:function(){this.ui.urlInput.val("")},installAddOn:function(e){e.preventDefault();var t=this,n=t.ui.urlInput.val(),o=new t.collection.model({url:n},{collection:t.collection});o.validateDescriptor().fail(r).done(function(e){t.dialog.hide(),i(o,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).done(function(){o.save({descriptor:e},{wait:!0,success:function(e){t.collection.add(e),t.clearUrlInput(),t.displayInstalledMessage(e)},error:r})})})},displayInstalledMessage:function(t){var i=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:n.escape(i)},!0);e.messages.success({body:r,fadeout:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(405),n(474),n(548),n(404),n(412),n(547),n(549),n(550),n(554),n(555),n(556),n(484)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p){return t(function(){function t(t){var n=e('[data-filename="{}"] a.eclipsedcount'.format(t.get("comment").path)),i=h(n);i.done(function(){var e=window.location.hash;window.location.hash=" ",window.location.hash=e})}var n=e("#pullrequest"),f=e("#pullrequest-actions").find(".approve"),m=e("#watch-pullrequest"),g=new s({id:n.attr("data-local-id"),approvalCount:f.data("approvalCount"),hasCurrentUserApproved:f.data("hasCurrentUserApproved"),isWatchedByCurrentUser:m.data("isWatching")});i.register(r,{weight:400,pullRequest:g}),o.addInitializer(function(e){new d({el:m,model:e.pullrequest}).bindUIElements()}),o.addInitializer(function(e){var t=new l({el:f,model:e.pullrequest,showCount:!0});t.bindUIElements(),t.setEnabled(!0)}),o.addInitializer(function(n){new c({el:e("#pullrequest-task-list"),model:n.pullrequest}).bindUIElements();var i=new u({model:n.pullrequest});a.vent.on("unresolvedTaskCountClicked taskContextLinkClicked",function(e){n.pullrequest.fetchTasksOnce(),i.toggleDialog(),e&&e.get("comment").path&&t(e)}),g.tasks.on("remove",function(){g.tasks.length||i.hideDialog()}),p([{section:gettext("Commits / pull requests"),shortcuts:[{keys:["shift+t"],description:gettext("Show the list of tasks"),op:"execute",params:[function(){n.pullrequest.fetchTasksOnce(),i.toggleDialog()}]}]}]),e(document).on("keypress",function(e){a.vent.trigger("keypress:"+e.keyCode,e)})}),o.addInitializer(function(e){var t=e.pullrequest;a.vent.once("diff:loaded",function(){t.tasks.once("sync add remove",function(e,n,i){i&&i.xhr?i.xhr.done(function(){t.fetchTasksOnce()}):t.fetchTasksOnce()})})}),o.start({pullrequest:g})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(412),n(407),n(170)],r=function(e,t,n,i,r){var o=!1;return t.Model.extend({defaults:{approvalCount:0,hasCurrentUserApproved:!1,isWatchedByCurrentUser:!1},urlRoot:"/!api/internal/repositories/{owner}/{slug}/pullrequests/".format({owner:r.owner.username,slug:r.slug}),initialize:function(){this.tasks=new i([],{pullrequest:this}),this.listenTo(n.vent,"updateApprovals",function(e){this.set("approvalCount",e)}),this.on("change:hasCurrentUserApproved",this._updateWatching,this),this.on("change:hasCurrentUserApproved",function(){n.vent.trigger("currentUserApproved")},this)},_sendRequest:function(t,n){return e.ajax({url:this.url()+(t?"/"+t:""),type:n?n:"GET"})},_setWatching:function(e){if(this.get("isWatchedByCurrentUser")!==e){var t=this._sendRequest("watch",e?"POST":"DELETE");return t.done(function(e){this.set("isWatchedByCurrentUser",e.watching)}.bind(this)),this.trigger("loading:isWatchedByCurrentUser",t),t}},_setApproved:function(e){if(this.get("hasCurrentUserApproved")!==e){var t=this._sendRequest("approve",e?"POST":"DELETE");return t.done(function(e){this.set("hasCurrentUserApproved",e.approved)}.bind(this)),this.trigger("loading:hasCurrentUserApproved",t),t}},_updateWatching:function(){var e=this._sendRequest("watch");this.trigger("loading:isWatchedByCurrentUser",e),e.done(function(e){this.set("isWatchedByCurrentUser",e.watching)}.bind(this))},approve:function(){this._setApproved(!0)},unapprove:function(){this._setApproved(!1);
},watch:function(){this._setWatching(!0)},unwatch:function(){this._setWatching(!1)},fetchTasksOnce:function(){o||(o=!0,this.trigger("loading:tasks",this.tasks.fetch({remove:!1,data:{pagelen:100,fields:"values.comment.inline"}})))},createTask:function(t){var n=this.tasks.getUnsaved();n?n.trigger("edit"):t.content?this.tasks.create(e.extend({comment:t.comment},t)):this.tasks.add(e.extend({comment:t.comment},t))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(467)],r=function(e,t){return t.extend({label:gettext("Pull request actions"),minQueryLength:0,maxResults:!1,initialize:function(e){t.prototype.initialize.apply(this,arguments),this.pullRequest=e.pullRequest},data:function(){var t=this.pullRequest.get("hasCurrentUserApproved"),n=this.pullRequest.get("isWatchedByCurrentUser"),i=[{label:gettext("Edit pull request"),$el:e("#edit-pullrequest")},{label:t?gettext("Unapprove pull request"):gettext("Approve pull request"),$el:e("#approve-button")},{label:n?gettext("Stop watching"):gettext("Watch"),$el:e("#watch-pullrequest a")},{label:gettext("Merge pull request"),$el:e("#fulfill-pullrequest:enabled")},{label:gettext("Decline pull request"),$el:e("#reject-pullrequest")}];return i},context:function(){return interpolate(gettext("Pull request #%(pull_request_id)s"),{pull_request_id:this.pullRequest.get("id")},!0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(215),n(212)],r=function(e){return e.ItemView.extend({template:"#pullrequest-approve-button-template",modelEvents:{"change:hasCurrentUserApproved":"render","change:approvalCount":"render","loading:hasCurrentUserApproved":"loading"},events:{"click @ui.$button":"toggleApproval"},ui:{$button:"#approve-button"},initialize:function(e){this.mergeOptions(e,["showCount"])},templateHelpers:function(){return{showApprovalCount:this.showCount}},toggleApproval:function(){this.model.get("hasCurrentUserApproved")?this.model.unapprove():this.model.approve()},setEnabled:function(e){this.ui.$button.disable(!e)},loading:function(e){this.ui.$button.loading(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(405),n(183),n(412),n(551),n(553)],r=function(e,t,n,i,r,o,a){return n.ItemView.extend({template:!1,createDialog:function(){this.taskList=new o({model:this.model}),this.dialog=new i({id:"task-list-dialog",height:"auto",width:600,closeOnOutsideClick:!0,focusSelector:".task:first"});var e=t("<div>").addClass("dialog-hint").text(gettext("Tip: Use shift + T to open the task list."));return this.dialog.addHeader(gettext("Tasks")),this.dialog.addPanel("task-list",this.taskList.render().$el),this.dialog.addLink(gettext("Close"),function(e){e.hide()}),this.dialog.getCurrentPanel().page.buttonpanel.append(e),this.dialog},showDialog:function(){this.taskList.render(),this.dialog.show()},hideDialog:function(){this.dialog&&this.dialog.hide()},toggleDialog:function(e){e&&e.preventDefault(),a.toggle(this.dialog,this)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(2),n(407),n(552),n(414)],r=function(e,t,n,i,r){return e.LayoutView.extend({template:"#pullrequest-task-list-template",regions:{openTasks:"#open-tasks",resolvedTasks:"#resolved-tasks"},initialize:function(){this.listenTo(this.model.tasks,"add remove",this.render)},onRender:function(){this.updateTasks()},templateHelpers:function(){return{hasResolvedTasks:!!this._getTasks({completed:!0}).length}},_getTasks:function(e){return t.reject(this.model.tasks.where(e),function(e){return e.isNew()})},updateTasks:function(){this.openTasks.show(new r({collection:new n(this._getTasks({completed:!1})),childView:i})),this.resolvedTasks.show(new r({collection:new n(this._getTasks({completed:!0})),childView:i}))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(412),n(411)],r=function(e,t,n,i){return i.extend({getClassNames:function(){var e=i.prototype.getClassNames.call(this);return e.push("collapsible collapsed"),e},collapsed:!0,ui:t.extend(i.prototype.ui,{description:".description"}),events:t.extend(i.prototype.events,{click:"toggleCollapsed"}),onChangeCompleted:function(){this.model.get("completed")&&this.$el.addClass("collapsed"),i.prototype.onChangeCompleted.call(this)},toggleCollapsed:function(n){if(!this.editing&&!this.model.get("completed")){var i=e(n.target),r=[this.ui.contextLink,this.ui.saveLink,this.ui.editLink,this.ui.cancelLink,this.ui.deleteLink],o=[];return t.each(r,function(e){e.selector&&o.push(e.selector)}),i.is(this.ui.status.selector)?(this.collapsed=!0,void this.$el.toggleClass("collapsed",!0)):void(i.closest(o.join(",")).length||(this.collapsed=!this.collapsed,this.$el.toggleClass("collapsed",this.collapsed)))}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8)],r=function(e){function t(t,n){var i=e.popup.current;return t||(t=n.createDialog&&n.createDialog()),i?i===t.popup?void(n.hideDialog?n.hideDialog():t.hide()):void(n.hideOtherDialog&&(i.hide(),n.showDialog?n.showDialog():t.show())):void(n.showDialog?n.showDialog():t.show())}return{toggle:t}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(405),n(412),n(212)],r=function(e,t,n){return t.ItemView.extend({template:"#pullrequest-tasks-count-template",templateHelpers:function(){return{has_tasks:!!this.model.tasks.reject(function(e){return e.isNew()}).length}},events:{"click @ui.link":"handleClick"},modelEvents:{"loading:tasks":"loading"},ui:{link:"a"},initialize:function(){n.vent.once("diff:loaded",function(){this.listenTo(this.model.tasks,"sync remove",this.render)}.bind(this))},handleClick:function(e){e.preventDefault(),n.vent.trigger("unresolvedTaskCountClicked")},onRender:function(){var e=this.model.tasks.filter(function(e){return!e.get("completed")&&!e.isNew()}).length,t=gettext("All tasks resolved");e>0&&(t=interpolate(ngettext("%(taskCount)s open task","%(taskCount)s open tasks",e),{taskCount:e},!0)),this.ui.link.text(t)},loading:function(e){this.ui.link.loading(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(212)],r=function(e){return e.ItemView.extend({template:"#pullrequest-watch-template",modelEvents:{"change:isWatchedByCurrentUser":"render","loading:isWatchedByCurrentUser":"loading"},events:{"click a":"toggleWatch"},toggleWatch:function(e){e.preventDefault(),this.model.get("isWatchedByCurrentUser")?this.model.unwatch():this.model.watch()},loading:function(e){this.$el.loading(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(389),n(388),n(183),n(165),n(170),n(557),n(147)],r=function(e,t,n,i,r,o,a,s,l,u){function c(e,t){var n=new o({width:1e3,height:"auto",id:"eclipsed-comments-dialog-{}".format(f++),closeOnOutsideClick:!0});return n.addHeader(gettext("Comments on prior versions"),"eclipsed-comments-heading"),n.addPanel(gettext("Comments on prior versions"),e,"eclipsed-comments-panel-body"),n.addLink(gettext("Close"),function(){n.hide()}),n}function d(e,t){e.length&&n.each(e.data("value"),function(e){n.each(e,function(e,r){t&&(e=n.intersection(e,t)),i.decorateThreads(m.toString(),e,r)})})}function h(e,n){e.html(n).removeClass("has-mask");var i=e.find(".pr-line-thread-ids"),o=e.find(".iterable-item"),a=o.map(function(){return t(this).data("commentId")});d(i,a),e.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var e=t(this),n=e.data("filename"),i=e.parent().is(".comment-content");new r(e.data("expand-context-url")+encodeURI(n),e.data("identifier"),!i,!1,m.toString()).decorate(e)})}function p(e){u(["atl._trackEvent","Pull Request","Eclipsed Comments","Viewed"]);var n=e.data("dialog"),i=new t.Deferred;if(n)return n.show(),i.resolve(),i;var r=e.closest(".commentable-diff"),o=r.data("filename"),a=r.data("eclipsed-comment-view-url"),s=t("<div></div>").addClass("maskable has-mask");return t.ajax({url:a,data:{file:o},dataType:"html"}).done(function(e){h(s,e),i.resolve()}).fail(function(){i.reject()}),n=c(s,o),e.data("dialog",n),n.show(),i}var f=0,m=a.concat("repositories",s.owner.username,s.slug,"pullrequests",l.localId,"comments");return p}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=e(document.body).data("currentPr")||{};return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(245),n(237),n(239),n(244),n(227),n(559),n(561)],r=function(e,t,n,i,r,o,a,s,l){return e(function(e){new l({collection:new s(e.data("json")),el:e,autofocus:!0}).render();var t=new r([],{model:i,matcher:i.matcher,queryEndpoint:e.find(".bb-repo-user-typeahead").attr("data-mention-url"),queryParamKey:"term",maxResponseSize:20});new a({el:e,className:"bb-repo-user-typeahead",results:o,resultView:n,source:t}).render()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(170),n(560)],r=function(e,t,n,i){return e.Collection.extend({model:i,parse:function(e){return e.values},url:function(){return"/!api/2.0/repositories/{}/{}/default-reviewers".format(n.owner.username,n.slug)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({idAttribute:"username",url:function(){return"{}/{}".format(this.collection.url(),this.get("username"))},parse:function(e){return{username:e.username,display_name:e.display_name,avatar:e.links.avatar.href}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(405),n(2),n(562)],r=function(e,t,n,i){return t.CompositeView.extend({template:"#default-reviewers-table-template",childView:i,childViewContainer:"tbody",initialize:function(e){e=e||{},this.autofocus=e.autofocus},onRender:function(){this.autofocus&&this.focusUsernameInput()},events:{submit:"onSubmit"},ui:{usernameInput:"#username",containerTable:"table.widget"},getUsernameInputValue:function(){return this.ui.usernameInput.val()},clearUsernameInput:function(){this.ui.usernameInput.val("")},focusUsernameInput:function(){this.ui.usernameInput.focus()},onSubmit:function(e){e.preventDefault(),this.addDefaultReviewer(this.getUsernameInputValue())},addDefaultReviewer:function(t){this.collection.create({username:t},{wait:!0,success:this.clearUsernameInput.bind(this),error:function(t,i){if(i.responseText){var r=JSON.parse(i.responseText),o=r.error&&r.error.message||gettext("There was a problem processing your request.");e.messages.error({body:n.escape(o),fadeout:!0})}}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(405),n(317)],r=function(e,t,n){return t.ItemView.extend({tagName:"tr",template:"#default-reviewer-template",events:{"click @ui.deleteLink":"deleteReviewer"},ui:{deleteLink:".default-reviewer-delete"},templateHelpers:function(){return{avatar:this.model.get("avatar")||n}},deleteReviewer:function(){this.model.destroy()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(564)],r=function(e,t){return e(function(e){t.vent.trigger("change:changeset",e.attr("data-hash"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(210)],r=function(e){return e.radio.channel("source")}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(566),n(215),n(188)],r=function(e,t,n){return t(function(){function t(e){r.toggleClass("show",e),a.disable(!e)}var i=e("#repo-content").find("form"),r=i.find("#repository-details"),o=i.find("#id_name"),a=i.find("button");i.on("valid-repo.onboarding",function(e,n){if(t(!0),n&&n.url){var i=/\/([^\/]*?)(\.git)?$/.exec(n.url);i&&o.val(i[1])}}),i.on("invalid-repo.onboarding verifying-repo.onboarding",function(){t(!1)}),i.on("type-selected.onboarding",function(e,n){"import"!==n.type&&(t(!0),"fork"===n.type&&o.val("Tutorial"),"empty"===n.type&&o.val("")),r.removeClass("import fork empty"),r.addClass(n.type)}),n(i)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3)],r=function(e,t){return function(e){function n(e){e||(l.val(""),u.val("")),d.toggleClass("hidden",!e)}function i(t){if(t){var n="import"===t,i=!!s.val();n?i?(e.trigger("verifying-repo.onboarding"),o(s.val(),l.val(),u.val())):i||e.trigger("invalid-repo.onboarding"):clearTimeout(a),e.trigger("type-selected.onboarding",{type:t}),n&&s.focus(),s.toggleClass("loading",n&&i),f.toggleClass("hidden",!n)}}function r(e){h.length||(h=t("<div>").addClass("error"),t("#id_url_group").append(h)),e&&h.text(e),h.toggleClass("hidden",!e)}function o(i,o,a){if(!i)return void s.removeClass("loading");s.removeClass("valid");var l={};o&&a&&(l.username=o,l.password=a),t.ajax({type:"POST",url:m.format(i),data:l,dataType:"json"}).fail(function(t){var o=t.responseText;403===t.status||404===t.status?(n(!0),404!==t.status||l.username||(o="{} Try logging in.".format(o))):500===t.status?o="{} does not appear to be a valid repository".format(i):n(!1),r(o),"import"===p.find("input:checked").val()&&e.trigger("invalid-repo.onboarding")}).done(function(n){if("svn"!==n.scm||n.trunk)t("#url-auth-fields").toggleClass("hidden",!o||!a),"import"===p.find("input:checked").val()&&e.trigger("valid-repo.onboarding",{url:i}),s.addClass("valid"),c.val(n.scm),r();else if(r("The URL does not point to trunk."),n.suggestions.length){var l=t("<span>").html('Try <a href="#trunk">{}</a>'.format(n.suggestions[0]));h.append(l)}}).complete(function(){s.removeClass("loading")})}var a,s=e.find("#id_url"),l=e.find("#id_username"),u=e.find("#id_password"),c=e.find("#id_source_scm"),d=t("#url-auth-fields"),h=t("#id_url_group").find(".error"),p=t("#action-field"),f=t("#import-fields"),m=decodeURIComponent(e.attr("data-validate-url"));p.on("change","input",function(e){var n=t(this);n.is(":checked")&&i(n.val())}),i(p.find("input:checked").val());var g=function(){o(s.val(),l.val(),u.val())},v=function(t){s.is(":hidden")||9===t.keyCode||(s.addClass("loading"),e.trigger("verifying-repo.onboarding"),a&&clearTimeout(a),a=setTimeout(g,3e3))};s.on("input propertychange",v),l.on("input propertychange",v),u.on("input propertychange",v),e.on("click",'a[href="#trunk"]',function(e){e.preventDefault(),s.val(t(this).text()),s.change()}),p.find("label").tooltip({gravity:function(){return"s"},opacity:1})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(165)],r=function(e,t,n){return t(function(){var t=e("#create-progress"),n=t.attr("data-repo-url");setInterval(function(){e.ajax({url:n,dataType:"json"}).done(function(e){"available"===e.state&&window.location.reload()})},2e3)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(145),n(569),n(149),n(165),n(168)],r=function(e,t,n,i,r){return n(function(){function t(){r.find("#progress-logs-container").show()}var n,r=e("#import-progress");n=setTimeout(t,1e4),i(r).done(function(){clearTimeout(n),window.location=r.attr("data-next-step-url")}).fail(t)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(147),n(149),n(168)],r=function(e,t,n,i,r,o){return function(n){function r(){t.post(p,u)}function a(e){n.removeClass("error-state warning-state success-state"),m.empty(),v.find(".progress").css({width:e+"%"})}function s(e){"failed"!==h&&(0===w?l("warning",gettext("Your import is currently in the queue")):100===b?(l("success",gettext("Import completed successfully")),clearInterval(d),x.resolve()):100===y||y-b>0?a(b+=10-b%10):w>b&&a(b++))}function l(t,i){n.addClass(t+"-state"),m.empty(),e.messages[t](m,{title:i,closeable:!1})}function u(e){var n,o,a=e.log.join("").replace(/\s+$/,"");switch(h=e.state,a===c?(o=g.children().last()[0],/\.\.\.$/.test(o.innerHTML)&&(o.innerHTML+=".")):(n=a.replace(c,""),c=a,y=e.percentage,w=e.percentage_upon_subtask_completion,i.each(n.replace(/\n{2,}/g,"\n").split("\n"),function(e){var n=t("<li>");g.append(n.append(e.replace(/^\[(.*)\] /,function(e,i){return n.append(t(document.createElement("time")).attr("data-relative","false").attr("datetime",i).localize("HH:MM:ss"))," "})))}),g.scrollTop(9e5)),e.state){case"running":setTimeout(r,1e3);break;case"success":y=100;break;default:l("error",gettext("Your import has failed. For more information, check the log below. You can also try your import again.")),x.reject()}}var c,d,h=n.data("status"),p=n.data("rest-url"),f=t(o.toHtml("progress-status-template")).appendTo(n),m=f.find("#progress-status-container"),g=f.find("#progress-logs"),v=f.find("#progress-bar"),y=n.data("percentage"),b=0,w=n.data("subtask-percentage"),x=new t.Deferred;return"success"===h?(l("success",gettext("Import completed successfully")),r(),x.resolve(),x.promise()):"failed"===h?(r(),x.reject(),x.promise()):(a(b),s(),d=setInterval(s,500),r(),x.promise())}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(571),n(147),n(215)],r=function(e,t,n,i){return t(function(){var t=e(".pricing").find("a");t.on("click",function(){i(["atl._trackEvent","Signup","Plans Page","Plan Boxes on Plans Page"])});var r=n(e("#plans").attr("data-target-user"));r.ready().done(function(n){t.disable(!1),n&&t.on("click",function(t){t.preventDefault();var n=e(t.target).attr("data-target-url");r.show().done(function(e){window.location=n.format(e)})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(192),n(183),n(149),n(164)],r=function(e,t,n,i,r,o){function a(e,t){function n(){var e=a.getCurrentPanel().body.find("form .user input:checked").val();s.resolve(e)}var a=new i({width:450,height:"auto",id:"bb-change-plan"});return a.addPanel("main"),a.getCurrentPanel().html(r.toHtml("change-plan-dialog-template",{adminTeams:e,currentUser:{username:o.username,display_name:o.displayName,avatar:o.avatarUrl,isTarget:o.username===t}})),a.addHeader(gettext("Change plan")).addButton(gettext("Confirm"),n,"aui-button aui-style").addCancel(gettext("Cancel"),function(e){e.hide()}),a}var s=new e.Deferred,l=new e.Deferred;return function(e){var t;return n().done(function(n){var i=n.teams.filter(function(t){return"admin"===t.privilege?(e===t.username&&(t.isTarget=!0),!0):void 0});i.length&&(t=a(i,e)),l.resolve(!!t)}),o.isAuthenticated||l.resolve(!1),{ready:function(){return l},show:function(){return t&&t.show(),s}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(305),n(307),n(458),n(304),n(158)],r=function(e,t,n,i,r,o){return e(function(){var e=t("#profile-repositories"),a=t("#repository-pjax"),s=t("#repository-language-select");n({$container:e,$pjaxContainer:a,filterTerm:e.find(".filter-status").attr("data-filter-term"),ignoreQuery:"page"}),i({$pjaxContainer:a,$controls:t("#repository-search"),ignoreQuery:"page"}),r({$pjaxContainer:a,$select:s,filterTerm:s.attr("data-filter-term"),ignoreQuery:"page",selectOptions:{formatResult:function(e){return"all"===e.id?s.data("noneTerm"):e.text}}}),a.on("pjax:end",function(){var e=t("#repository-list").data("repoCount");t("#profile-repositories-tab .aui-badge").text(e)}),o(e,{$pjaxContainer:a,setMask:!1})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(307),n(304),n(158)],r=function(e,t,n,i){return e(function(){var e=t("#filter-pjax");n({$pjaxContainer:e,$controls:t("#user-search"),ignoreQuery:"page"}),i(e)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(209),n(163),n(211)],r=function(e,t,n,i){return e(function(e){i("bitbucket.profile.hipchat.ad.presented"),e.find(".dismiss-button").on("click",function(t){i("bitbucket.profile.hipchat.ad.dismissed"),n.set("dismiss-hipchat-box-"+e.attr("data-team-username"),"true"),e.hide()}),e.find(".install-button").on("click",function(){i("bitbucket.profile.hipchat.ad.clicked")}),t.vent.on("hipchatIntegration:installed",function(){e.hide()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(305),n(304)],r=function(e,t,n,i){return e(function(){var e=t("#profile-snippets"),r=t("#snippets-pjax");n({$container:e,$pjaxContainer:r,ignoreQuery:"page"}),i(e,{$pjaxContainer:r})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(342),n(512),n(158)],r=function(e,t,n,i){return t(function(){function t(e,t){var n=e.data("follow-text")||"Follow",i=e.data("unfollow-text")||"Following";e.toggleClass("following",t).text(t?i:n)}var r=e("#edit-avatar"),o=e("#user-profile img, .aui-avatar-inner img"),a=e(".user-avatar"),s=r.data("isAtlassianId"),l=r.attr("data-submit-url"),u=r.attr("data-text-title"),c=r.attr("data-text-delete"),d=e("#profile"),h=e("#profile-tabs"),p=d.data("ownProfile");p&&h.on("follow:user","button.follow",function(t,n){var i=e("#profile-following-count").find(".count"),r=+i.text();n?r++:r--,r=0>r?0:r,i.text(r)}),e("#profile-follow-button, #blank-slate-follow-button").on("follow:user follow:team",function(n,i){var r=e("#profile-followers"),o=e(".user-list li.user:not(.hidden)").length;i&&!o?r.find("li.empty").addClass("hidden"):i||1!==o||r.find("li.empty").removeClass("hidden"),r.find("li.current-user").toggleClass("hidden",!i),t(e("#profile-follow-button"),i),t(e("#blank-slate-follow-button"),i)}),h.on("follow:user follow:team","button.follow",function(t,n){var i=e(t.target).closest(".user"),r=i.find(".followers-count"),o=+r.find(".count").text();n?o++:o--,o=0>o?0:o,r.html('<span class="count">'+o+"</span> "+(1===o?"follower":"followers"))}).on("follow:repo","button.follow",function(t,n){var i=e(t.target).closest(".repository");i.find(".followers-count").html(' <span class="count">'+n.followers+"</span> "+(1===n.followers?"follower ":"followers "))});var f=h.find("li"),m=e("#profile-tab-content");m.on("pjax:end",function(t){var n=m.find("> div:first").attr("id");f.removeClass("active-tab"),e("#"+n+"-tab").addClass("active-tab"),i.unmask(e(t.target))}).on("pjax:error",function(t,n,i){return n.readyState>0&&"abort"!==i?(e(t.target).html("<h2>Oops!</h2><p>Something has gone terribly wrong...</p>"),!1):void 0}).on("pjax:beforeSend",function(t){i.mask(e(t.target),{backgroundColor:"transparent",spinner:"large"})}),e.support.pjax&&f.on("click","a",function(t){var n=e(t.target).closest("li");t.preventDefault(),m.empty(),e.pjax({url:e(this).attr("href"),push:!0,container:m,scrollTo:null,timeout:3e4}),f.removeClass("aui-nav-selected"),n.addClass("aui-nav-selected")}),r.length&&new n({analyticsType:"Profile",avatars:o,dialogTitle:u,endpointUrl:l,isAtlassianId:s,showDelete:r.hasClass("has-avatar"),templateOptions:{deleteText:c,maskClass:"avatar256"},trigger:r,uploadIndicator:a})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(578),n(579),n(580),n(215)],r=function(e,t,n,i,r){var o=new n,a=function(e,t,n){r[e]()(t,{passWhen:function(e){n(e)}})};return t(function(t){function n(){p.disable(!1,{text:gettext("Continue")})}function r(e){p.disable(!0,{text:e})}function s(){b===y.INITIAL_SUBMIT&&t.on("submit",function(t){t.preventDefault(),f.off("focusout"),u().done(function(){o.onLoading(f),f.disable(!0),r(gettext("Validating...")),e.post("/socialauth/xhr/check-email/",{email:f.val()}).done(function(t){return t.aid_exists?void(window.location=t.redirect_url):(e("#js-email-field").val(f.val()),o.onValid(f),void h())}).fail(function(e){AJS.messages.error({body:gettext("There was an error validating your email. Try again.")}),f.disable(!1)}).always(function(){n()})})})}function l(){n(),t.off("submit").one("submit",function(e){e.preventDefault(),r(gettext("Validating..."));var n=c();d().then(function(){n?(t.off("submit").submit(),r(gettext("Submitting..."))):l()},function(){l()})})}function u(){var t=e.Deferred();return a("email",f.val(),function(e){e?o.onClear(f):o.onInvalid(f,gettext("Please enter a valid email address")),e?t.resolve():t.reject()}),t.promise()}function c(){var e=!!m.val().trim();return e?o.onValid(m):o.onInvalid(m,gettext("Please enter a name")),e}function d(){return w.validateAsync(!0)}function h(){b=y.FINAL_SUBMIT,e("#js-form-prompt").html(gettext("Please complete your account details")),e("#js-marketing-implicit-agreement-notice").removeClass("hidden"),f.disable(!0),v.full_name&&o.onInvalid(m,v.full_name.join("<br />"),!0),v.password&&o.onInvalid(g,v.password.join("<br />"),!0),l(),m.removeClass("hidden"),g.removeClass("hidden"),m.focus()}var p=e("#js-continue-cta-link"),f=t.find("#js-email-proxy-field"),m=t.find("#js-full-name-field"),g=t.find("#js-password-field"),v=t.data("errors")||{},y={INITIAL_SUBMIT:1,FINAL_SUBMIT:2},b=y.INITIAL_SUBMIT;m.on("focusout",c);var w=i.password(g,o);v&&(f.data("populated-by-server")&&!v.email?h(v):v.email&&o.onInvalid(f,v.email.join("<br />"),!0)),s(),n()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3)],r=function(e,t){function n(e){this.options=t.extend({loadingClass:"loading",validClass:"valid",invalidClass:"invalid"},e),this.options.tipsyOptions=t.extend({className:"registration-error",gravity:"w",opacity:1,offset:5,trigger:"manual"},this.options.tipsyOptions)}return n.prototype.onValid=function(e){this.onClear(e),e.addClass(this.options.validClass)},n.prototype.onInvalid=function(e,n,i){this.onClear(e);var r={};i&&(r.html=!0),e.addClass(this.options.invalidClass).attr("data-validation-error",n).attr("title",n).tipsy(t.extend({},this.options.tipsyOptions,r)).tipsy("show")},n.prototype.onLoading=function(e){this.onClear(e),e.addClass(this.options.loadingClass)},n.prototype.onClear=function(e){e.removeClass(this.options.loadingClass).removeClass(this.options.validClass).removeClass(this.options.invalidClass).removeAttr("data-validation-error").removeAttr("title").tipsy("hide")},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(363),n(580)],r=function(e,t,n){function i(e,i){var r=new t(e,i);return r.addValidation(n.notEmail(gettext("Your username cannot be an email address"))),r.addValidation(n.username(gettext("A valid username must be non-empty, and contain only letters, numbers, underscores, or hyphens."))),r.addValidation(n.handleAvailable(gettext("That username already exists"))),r}function r(e,i){var r=new t(e,i);return r.addValidation(n.username(gettext("Please enter a valid team ID"))),r.addValidation(n.handleAvailable(gettext("That team ID already exists"))),r}function o(e,i){var r=new t(e,i);return r.addValidation(n.email(gettext("Please enter a valid email address"))),r.addValidation(n.emailAvailable(gettext("That address is already in use"))),r}function a(e,n){var i=8,r=new t(e,n),o=gettext("Your password must be at least %(min_length)s characters long");return r.addValidation(function(e,t){e&&e.length>=i?t.pass():t.fail(interpolate(o,{min_length:i},!0))}),r}return{email:o,password:a,teamUsername:r,username:i}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(236)],r=function(e,t){function n(t){return function(n,i){var r=n.trim();return r in o?void i.passWhen(o[r],t):void e.ajax({type:"GET",dataType:"json",url:s.format(r)}).done(function(e){i.passWhen(e,t),o[r]=e}).error(function(){i.pass()})}}function i(t){return function(n,i){var r=n.trim();return r in a?void i.passWhen(a[r],t):void e.ajax({type:"GET",dataType:"json",url:l.format(r)}).done(function(e){i.passWhen(!e,t),a[r]=!e}).error(function(){i.pass()})}}function r(e,t){return function(n){return function(i,r){t?r.passWhen(!e.test(i),n):r.passWhen(e.test(i),n)}}}var o={},a={},s=e("[data-name-available-url]").attr("data-name-available-url")||"/xhr/name_available/{}",l=e("[data-handle-url]").attr("data-handle-url");return{handleAvailable:n,emailAvailable:i,email:r(t.email),username:r(t.username),notEmail:r(t.email,!0)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(579),n(578),n(215)],r=function(e,t,n,i){var r=new i;return t(function(){function t(e){i.disable(!0,{text:e})}var i=e("#js-continue-cta-link"),o=e("#js-username-form"),a=o.find("#js-username-field"),s=n.username(a,r);a.off();var l=o.data("errors")||{};l.username&&r.onInvalid(a,l.username.join("<br />"),!0),o.on("submit",function(e){e.preventDefault(),s.validateAsync(!0).done(function(){o.off("submit").submit(),t(gettext("Submitting..."))})}),i.disable(!1)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(t){function n(){e.post(t.data("resend-endpoint")).done(function(t){var n;t.verified?(AJS.messages.error({body:gettext("This email has already been verified. Try logging in.")}),n=gettext("Email already verified")):(AJS.messages.info({body:gettext("We have sent another verification email. Please check your inbox.")}),setTimeout(i,1e4),n=gettext("Verification email re-sent")),e("#js-resend-verification-text").addClass("action-taken-notice").html(n)}).fail(function(){AJS.messages.error({body:gettext("We failed to resend the verification email. Please try again shortly.")}),i()})}function i(){t.one("click",n)}i()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(147)],r=function(e,t,n){return t(function(){e(".connect-button").on("click","button",function(){var t=/(google|facebook|twitter|github)-button/,i=t.exec(e(this).attr("class"))[1],r=e("#login").length>0?"Login":"Registration";n(["atl._trackEvent","Social registration",r,i])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(585),n(586),n(164),n(215),n(206),n(147),n(163),n(587),n(579),n(578)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h){var p=s("Team creation");return n(function(e){function n(){var e=f.val()||m.attr("data-placeholder");m.text(e)}var a=t("#team-members"),s=t("#id_team_name"),f=t("#id_username"),m=t("#namespace"),g=e.find('[type="submit"]');new i(s,f,c);var v=d.teamUsername(f,new h).onValidate(function(e){g.disable(!e)});s.on("blur",v.validate),r(a,{allowInvitations:!0,userInput:a.find("#team-member"),userField:t("#id_usernames"),adminUsersField:t("#id_admin_usernames"),invitationField:t("#id_addresses"),adminInvitationsField:t("#id_admin_addresses"),initialUsers:o.username?[{avatar:o.avatarUrl,display_name:o.displayName,username:o.username}]:[],initialAdmins:o.username?[o.username]:[],allowAddSelf:!0}),a.bind("bb:userwidget.invite-added",function(){l(["atl._trackEvent","Share","Invitation - Create Team"])}),f.on("input propertychange change",n),n(),g.on("click",function(){p("Create button clicked")});var y=!1;e.on("submit",function(n){!y&&t("#id_hipchat").is(":checked")&&(n.preventDefault(),u.set("show-hipchat-dialog",!0).done(function(){y=!0,e.submit()}))})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2)],r=function(e,t){function n(e,t,n){this.$src=e,this.$dst=t,this.echo=n,this.handler=function(){this.$dst.val(this.val()),this.$dst.change()}.bind(this),this.onblur=function(){this.$dst.val()!==this.val()&&this.unbindAll()}.bind(this),this.bindAll()}return n.prototype.bindAll=function(){this.$src.bind("keyup change",this.handler),this.$dst.bind("blur",this.onblur)},n.prototype.unbindAll=function(){this.$src.unbind("keyup change",this.handler),this.$dst.unbind("blur",this.onblur)},n.prototype.val=function(){return this.echo.apply(this,t.map(this.$src,function(t){return e(t).val()}))},n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(187),n(3),n(2),n(321),n(164),n(198),n(149),n(328)],r=function(e,t,n,i,r,o,a,s){function l(e){return e?e.split(","):[]}var u={initialUsers:[],initialAdmins:[],allowAddSelf:!0,allowDeleteSelf:!1,allowRevokeSelfAdmin:!1,allowInvitations:!1,allowTeams:!1};return function(c,d){function h(){var e=n.keys(C);y.val(e),b.val(n.filter(e,function(e){return C[e]}));var t=n.keys(k);g.val(t),v.val(n.filter(t,function(e){return k[e]}));var i=!(!t.length&&!e.length),r=!!(b.val()&&b.val().length||v.val()&&v.val().length);c.toggleClass("non-empty",i).trigger("change:members",[i,r])}d=t.extend(u,d);var p,f,m,g,v,y,b,w,x,_,k,C,$,S;p=c.find(".error").first(),f=d.userInput||c.find(".user-input"),m=d.userList||c.find("table.widget"),g=d.userField||c.find(".user-field"),v=d.adminUsersField||c.find(".admin-users-field"),b=d.adminInvitationsField||c.find(".admin-invitations-field"),
d.allowInvitations&&(y=d.invitationField||c.find(".email-field")),w=d.addUserButton||c.find("button.add-user"),_=function(e){return p.text(e).show()},S=!(d.initialAdmins&&d.initialAdmins.length),k={},C={},x=function(e,n,i){var o;if(i=!!i,d.allowInvitations&&"string"==typeof e)o=t(a.toHtml("team-member-template",{isRegistered:!1,isAdmin:i,email:e})),m.append(o),C[e]=i,c.trigger("bb:userwidget.invite-added",e);else{var s=e.username;e.isRegistered=!0,e.isAdmin=i,e.isCheckboxDisabled=!d.allowRevokeSelfAdmin&&s===r.username,o=t(t.parseHTML(a.toHtml("team-member-template",e))),d.allowDeleteSelf||s!==r.username||o.find('a[href="#delete"]').remove(),m.append(o),k[s]=i,c.trigger("bb:userwidget.user-added",e)}n&&(p.hide().text(""),f.val("").focus()),h()},$={usernames:l(g.val()),addresses:[],adminUsernames:l(v.val()),adminAddresses:l(b.val())},d.allowInvitations&&($.addresses=l(y.val())),$.addresses.length||$.usernames.length?e.users({user:$.usernames},{error:function(){return i(gettext("An unexpected error occurred!"))},success:function(e){n.each($.usernames,function(t){x(e[t],!1,n.contains($.adminUsernames,t))}),n.each($.addresses,function(e){x(e,!1,n.contains($.adminAddresses,e))})}}):d.initialUsers.length?n.each(d.initialUsers,function(e){x(e,!1,n.contains(d.initialAdmins,e.username))}):h(),f.keypress(function(e){13===e.keyCode&&(w.click(),e.preventDefault())});var T;w.click(function(n){n.preventDefault();var i=f.val().trim();if(i){var a=t(n.target);if(!a.is(":disabled"))return a.prop({disabled:!0}),T=o(300,function(){f.addClass("loading")}),e.user(i).details({complete:function(){a.prop({disabled:!1}),clearTimeout(T),f.removeClass("loading")},error:function(e){return 404!==e.status?_("An unexpected error occurred."):d.allowInvitations&&s.email(i)?Object.prototype.hasOwnProperty.call(C,i)?_("{} is already a member.".format(i)):(x(i,!0,S),void(S=!1)):_("No user named {}.".format(i))},success:function(e){return Object.prototype.hasOwnProperty.call(k,e.username)?_("{username} is already a member.".format(e)):d.allowAddSelf||e.username!==r.username?!d.allowTeams&&e.is_team?_("You cannot add a team as a member."):(x(e,!0,S),void(S=!1)):_("You cannot add yourself as a member.")}})}}),c.bind("adduser.user-widget",function(e,t){var n=t.user;Object.prototype.hasOwnProperty.call(k,n.username)?t.errorOnDuplicate&&_("{username} is already a member.".format(n)):x(n)}),c.on("change","input[name=is-admin]",function(e){var n=t(e.target),i=n.closest("tr"),r=n.prop("checked");i.hasClass("registered-user")?k[i.data("username")]=r:C[i.data("email-address")]=r,h()}),m.delegate('a[href="#delete"]',"click",function(e){var i;if(e.preventDefault(),i=t(this).closest("tr"),i.hasClass("registered-user")){var r=i.data("username");delete k[r]}else{var o=i.data("email-address");delete C[o]}return h(),S=n.isEmpty(k)&&n.isEmpty(C),i.remove()})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){return(""+e).replace(/\W/g,"").toLowerCase()}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(145),n(209),n(163),n(211)],r=function(e,t,n,i,r){return t(function(t){r("bitbucket.registration.team.hipchat.ad.presented"),t.find("a").on("click",function(e){r("bitbucket.registration.team.hipchat.ad.link.clicked")}),t.find("#id_hipchat").on("click",function(t){r("bitbucket.registration.team.hipchat.ad.checkbox.clicked",{checked:e(t.target).is(":checked")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(188)],r=function(e,t){return t(function(){var t=e("#openid-form"),n=t.find("#openid-providers"),i=n.find("a"),r={expires:365};e("a.switch-login").click(function(t){t.preventDefault();var n=e(this).attr("href").slice(1),i=e(".login-box, .registration-box");i.attr("data-method",n),e.cookie("login-method",n,r)}),i.click(function(n){var o=e(this);i.removeClass("selected"),o.addClass("selected"),t.find(".provider").removeClass("selected"),n.preventDefault(),-1===o.data("url").indexOf("{id}")?(t.find(".buttons").removeClass("selected"),t.trigger("submit")):(e.cookie("openid-provider",o.attr("href"),r),t.find(".buttons").addClass("selected")),e(o.attr("href")).addClass("selected").find("input").focus()}),t.submit(function(i){var r=n.find(".selected").attr("data-url"),o=t.find(".provider.selected input").val();e("#openid_provider").val(r.replace("{id}",o)),e("#openid_username").val(o)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(585),n(306),n(587),n(579),n(363),n(578),n(215)],r=function(e,t,n,i,r,o,a,s){return t(function(t){var i=function(){function i(){var e=f.val()||p.attr("data-placeholder");p.text(e)}function a(){var e=g.val()&&!g.hasClass("invalid")&&(!y.length||y.val()&&!y.hasClass("invalid"))&&v.val()&&!v.hasClass("invalid")&&(!b.length||b.val())&&!f.hasClass("invalid");w.disable(!e)}function l(e,t){return e.trim().toLowerCase()===f.val().trim().toLowerCase()?t.fail(gettext("Username cannot be the same as team ID")):void t.pass()}function u(e,t){return e.trim().toLowerCase()===g.val().trim().toLowerCase()?t.fail(gettext("Team ID cannot be the same as username")):void t.pass()}function c(){f.val(""),m.val(""),i(),C.clearStyle()}function d(){c(),x.removeClass("hide-section")}function h(){c(),x.addClass("hide-section")}var p=e("#namespace"),f=e("#id_team_username"),m=e("#id_team_name"),g=e("#social_username"),v=e("#id_email"),y=e("#id_password1"),b=e("#g-recaptcha-response"),w=t.find('button[type="submit"]'),x=e(".team-form");g.length||(g=e("#id_username")),new n(m,f,r),f.on("input propertychange change",i),i();var _=new s,k=o.username(g,_).addValidation(l).onValidate(a).validate(),C=o.teamUsername(f,_).addValidation(u).onValidate(a).validate(),$=o.email(v,_).onValidate(a).validate();y.length&&o.password(y,_).onValidate(a).validate(),g.on("input",C.debouncedValidate),f.on("input",k.debouncedValidate),m.on("input",C.debouncedValidate),b.on("change",a),t.on("submit",function(){f.val(f.val().trim()),g.val(g.val().trim())}),a();var S=e("#plan-selector"),T=S.find(".plan"),D=e("#signup-plans"),P=e("#id_plan"),E=e(".account-form .plan-price, .login-form .plan-price"),A=D.find("li"),I="5_users"!==P.val();D.on("click","li",function(t){t.preventDefault();var n=e(t.target).closest("li"),i=n.data("showTeam");A.removeClass("selected"),n.addClass("selected"),T.text(n.find(".users").text()),P.val(n.attr("data-plan")),E.text(n.attr("data-plan-price")),i&&!I?(d(),I=!0):!i&&I&&(h(),I=!1)});var R=e("#social-setup");R.on("click",".form-link a",function(t){t.preventDefault(),k.clearStyle(),$.clearStyle(),C.clearStyle();var n=e(this).attr("href").slice("#social-".length);R.attr("data-method",n)})};!window.hasCaptcha||window.isCaptchaReady?i():e("body").on("recaptchaReady",i)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(363),n(578),n(580),n(215)],r=function(e,t,n,i,r){return t(function(){function t(){l.disable(o.hasClass("invalid")||a.hasClass("invalid"))}var o=e("#id_username"),a=e("#id_email"),s=e("#team-locked-form"),l=s.find('button[type="submit"]'),u=s.attr("data-team-name"),c=new i,d=new n(o,c);d.addValidation(r.notEmail(gettext("Your username cannot be an email address"))).addValidation(r.username(gettext("Please enter a valid username"))).addValidation(function(e,t){var n=e.trim().toLowerCase()===u.toLowerCase();t.passWhen(!n,gettext("Your username must be different from your team name"))}).addValidation(r.handleAvailable(gettext("That username already exists"))).onValidate(t).validate();var h=new n(a,c);h.addValidation(r.email(gettext("Please enter a valid email address"))),h.addValidation(function(t,n){e.ajax({type:"GET",dataType:"json",url:s.attr("data-handle-url"),data:{handle:t.trim()}}).done(function(e){return e?e.handle.toLowerCase()===u.toLowerCase()?n.pass():void n.fail(gettext("That email address is already in use")):n.pass()})}).onValidate(t).validate(),s.on("submit",function(){o.val(o.val().trim())}),e("#create-admin").on("click",function(t){t.preventDefault(),e(this).remove(),e(".account-form").removeClass("hide-section")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(593),n(602)],r=function(e,t,n,i){return t(function(){new n({el:e("#repo-access-pane")}),new i({el:e("#repo-group-access-pane")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(1),n(2),n(594),n(596),n(597),n(598),n(599),n(293),n(324),n(149),n(165),n(600),n(198),n(601),n(328),n(164),n(170)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p,f,m,g,v,y){var b=[y.owner.username,y.slug],w=h.concat("privileges",b),x=n.View.extend(i.extend(l,{tagName:"tr",template:"user-access-template",events:{'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"updateWithReversionOnFailure"},SELF_REVOCATION_WARNING:gettext("You might be revoking your own admin access to this repository."),initialize:function(){this.model.on("change",this.render,this),this.model.view=this},render:function(){return this.$el.html(d.toHtml(this.template,this.model.toJSON())),this},potentiallyRevokingOwnAccess:function(e){return e===v.username&&"admin"===this.model.get("privilege")},remove:function(){if(this.locked)return this;this.locked=!0;var t=this,n=this.$el,i=n.find('a[href="#delete"]'),r=setTimeout(function(){i.addClass("loading")},200),o=function(){t.locked=!1,clearTimeout(r),i.removeClass("loading")},a=function(){return t.model.destroy({success:function(){clearTimeout(r),i.removeClass("loading"),n.slideUp(function(){n.remove()})},wait:!0,error:function(n,i){o(),e.messages.error({body:t.GENERIC_ERROR_MSG,fadeout:!0})}})};return this.confirmIfSelfRevocation({confirm:function(e){a().then(function(){e&&t.checkAdminAccess(y,{hasNoAccess:location.reload.bind(location)})})},decline:function(){t.locked=!1,clearTimeout(r),i.removeClass("loading")}}),!1},isSelfRevoking:function(){return t.Deferred().resolve(this.potentiallyRevokingOwnAccess(this.model.get("username")))},update:function(n,i){var r=this;if(!this.locked)return this.confirmIfSelfRevocation({confirm:function(o){r.model.save({privilege:t(n.target).data("privilege")},{success:function(){o&&r.checkAdminAccess(y,{hasNoAccess:location.reload.bind(location)})},error:function(t,n){i(),e.messages.error({body:r.GENERIC_ERROR_MSG,fadeout:!0})}})}}),this}})),_=n.View.extend({tagName:"tr",template:"user-access-template",events:{"click .resend-invitation a":"resend",'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"update"},initialize:function(){this.model.on("change",this.render,this),this.model.view=this},render:function(){return this.$el.html(d.toHtml(this.template,this.model.toJSON())),this},resend:function(e){e.preventDefault(),t.ajax({url:this.model.url(),type:"POST",data:this.model.toJSON(),dataType:"json",success:function(){t(e.target).closest(".resend-invitation").fadeOut(200,function(){var e=gettext("Invitation sent");t(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">{}</span>'.format(i.escape(e))).fadeIn(200)})}})},remove:function(){if(this.locked)return this;this.locked=!0;var t=this,n=this.$el,i=n.find('a[href="#delete"]'),r=setTimeout(function(){i.addClass("loading")},200),o=function(){t.locked=!1,clearTimeout(r),i.removeClass("loading")};return this.model.set({id:this.model.get("email")}),this.model.destroy({wait:!0}).done(function(){clearTimeout(r),i.removeClass("loading"),n.slideUp(function(){n.remove()}),t.checkAdminAccess(y,{hasNoAccess:location.reload.bind(location)})}).fail(function(n,i){o(),e.messages.error({body:t.GENERIC_ERROR_MSG,fadeout:!0})}),!1},update:function(n){var i=this;if(!this.locked)return this.model.save({id:this.model.get("email"),permission:t(n.target).data("privilege")}).fail(function(t,n){e.messages.error({body:i.GENERIC_ERROR_MSG,fadeout:!0})}),this}}),k=n.View.extend({events:{'click button[type="submit"]':"create"},initialize:function(){this.$table=this.$("#user-access"),this.$table.data("initialized")||(this.$form=this.$("#grant-access"),this.$privilege=this.$("#access-level"),this.$username=this.$("#username"),this.submitDisabled=!1,this.$error=this.$(".error"),this.userCollection=new s,this.invitationCollection=new r,t.get(this.userCollection.url,function(e){var n,r,o;o=function(e){var t={avatar:e.avatarUrl},n=["username","firstName","lastName","displayName","isTeam"];return i.each(n,function(n){t[n.replace(/[A-Z]/g,"_$&").toLowerCase()]=e[n]}),t},r=new a({privilege:"owner",user:o(t("#repository-owner-userjson").data().userjson)});var s=t("#repository-creator-userjson");if(s.length>0&&s.data().priv.username!==y.owner.username&&(n=new a({privilege:"creator",user:o(s.data().priv)})),this.userCollection.add(e),this.$table.find("tr.loading").remove(),this.$table.find("tr.form").after(this.userCollection.reduce(function(e,t){var n=new x({model:t});return n.appView=this,e.add(n.render().el)}.bind(this),t())),n){this.userCollection.add(n);var l=new x({model:n,className:"creator"});l.appView=this,this.$table.find("tr.form").after(l.render().el)}this.userCollection.add(r);var u=new x({model:r,className:"owner"});u.appView=this,this.$table.find("tr.form").after(u.render().el),this.$table.attr("data-initialized",!0),this.$el.show()}.bind(this),"json"),t.get(this.invitationCollection.url,function(e){this.invitationCollection.add(e),this.$table.find("tr.loading").remove(),this.$table.append(this.invitationCollection.reduce(function(e,t){var n=new _({model:t});return n.appView=this,e.add(n.render().el)}.bind(this),t())),this.$el.show()}.bind(this),"json"))},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))},create:function(e){e.preventDefault();var n,i=this.$username.val().trim(),r=t(e.target).closest(".repo-access-form").find(".access-level select");if(!this.submitDisabled&&i){if(this.userCollection.get(i)){var s=gettext("%(username)s already has access.");return void this.respond(interpolate(s,{username:i},!0))}this.submitDisabled=!0,n=f(400,function(){this.$form.addClass("loading"),t(e.target).addClass("disabled").prop("disabled",!0).attr("aria-disabled",!0)}.bind(this));var l=p(function(){this.submitDisabled=!1,window.clearTimeout(n),this.$form.removeClass("loading"),t(e.target).removeClass("disabled").prop("disabled",!1).attr("aria-disabled",!1)},this);t.ajax({url:w.toString(i),type:"PUT",contentType:"text/plain",data:r.val(),dataType:"json",error:l(function(n){var a,s,l=!0;switch(n.status){case 404:if(g.email(i)){var u=this.invitationCollection.filter(function(e){return e.get("email")===i});if(u.length>0)a=gettext("%(username)s has already been invited"),s=interpolate(a,{username:i},!0);else{l=!1;var d=this.invitationCollection.create({email:i,permission:r.val()}),h=new _({model:d});h.appView=this,this.$table.append(h.render().el),this.respond(),this.$username.val("")}}else a=gettext('No user named "%(username)s".'),s=interpolate(a,{username:i},!0);break;case 402:var p=t.parseJSON(n.responseText).data;s=o.getErrorText(p),p.owner=v.username===p.user.username,p.can_upgrade&&c(t(e.target),{data:p});break;default:s=n.responseText}l&&this.respond(s)}),success:l(function(e){var t=new a(e[0]),n=this.userCollection.get(t.get("username"));if(n)n.set({privilege:t.get("privilege")}),n.view.render();else{var i=new x({model:t});i.appView=this,i.render(),this.userCollection.add(t),m(t,this,this.userCollection)}this.respond(),this.$username.val("").focus()}.bind(this))})}}});return k}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(595),n(165),n(170)],r=function(e,t,n,i,r,o){var a=[o.owner.username,o.slug],s=r.concat("invitations",a),l=t.Collection.extend({model:i,url:s.toString(),comparator:function(e){return e.get("email")},parse:function(e){return n.map(e,function(e){return e.id=e.user.email,e})}});return l}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(165),n(170)],r=function(e,t,n,i){var r=[i.owner.username,i.slug],o=n.concat("invitations",r),a=t.Model.extend({toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.isEditable=!0,e[e.permission]=!0,e},url:function(){return o.toString(this.get("email"))}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){return{getErrorText:function(t){return t.can_upgrade?e("#admin-user-access").attr("data-upgrade-required-text"):e("#admin-user-access").attr("data-upgrade-required-non-owner-text").format(t.user.username)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(165),n(170),n(317)],r=function(e,t,n,i,r,o){var a=[r.owner.username,r.slug],s=i.concat("privileges",a),l=t.Model.extend({initialize:function(){var e=this.get("user"),t=e.display_name;this.set({id:e.username,avatar:e.avatar||o,name:t,username:e.username,is_staff:e.is_staff})},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return"creator"==e.privilege||"owner"==e.privilege?e.isEditable=!1:(e.isEditable=!0,e[e.privilege]=!0),e},url:function(){return s.toString(this.get("username"))},sync:function(e,n,i){return"update"===e&&(i.contentType="text/plain",i.data=n.get("privilege")),t.sync.call(this,e,n,i)}});return l}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(597),n(165),n(170)],r=function(e,t,n,i,r,o){var a=[o.owner.username,o.slug],s=r.concat("privileges",a),l=t.Collection.extend({model:i,url:s.toString(),comparator:function(e){var t=e.get("privilege");return["owner"==t?0:1,"creator"==t?0:1,e.get("name").toLowerCase()]},parse:function(e){return n.map(e,function(e){return e.id=e.user.username,e})}});return l}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(293)],r=function(e,t){var n=e("body").data("base-url")!==location.origin;return{GENERIC_ERROR_MSG:gettext("There has been a technical issue. Please retry shortly."),checkAdminAccess:function(t,i){var r=t.slug;return n||(r=t.owner.username+"/"+r),e.get("/"+r+"/admin/access-check").then(function(){i.hasAccess&&i.hasAccess()}).fail(function(e){403===e.status?i.hasNoAccess&&i.hasNoAccess():i.hasAccess&&i.hasAccess()})},updateWithReversionOnFailure:function(t){var n=this,i=e(t.target).closest("tr"),r=this.model.get("privilege"),o=function(){i.find(".selected").removeClass("selected").addClass("aui-lozenge-subtle"),i.find('[data-privilege="'+r+'"]').addClass("selected").removeClass("aui-lozenge-subtle"),n.model.set("privilege",r)};this.update(t,o)},confirmIfSelfRevocation:function(e){var t=this;this.isSelfRevoking().then(function(n){n?t._showRevocationConfirmationDialog(e):e.confirm(n)}).fail(function(){t._showRevocationConfirmationDialog(e)})},_showRevocationConfirmationDialog:function(e){t({content:this.SELF_REVOCATION_WARNING,buttonText:gettext("Revoke")}).done(function(){e.confirm(!0)}).fail(function(){e.decline&&e.decline()})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){return function(t,n){return function(i){return function(){var r=e.toArray(arguments);n=n||null,t.apply(n,r),i.apply(n,r)}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2)],r=function(e){return function(t,n,i){var r=i||n.collection,o=e.sortedIndex(r.models,t,r.comparator),a=n.$ol||n.$table.find("tbody"),s=n.$table&&n.$table.find("tbody tr.form");if(s&&s.length){var l;s.length&&(0===o?s.after(t.view.el):(l=o+1,a.children(":nth-child("+l+")").after(t.view.el)))}else 0===o?a.prepend(t.view.el):a.children(":nth-child("+o+")").after(t.view.el);return{add:function(){r.add(t,{at:o})}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(1),n(2),n(603),n(604),n(596),n(599),n(324),n(149),n(165),n(600),n(198),n(601),n(170),n(164)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p,f,m){var g=[f.owner.username,f.slug],v=c.concat("group-privileges",g),y=c.concat("_group-privileges-to-add",g),b=n.View.extend(i.extend(s,{tagName:"tr",template:"group-access-template",events:{'click [href="#delete"]':"clear","click .access li:not(.selected)":"updateWithReversionOnFailure"},initialize:function(){i.bindAll(this,"render"),this.model.bind("change",this.render),this.model.view=this},render:function(){return t(this.el).html(u.toHtml(this.template,this.model.toJSON())),this},remove:function(){var e=t(this.el).slideUp(function(){var n=e.siblings().length;e.remove(),n||t("#group-access").hide(),w()})},isSelfRevoking:function(){return"admin"!==this.model.get("privilege")?t.Deferred().resolve(!1):t.getJSON("/!api/1.0/groups/?group="+this.model.get("id").replace(":","/")).then(function(e){return e.length>0})},SELF_REVOCATION_WARNING:gettext("You might be revoking your own admin access to this repository."),clear:function(n){if(n.preventDefault(),this.locked)return this;this.locked=!0;var i=this,r=t(this.el).find('a[href="#delete"]'),o=setTimeout(function(){r.addClass("loading")},200),a=function(){i.locked=!1,clearTimeout(o),r.removeClass("loading")},s=function(){return i.model.destroy().done(i.remove.bind(i)).fail(function(t,n){a(),e.messages.error({body:i.GENERIC_ERROR_MSG,fadeout:!0})})};return this.confirmIfSelfRevocation({confirm:function(){s().then(function(){i.checkAdminAccess(f,{hasNoAccess:location.reload.bind(location)})})},decline:a})},update:function(t,n){var i=this,r=function(){return i.model.save({privilege:t.target.innerHTML}).done(w).fail(function(t,r){n(),e.messages.error({body:i.GENERIC_ERROR_MSG,fadeout:!0})})};this.confirmIfSelfRevocation({confirm:function(e){r().then(function(){e&&i.checkAdminAccess(f,{hasNoAccess:location.reload.bind(location)})})}})}})),w=t.get.bind(t,y.toString(),function(e){var n=gettext("Select a group"),r=t('<option value=""></option>').text(n),o=[r].concat(i.map(e,function(e){var n=e.owner.username+":"+e.slug;return t("<option>").val(n).text(e.name+" ("+n+")")})),a=t("#groupname").empty();a.append.apply(a,o).trigger("change")},"json"),x=n.View.extend({events:{"click button:submit":"create"},initialize:function(){this.$table=this.$("#group-access"),this.$table.data("initialized")||(this.$form=this.$("#grant-group-access"),this.$error=this.$(".error"),w(),this.submitDisabled=!1,this.collection=new o,this.collection.fetch({success:function(e){this.$table.find("tr.loading").remove(),e.length&&(this.$table.find("tr.form").after(e.reduce(function(e,t){var n=new b({model:t});return n.parent=this,e.add(n.render().el)},t())),this.$table.attr("data-initialized",!0))}.bind(this)}))},respond:function(e,t){e?(this.$error.removeClass("hidden"),this.$error.find(".message")[t?"html":"text"](e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))},create:function(e){e.preventDefault();var n,i,o=t("#groupname").val(),s=t(e.target).closest(".repo-access-form").find(".access-level select");if(this.$form.addClass("loading"),t(".ui-autocomplete").hide(),!this.submitDisabled&&o){if(n=this.collection.get(o)){var u=gettext("%(owner)s:%(group)s already has access.");return void this.respond(interpolate(u,{owner:n.owner.username,group:n.slug},!0))}this.submitDisabled=!0,i=h(400,function(){this.$form.addClass("loading"),t(e.target).addClass("disabled").prop("disabled",!0).attr("aria-disabled",!0)}.bind(this));var c=d(function(){this.submitDisabled=!1,window.clearTimeout(i),this.$form.removeClass("loading"),t(e.target).removeClass("disabled").prop("disabled",!1).attr("aria-disabled",!1)},this);t.ajax({url:v.toString(t("#groupname").val().split(":")),type:"PUT",contentType:"text/plain",data:s.val(),dataType:"json",error:c(function(n){switch(n.status){case 402:var i=t.parseJSON(n.responseText).data,r=a.getErrorText(i);i.owner=m.username===i.user.username,i.can_upgrade&&l(t(e.target),{data:i}),this.respond(r);break;case 403:var s=gettext('<strong>Your private repositories are over their user limit.</strong> Committers have read-only access. <a href="/plans">Upgrade my plan</a>.');this.respond(s,!0);break;case 404:var s=gettext("No group named %(group_name)s.");this.respond(interpolate(s,{group_name:o},!0));break;default:this.respond(n.responseText)}}),success:c(function(e){this.respond();var t=new r(e[0]),n=new b({model:t}).render();n.parent=this,p(t,this).add(),this.$table.show(),w()})})}}});return x}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(165),n(170)],r=function(e,t,n,i){var r=[i.owner.username,i.slug],o=n.concat("group-privileges",r),a=t.Model.extend({url:function(){var e=this.get("group");return o.toString(e.owner.username,e.slug)},initialize:function(e){var t=e.group;this.set({id:t.owner.username+":"+t.slug})},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e[e.privilege]=!0,e},sync:function(e,n,i){return"update"===e&&(i.contentType="text/plain",i.data=n.get("privilege")),t.sync.call(this,e,n,i)}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(603),n(165),n(170)],r=function(e,t,n,i,r){var o=[r.owner.username,r.slug],a=i.concat("group-privileges",o),s=t.Collection.extend({model:n,url:a.toString(),comparator:function(e){return e.get("group").name.toLowerCase()}});return s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(2),n(606),n(614)],r=function(e,t,n,i,r){return e(function(){var e=t("#admin-branch-management"),n=e.find(".branch-restrictions-form");if(n.length){var o=e.data("writers"),a=e.data("branches"),s=e.data("models");n.each(function(){var n=t(this),l=n.attr("data-kind"),u=new i(s[l],{url:e.attr("data-api-url"),kind:l});new r({el:n,collection:u,disableUsers:n.hasClass("no-users"),writers:o,branches:a}).render()})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(607)],r=function(e,t){return e.Collection.extend({model:t,initialize:function(e,t){this.url=t.url,this.kind=t.kind},parse:function(e,t){return e.values?e.values:e},comparator:function(e){return[e.get("pattern").toLowerCase()]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(608),n(610),n(612),n(613)],r=function(e,t,n,i,r,o){var a=new RegExp(r.starRegex.source),s={};return e.Model.extend({initialize:function(e,t){this.set(this.parse(e))},parse:function(e){e.users=new n(e.users),e.groups=new i(e.groups);var t=o(e.pattern);return e.has_wildcard=a.test(t),e},calculateMatchingBranches:function(e){var n=this.get("pattern"),i=[];return t.each(e,function(e){if(!e.disableMatching){var t=s[e.name]||new r(e);t.matches(n,null,!0)&&i.push({name:e.name}),s[e.name]=t}}),this.matching=i,i}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(609)],r=function(e,t){return e.Collection.extend({model:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({idAttribute:"username"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(611)],r=function(e,t){return e.Collection.extend({model:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Model.extend({idAttribute:"full_slug"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(238),n(613)],r=function(e,t,n){var i={},r={},o=t.extend({idAttribute:"name",sortKeys:function(e){var t=e.toLowerCase(),n=this.get("name").toLowerCase();return[t!==n,n]},convertToRegex:function(e,t){var a=t?r:i;if(!a[e]){var s=n(e);s=s.replace(o.starRegex,function(e,t){return t?t+".*":".*"}),s=s.replace(o.escapedStarRegex,"\\*"),s=t?"^"+s+"$":"^"+s,a[e]=new RegExp(s)}return a[e]},highlightSubstring:function(t,n){if(n){n=this.convertToRegex(n.toLowerCase());var i=n.exec(t);if(i&&i.length)return this.highlight(t,i[0])}return e.escape(t)},matches:function(e,t,n){var i=this.convertToRegex(e,n);return i.test(this.get("name"))}},{starRegex:/^\\\*|([^\\])\\\*/g,escapedStarRegex:/\\\\\\\*/g});return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(615),n(618),n(620),n(212),n(215)],r=function(e,t,n,i,r,o){return e.View.extend({initialize:function(e){this.$restrictionsContainer=this.$("tbody"),this.disableUsers=e.disableUsers,this.writers=e.writers,this.branches=this.filterBranches(e.branches),this.$pattern=this.$("input.pattern-input"),this.$error=this.$(".aui-message"),this.$submitButton=this.$("button"),this.views={},this.$userGroupField=this.$("input.user-or-group"),this.$userGroupField.length&&(this.userAutocomplete=i(this.$userGroupField,this.writers),this.userAutocomplete.updateSource()),r(this.$pattern,this.branches),this.collection.on("add",this.insertRule,this),this.collection.on("remove",this.removeRule,this),this.collection.on("change:pattern",this.reorderRule,this),this.toggleSubmitButton()},events:{"click button":"add","keyup input.pattern-input":"toggleSubmitButton","input input.pattern-input":"toggleSubmitButton","typeahead-completed input.pattern-input":"toggleSubmitButton","change input.user-or-group":"toggleSubmitButton"},filterBranches:function(e){var t="true"===this.$el.attr("data-bookmarks-only"),i={name:"*",disableMatching:!0};return t?(e=n.filter(e,function(e){return e.bookmark}),i.note="(All bookmarks)"):i.note="(All branches)",e.unshift(i),e},render:function(){return this.collection.each(function(e){this.insertRule(e,!1)}.bind(this)),this.$restrictionsContainer.find("tr.loading").remove(),n.each(this.views,function(e){e.countMatchingBranches()}),this},toggleSubmitButton:function(){var e=!!this.$pattern.val(),t=!this.userAutocomplete||!this.userAutocomplete.isEmpty();this.$submitButton.disable(!e||!t)},add:function(e){e.preventDefault();var n={users:[],groups:[]};this.userAutocomplete&&(n=this.userAutocomplete.selectedWriters());var i=t(e.target).loading(),r={wait:!0,success:function(e,t,n){i.resolve(),this.$error.addClass("hidden"),this.userAutocomplete&&this.userAutocomplete.clear(),this.$pattern.val(""),this.toggleSubmitButton()}.bind(this),error:function(e,t,n){i.reject(),this.$error.find(".message").text(t.responseText),this.$error.removeClass("hidden")}.bind(this)},o=this.$pattern.val().trim(),a=this.collection.where({pattern:o});if(a.length){var s=a[0],l=s.get("users").clone(),u=s.get("groups").clone();l.add(n.users),u.add(n.groups),s.save({users:l,groups:u},r)}else this.collection.create({kind:this.collection.kind,pattern:o,users:n.users,groups:n.groups},r)},insertRule:function(e,t){var n=new o({model:e,disableUsers:this.disableUsers,$userGroupField:this.$userGroupField,$error:this.$error,writers:this.writers,branches:this.branches}).render(),i=this.collection.indexOf(e);this.$restrictionsContainer.find("tr:nth("+i+")").after(n.$el),this.views[e.id]=n,t&&n.countMatchingBranches()},removeRule:function(e){delete this.views[e.id]},reorderRule:function(e){var t=this.views[e.id];this.collection.sort();var n=this.collection.indexOf(e);t.$el.detach(),this.$restrictionsContainer.children().slice(n,n+1).after(t.$el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(149),n(241),n(616),n(617)],r=function(e,t,n,i,r,o){return function(a,s,l){function u(t,n){var i=[];e(t.val().split(",")).each(function(){i.push(d.get(this))}),n(i)}function c(e){d.off("respond"),d.on("respond",function(t){e.callback({results:t.results})}),d.query(e.term)}l=l||{};var d=l.source;s=t.map(s,function(e){return new r(e)}),d||(d=new i(s,{model:r,matcher:r.matcher}));var h=l.formatResult||function(e,t,i){var r=n.toHtml("user-or-group-suggestion",e.toHighlightedJSON(i.term));e.is_user||t.addClass(" bb-typeahead-item bb-typeahead-group-result"),t.append(r)},p=l.formatSelection||function(e,t){t.append(n.toHtml("user-or-group-result",e.toJSON()))},f=a.auiSelect2(e.extend({placeholder:gettext("Start typing to search for a user"),containerCssClass:"text long-field",dropdownCssClass:"bb-typeahead-suggestions aui-dropdown2 aui-style-default bb-user-suggestions",
multiple:!0,query:c,formatResult:h,formatSelection:p,initSelection:u},l.select2)),m=l.viewClass||function(){return o},g=a.parents("div.field-container, div.field-group");return g.addClass("user-group-autocomplete"),new(m())({source:d,el:g[0],$input:a,$select2:f}).render()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(238)],r=function(e,t){return t.extend({initialize:function(e,t){e&&this.set(this.parse(e))},parse:function(t){return t.is_user=e.has(t,"username"),t.id=t.is_user?t.username:t.full_slug,t},toJSON:function(){var e=t.prototype.toJSON.call(this);return e.has_display_name=this.get("display_name")!==this.get("username"),e},toHighlightedJSON:function(e){var t=this.toJSON();return t.is_user?(t.display_name=this.highlightSubstring(t.display_name,e),t.username=this.highlightSubstring(t.username,e)):(t.name=this.highlightSubstring(t.name,e),t.full_slug="{}:{}".format(this.highlightSubstring(t.owner.username,e),this.highlightSubstring(t.slug,e))),t},sortKeys:function(e){var t=this.get("is_user"),n=e.toLowerCase();return[!t,t&&!(n===this.get("username").toLowerCase()),t&&this.get("display_name").toLowerCase(),t&&this.get("username").toLowerCase(),!(t||n===this.get("owner").username.toLowerCase()),!(t||n===this.get("slug").toLowerCase()),!t&&this.get("name").toLowerCase(),!t&&this.get("full_slug").toLowerCase()]},match:function(e,t){return this.startsWith(this.get(e),t)},nameMatch:function(e){return this.match("name",e)},ownerMatch:function(e){return this.startsWith(this.get("owner").username,e)},slugMatch:function(e){return this.match("slug",e)},usernameMatch:function(e){return this.match("username",e)},displayNameMatch:function(e){return this.match("display_name",e)},matches:function(e,t){if(this.get("selected"))return!1;if(this.get("is_user")){var n=this.usernameMatch(e),i=this.displayNameMatch(e);return n||i}return this.ownerMatch(e)||this.slugMatch(e)||this.nameMatch(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(228)],r=function(e,t){return t.extend({className:"bb-user-group-typeahead",initialize:function(e){this.$input=e.$input,this.$select2=e.$select2,t.prototype.initialize.call(this,e),this.$input.on("change",this.updateSource.bind(this)),this.updateSource()},selectedWriters:function(){var e={users:[],groups:[]};return this.source.each(function(t){if(t.get("selected")){var n=t.get("is_user")?e.users:e.groups;n.push(t)}}),e},hasChanged:function(t){function n(e){return e.id}var i=this.selectedWriters(),r=t.users.map(n),o=e.map(i.users,n),a=t.groups.map(n),s=e.map(i.groups,n);return r.length!=o.length||a.length!=s.length?!0:e.intersection(o,r).length!=r.length||e.intersection(s,a).length!=a.length},isEmpty:function(){return!this.source.any(function(e){return e.get("selected")})},clear:function(){this.$input.val(""),this.$input.change()},updateSource:function(){var e=this.source;e.each(function(e){e.set("selected",!1)});var t=this.$input.val()?this.$input.val().split(","):[];t.forEach(function(t){var n=e.get(t);n.set("selected",!0)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(612),n(228),n(619)],r=function(e,t,n){return function(i,r){var o=i.parents("div.field-container, div.field-group"),a=new n(r,{model:e,matcher:e.matcher});return i.addClass("bb-typeahead-input"),i.attr("autocomplete","off"),o.addClass("branch-autocomplete"),new t({source:a,el:o[0],callToActionText:gettext("Begin typing to search for a branch or tag"),resultsClasses:"bb-typeahead-branches",resultTemplate:"branch-suggestion"}).render()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(612),n(241)],r=function(e,t,n){return n.extend({getFilteredResults:function(i){function r(e){return e.id===a.id}var o=n.prototype.getFilteredResults.call(this,i);if(i){var a=new t({name:i});e.find(o,r)||o.unshift(a)}return o}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(1),n(2),n(149),n(615),n(618),n(621),n(622),n(183),n(212),n(215)],r=function(e,t,n,i,r,o,a,s,l,u){return n.View.extend({tagName:"tr",className:"restriction",events:{"click .edit-link":"showEditForm","click [href=#delete]":"delete"},initialize:function(e){this.disableUsers=e.disableUsers,this.$userGroupField=e.$userGroupField,this.writers=e.writers,this.branches=e.branches,this.$error=e.$error,this.maxMatching=5,this.model.on("change",this.updateRow,this),this.model.on("change:pattern",this.countMatchingBranches,this),this.model.on("destroy",function(){this.$el.remove()},this)},showEditForm:function(e){e.preventDefault();var n;if(this.dialog)n=this.dialog.getCurrentPanel().body.find("div.user-or-group select");else{var i=this.dialog=new u({width:700,height:"auto",id:"edit-branch-{}-form".format(this.model.id)});this.$content=t("<div>"),i.addHeader(gettext("Edit branch restriction")),i.addPanel("edit-form",this.$content,"edit-form-body"),i.addButton(gettext("Save"),this.edit.bind(this),"edit-restriction-button"),this.$submitButton=this.dialog.getCurrentPanel().page.buttonpanel.find(".edit-restriction-button"),i.addCancel(gettext("Cancel"),function(e){e.hide()}),this.$content.html(r.toHtml("edit-branch-restriction",this.model.toJSON())),n=this.$userGroupField.clone(),n.attr("id","user_or_group_{}".format(this.model.id)),this.$content.find(".user-or-group-autocomplete").append(n),this.autocomplete=o(n,this.writers,{select2:{width:"100%"}}),this.$pattern=this.$content.find("input.pattern-input"),a(this.$pattern,this.branches),this.$error=this.$content.find(".aui-message"),this.$pattern.on("keyup",this.disable.bind(this)),n.on("change",this.disable.bind(this))}var s=[];this.model.get("users").each(function(e){s.push(e.id)}),this.model.get("groups").each(function(e){s.push(e.id)}),n.val(s.join(",")),n.change(),this.$pattern.val(this.model.get("pattern")),this.disable(),this.dialog.show()},edit:function(e){var n=this.autocomplete.selectedWriters(),i=this.model.save({users:n.users,groups:n.groups,pattern:this.$pattern.val()},{wait:!0});i.done(function(){this.$error.addClass("hidden"),this.dialog.hide()}.bind(this)),i.fail(function(e){this.$error.find(".message").text(e.responseText),this.$error.removeClass("hidden")}.bind(this)),t(e.target).loading(i)},disable:function(){var e=this.$pattern.val(),t=e!==this.model.get("pattern"),n={users:this.model.get("users"),groups:this.model.get("groups")};e&&!this.autocomplete.isEmpty()&&(t||this.autocomplete.hasChanged(n))?this.$submitButton.disable(!1):this.$submitButton.disable(!0)},renderUsersAndGroups:function(){if(!this.disableUsers){var e=this.$el.find("td.user-group div").html("");this.model.get("users").each(function(t){var n=new s({model:t}).render();e.append(n.$el)}),this.model.get("groups").each(function(t){var n=new l({model:t}).render();e.append(n.$el)})}},render:function(){var t=this.model.toJSON();return t.disableUsers=this.disableUsers,t.disableEdit=this.disableUsers,this.$el.html(r.toHtml("branch-restriction",t)),this.renderUsersAndGroups(),e.InlineDialog(this.$(".pattern .aui-badge"),"matching-branches-{}".format(this.model.id),this.showMatchingBranches.bind(this),{width:200}),this},updateRow:function(){this.$(".pattern .value").text(this.model.get("pattern")),this.disableUsers||this.renderUsersAndGroups()},countMatchingBranches:function(){var e=this.$(".pattern .aui-badge");if(this.model.get("has_wildcard")){var t=this.model.calculateMatchingBranches(this.branches);e.removeClass("hidden").text(t.length)}else e.addClass("hidden")},showMatchingBranches:function(e,t,n){var i={matching:this.model.matching,more:this.model.matching.length>this.maxMatching};i.more&&(i.matching=i.matching.slice(0,this.maxMatching)),e.html(r.toHtml("matching-branches",i)),n()},"delete":function(e){e.preventDefault();var n=this.model.destroy({wait:!0});n.done(function(){this.$error.addClass("hidden")}.bind(this)),n.fail(function(e){this.$error.find(".message").text(e.responseText),this.$error.removeClass("hidden")}.bind(this)),t(e.target).closest("a").loading(n)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(149)],r=function(e,t){return e.View.extend({className:"user",render:function(){return this.$el.html(t.toHtml("branch-user-rule",this.model.toJSON())),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(149)],r=function(e,t){return e.View.extend({className:"bb-group",render:function(){return this.$el.html(t.toHtml("branch-group-rule",this.model.toJSON())),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(293),n(215)],r=function(e,t,n){return e(function(){var e=t("#delete-repository form");e.on("submit",function(e){e.preventDefault(),n({id:"delete-repository",title:"Delete repository?",content:"Deleting a repository is a permanent action and cannot be undone. Are you sure you wish to permanently delete this repository, and any associated issues or wikis?",buttonText:"Delete"}).done(function(){t(e.target).off("submit").submit()})}),e.find("button").disable(!1)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(187),n(359),n(170)],r=function(e,t,n,i,r){var o=n.repository(r.owner.username,r.slug);return e(function(){var e=t("#deploy-keys"),n=t("#edit-ssh-key"),r={onEdit:function(e,t){o.update_deploy_key(n.find("#ssh_pk").val(),e,t)},onCreate:function(e,t){o.create_deploy_key(e,t)},onDelete:function(e,t){o.delete_deploy_key(e,t)}};i(e,r)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(183),n(149)],r=function(e,t,n,i,r){return n(function(){function e(){var e=new i({width:500,height:300,id:"repo-hooks-dialog"});return e.addPanel("panel-hook"),e.addButton("Save",function(e){t(e.popup.element).find("form").submit()}),e.addCancel("Cancel",function(e){f.fire(),e.hide()}),e.popup.element.on("click",".change-redacted-value",function(e){e.preventDefault();var n=t(e.target);n.replaceWith(r.toHtml(n.attr("data-template"),{}))}),e}function n(e){return function(){e.find(".delete").click()}}function o(n){var i=t(n.target),r=i.closest(".hook"),o=r.find("form");n.preventDefault(),c=c||e(),c.addHeader(r.find(".hook-name").text()),c.getCurrentPanel().body.empty().append(o.clone()),c.show()}function a(t){c=e(),c.addHeader("Add POST hook"),c.getCurrentPanel().body.empty().append(t.removeClass("hidden")),c.show()}function s(e){var i=t(e.target),r=i.find('[name="add-service"]');e.preventDefault();var o=r.val();return o&&parseInt(o,10)>0&&t.ajax({type:i.attr("method")||"POST",url:i.attr("action"),data:i.serialize(),dataType:"html"}).success(function(e){var i=t(e).find("#hooks-list"),r=i.find('.hook[data-added-service="true"]');h.replaceWith(i),h=t("#hooks-list"),r.find(".edit").click(),f.add(n(r))}),!1}function l(e){var n=t(e.target).closest("a"),i=n.closest(".hook");e.preventDefault(),n.addClass("loading"),t.ajax({type:"DELETE",url:n.attr("data-url"),dataType:"json"}).success(function(){i.remove()})}function u(e){var n=t(e.target);return e.preventDefault(),t.ajax({type:"POST",url:n.attr("action"),data:n.serialize(),dataType:"html"}).success(function(e){var n=t(e).find("#hooks-list");h.replaceWith(n),h=t("#hooks-list"),c.hide(),f.empty()}),!1}var c,d=t("#admin-hooks"),h=d.find("#hooks-list"),p=t("#quick-add-hook-form"),f=t.Callbacks();t("#add-hook-form").on("submit",s),d.on("click","a.delete",l).on("click","a.edit",o),t(document).on("submit","#repo-hooks-dialog form",u),p.length&&a(p)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(627),n(158),n(185)],r=function(e,t,n,i,r,o){return n(function(e){var n=t("#repo-admin-nav").find("a");o(function(){var e=n.filter('a[href="'+i()+'"]');n.closest("li").removeClass("aui-nav-selected"),e.closest("li").addClass("aui-nav-selected")}),e.pjax("#repo-admin-nav a",{container:"#pjax-main",scrollTo:null}).on("pjax:beforeSend",function(){e.find("select.select2-offscreen").auiSelect2("destroy")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){return(e||window.location.pathname).rstrip("/")}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(145),n(3),n(629)],r=function(e,t,n){return e(function(){var e=n(t("#issue-export"),{template:"export-dialog-template",title:"Issue export",id:"issue-export",height:"210",onComplete:function(t,n){"SUCCESS"===n.status&&(n.downloadUrl=n.url,n.title="Issue export complete",n.closeLink=!0),e.update(n)},getStatus:function(e){var t="Waiting for export to start...";return e.phase&&(t="Exporting: "+e.phase),t}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(183),n(149)],r=function(e,t,n,i){return function(t,r){function o(e){t.on(e,h)}function a(e){var t;return t="function"==typeof r.templateData?r.templateData(e):e||r.templateData,t||{}}function s(){m||(l(),u(a())),m.show()}function l(){m=new n({width:v,height:y,id:"bb-"+g+"-dialog"}),m.addPanel("main")}function u(e){m.addHeader(e.title||r.title||gettext("Progress")).getCurrentPanel().html(i.toHtml(r.template,e)),m.popup.element.find(".dialog-button-panel").empty(),e.closeLink&&m.addCancel(gettext("Close"),function(e){e.hide()})}function c(e,t,n){u({error:n,closeLink:!0})}function d(e){s(),f(e)}function h(n){n&&n.preventDefault(),r.taskUrl=r.taskUrl||t.attr("data-url"),s(),e.ajax({type:"post",dataType:"json",url:r.taskUrl,success:function(e,t,n){"success"===t&&d(r.taskUrl)},error:c})}function p(e){var t=m.popup.element.find("#progress-container"),n=r.getStatus(e);t.find(".progress-message").text(n),e.pct&&(t.find(".progress").css({width:e.pct+"%"}),t.find(".progress-percent").text(e.pct+"%"))}function f(t){e.ajax({type:"get",dataType:"json",url:t,success:function(e,n,i){"ACCEPTED"===e.status||"STARTED"===e.status?(p(e),setTimeout(function(){f(t)},1e3)):"SUCCESS"===e.status?r.onComplete&&r.onComplete(m,e):"FAILURE"===e.status&&c(i,n,e.message?e.message:gettext("Unexpected error"))},error:c})}1!==arguments.length||t.jquery||(r=t,t=e());var m,g=r.id||"progress",v=r.width||600,y=r.height||"auto";return t&&t.length&&o("click"),{getDialog:function(){return m},getElement:function(){return m.popup.element},bind:function(e,n,i){e&&e.length&&(t=e,o(n))},start:function(e,t){r.taskUrl=e?e:r.taskUrl,"get"===t?d(e):h()},update:u}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(629),n(395),n(396)],r=function(e,t,n,i,r){return e(function(){function e(){u.start(a,"get"),t("#import-upload-file").val(""),o.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled")}var o=t("#issue-import"),a=o.attr("data-url"),s=t("#import-upload-file"),l=t("#import-upload-form"),u=n({template:"import-dialog-template",title:"Issue import",id:"issue-import",height:"210",onComplete:function(e,t){"SUCCESS"===t.status&&(t.finished=!0,t.title="Issue import complete",t.closeLink=!0),u.update(t)},getStatus:function(e){var t="Waiting for import to start...";return e.phase&&(t="Importing: "+e.phase),t}});i(s,{$dropTarget:t("#import"),uploadOnDrop:!0,complete:function(t){202===t.status?e():t.status>=400&&t.status<500&&(l.find(".error-container").empty().text(t.response),o.removeClass("loading"))},fileSelected:function(e){e.name&&(l.find(".error-container").empty(),o.removeAttr("aria-disabled").removeAttr("disabled"))}}),r&&o.attr({"aria-disabled":!0,disabled:!0}),l.on("submit",function(){t("#import-upload-target").one("load",e),o.addClass("loading").attr({"aria-disabled":!0,disabled:!0})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(393),n(403)],r=function(e,t,n){return e(function(){function e(){"public"===o.filter(":checked").val()?s.slideDown(i):s.slideUp(i)}var i=400,r=t("#issues-admin"),o=r.find('[name="issue_tracker"]'),a=r.find('[name="new_issue_message"]'),s=r.find("#anonymous_issues_field");o.on("click",e),e(),a.markItUp(n())})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(633),n(635)],r=function(e,t,n,i){return e(function(){var e=t("#repo-admin section"),r=e.data("category"),o=i.create(r);o.reset(e.data("json")),new n({collection:o,el:e,category:r})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(8),n(634),n(601)],r=function(e,t,n,i,r){return t.View.extend({events:{setdefaultitem:"defaultItem",submit:"add"},initialize:function(t){this.$table=this.$("table.widget"),this.$name=this.$("input:text"),this.$error=this.$(".error"),this.$table.find("tr.form").after(this.collection.reduce(function(e,t){var n=t.view=new i({model:t});return n.parent=this,e.add(n.el)}.bind(this),e()))},defaultItem:function(e,t){this.collection.each(function(e){e.set({"default":e===t}),e.view.setDefaultState()})},add:function(e){e.preventDefault();var t=this.$name.val().trim();if(t){var n=this.collection,o=new n.model;o.collection=n,o.save({name:t},{error:function(e,t){this.respond(t)}.bind(this),success:function(e){this.respond(),e.view=new i({model:e}),e.view.parent=this,r(e,this).add(),this.$name.val("").focus()}.bind(this),wait:!0})}},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(183),n(149),n(601)],r=function(e,t,n,i,r){function o(e,i){var r=new n({width:450,height:"auto",id:"bb-edit-category"});r.addPanel("main");var o=r.getCurrentPanel(),a=gettext("Name");o.html('<form class="aui"><div class="field-group">'+"<label>{}</label>".format(t.escape(a))+'<input type="text" class="text" id="edit_category_name" name="edit_category_name"/></div></form>');var s=/^(.+)s$/.exec(e)[1],l=gettext("Edit %(category)s");return r.addHeader(interpolate(l,{category:s},!0)).addButton(gettext("Edit"),i,"aui-button aui-style").addCancel(gettext("Cancel"),function(e){e.hide()}),o.body.find("form").submit(function(e){e.preventDefault(),i()}),r}return e.View.extend({tagName:"tr",events:{'click a[href="#edit"]':"rename",'click a[href="#default"]':"toggle",'click a[href="#delete"]':"destroy"},initialize:function(e){this.$el.html(i.toHtml("issues-category-template",{name:this.model.get("name"),singular:/^(.+)s$/.exec(this.model.category)[1]})),this.setDefaultState()},setDefaultState:function(){this.model.get("default")?this.$el.attr({title:gettext("Remove default")}).addClass("default"):this.$el.attr({title:gettext("Set as default")}).removeClass("default")},startWaiting:function(){return this.$el.addClass("waiting")},stopWaiting:function(){return this.$el.removeClass("waiting")},rename:function(e){e.preventDefault();var t=o(this.model.category,function(){t.hide(),this.submitRename()}.bind(this));this.$input=t.getCurrentPanel().body.find("#edit_category_name"),this.$input.val(this.model.get("name")),t.show()},submitRename:function(){var e=this.$el,t=this.model.get("name"),n=this.$input.val().trim();n&&n!==t&&this.model.save({name:n},{success:function(t){this.parent.respond(),r(t,this.parent),e.find("td.name > div").text(n)}.bind(this),error:function(i,r){e.find("td.name > div").text(t),this.parent.respond(this.model.message(409===r.status?"already-exists":"unknown",n))}.bind(this),wait:!0})},toggle:function(e){e.preventDefault(),this.startWaiting(),this.model.save({"default":!this.model.get("default")},{success:function(e){e.view.stopWaiting().trigger("setdefaultitem",e.get("default")?e:null)},wait:!0})},removeRow:function(){var e=this.$el;e.slideUp(function(){this.stopWaiting(),e.remove()}.bind(this))},destroy:function(e){e.preventDefault(),this.startWaiting(),this.model.destroy({success:function(e){e.view.removeRow()},wait:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(636)],r=function(e,t){var n={create:function(n){var i=e.Collection.extend(this.mixin);return i.prototype.model=t.extend({category:n}),new i},mixin:{comparator:function(e){return e.get("name").toLowerCase()},contains:function(e){return this.any(function(t){return t.get("name")===e})},url:function(){return window.location.pathname}}};return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2)],r=function(e,t){var n=e.Model.extend({initialize:function(){var e=/^(.)(.+?)s$/.exec(this.category);this.label=e[1].toUpperCase()+e[2]},messages:{"already-exists":function(e){var t=gettext('%(label)s "%(name)s" already exists!');return interpolate(t,{label:this.label,name:e},!0)},unknown:function(){return gettext("An unknown error occurred.")}},message:function(e){return this.messages[e].apply(this,t.toArray(arguments).slice(1))},validate:function(e){return this.isNew()&&this.collection.contains(e.name)?this.message("already-exists",e.name):void 0},url:function(){var e=this.collection.url();return this.id?/^(.*?)\/?$/.exec(e)[1]+"/"+this.id:e}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(638)],r=function(e,t,n){return e(function(){new n({el:t("#notifications")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(639),n(640),n(601),n(328)],r=function(e,t,n,i,r,o,a){var s=t.View.extend({events:{removeaddress:"remove",submit:"add"},initialize:function(){this.$table=this.$("table.widget"),this.$address=this.$('input[type="text"], input[type="email"]'),this.$error=this.$(".error"),this.token=this.$('input[name="csrfmiddlewaretoken"]').val(),this.collection=new i(n.map(this.$el.data("json"),function(e){return{id:e}})),this.$table.find("tr.form").after(this.collection.reduce(function(e,t){return t.view=new r({model:t}),e.add(t.view.el)},e()))},sync:function(t,n){e.ajax({url:window.location.pathname,type:"POST",data:{addresses:t,csrfmiddlewaretoken:this.token},success:n.bind(this)})},add:function(e){e.preventDefault();var n=this.$address.val().trim();if(!a.email(n))return void this.respond("Invalid email address.");if(this.collection.get(n)){var i=gettext("%(address)s is already listed!");return void this.respond(interpolate(i,{address:n},!0))}this.sync(this.collection+"\n"+n,function(){this.respond();var e=new t.Model({id:n});e.view=new r({model:e}),o(e,this).add(),this.$address.val("")})},remove:function(e,t){var n=this.collection;this.sync(n.toString.call(n.reject(function(e){return e===t.model})),t.success)},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}});return s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){var t=e.Collection.extend({comparator:function(e){return e.id.toLowerCase()},toString:function(){return this.map(function(e){return e.id}).join("\n")}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(149),n(634)],r=function(e,t){var n=t.extend({initialize:function(){this.$el.html(e.toHtml("issues-notifications-template",{email:this.model.get("id")}))},destroy:function(e){e.preventDefault(),this.startWaiting().trigger("removeaddress",{model:this.model,success:function(){var e=this.stopWaiting();e.slideUp(function(){e.remove()}),this.model.collection.remove(this.model)}.bind(this)})}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(187),n(314),n(170),n(361)],r=function(e,t,n,i,r,o){return e(function(){function e(e){e.preventDefault();var n=t(e.target).closest("tr"),i=n.data();l.delete_linkifier(i.id,{success:function(){n.remove(),u.find("tr").length||u.append(t("<tr><td>There are no links configured.</td><td></td><td></td></tr>"))},error:function(){t("#link-errors").text("There was an error communicating with the server, please try again.")}})}function a(e,n){new i(n,{success:function(){document.location.reload()},error:function(e,n){t(".field-group .error").remove(),t("#repo-link-errors").addClass("hidden");var i=o(n.responseText);t.each(i,function(e,n){var i=t('[name="'+e+'"]');if(0===i.length)t("#repo-link-errors").removeClass("hidden").find(".message").text(n);else{var r=t("<div>").addClass("error").text(n);i.after(r)}})}}).bind()}var s=t("#repository-links"),l=n.repository(r.owner.username,r.slug),u=s.find(".repo-links-list tbody");t(".link-action").each(a),t(".delete-link").on("click",e)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(342),n(485),n(643)],r=function(e,t,n,i,r){return e(function(){r.onReady();var e=t("#change-logo"),o=t("#id_project"),a=t(".repo-avatar-container img"),s=t("#admin-settings .repo-avatar-container"),l=e.data("submitUrl"),u=e.data("textTitle"),c=e.data("textDelete");i(o),new n({analyticsType:"Repo",avatars:a,dialogTitle:u,endpointUrl:l,showDelete:e.hasClass("has-avatar"),templateOptions:{deleteText:c},trigger:e,uploadIndicator:s})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(8),n(145),n(178),n(2),n(324),n(164),n(215),n(149),n(163),n(298),n(644)],r=function(e,t,n,i,r,o,a,s,l,u,c){return n(function(){function t(){var t=g.prop("checked");e("#id_forking_group").toggle(t),e("#id_no_public_forks").closest("fieldset").toggle(t)}var n=e(".repo-form"),i=n.find(".aui-button-primary"),s=n.data("plan-users"),l=n.data("users-required"),d=n.attr("data-owner-username"),h=n.attr("data-owner-display-name"),p=n.data("over-plan-limit"),f=n.data("can-upgrade");if(i.disable(!1),e("#id_language").auiSelect2({allowClear:!0}),e("select#id_owner").auiSelect2({formatResult:c,formatSelection:c}).on("change",function(t){e("#integrations-container").toggle(e(t.target).find(":selected").data("can-administer"))}),p&&f){var m={plan_users:s,users_required:l,can_upgrade:f,user:{username:d,display_name:h}};m.owner=a.username===m.user.username,o(i,{data:m})}var g=e("#id_is_private").change(t);t();var v=function(){var t=g.prop("checked"),i=e("#id_forking");if(i.length){var o=n.data("forking-values")[i.val()];r.each(["no_forks","no_public_forks"],function(n){e("#id_{}".format(n)).val(t?o[n]:"False")})}else t||e("#id_no_public_forks").prop("checked",!1)};n.on("aui-valid-submit",function(e){i.disable(!0)});var y=e("[data-aui-validation-field]"),b=!1;n.on("submit",function(t){y.length||i.disable(!0),!b&&e("#id_hipchat").is(":checked")?(t.preventDefault(),u.set("show-hipchat-dialog",!0).done(function(){b=!0,n.submit()})):v()}),n.find("#fp_sel").change(function(){"specific"===this.value?(e("#fp_specific").show(),e("#fp_specific_input").focus()):(e("#fp_specific").hide(),e("#fp_specific_input").val(this.value))})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(80)],r=function(e,t){t.register(["non-blank"],function(t){t.$el.val().trim()?t.validate():t.invalidate(e.I18n.keys["aui.validation.message.required"])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(198)],r=function(e,t,n){return t(function(){n(1e3,function(){e.pjax({container:"#pjax-main",url:window.location.href})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(485)],r=function(e,t,n){return e(function(){t("#transfer-repository #id_user").addClass("bb-user-team-typeahead"),n(t("input[name=project]"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(485)],r=function(e,t,n){return e(function(){n(t("input[name=project]"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(324),n(325)],r=function(e,t,n,i){return e(function(){var e=t("#transfer-accept-button"),r=e.attr("data-users-required"),o=e.attr("data-plan-users"),a=e.attr("data-target-username"),s=e.attr("data-target-display-name");n(e,{data:{user:{display_name:s,username:a},users_required:r,plan_users:o},calculatePositions:i.alignLeft()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(650),n(652)],r=function(e,t,n,i){return t(function(){var t=e("#username-mapping");new i({collection:new n(t.find("form").data("json")),el:t})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(651),n(627)],r=function(e,t,n){return e.Collection.extend({model:t,comparator:function(e){return[e.get("display_name").toLowerCase(),e.get("alias")]},url:n})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(317),n(627)],r=function(e,t,n,i){return t.Model.extend({idAttribute:"alias",initialize:function(e){this.set({avatar:e.avatar||n})},url:function(){return i()+"/"+this.get("username")+"/"+encodeURIComponent(this.get("alias"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(651),n(653),n(601)],r=function(e,t,n,i,r){return e.View.extend({events:{submit:"add"},initialize:function(){this.$username=this.$("#username"),this.$alias=this.$("#alias"),this.$error=this.$(".error"),this.$table=this.$("table.widget"),this.$loading=this.$table.find("tr.loading"),this.$loading.length&&(this.collection.each(function(e){e.view=new i({model:e}),e.collection=this.collection,this.$table.append(e.view.el)}.bind(this)),this.$loading.remove(),this.collection.on("add",function(e){e.view=new i({model:e}),e.collection=this.collection,r(e,this)},this),this.collection.on("remove",function(e){var n=t(e.view.el);n.slideUp(function(){n.remove()})}))},add:function(e){e.preventDefault();var i=this.$username.val().trim(),r=this.$alias.val().trim(),o=[];return i||o.push("Username is required."),r||o.push("Alias is required."),o.length?this.respond(o.join(" ")):(r=new n({username:i,alias:r}),void r.save({},{success:function(e){this.collection.add({username:i,display_name:e.get("display_name"),alias:e.get("committer"),avatar:e.get("avatar")}),this.$username.val("").focus(),this.$alias.val(""),this.respond()}.bind(this),error:function(e,n){this.respond(t.parseJSON(n.responseText).msg)}.bind(this),wait:!0}))},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(149)],r=function(e,t){return e.View.extend({tagName:"tr",events:{"click .bb-list-action-delete":"remove"},initialize:function(){this.$el.html(t.toHtml("username-mapping-template",this.model.toJSON()))},remove:function(e){e.preventDefault(),this.$(".bb-list-action-delete").addClass("loading"),this.model.destroy()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(387),n(170),n(372),n(149),n(441)],r=function(e,t,n,i,r,o,a,s,l){return n(function(){function e(e,n){return a(e,n),s.toHtml("repo-avatar-template",{name:e.text,size:16,avatar_url:t(e.element).attr("data-avatar-url")})+e.text}function n(e,t,n){n.removeAttr("id").hide().filter('[data-repo="{}"]'.format(t)).attr("id","id_{}".format(e)).prev(".select2-container").show()}function i(e,n){var i=l(t("#id_{}".format(n)).val());e.find(".branch[data-field={}] .branch-badge".format(n)).find(".repo-name").attr("title",i.repo).html(s.toHtml("repo-avatar-template",{name:i.repo,size:16,avatar_url:t("#id_{}_repo option:selected".format(n)).attr("data-avatar-url")})+i.repo).end().find(".branch-name").attr("title",i.branch).text(i.branch)}function u(e){var t=e.find("#id_source option:selected"),n=e.find("#id_dest option:selected"),i=l(t.val()),r=l(n.val()),a=t.data("multiple-heads")?i.hash:i.branch,s=n.data("multiple-heads")?r.hash:r.branch;return a=encodeURIComponent(a),s=encodeURIComponent(s),(i.repo!==r.repo||i.repo!==o.fullslug)&&(a="{}:{}".format(i.repo,a),s="{}:{}".format(r.repo,s)),"{}%0D{}".format(a,s)}var c,d=t(".branch-compare"),h=d.attr("data-compare-url"),p=d.find(".compare-form"),f=p.data("auto-reload");p.find(".repo-select").auiSelect2({formatResult:e,formatSelection:e,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide",escapeMarkup:function(e){return e}}),p.find(".branch-select").auiSelect2({formatResult:a,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}),p.find(".branch").each(function(){var e=t(this),r=e.attr("data-field"),o=e.find(".repo-select"),a=e.find(".branch-select"),s=e.find("select.repo-select").val();
n(r,s,a),o.on("change",function(){n(r,t(this).val(),a),i(p,r),f&&p.trigger("submit")}),a.on("change",function(){i(p,r),f&&p.trigger("submit")}),e.on("click",".toggle-link",function(i){t(i.target).remove(),e.find(".branch-badge").hide(),e.find(".select-lists").removeClass("hidden"),n(r,s,a)})}),p.find(".branch").on("click",".toggle-link",function(e){e.preventDefault()}),p.on("click",".swap-button",function(e){e.preventDefault();var i=p.find(".branch.source"),r=p.find(".branch.destination"),o=i.find(".branch-badge").html(),a=r.find(".branch-badge").html(),s=t("#id_source"),u=t("#id_source_repo"),c=u.val(),d=s.val(),h=(l(d),t("#id_dest")),m=t("#id_dest_repo"),g=m.val(),v=h.val();l(v);u.auiSelect2("val",g),n("source",g,i.find(".branch-select")),s.auiSelect2("val",v),i.find(".branch-badge").html(a),m.auiSelect2("val",c),n("dest",c,r.find(".branch-select")),h.auiSelect2("val",d),r.find(".branch-badge").html(o),f&&p.submit()}),p.on("submit",function(e){e.preventDefault(),c=u(p),d.addClass("has-mask").on("pjax:end",function(){d.removeClass("has-mask")}),t.pjax({url:h.replace("::spec",c),container:d,timeout:3e4})});var m=d.find(".content-container"),g=m.find(".merge-button"),v=m.find(".sync-link"),y=m.attr("data-source-repo"),b=m.attr("data-dest-repo"),w=m.attr("data-source-repo-avatar"),x=m.attr("data-dest-repo-avatar"),_=m.attr("data-source-branch"),k=m.attr("data-dest-branch"),C=m.data("source-is-mainbranch"),$=m.data("dest-is-mainbranch"),S=m.data("can-delete-dest"),T=m.attr("data-compare-source-value"),D=m.attr("data-compare-dest-value"),P=m.attr("data-merge-url"),E=m.attr("data-sync-url"),A=m.attr("data-sync-conflict-url");r(g,{getData:function(){var e;return e=y===b?_:C&&$?y:"{}/{}".format(y,_),{action:P,source:T,sourceBranch:_,sourceRepo:y,sourceAvatar:w,sourceAvatarAltText:y,dest:D,destBranch:k,destRepo:b,destAvatar:x,destAvatarAltText:b,sameRepo:y===b,canCloseBranch:y===b&&!C&&S,hasConflicts:!1,mergeCommands:t("#merge-commands-content").html(),commitMessageSlug:e}}}),r(v,{conflictUrl:A,getData:function(){var e;return e=y===b?k:C&&$?b:"{}/{}".format(b,k),{syncBranch:!0,action:E,source:D,sourceBranch:k,sourceRepo:b,sourceAvatar:x,sourceAvatarAltText:b,dest:T,destBranch:_,destRepo:y,destAvatar:w,destAvatarAltText:y,sameRepo:y===b,canCloseBranch:!1,hasConflicts:!1,mergeCommands:t("#merge-commands-content").html(),commitMessageSlug:e}}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(656),n(659),n(325),n(246)],r=function(e,t,n,i,r,o,a){return n(function(n){function s(e,t,n,i,r){var o=e.closest("li");return o.offset().left+o.outerWidth()-n+r.offsetX}var l=t("#participants").find("ol"),u=n.data("contributors");new r({el:l,collection:new i(u),avatarLimit:5,avatarSize:24,align:"center"}).render(),a(".pr-dialog-trigger",function(t){e.InlineDialog(t,"pr-dialog",function(e,t,i){return n.find(".pr-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:o.alignTo(s)})}),a(".issue-dialog-trigger",function(t){e.InlineDialog(t,"issue-dialog",function(e,t,i){return n.find(".issue-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:o.alignTo(s)})}),n.find(".restrictions span").tooltip()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(657),n(658)],r=function(e,t,n,i){return e.Collection.extend({model:n,initialize:function(e,t){t=t||{},this.url=t.url,this.likesUrl=t.likesUrl,this.noun=t.noun},comparator:function(e){var t=(new Date).getTime(),n=e.get("last_updated_on");return[e.get("approved")?1:0,n?i(n).getTime():t]},includes:function(e,n){return n=n||this,t.any(n,function(t){return t.get("username")===e})},approved:function(e){return this.some(function(t){return t.get("username")===e&&t.get("approved")})},lastNParticipants:function(e,n,i){function r(e){return e.get("username")===n}var o=this.filter(i);if(o.length<=e)return o;var a=t.tail(o,o.length-e),s=n&&this.includes(n,o);return s&&!t.find(a,r)&&(a.shift(),a.unshift(t.find(o,r))),a},remainingParticipants:function(e,n,i){function r(e){return e.get("username")===n}function o(e){return e.get("username")!==n}var a=this.filter(i);return a.length<=e?[]:(t.find(a,r)&&(a=t.filter(a,o),e-=1),t.initial(a,e))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(658),n(168)],r=function(e,t,n,i){return e.Model.extend({idAttribute:"username",isNew:function(){return!this.get("last_updated_on")},parse:function(e){return e.user?n.extend({last_updated_on:(new Date).toISOString(),approved:e.user.approved,reviewers:!0,avatar:e.user.links.avatar.href},e.user):e},toJSON:function(){var n=e.Model.prototype.toJSON.call(this);return n.date=this.get("last_updated_on")?t.localize(i(this.get("last_updated_on"))):void 0,n.hasComments=!!this.get("comments"),n},url:function(){return this.collection.likesUrl}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){var t={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},n=/(\d{4})-(\d{2})-(\d{2})[ |T](\d{2}):(\d{2}):(\d{2})(\+\d{2}:\d{2})?/,i=e.match(n);return new Date("{} {} {} {}:{}:{} UTC".format(i[3],t[i[2]],i[1],i[4],i[5],i[6]))}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(8),n(3),n(164),n(660),n(661)],r=function(e,t,n,i,r){return r.extend({initialize:function(e){r.prototype.initialize.call(this,e),this.avatarLimit=e.avatarLimit||5,this.align=e.align},events:{"show-all.participants":"showAll"},processParticipantsList:function(e){var t=n.username,i=e.length>this.avatarLimit;return i&&(e=this.collection.lastNParticipants(this.avatarLimit-1,t,this.condition)),e},renderAvatarsCompleted:function(n){var r,o=this.$el,a=n.length-(this.avatarLimit-1);a>1&&(o.append(t('<li><a class="truncated-count aui-badge" href="#">{}</a></li>'.format(a))),r="right"===this.align?i.rightAlignDialogOptions:"center"===this.align?i.centerAlignDialogOptions:i.leftAlignDialogOptions,e.InlineDialog(o.find(".truncated-count"),"remaining-participants",function(e,t,n){o.trigger("show-all.participants",{container:e,callback:n})},r))},showAll:function(e,t){var r=this.collection.remainingParticipants(this.avatarLimit-1,n.username,this.condition),o=t.container,a=t.callback;i.showParticipantsDialog(o,r,this.collection.noun,a)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(656),n(658),n(325),n(149)],r=function(e,t,n,i,r,o){return{showParticipantsDialog:function(n,i,r,o){n.html(""),n.addClass("show-participants-dialog");var a=e("<ol></ol>");n.append(a),t.each(i,function(e){a.append(this.participantHtml(e,r))},this),o&&o()},participantHtml:function(t,n,r){var a=t.attributes;return a.date=t.get("last_updated_on")?e.localize(i(t.get("last_updated_on"))):void 0,a.size=r||"small",a.noun=n,e(o.toHtml("participant-template",a))},collectionFrom:function(t,i){var r=e.Deferred(),o=new n([],{url:t.data("participants-url"),likesUrl:t.data("likes-url"),noun:t.data("noun")});return i=i||24,o.fetch({reset:!0,data:{avatar_size:i},success:function(e,t){r.resolve(e)}}),r},centerAlignDialogOptions:{width:"auto",calculatePositions:r.alignCenter()},rightAlignDialogOptions:{width:"auto",calculatePositions:r.alignRight()},leftAlignDialogOptions:{width:"auto",arrowOffsetX:-8}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(660),n(149)],r=function(e,t,n,i){return e.View.extend({initialize:function(e){this.condition=e.condition||function(){return!0},this.auiAvatarSize=e.auiAvatarSize,this.emptyTemplate=e.emptyTemplate,this.collection.bind("reset",this.render,this),this.collection.bind("participants:refresh",t.bind(this.refreshParticipants,this))},refreshParticipants:function(){this.collection.fetch({reset:!0})},render:function(){return this.renderAvatars(),this},processParticipantsList:function(e){return e},renderAvatarsCompleted:function(e){},renderAvatars:function(){this.$el.empty(),this.$el.removeClass("loading");var e=this.collection.filter(this.condition),n=this.processParticipantsList(e);n.length?(this.$el.removeClass("empty"),n.reverse(),t.each(n,this.addAvatar,this)):(this.$el.addClass("empty"),this.emptyTemplate&&this.$el.append(i.toHtml(this.emptyTemplate))),this.renderAvatarsCompleted(e)},addAvatar:function(e){var t=n.participantHtml(e,this.collection.noun,this.auiAvatarSize);this.$el.append(t)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(440),n(388),n(416),n(284),n(149),n(306)],r=function(e,t,n,i,r,o,a,s,l){return n(function(n){function u(){var e=window.location.hash;window.location.hash="",window.location.hash=e}function c(e){return e=e||window.location.hash,0===e.indexOf("#L")||0===e.indexOf("#chg-")}function d(){if(!y)return void m.removeClass("has-mask").html("<p>There are no changes.</p>");if(p)return m.removeClass("has-mask"),void m.append(s.toHtml("diff-too-large-template",{sourceHash:m.attr("data-source-hash"),destHash:m.attr("data-dest-hash")}));var e=t.ajax({url:l.asUrl(m.attr("data-diff-url")),type:"GET",dataType:"html"});e.done(function(e){m.removeClass("has-mask").html(e);var n=new i({el:t("#diff-ignore-whitespace")}).render();m.find(".bb-patch-unified .bb-udiff").each(function(){var e=t(this),n=e.data("filename"),i=e.data("compare-files-url");new o(n,i).decorate(e.find(".diff-actions")),new r(e.data("expand-context-url")+encodeURI(n),e.data("identifier"),!1).decorate(e)}),n.on("toggle",function(e){m.addClass("has-mask"),l.update("w",e?"1":"0"),window.history.replaceState({},"",l.asUrl(window.location.href)),d()}),c(window.location.hash)&&u()}),e.fail(function(e){m.removeClass("has-mask").html("<h2>Error</h2><p>We were unable to load this page.</p>")})}function h(){var e=t.ajax({url:v.attr("data-pull-requests-url"),type:"GET",dataType:"html"});e.done(function(e){v.removeClass("has-mask").html(e),a()}),e.fail(function(e){v.removeClass("has-mask").html("<h2>Error</h2><p>We were unable to load this page.</p>")})}var p=t("#commit-list-container").data("changesets-limited"),f=t("#compare-diff-tab"),m=t("#compare-diff-content"),g=t("#compare-pull-requests-tab"),v=t("#compare-pull-requests-content"),y=n.data("has-changes");"#diff"===window.location.hash||c(window.location.hash)?(e.tabs.change(f.find("a")),d()):f.one("click","a",d),"#pull-requests"===window.location.hash?(e.tabs.change(g.find("a")),h()):g.one("click","a",h),n.on("click",".menu-item",function(e){window.location.hash=t(e.target).attr("href").substr("#compare-".length)}),e.tabs.setup()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(665),n(3),n(145),n(2),n(321),n(387),n(667),n(668),n(664),n(669),n(170),n(164),n(246),n(369),n(149),n(158)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p,f){return n(function(){var n=t(".content-container"),f=n.attr("data-merge-url"),m=n.attr("data-sync-url"),g=n.attr("data-compare-source-value"),v=n.attr("data-compare-dest-value"),y="{}/{}".format(c.owner.username,c.slug),b=n.attr("data-source-branch"),w=n.attr("data-source-hash"),x=n.data("has-multiple-heads"),_=n.attr("data-dest-branch"),k=n.data("has-source-access"),C=n.data("has-dest-access"),$=n.data("can-delete"),S=n.data("has-conflicts");h(".blank-slate-checkout-button",function(e){a(e,{cloneUrl:d.isSshEnabled?e.attr("data-ssh-url"):e.attr("data-https-url"),branchName:b,scm:c.scm})}),h(".checkout-button",function(e){s(e,function(){return b})}),C&&o(n.find(".merge-button"),{id:"merge-"+e(_,{isIdentifier:!0}),conflictUrl:n.attr("data-merge-conflict-url"),getData:function(){return{action:f,mergeEvent:"detail:merge",source:g,sourceBranch:b,sourceRepo:y,dest:v,destBranch:_,destRepo:y,sameRepo:!0,canCloseBranch:$,hasConflicts:S,mergeCommands:S&&t("#merge-commands-content").html(),commitMessageSlug:x?"{} ({})".format(b,w):b}}}),k&&h(".sync-link",function(e){u(e,{action:m,mergeEvent:"detail:sync",repository:y,dest:g,destBranch:b,source:v,sourceBranch:_,conflictUrl:n.attr("data-sync-conflict-url"),syncBranch:!0}).done(function(e,t){p.addMessage("{} successfully synced with {}.".format(b,_)),window.location.reload(!0)})}),$&&l(t(".delete-link"),{branch:b,apiUrl:n.attr("data-delete-url")}).done(function(e){var t;t="hg"===c.scm?"{} successfully closed.".format(e):"{} successfully deleted.".format(e),p.addMessage(t),window.location=n.attr("data-branch-list-url")}).fail(function(e){var t;t="hg"===c.scm?"Failed to close {}.".format(e):"Failed to delete {}.".format(e),r(t)}),t(".compare-choices .branch.destination").on("click",".toggle-link",function(e){e.preventDefault();var r=t(e.delegateTarget),o=n.attr("data-branches-api-url"),a=n.attr("data-branch-detail-url"),s=t("<select/>");r.addClass("loading"),t.getJSON(o).done(function(e){s.append(i.map(e,function(e){return e===_?t('<option selected="selected"/>').text(e)[0]:t("<option/>").text(e)[0]})),r.removeClass("loading").empty().append(s),s.auiSelect2()}),s.on("change",function(e){var n=t("#branch-detail");n.addClass("has-mask").on("pjax:end",function(){n.removeClass("has-mask")}),t.pjax({url:"{}?dest={}".format(a,encodeURIComponent(t(this).val())),container:n,timeout:3e4})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(170),n(293)],r=function(e,t,n){return function(i,r){var o,a=new e.Deferred;return i.on("click",function(i){if(i.preventDefault(),!e(i.target).hasClass("disabled")){var s;"hg"==t.scm?(o=gettext("Close branch"),s=gettext("Are you sure you want to close %(branch_name)s?")):(o=gettext("Delete branch"),s=gettext("Are you sure you want to delete %(branch_name)s?")),n({title:o,content:interpolate(s,{branch_name:r.branch},!0)}).done(function(){e.ajax(r.apiUrl,{dataType:"json",type:"DELETE"}).done(function(){a.resolve(r.branch)}).fail(function(){a.reject(r.branch)})})}}),a}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;(function(e,r){!function(o){var a="object"==typeof t&&t,s=("object"==typeof e&&e&&e.exports==a&&e,"object"==typeof r&&r);(s.global===s||s.window===s)&&(o=s);var l={},u=l.hasOwnProperty,c=function(e,t){if(!e)return t;var n,i={};for(n in t)i[n]=u.call(e,n)?e[n]:t[n];return i},d=/[\x20-\x2C\x2E\x2F\x3B-\x40\x5B-\x5E\x60\x7B-\x7E]/,h=/[\x20\x21\x23-\x26\x28-\x2C\x2E\x2F\x3B-\x40\x5B\x5D\x5E\x60\x7B-\x7E]/,p=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,f=function(e,t){t=c(t,f.options),"single"!=t.quotes&&"double"!=t.quotes&&(t.quotes="single");for(var n,i,r,o,a="double"==t.quotes?'"':"'",s=t.isIdentifier,l=e.charAt(0),u="",m=0,g=e.length;g>m;)i=e.charAt(m++),r=i.charCodeAt(),32>r||r>126?(r>=55296&&56319>=r&&g>m&&(o=e.charCodeAt(m++),56320==(64512&o)?r=((1023&r)<<10)+(1023&o)+65536:m--),n="\\"+r.toString(16).toUpperCase()+" "):n=t.escapeEverything?d.test(i)?"\\"+i:"\\"+r.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B:]/.test(i)?s||":"!=i?"\\"+r.toString(16).toUpperCase()+" ":i:"\\"==i||!s&&('"'==i&&a==i||"'"==i&&a==i)||s&&h.test(i)?"\\"+i:i,u+=n;return s&&(/^_/.test(u)?u="\\_"+u.slice(1):/^-[-\d]/.test(u)?u="\\-"+u.slice(1):/\d/.test(l)&&(u="\\3"+l+" "+u.slice(1))),u=u.replace(p,function(e,t,n){return t&&t.length%2?e:(t||"")+n}),!s&&t.wrap?a+u+a:u};f.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},f.version="0.1.0",i=function(){return f}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}(this)}).call(t,n(666)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){var i,r;i=[n(2),n(147)],r=function(e,t){return function(n,i){n.click(function(n){var r,o=e.isFunction(i.cloneUrl)?i.cloneUrl(n):i.cloneUrl,a=e.isFunction(i.branchName)?i.branchName(n):i.branchName;r=i&&"hg"===i.scm?a:"refs/heads/{}".format(a),t(["atl._trackEvent","Repo","Checkout Branch",i&&i.scm]),window.location.href="sourcetree://checkoutRef?ref={}&cloneUrl={}&type=bitbucket".format(r,o)})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(667),n(164),n(170),n(149)],r=function(e,t,n,i,r,o){return function(a,s){function l(e){var n=t(e.target).closest(".sourcetree-callout");return i.isSshEnabled?n.attr("data-ssh-url"):n.attr("data-https-url")}function u(i,a,u){var d,h=e.InlineDialog.current,p=o.toHtml("branch-checkout-template",{branchName:s()});i.html(p),n(i.find("button"),{cloneUrl:l,branchName:s,scm:r.scm}),d=i.find("input"),d.focus(function(){var e=t(this);e.one("mouseup",function(e){e.preventDefault()}),e.select()}),u(),setTimeout(function(){return h&&h.id===c?void e.InlineDialog.current.hide():void d.select()},0)}var c="checkout-branch-dialog";t("#inline-dialog-checkout-branch-dialog").remove(),e.InlineDialog(a,c,u,{width:360})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(665),n(3),n(387)],r=function(e,t,n){return function(i,r){var o=new t.Deferred;return n(i,{id:"merge-"+e(r.destBranch,{isIdentifier:!0}),conflictUrl:r.conflictUrl,getData:function(){return{action:r.action,mergeEvent:r.mergeEvent||!1,source:r.source||"{}::{}".format(r.repository,r.sourceBranch),sourceBranch:r.sourceBranch,sourceRepo:r.repository,dest:r.dest||"{}::{}".format(r.repository,r.destBranch),destBranch:r.destBranch,destRepo:r.repository,sameRepo:!0,canCloseBranch:!1,hasConflicts:!1,mergeCommands:"",commitMessageSlug:r.sourceBranch,syncBranch:!!r.syncBranch}},success:function(){o.resolve(r.destBranch,r.sourceBranch)}}),o}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(305),n(307),n(304),n(158)],r=function(e,t,n,i,r){return e(function(){var e=t("#list-branches"),o=t("#branch-pjax");n({$container:e,$pjaxContainer:o,ignoreQuery:"page"}),i({$pjaxContainer:o,$controls:t("#branch-search"),ignoreQuery:"page"}),r(e,{$pjaxContainer:o,setMask:!1})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(2),n(664),n(669),n(170),n(321),n(369),n(149)],r=function(e,t,n,i,r,o,a,s,l){return e(function(){function e(){var e,i=t(".ahead .value, .behind .value");i.length&&(e=t(n.max(i,function(e){return t(e).data("value")})).data("value"),i.each(function(){var n=t(this),i=100*Math.sqrt(n.data("value")/e);n.siblings(".graph").animate({width:i+"%"})}))}function u(){t.ajax({url:m}).done(function(i){"calculating"===i.status?n.delay(function(){u()},1e3):"ready"===i.status&&(c.find("tbody > tr").each(function(){var e=t(this),r=e.attr("data-branch-name"),o="{}:{}".format(r,e.attr("data-branch-hash")),a=i.data[o],s=n.extend(a,{mainbranch:f,name:r,aheadOrBehind:a.ahead>0||a.behind>0}),u=l.toHtml("behind-cell-template",s),c=l.toHtml("ahead-cell-template",s);e.find(".behind").replaceWith(u),e.find(".ahead").replaceWith(c)}),e(),d.removeClass("hidden"))})}var c=t("#list-branches"),d=t("#branch-filters");c.find("a.close-branch").each(function(e,n){var r=t(n);i(r,{branch:r.attr("data-branch"),apiUrl:r.attr("data-api-url")}).done(function(e){var t;t="hg"==o.scm?"{} successfully closed.".format(e):"{} successfully deleted.".format(e),s.addMessage(t);var n=c.find(".paginator .prev-page");0===n.length||c.find("li.branch").length>1?window.location.reload(!0):window.location.href=n.attr("href")}).fail(function(e){var t;t="hg"==o.scm?"Failed to close {}.".format(e):"Failed to delete {}.".format(e),a(t)})});var h=c.attr("data-compare-url"),p=c.attr("data-compare-slug"),f=c.attr("data-main-branch"),m=c.attr("data-meta-url"),g=c.data("has-cache");c.find("a.sync-branch").each(function(e,n){var i=t(n);r(i,{action:h,mergeEvent:"list:sync",repository:p,dest:i.attr("data-compare-value"),destBranch:i.attr("data-branch"),sourceBranch:f,conflictUrl:i.attr("data-conflict-url"),syncBranch:!0}).done(function(e,t){s.addMessage("{} successfully synced with {}.".format(e,t)),window.location.reload(!0)})}),c.find("a.merge-branch").each(function(e,n){var i=t(n);r(i,{action:h,mergeEvent:"list:merge",repository:p,destBranch:f,source:i.attr("data-compare-value"),sourceBranch:i.attr("data-branch"),conflictUrl:i.attr("data-conflict-url")}).done(function(e,t){s.addMessage("{} successfully merged into {}.".format(e,t)),window.location.reload(!0)})}),g?e():u(),d.find("a").tooltip()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(209),n(673),n(668),n(158)],r=function(e,t,n,i,r){return t(function(t){function o(){var t=e("#branch-info"),n=t.attr("data-branch"),i=t.attr("data-kind");s.toggleClass("aui-iconfont-devtools-branch","tag"!==i),s.toggleClass("aui-iconfont-devtools-tag","tag"===i),l.text(n||gettext("All branches")),u.toggleClass("hidden",!n),d.toggleClass("hidden",!n),c.attr("title",t.attr("data-at")),n?(u.insertAfter(c),r(u,function(){return n})):u.detach()}var a=e(".branch-selector-pjax"),s=t.find(".branch-kind"),l=t.find(".name"),u=e("#checkout-branch-button"),c=t.find(".branch-dialog-trigger"),d=e(".show-all-branches");i.container=a,a.on("pjax:start",function(){a.addClass("has-mask")}).on("pjax:end",function(){a.removeClass("has-mask"),n.commands.execute("branchDialog:hide"),o()}),t.pjax(".show-all-branches",i),e.support.pjax&&n.vent.on("branchDialog:click",function(t){e.pjax.click(t,i)}),o()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return{timeout:5e4}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(145),n(675)],r=function(e,t,n){return t(function(t){var i,r,o=e("#commit-graph"),a=o.parent().height()+80,s="commit-graph-svg",l={id:s,topPadding:16,offset:5},u=JSON.parse(o.attr("data-graph"));u&&u.length&&(o.height(a),i=new n(l).render(u,t.hasClass("expandable")),r=i.getWidth(),e("#"+s).attr("height",a).attr("width",r),t.width(r+10))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(676)],r=function(e,t){return function(n){var i=[[153,153,0],[0,153,0],[0,153,153],[0,0,153],[153,0,153],[153,153,0],[0,0,0]],r=[[191,191,64],[64,191,64],[64,191,191],[64,64,191],[191,64,191],[191,191,64],[64,64,64]];this.offset=n.offset||0,this.svg=t(n.id||"commit-graph-svg",document.getElementById("commit-graph")),this.columns=0,this.bg=[0,4],this.cell=[2,0],this.topPadding=n.topPadding||2,this.rowHeight=n.rowHeight||19,this.columnWidth=n.columnWidth||8,this.isLegacy=!!n.useLegacyRendering,this.getColor=function(e,t){var n=t?i:r,o=n[e%n.length];return"rgb("+o.join(", ")+")"},this.getWidth=function(){return this.columnWidth*this.columns},this.drawCircle=function(e){return this.svg.circle(e.radius,e.x,e.y,this.getColor(e.color,!1))},this.drawPath=function(e){this.svg.connect(e.from,e.to,e.color)},this.getRowElement=function(t){return e("#chg_"+t+" :first-child")},this.drawEdge=function(e,t,n,i){var r,o=this.getRowElement(e),a=o.position().top+this.topPadding,s=this.offset+this.columnWidth*t,l=a+o.outerHeight()+1,u=this.offset+this.columnWidth*n;return this.isLegacy&&(s=400-s,u=400-u),0===e?(a-=20,r={coords:{x1:u,y1:l,x2:s,y2:a}}):e===this.commitCount-1&&(l+=20,r={coords:{x1:s,y1:a,x2:u,y2:l}}),r&&(r.stops=[{offset:0,"stop-color":this.getColor(i,!0),"stop-opacity":1},{offset:"80%","stop-color":this.getColor(i,!0),"stop-opacity":0}]),this.drawPath({from:[s,a+1],to:[u,l],color:r||this.getColor(i,!0)}),this},this.drawNode=function(e,t,n,i){var r=3,o=this.getRowElement(t),a=o.position().top+this.topPadding,s=this.offset+this.columnWidth*n;return this.isLegacy&&(s=400-s),this.drawCircle({radius:r,x:s,y:a,color:i}).setAttribute("title",e),this},this.render=function(t){var n=e("#commit-graph-svg"),i=t.length;n.empty(),this.commitCount=i;for(var r=0;i>r;++r){var o=t[r];if(o){var a=o[0],s=o[1],l=s[0],u=s[1],c=o[2],d=this.getRowElement(r);this.cell[1]+=d.outerHeight(),this.bg[1]+=this.rowHeight,this.columns=this.columns<c.length?c.length:this.columns;for(var h=0,p=c.length;p>h;++h){var f=c[h],m=f[0],g=f[1],v=this.colorIdx||f[2];this.drawEdge(r,m,g,v)}0!==r&&this.drawNode(a,r,l,u)}}return n.attr("width",this.getWidth()),this}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e,t){function n(e,t,n){var i=document.createElementNS(c,"linearGradient"),r=u.querySelector("defs")||u.insertBefore(document.createElementNS(c,"defs"),u.firstChild);t=t||{},i.setAttribute("id",e),i.setAttribute("spreadMethod","pad"),i.setAttribute("gradientUnits","userSpaceOnUse");for(var o in t)t.hasOwnProperty(o)&&i.setAttribute(o,t[o]);for(var a=0;a<n.length;a++){var s=n[a],l=document.createElementNS(c,"stop");for(var d in s)s.hasOwnProperty(d)&&l.setAttribute(d,s[d]);i.appendChild(l)}return r.appendChild(i)}function i(e,t,n,i){var r=document.createElementNS(c,"circle");return r.setAttribute("cx",t||75),r.setAttribute("cy",n||75),r.setAttribute("r",e),r.setAttribute("fill",i||d.fill),u.appendChild(r),r}function r(e,t){var i,r=document.createElementNS(c,"path");return r.setAttributeNS(null,"d",e),t.stops&&(i="gradient-"+h++,n(i,t.coords,t.stops),t="url(#"+i+")"),r.setAttribute("fill","none"),r.setAttribute("stroke-width","1"),r.setAttribute("stroke",t||d.stroke),u.appendChild(r),r}function o(e,t){return"M"+e+","+t}function a(e,t){return"L"+e+","+t}function s(e,t,n,i){var r=e,o=(i-t)/2+t,a=n,s=i-(i-t)/2;return"C"+r+","+o+" "+a+","+s+" "+n+","+i}function l(e,t,n){var i=e[0],l=e[1],u=t[0],c=t[1],d=[];return d.push(o(i,l)),i===u||l===c?d.push(a(u,c)):d.push(s(i,l,u,c)),r.call(this,d.join(" "),n)}var u=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=u.namespaceURI,d={fill:"#707070",stroke:"#999999"},h=0;return u.setAttribute("id",e),t&&t.appendChild(u),{circle:i,connect:l,get:function(){return this.svg},gradient:n,path:r}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(306),n(440),n(678),n(660),n(659),n(679)],r=function(e,t,n,i,r,o,a,s){return n(function(){var n=t("#commit-header"),l=t("#watch-commit-icon"),u=n.find(".participants"),c=new r({el:t("#diff-ignore-whitespace")}).render();a.collectionFrom(u).done(function(e){new s({el:n.find("#participants").find("ol"),collection:e,avatarLimit:6,align:"right"}).render(),new o({el:n.find(".approve-button"),collection:e}).render(),e.bind("approved",function(e){e&&n.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:!0})}),t(document).on("comment-added",function(t){e.trigger("participants:refresh"),n.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:!0})})}),n.on("follow:commit","a.follow",function(e,t){l.toggleClass("aui-iconfont-watch",t).toggleClass("aui-iconfont-unwatch",!t)});var d=["parents","branches","tags"];t.each(d,function(n,i){e.InlineDialog(t(".truncated-"+i+"-count"),"extra-"+this,function(e,n,r){e.append(t(".extra-"+i)),r&&r()})}),c.on("toggle",function(e){i.update("w",e?"1":"0"),window.location.href=i.asUrl(window.location.href)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(2),n(164),n(147)],r=function(e,t,n,i,r){var o=i.username;return t.View.extend({initialize:function(){this.$button=this.$el,this.collection.bind("reset",this.render,this),this.collection.bind("participants:refresh",n.bind(this.render,this))},events:{click:"toggle"},toggle:function(t){t.preventDefault();var n=this.$button,i=this.collection,r=i.approved(o);if(!n.hasClass("disabled")){n.addClass("disabled"),n.prop("disabled",!0),n.attr("aria-disabled",!0);var a=setTimeout(function(){n.addClass("loading")},300),s={success:function(){i.fetch({reset:!0,complete:function(){clearTimeout(a),n.removeClass("disabled loading"),n.prop("disabled",!1),n.attr("aria-disabled",!1)}}),i.trigger("approved",!r)},error:function(t,n){e.messages.error({body:n.responseText})},wait:!0};r?(this.analytics(!1),i.find(function(e){return e.get("username")===o}).destroy(s)):(this.analytics(!0),i.create({username:o},s))}},render:function(){var e=this.collection.approved(o);this.$button.find("span").text(e?gettext("Unapprove"):gettext("Approve"))},analytics:function(e){r(["atl._trackEvent","Approvals",this.collection.noun,e?"Approved":"Unapproved"])}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(423),n(170),n(682),n(416),n(388),n(680),n(681),n(683),n(389),n(165)],r=function(e,t,n,i,r,o,a,s,l,u,c){var d=function(){var d=e("#changeset-diff");if(1===d.length&&!e("#pullrequest").length){var h=e("#comment-info"),p=h.data("comment-url"),f=h.data("general-thread-ids"),m=h.data("file-line-thread-ids"),g=d.find(".bb-patch-unified");if(g.find(".bb-udiff, .comment-content .bb-udiff").each(function(){var a,s=e(this),l=s.data("filename"),u=s.data("compare-files-url"),d=s.parent().is(".comment-content");if(m){var h=m[l]||[];a=new i(p,l,h).decorate(s)}var f=c.concat("repositories",n.owner.username,n.slug,"changesets",t,"comments").toString();new r(l,u).decorate(s.find(".diff-actions")),new o(s.data("expand-context-url")+encodeURI(l),s.data("identifier"),!d,a,f).decorate(s)}),f){new l(p,!0).decorate(e("#comments-list.line-commenting > li.new-comment")),u.decorateThreads(p,f);var v=e("#general-comments .comment-count"),y=e("#comments-list");new s(v,y).decorate()}e("#commit-files-summary").on("click",".comments-link",function(t){var n=e(t.target).data("file-path"),i=e(document.getElementById("chg-"+n)),r=i.find("li.comment").first().data("modelobj");r&&(r.scrollTo(),t.preventDefault())}),e("#commit-files-summary .count-badge").each(function(t,n){var i=e(n),r=i.find(".count"),o=e(document.getElementById("chg-"+i.find(".comments-link").data("file-path")));new s(r,o).decorate()}),a.setupDeferredDiffMarkers(g,f,p)}};e(d),e(document).on("pjax:end",d)}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(681),n(682),n(388),n(416),n(149)],r=function(e,t,n,i,r,o,a){var s={};return s.setupDeferredDiffMarkers=function(s,l,u){e("#commit-files-summary li.truncated").each(function(n,i){t.defer(function(t){var n=e(t),i=n.data("file-identifier"),r=n.find("a.execute").text(),o=n.hasClass("file-conflicts"),l=n.find(".count-badge .count").text(),u={diffidentifier:i,filename:r,conflicts:o};"0"!==l&&(u.eclipsedcount=l);var c=e(a.toHtml("diff-too-big-template",u));s.append(c),n.on("click",function(){c.find(".load-diff").click()})},i)}),s.on("click",".load-diff",function(a){a.preventDefault();var s=e(a.target),c=s.closest(".bb-udiff"),d=c.data("identifier"),h=e('#commit-files-summary li[data-file-identifier="{}"]'.format(d)),p=e('<div class="mask">'),f=e("#compare"),m=f.attr("data-anchor"),g=f.attr("data-dest-rev");c.find(".too-big-message .title").append(p),p.show(),e.ajax({type:"GET",url:window.location,data:{file:d},dataType:"html",success:function(a){var s,p=e(a),f=p.find('section[data-identifier="{}"]'.format(d)),v=p.find('#commit-files-summary li[data-file-identifier="{}"]'.format(d)),y=f.data("filename"),b=f.data("compare-files-url"),w=t.keys(f.data("linecommentroots")||{});return f.length?(c.replaceWith(f),h.replaceWith(v),l&&(new n(v.find(".count-badge .count"),f).decorate(),s=new i(u,y,w,m,g).decorate(f)),new o(y,b).decorate(f.find(".diff-actions")),new r(f.data("expand-context-url")+encodeURI(y),f.data("identifier"),!0,s,u?u.toString():"").decorate(f),void f.trigger("deferred-large-diff/load",a)):(c.find(".too-big-message .try-again").hide(),c.find(".too-big-message .try-again-failed").show(),void c.find(".mask").remove())}})})},s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=function(e,t){this.$countElem=e,this.$commentContainer=t};return t.prototype.decorate=function(){this.$commentContainer.on("comment-count/create",e.proxy(this.updateCount,this)),this.$commentContainer.on("comment-count/delete",e.proxy(this.updateCount,this))},t.prototype.updateCount=function(){var e=this.$commentContainer.find("li.comment:not(.deleted)").length,t=this.$commentContainer.find(".eclipsedcount span").text();t&&(e+=parseInt(t,10)),this.$countElem.html(e),0===e?this.$countElem.closest(".count-badge").addClass("zero"):this.$countElem.closest(".count-badge").removeClass("zero")},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(390),n(392),n(389)],r=function(e,t,n,i,r,o){var a=e.sidebar(".aui-sidebar"),s=function(e,t,n,i,a){
this.endPoint=e,this.filename=t,this.anchor=i,this.destrev=a,this.commentForm=new r,this.$elem=null,this.threads=o.decorateThreads(e.toString(),n,t)};return s.prototype.decorate=function(e){return this.$elem=e,this.enterDocument(),this},s.prototype.calculateListWidth=function(){var e=this.$elem.find(".comment-thread-container:first");if(!e.length)return!1;var t=parseInt(e.css("padding-left").replace("px",""),10),n=parseInt(e.css("padding-right").replace("px",""),10),i=e.find(".comments-list"),r=parseInt(i.css("border-left-width").replace("px",""),10),o=parseInt(i.css("border-right-width").replace("px",""),10);return this.listWidth=this.$elem.width()-t-n-r-o,this.listWidth},s.prototype.setListWidth=function(){this.$elem.find(".comments-list").css("max-width",this.calculateListWidth())},s.prototype.enterDocument=function(){this.$elem.on("click",".add-diff-comment",t.proxy(this.showForm,this)),t(this.commentForm).bind("comment-form/cancel",t.proxy(this.hideForm,this));var e=this;n.each(this.threads,function(n){t(n).bind("line-comment/thread-deleted",t.proxy(e.cleanUpThreads,e))}),this.$elem.find(".comments-list").css("max-width",this.calculateListWidth()),t(window).on("resize",this.setListWidth.bind(this)),a.on("expand-end collapse-end",this.setListWidth.bind(this))},s.prototype.showForm=function(e){e.preventDefault(),this.hideForm();var r=t(e.target).closest(".add-diff-comment"),o={content:"",filename:this.filename,anchor:this.anchor,dest_rev:this.destrev},a=r.siblings(".line-numbers").data("fnum"),s=r.siblings(".line-numbers").data("tnum");a&&s||a?o.line_from=a:o.line_to=s;var l=new i(o,{urlRoot:this.endPoint.toString()});this.commentForm.comment=l,l.on("sync",n.once(this.insertNewComment),this);var u;if(r.hasClass("add-file-comment")){var c=r.closest(".diff-container").find(".diff-content-container");u=c.children(".comment-thread-container")}else{var d=r.closest(".udiff-line");u=d.next(".comment-thread-container")}u.length||(u=t('<div class="comment-thread-container"><ol class="comments-list"></ol></div>'),c?u.prependTo(c):d&&u.insertAfter(d),u.find(".comments-list").css("max-width",this.listWidth?this.listWidth:this.calculateListWidth())),u.removeClass("existing-comment");var h=u.find(".comments-list");this.commentForm.$elem?this.commentForm.$elem.prependTo(h):this.commentForm.render(h),this.commentForm.showAndFocus()},s.prototype.insertNewComment=function(e){var n=this.commentForm.$elem.parent(".comments-list"),i=new o(e).render(n);t(i).bind("line-comment/thread-deleted",t.proxy(this.cleanUpThreads,this)),this.threads.push(i),this.hideForm(),i.scrollTo(),this.commentForm.clearContents(),t(document).trigger("comment-added")},s.prototype.acceptLineComments=function(e){var i=this;n.each(e,function(e){t(e).bind("line-comment/thread-deleted",t.proxy(i.cleanUpThreads,i)),i.threads.push(e)})},s.prototype.cleanUpThreads=function(){n.each(this.$elem.find(".comment-thread-container:not(:has(li.comment, li.new-comment))"),function(e){t(e).remove()})},s.prototype.hideForm=function(){if(this.commentForm.$elem){var e=this.commentForm.$elem.parent(".comments-list");if(this.commentForm.$elem.detach(),!e.children().length){var t=e.parent(".comment-thread-container");t.remove()}}},s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(390),n(392),n(389)],r=function(e,t,n,i,r){var o=function(e,t){this.endPoint=e,this.comment=this.newModel(),this.commentForm=new i(this.comment),this.insertWhere=t?"before":"after",this.$elem=null};return o.prototype.newModel=function(){var e=new n({content:""},{urlRoot:this.endPoint.toString()});return e.on("sync",t.once(this.insertNewComment),this),e},o.prototype.decorate=function(e){return this.$elem=e,this.commentForm.decorate(e),this.enterDocument(),this},o.prototype.enterDocument=function(){},o.prototype.insertNewComment=function(t){new r(t).render(this.$elem,this.insertWhere),e(document).trigger("comment-added"),this.comment=this.newModel(),this.commentForm.comment=this.comment,this.commentForm.shrinkSize(),this.commentForm.clearContents()},o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(307),n(673)],r=function(e,t,n,i){return t(function(t){function r(){var n=e("#branch-info").attr("data-branch"),i=e("#corrected-search").attr("data-value");n?(t.addClass("hidden"),l.val("")):(t.removeClass("hidden"),i&&"tip"!==i&&!l.is(":focus")&&l.val(i))}var o=t.find(".help"),a=e("#commit-filter-help"),s=e("#commits").find(".pjax"),l=t.find("input");n({$pjaxContainer:s,$controls:t,pjaxOptions:i,ignoreQuery:"page"}),o.on("click",function(t){a.toggleClass("hidden"),e(t.target).toggleClass("bb-inline-dialog-anchor")}),t.on("submit",function(){a.addClass("hidden"),o.find("span").removeClass("bb-inline-dialog-anchor"),e(".more-action-menu.active").trigger("aui-button-invoke")}),s.on("pjax:end",r)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(673),n(304),n(167),n(686)],r=function(e,t,n,i,r,o){return t(function(t){var a=e("#commits").find(".pjax");o(t.find("a.unmapped-user")),i(t,{$pjaxContainer:a}),n.container=a,t.pjax(".commit-labels a",n),t.pjax(".branch-name",n),a.on("pjax:end",function(){r()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(149)],r=function(e,t,n){return function(i){function r(e,i,r){o.refresh();var a=t(i);e.html(n.toHtml("unmapped-author-dialog",{link:a.attr("href"),raw_author:a.data("raw-author")})),r&&r()}var o=e.InlineDialog(i,"unmapped-user",r)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(686)],r=function(e,t,n){return t(function(e){n(e.find("a.unmapped-user"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(206)],r=function(e,t,n){return t(function(){var t=e("#repo-create"),i=n("Repo Create");t.find("a.import-repo").on("click",function(){i("Import Repository Link - Clicked")}),t.find("a.doc-101").on("click",function(){i("New to Bitbucket? Link - Clicked")}),t.find("a.team-pitch").on("click",function(){i("Working in a team? Link - Clicked")}),t.find('button[type="submit"]').on("click",function(){i("Create Repository Button - Clicked")}),t.find("a.cancel").on("click",function(){i("Cancel Link - Clicked")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(183),n(212)],r=function(t,i,r,o){return o(function(){function t(e){var t=new r({width:600,height:"auto",id:"create-branch-dialog",closeOnOutsideClick:!0});return t.addHeader(gettext("Create branch")),t.addPanel("panel-create"),t.addButton(gettext("Create"),function(){var e=i(s.popup.element);e.find(".dialog-button-panel button").loading(),e.find("#create-branch-form").submit()},"aui-button"),t.addCancel(gettext("Cancel"),function(e){e.hide()}),a=i.ajax({type:"get",url:e.attr("href"),dataType:"html"}),t}function o(r){var o=i(r.target).closest(".create-branch-button");r.preventDefault(),s=s||t(o),o.loading(a).done(function(t){var r=i(t);r.find(".buttons").remove(),s.getCurrentPanel().body.html(r),n.e(1,function(t){(function(e){var n=[t(370)];(function(e){e.onReady()}).apply(null,n)}).call(this,t(666)(e))})}).fail(function(){i(s.getCurrentPanel().body).append('<p class="error">An unexpected error occurred.</p>')}).always(function(){s.show()})}var a,s;i(document).on("click",".create-branch-button",o)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(t){var n=t.attr("action"),i=e("#upload-file-form"),r=e("#captcha-wrong");t.submit(function(){return e.getJSON(n,e(this).serialize(),function(e){"success"===e.status?(i.find('[name="token"]').val(e.token),i.removeClass("hidden"),t.addClass("hidden")):"fail"===e.status&&r.removeClass("hidden")}),!1})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(293)],r=function(e,t,n){return t(function(t){var i=e("#downloads-count"),r=+i.text();t.find("a[data-id]").click(function(t){t.preventDefault();var o=e(this),a=o.data(),s=gettext("Permanently delete %(filename)s?");n({title:gettext("Delete download"),content:interpolate(s,{filename:a.filename},!0)}).done(function(){o.addClass("deleting"),e.post(o.attr("href"),{file_id:a.id},function(){var e=o.closest("tr");e.siblings().length?(e.remove(),i.text(r-=1)):window.location.reload()})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(215)],r=function(e,t){return t(function(t){var n=t.find("#files"),i=t.find("#content-type"),r=t.find("#upload-button");r.disable(!1).click(function(e){e.preventDefault(),n.click()}),n.change(function(){var o=n.val().match(/[^\/\\]*$/)[0];i.val(e.ajax({url:"/site/mimeguess/"+o,async:!1,dataType:"json"}).responseText),t.find('input[name="Content-Disposition"]').attr("value","attachment; filename="+o),r.addClass("loading").disable(!0),t.submit()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(694)],r=function(e,t,n){return t(function(e){var t=e.find(".textarea-preview");new n({el:t}).render()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(405),n(8),n(695),n(696),n(393),n(403)],r=function(e,t,n,i,r,o,a){return n.ItemView.extend({behaviors:function(){return{WarnsOnPageChange:{behaviorClass:r,condition:function(){return this.getContent()!==this.initialContent&&!this._submitting}.bind(this)}}},events:{"keydown @ui.textarea":"checkForSubmission"},ui:{textarea:"textarea"},initialize:function(){this.bindUIElements(),this.initialContent=this.getContent(),this.language=this.$el.data("markup-type")||"markdown",this.listenForSubmission()},getContent:function(){return this.ui.textarea.val()},render:function(){return this.ui.textarea.markItUp(a(t.result(this,"markItUpOptions"))),this.bindUIElements(),this},listenForSubmission:function(){var t=this.ui.textarea[0].form;t&&e(t).on("submit",function(){this._submitting=!0}.bind(this))},checkForSubmission:function(e){e.keyCode===i.keyCode.ENTER&&e.metaKey&&e.target.form&&e.target.form.submit()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(405)],r=function(e,t,n){return n.Behavior.extend({initialize:function(){this._warnHandler=function(){return t.result(this.options,"condition")?t.result(this.options,"message"):void 0}.bind(this),e(window).on("beforeunload",this._warnHandler)},onDestroy:function(){e(window).off("beforeunload",this._warnHandler)},defaults:{condition:!0,message:gettext("Your changes will be lost. Are you sure you want to leave?")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405)],r=function(e,t){return t.ItemView.extend({languageNames:{markdown:"Markdown",creole:"Creole",rest:"reStructuredText",textile:"Textile"},events:{"click a":"updateLanguage","aui-dropdown2-show":"setActive"},initialize:function(e){this.$languageBtn=e.$languageBtn,this.language=e.language,this.on("change:language",function(e){this.language=e,this.render()})},render:function(){return this._buttonAuified||(this.auifyButton(),this._buttonAuified=!0),this.updateLabel(this.language),this},updateLanguage:function(t){t.preventDefault(),this.trigger("change:language",e(t.target).data("markupLang"))},auifyButton:function(){this.$languageBtn.removeClass("hidden").find("a").addClass("aui-dropdown2-trigger aui-dropdown2-trigger-arrowless aui-style-default").attr({"aria-haspopup":"true","aria-owns":"dropdown-wiki-lang","data-container":"#markItUpId_data"})},updateLabel:function(e){var t='<span class="aui-icon-dropdown"></span>';this.$languageBtn.find("a").text(this.languageNames[e]).append(t)},setActive:function(){this.$("li a").removeClass("active"),this.$('a[data-markup-lang="'+this.language+'"]').addClass("active")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(158),n(698)],r=function(e,t){return t(function(t){var n=e("#readme");t.on("click",function(t){t.preventDefault(),n.pjaxWithMask({push:!1,url:e(this).attr("href"),timeout:3e4})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(158)],r=function(e){e.fn.pjaxWithMask=function(t){var n=e(this);return e.pjax(e.extend(t,{container:n})),n.on("pjax:send",function(e){n.addClass("has-mask")}),n.on("pjax:complete",function(e){n.removeClass("has-mask")}),n}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(209),n(163),n(211)],r=function(e,t,n,i,r){return t(function(t){r("bitbucket.repository.create.hipchat.ad.presented"),t.find("#id_hipchat").on("click",function(t){r("bitbucket.repository.create.hipchat.ad.checkbox.clicked",{checked:e(t.target).is(":checked")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(206)],r=function(e,t,n){return t(function(){var t=e("#repo-import"),i=n("Repo Import");t.find("a.create-repo").on("click",function(){i("Create Repository Link - Clicked")}),t.find("a.import-github").on("click",function(){i("Import from GitHub Link - Clicked")}),t.find("a.team-pitch").on("click",function(){i("Working in a team? Link - Clicked")}),t.find('button[type="submit"]').on("click",function(){i("Import Repository Button - Clicked")}),t.find("a.cancel").on("click",function(){i("Cancel Link - Clicked")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(423),n(170),n(474),n(704),n(702),n(564),n(202),n(206),n(306),n(185)],r=function(e,t,n,i,r,o,a,s,l,u,c,d){return t(function(){l.set(i.id),r.register(o,{weight:300}),r.register(a,{repository:i.fullslug,hash:n,branch:c.get("at")}),d(function(){r.get(a).options.branch=c.get("at")}),s.vent.on("change:changeset",function(e){r.get(a).options.hash=e});var t=u("Contextual actions");e("#create-branch-contextual").on("click",function(){t("Create branch")}),e("#create-pull-request-contextual").on("click",function(){t("Create pull request")}),e("#create-issue-contextual").on("click",function(){t("Create issue")}),e("#clone-wiki-contextual").on("click",function(){t("Clone wiki")}),e("#create-page-contextual").on("click",function(){t("Create page")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(466),n(471),n(703)],r=function(e,t,n,i,r){function o(e){return e.replace(/(^\s*)|(\s*$)/gi,"").replace(/[ ]{2,}/gi," ")}function a(e){var n="",i=o(e).split(/\*|\s|(?=[A-Z0-9]|\/|\.|-|_)/g);i=t.filter(i,function(e){return e.length});var r=i.length;if(r){n+="("+t.map(i[0].split(""),s).join("")+")";for(var a=1;r>a;a++)n+=".*?("+t.map(i[a].split(""),s).join("")+")";return new RegExp("("+n+")","g")}return null}function s(e){return e!==e.toUpperCase()?"["+l(e.toUpperCase()+e)+"]":l(e)}function l(e){return e.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&")}return n.extend({label:gettext("Repository source"),start:0,data:[],maxResults:10,context:function(){return this.options.repository},url:function(e){return"/!api/1.0/repositories/{}/directory/{}?start={}".format(this.options.repository,this.options.hash,this.start)},getSourceUrl:function(e){var t="/{}/src/{}/{}".format(this.options.repository,this.options.hash,e);return this.options.branch&&(t+="?at={}".format(encodeURIComponent(this.options.branch))),t},transformData:function(e,n){var r=a(n);return t.filter(this.data,function(e){return r.test(e)}).map(function(e){for(var t,r=[],o=a(n);null!==(t=o.exec(e));)r.push([o.lastIndex-t[0].length,o.lastIndex]);return{label:i(e,r),title:e,url:this.getSourceUrl(e)}}.bind(this))},getAsyncDeferred:function(n){var i=e.ajax(this.getUrl(n));return i.done(function(e){this.data=t.uniq(this.data.concat(e.values))}.bind(this)),i},fetchData:function(e,t){this.getCachedAsyncDeferred(t).done(function(n){this.options.hash||(this.options.hash=n.revision);var i=this.transformData(this.data,t);!n.isLastPage&&i.length<=this.maxResults?(this.start=n.nextPageStart,this.fetchData(e,t)):e.resolve(i)}.bind(this))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e,t){if(t=t||50,e.length<=t)return e;var n=e.split("/"),i=n.pop(),r=Math.ceil(t/2);i.length>=r&&(i=i.slice(0,r-3)+"...");var o=n.join("/"),a=t-i.length-1;return o.length>a&&(o=o.slice(0,a-3)+"..."),o+"/"+i}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(3),n(170),n(467)],r=function(e,t,n){return n.extend({label:gettext("Repository actions"),context:t.fullslug,minQueryLength:0,maxResults:!1,data:function(){return[{label:gettext("Create branch"),$el:e("#repo-create-branch-link")},{label:gettext("Create pull request"),$el:e("#repo-create-pull-request-link")},{label:gettext("Fork repository"),$el:e("#repo-fork-link")}]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(2)],r=function(e,t,n){return t(function(){var t=e("#attachments"),i=t.find(".attachment-list");e(document).on("change","#id_attachments",function(){i.children(".pending").remove(),i.children(".empty").remove(),"undefined"!=typeof this.files&&n.each(this.files,function(t){e('<li class="pending"></li>').text(t.name).appendTo(i)})}),i.on("click",'a[href="#delete-attachment"]',function(t){if(t.preventDefault(),confirm("Are you sure you want to delete this attachment?")){var n=e(this),r=i.data("deleteUrl");e.ajax({url:r,type:"POST",data:{delete_attachment_id:n.data("id"),csrfmiddlewaretoken:e('input[name="csrfmiddlewaretoken"]').val()},dataType:"html",success:function(){n.closest("li").remove()}})}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(187),n(3),n(145),n(2),n(293),n(393),n(170),n(164),n(401),n(149),n(707),n(215)],r=function(e,t,n,i,r,o,a,s,l,u,c,d){return i(function(){function i(e){var t=n(e.target),i=n("form.editor.focused");h(t.val())?i.find("button:submit").disable(!0):i.find("button:submit").disable(!1)}function h(e){var t=/^\s*$/;return e.match(t)?!0:!1}function p(e){e.off("input","textarea",i),e.find("textarea").val("").markItUpRemove(),e.removeClass("textarea-preview").removeClass("focused"),e.find('a[href="#submit"], button:submit').removeClass("loading").disable(!1),m.hasClass("commentable")&&(e.closest(".comment article").removeClass("editing"),e.closest(".new-comment").length||e.closest("form").detach())}function f(t,n){var i=t.find("textarea").val(),r=/^\s*\+\d+\s*$/;if(!i.match(r))return void n();var a=t.find(".editor");d.currentUserHasVoted()?o({content:gettext("You have already voted on this issue. Would you still like to submit this comment?"),id:"already-voted-vote-suggestion",buttonText:gettext("Yes")}).done(function(){n()}).fail(function(){u(a.find(".cancel"),a),p(a)}):o({content:gettext("Voting on this issue will get it more attention than a +1 alone, click to add your vote instead."),id:"vote-suggestion",buttonText:gettext("Vote"),cancelText:gettext("Comment")}).done(function(){d.toggleVote(),u(a.find(".cancel"),a),p(a),e.messages.success({body:gettext("Thank you for voting on this issue."),fadeout:!0})}).fail(function(){n()})}var m=n("#issues-comments"),g=n("#issue-view").data(),v=function(){window.location.reload(!0)},y=t.repository(s.owner.username,s.slug);m.find("dd.comment").each(function(){var e=n(this),t=e.text().trim(),i=[/^Duplicate of #\d+[.]$/,/^Issue #\d+ was marked as a duplicate of this issue[.]$/],o=r.any(i,function(e){return e.test(t)});o&&e.nextUntil().remove()}),m.hasClass("commentable")&&m.append(c.toHtml("new-comment-template",{user_avatar_url:l.avatarUrl,display_name:l.displayName,content:""})),m.on("focus",".editor textarea",function(e){var t,r,o=n(e.target).closest(".editor"),s=m.find(".editor.focused");s.each(function(){o[0]!==this&&p(n(this))}),t=n(this).closest(".editor"),m.find(".focused").removeClass("focused"),t.addClass("focused"),r=t.find("textarea"),r.hasClass("markItUpEditor")||(t.addClass("textarea-preview"),r.markItUp(a()),setTimeout(function(){r.trigger("focus")},0),t.on("input","textarea",i)),h(r.val())&&t.find("button:submit").disable(!0)}),m.on("click",".editor .cancel",function(e){e.preventDefault();var t=n(this).closest(".editor");u(n(e.target),t),p(t)});var b=n("#issue-comment, .new-comment");b.on("click keydown",'a[href="#submit"], button:submit',function(e){if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var t=b.find("textarea").val();f(b,function(){b.find('a[href="#submit"], button:submit').addClass("loading").disable(!0),y.create_issue_comment(g.localId,{content:t},v)})}}),m.on("click keydown",".issue-comment .aui-button-primary",function(e){var t=n(e.target).closest(".comment article");if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var i=t.find("textarea").val(),r=t.data("comment-id");f(t,function(){t.find('a[href="#submit"], button:submit').addClass("loading").disable(!0),y.update_issue_comment(g.localId,r,{content:i},{success:v,error:function(e){401===e.status&&alert("You must be logged in to post a comment.")}})})}}),m.on("click",".edit-comment-link",function(e){e.preventDefault();var t=n(e.target).closest(".comment-content, .comment");if(m.hasClass("commentable")){var i,r,o,a;a=n(this).closest(".comment article"),o=a.attr("data-content");var s=n(c.toHtml("new-comment-template",{user_avatar_url:l.avatarUrl,display_name:l.displayName,content:o,convert_markup:"True"===a.data("convert-markup")}));i=s.find("form"),m.append(i),a.find(".comment-content").after(i),r=i.find("textarea"),r.data("originalComment",o),i.find(".comment_id").val(a.data("commentId")),a.addClass("editing"),r.focus()}else t.addClass("edit-comment-mode"),t.find("article").addClass("editing"),t.find(".editor textarea").focus()}),n(".edit-comment").each(function(){var e=n(this);e.find("a.button, button").click(function(){var t=e.find("textarea").val(),n=e.data("comment-id");y.update_issue_comment(g.localId,n,{content:t},{success:v,error:function(e){401===e.status&&(alert("You must be logged in to post a comment."),v())}})})}),n(".delete-link").click(function(e){e.preventDefault();var t=n(this),i=gettext("This is a destructive operation. Delete comment?");o(i).done(function(){t.closest("form").submit()})}),n(".comment-spam-link").click(function(e){e.preventDefault(),n(this).closest("form").submit()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(708)],r=function(e,t){function n(t,n){e("#issue-vote-count").text(t).toggleClass("aui-badge-active",n)}function i(i,r){var o=e("#issue-vote-trigger");r?(o.addClass("following").text(o.attr("data-unvote-text")).data("voted",!0),t.toggleWatching(!0)):o.removeClass("following").text(o.attr("data-vote-text")).data("voted",!1),n(i,r)}function r(){e.ajax({url:e("#issue-vote-trigger").attr("href"),type:"post",dataType:"json"}).success(function(e){i(e.count,e.voted)})}function o(){return e("#issue-vote-trigger").data("voted")}return e(document).on("click","#issue-vote-trigger",function(e){e.preventDefault(),r()}),{updateVoteCount:n,toggleVote:r,toggleVoteUI:i,currentUserHasVoted:o}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){function t(t){var n=e("#issue-watch-count"),i=parseInt(n.text(),10);i=t?i+1:i-1,n.text(i).toggleClass("aui-badge-active",t)}function n(n){var i=e("#issue-watch-trigger");n!==i.hasClass("following")&&(n?i.addClass("following").text(i.attr("data-unfollow-text")):i.removeClass("following").text(i.attr("data-follow-text")),t(n))}return{updateWatchingCount:t,toggleWatching:n}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(393),n(215),n(298),n(403)],r=function(e,t,n,i,r,o){return n(function(){var e=t("#issue-form"),n=e.find("#id_responsible");n.auiSelect2({allowClear:!0,formatResult:o,formatSelection:o}),t("#id_component, #id_milestone, #id_version").auiSelect2({allowClear:!0}),e.find("#id_content, #id_comment, .edit-comment textarea, #id_update_comment").markItUp(i()),e.find("#assign-to-me").click(function(e){var i=t(e.target).attr("data-username");e.preventDefault(),n.val(i).trigger("change")}),e.on("submit",function(e){t(e.target).find('button[type="submit"]').disable(!0)}),t("#select-files-button").click(function(){t("#id_attachments").click()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(2)],r=function(e,t,n){return t(function(){var t=e("#issues-list"),i={"~":"contains","^":"starts with",$:"ends with","!":"not"},r={},o=t.find(".issues-list").data("qs");o&&n.each(o.split("&"),function(e){var t,o,a,s;e=e.split("="),o=e[0],s=decodeURIComponent(e[1].replace(/\+/g,"%20")),t=s.substr(0,1),n.has(i,t)?(s=s.substr(1),a=i[t]+" "):a="",s="responsible"!==o||s?a+'"'+s+'"':"!"===t?"someone":"no one",(r[o]||(r[o]=[])).push(s)});var a={q:"query",reported_by:"reporter",responsible:"assignee"},s=n.map(n.keys(r).sort(),function(e){return"<b>{label!esc}:</b>\n{value!esc}".format({label:a[e]||e,value:r[e].sort().join(" or ")})});t.find("#issues-filter-criteria").html(s.join(" "))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2)],r=function(e,t,n,i){return n(function(){var e=t("#issues-query-builder"),n=e.find("form.query-form"),r=n.data(),o=e.find("#filters"),a=t("#addfilter"),s=t("#filters"),l={init:function(e,t){var n;if(e)for(n in e)"select"===e[n].type&&e[n].options.length<=0&&a.find('option[value="'+e[n].name+'"]').remove();if(a.bind("change",function(){this.selectedIndex>0&&l.create(this.options[this.selectedIndex].value)}).auiSelect2(),o.html(""),!i.isEmpty(t))for(n in t)for(var r=0;r<t[n].length;r++)l.create(n,t[n][r][0],t[n][r][1])},generate_select:function(e,t,n){""!==t[0].value&&(/^responsible\d+$/.test(e)?t.unshift({text:"unassigned",value:""}):/^(?:component|milestone|version)\d+$/.test(e)&&t.unshift({text:"unset",value:""}));var i=document.createElement("select");i.name=e;for(var r,o=0;o<t.length;o++)"object"==typeof t[o]?(r=new Option(t[o].text,t[o].value),t[o].value===n&&(r.selected=!0)):(r=new Option(t[o],t[o]),t[o]===n&&(r.selected=!0)),i.options[i.options.length]=r,i.className="nosearch";return i},generate_remove_button:function(){var e=t('<a class="icon filter-remove">Remove filter</a>');return e[0]},remove:function(){var e=t(this).parent().parent();if(e.attr("class")===e.next("li").attr("class")){var n=e.find(".filter-header").text();e.next("li").find(".filter-header").text(n)}e.remove()},generate_comp_select:function(e,t,n){var i={text:[{text:"contains",value:"~"},{text:"doesn't contain",value:"!~"},{text:"begins with",value:"^"},{text:"ends with",value:"$"},{text:"is",value:""},{text:"is not",value:"!"}],select:[{text:"is",value:""},{text:"is not",value:"!"}]};return"text"===t||"select"===t?this.generate_select(e,i[t],n):void 0},create:function(e,n,i){var r=u[e],c=!1,d=1;s.find("li").hasClass("filter_"+e)&&(c=!0,d=s.find("li.filter_"+e).length+1);var h=t("<li></li>");h.addClass("filter_"+e);var p=t('<div class="filter-header"></div>');c?p.text("or"):p.text(r.header),h.append(p);var f=t('<div class="filter-comp"></div>');if("text"===r.type||"select"===r.type){var m=l.generate_comp_select("comp_"+r.name+d,r.type,n);f.append(m),setTimeout(function(){t(m).auiSelect2()},0)}h.append(f);var g,v=t('<div class="filter-query"></div>');"text"===r.type?(g=t("<input/>"),g.attr("type","text"),g.attr("name",e+d),g.val(i?i:""),g.attr("size",30)):"select"===r.type&&(g=this.generate_select(e+d,r.options,i)),g&&(v.append(g),"select"===r.type&&setTimeout(function(){t(g).auiSelect2()},0)),h.append(v);var y=t("<div></div>"),b=this.generate_remove_button();y.append(b),h.append(y),t(b).click(l.remove),c?(s.find(".filter_"+e+":last").after(h),s.find(".filter_"+e+" div").removeClass("last-of-type"),s.find(".filter_"+e+":last div").addClass("last-of-type")):o.append(h),a.get(0).selectedIndex=0}},u={title:{name:"title",type:"text",header:"Title"},content:{name:"content",type:"text",header:"Description"},version:{name:"version",type:"select",header:"Version",options:r.versions},milestone:{name:"milestone",type:"select",header:"Milestone",options:r.milestones},component:{name:"component",type:"select",header:"Component",options:r.components},kind:{name:"kind",type:"select",header:"Type",options:r.kinds},status:{name:"status",type:"select",header:"Status",options:r.statuses},priority:{name:"priority",type:"select",header:"Priority",options:r.priorities},responsible:{name:"responsible",type:"select",header:"Assignee",options:r.responsibles},reported_by:{name:"reported_by",type:"text",header:"Reported by"}};l.init(u,r.query),e.find("#filters-filters").find(".cancel").click(function(e){e.preventDefault(),window.history.back()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(187),n(3),n(145),n(393),n(170),n(183),n(149),n(298),n(403)],r=function(e,t,n,i,r,o,a,s,l){return i(function(){function e(){c=n(s.toHtml("transition-dialog-template")),d=c.find(".error");var e=c.find("#id_responsible"),t=c.find("#assign-to-me"),o=function(e){d.removeClass("hidden"),d.find(".message").text(e)},u={dataType:"json",success:v,error:function(e){o(404===e.status?gettext("The duplicate issue does not exist"):e.responseText?e.responseText:gettext("An unexpected error occurred."))}};c.submit(function(e){e.preventDefault(),i(c,o,u)});var h=new a({width:700,height:"auto",id:"issue-transition-dialog",closeOnOutsideClick:!0});return c.find("#id_transition_comment").markItUp(r()),e.auiSelect2({allowClear:!0,formatResult:l,formatSelection:l}),t.on("click",function(t){t.preventDefault();var i=n(t.target).attr("data-username");e.auiSelect2("val",i)}),h.addHeader(gettext("Transition issue")),h.addPanel("Transition",c,"panel-body"),h.addButton(gettext("Change"),function(){i(c,o,u)},"aui-button transition-issue-button"),h.addCancel(gettext("Cancel"),function(e){e.hide()}),h}function i(e,t,i){var r=e.find("#id_transition_comment").val(),o=e.find("#id_responsible").val(),a={status:p,responsible:o,comment:r},s=h.popup.element.find(".transition-issue-button");if(s.addClass("loading").attr({"aria-disabled":!0,disabled:!0}),6===p){var l=e.find("#id_duplicate_issue").val(),u=/\d+/.exec(l);if(!u)return t(gettext("Invalid issue number")),void s.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");if(+u[0]===g.localId)return t(gettext("Invalid issue number")),void s.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");i.type="POST",i.url=e.data("duplicateUrl"),i.dataType="html",i.data=a,a.duplicate=u[0],n.ajax(i)}else y.update_issue(g.localId,a,i)}function u(t){t.preventDefault();var i=n(this),r=i.attr("title");h||(h=e()),p=i.data("transition-to");var o=6===p;c.find(".duplicate").toggle(o),c.find(".comment").toggle(!o),d.addClass("hidden"),h.addHeader(r?r:gettext("Transition issue")),h.show()}var c,d,h,p,f=n("#workflow-dropdown"),m=n("#issue-view"),g=m.data(),v=function(){window.location.reload(!0)},y=t.repository(o.owner.username,o.slug);f.find('[data-transition-to="{curr}"], [data-transition-to="{next}"]'.format({curr:g.status,next:m.find("#change-state").find("a").data("transition-to")})).remove(),f.find("[data-transition-to]").click(u),n("#change-state").click(u)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(293),n(393),n(164),n(183),n(246),n(167),n(149),n(163),n(707),n(708),n(403),n(439)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h,p){return n(function(){function e(){if(f)return f;f=new s({width:700,height:"auto",id:"issue-attachment-dialog",closeOnOutsideClick:!0});var e=t(c.toHtml("attachment-dialog-template"));return e.find("textarea").markItUp(o()),f.addHeader("Attach files"),f.addPanel("Attach",e,"panel-body"),f.addButton("Attach",function(){e.submit()}),f.addCancel("Cancel",function(e){e.hide()}),f}var n=t("#issue-view"),a=(n.data(),/[(](BB-\d+)[)]/.exec(t("#issue-title").text())),h=n.find("#jira");h.toggle(location.pathname.startsWith("/site/master/")),h.length&&a&&h.text("View in JIRA").attr({href:"https://bitbucket.atlassian.net/browse/"+a[1]}),n.find("#issue-delete-link").click(function(e){e.preventDefault();var n=t(this),i=gettext("This is a destructive operation. Delete issue?");r(i).done(function(){
n.closest("form").submit()})}),n.find("#issue-flag-spam").click(function(e){e.preventDefault(),t(this).closest("form").submit()}),t(document).on("follow:issue","#issue-watch-trigger",function(e,t){p.updateWatchingCount(t)}),t("ul.issue-attachment-list").find("a.image-attachment").fancybox({loop:!1,nextEffect:"fade",prevEffect:"fade",beforeLoad:function(){this.title=i.escape(t(this.element).attr("title"))}}),l("#jira-issue-box",function(e){var n=e.find("a.close");n.on("click",function(i){i.preventDefault(),d.set("dismiss-jira-box-"+n.attr("data-repo-id"),"True").done(function(){e.animate({opacity:0},200,function(){t(this).animate({height:0},200,function(){e.remove()})})})})});var f;t(".issue-attach-link").click(function(t){t.preventDefault(),e().show()}),u()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(374),n(206),n(149),n(376),n(212)],r=function(e,t,n,i,r,o,a,s){function l(e){i.each(e.branches||[],function(e){e.encodedName=encodeURIComponent(e.name)}),i.each(e.tags||[],function(e){e.encodedName=encodeURIComponent(e.name)})}var u=o("Repo Overview"),c=292;return n(function(n){function i(e,i,c){var d=e.find("input.filter-box");e.find(".repo-stats-dialog").length?c&&c():e.loading(t.ajax({type:"get",url:n.attr("data-url"),dataType:"json"})).done(function(t){l(t),e.append(a.toHtml(n.attr("data-template"),t)),s(e),d=e.find("input.filter-box"),r.tabbedFilter(d,e),c&&c()}),u("Stats Dialog - Displayed",o),setTimeout(function(){d.focus()},0)}var o=n.attr("id"),d={width:c};o=o.substring(0,o.length-"-trigger".length),e.InlineDialog(n,"overview-"+o,i,d)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(2),n(206),n(149),n(212)],r=function(e,t,n,i,r,o){function a(e,n,i){var r=t(n),a=e.find(".repo-stats-dialog");a.length&&r.attr("data-cached")?i&&i():(a.empty(),e.loading(t.ajax({type:"get",url:r.attr("data-url"),dataType:"json"})).done(function(t){var n=o.toHtml(r.attr("data-template"),t);e.removeClass("loading"),a.length?a.replaceWith(n):e.append(n),r.attr("data-cached",!0),i&&i()})),s("Stats Dialog - Displayed","followers-dialog")}var s=r("Repo Overview");return n(function(n){var i=t("a.follow"),r=t("#followers-list"),o=i.hasClass("following");t(document).on("follow:repo","a.follow",function(e,t){if(o!==t){o=t,r.find("li.current-user").toggleClass("hidden",!t);var i=n.find(".value"),a=+i.text();t?a++:a--,n.removeAttr("data-cached"),r.find("ol").toggleClass("empty",0===a),i.text(a);var s=n.html();1===a?n.html(s.replace(/Watchers/,"Watcher")):n.html(s.replace(/Watcher\b/,"Watchers"))}}),e.InlineDialog(n,"overview-followers-dialog",a,{width:292})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(382),n(147)],r=function(e,t,n,i){return t(function(){function t(t){var n=e(t.target),a=n.attr("href").substring(1),s=r.find('[href="#'+a+'"]').closest("li");t.preventDefault(),s.length||(s=r.filter(":first")),r.removeClass("aui-nav-selected"),s.closest("li").addClass("aui-nav-selected"),o.removeClass("selected"),e("#"+a).addClass("selected");var l=["atl._trackEvent","Repo Getting Started",a];n.hasClass("next")&&l.push("Next"),i(l)}var n=e("#repo-getting-started"),r=n.find("nav li"),o=n.find(".tab-pane"),a=n.find('#invite-friends [href="#share"]'),s=e("#start-from-scratch");n.find("nav li a, a.tab-jump").click(t),a.on("click",function(){i(["atl._trackEvent","Repo Getting Started","Send an Invitation"])}),s.on("click","a",function(t){i(e(t.target).hasClass("set-up")?["atl._trackEvent","Repo Getting Started","Set Up DVCS",s.attr("data-scm")]:["atl._trackEvent","Repo Getting Started","Bitbucket 101"])}),e("#commit-and-push").on("click","a.readme",function(){i(["atl._trackEvent","Repo Getting Started","Learn Readme"])}),e(".getting-started-choice").on("click",function(t){t.preventDefault();var n=e(this);n.toggleClass("collapsed"),n.find(".aui-icon").toggleClass("aui-iconfont-expanded").toggleClass("aui-iconfont-collapsed");var r=n.hasClass("collapsed")?"closed":"open";i(["atl._trackEvent","Repo Blank Slate",n.attr("href"),r])}),e(".getting-started-choice:visible:first").click(),e("#sourcetree-download").on("click",function(){i(["atl._trackEvent","Repo Blank Slate","Download SourceTree"])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(206),n(716),n(718),n(719),n(720),n(721),n(722)],r=function(e,t,n){return t(function(){var t=n("Repo Overview");e(".clone-url-input","#repo-stats").on("focus",function(){t("Clone Url - Focused")}),e("#repo-overview-download").on("click",function(){t("Download Shortcut - Link Clicked")}),e("#repo-activity").on("click",".newsfeed a",function(){t("Newsfeed - Link Clicked")}).on("click",".subscribe",function(){t("Newsfeed - Subscribe Link Clicked")}),e(".page-actions").on("click","#repo-share-link",function(){t("Share Button - Clicked")}).on("click","a.repo-watch",function(){t("Watch Prefs Dialog")}).on("follow:repo","a.follow",function(e,n){t(n?"Watch Repo":"Unwatch Repo")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(147),n(163)],r=function(e,t,n,i){return t(function(t){var r=t.find('a[href="#invite-repo"]'),o=t.find("a.close");r.on("click",function(){n(["atl._trackEvent","Share","Repo overview invite user button"])}),o.on("click",function(r){r.preventDefault();var a="dismiss-invite-box-"+o.data("repo-id");i.set(a,"True").done(function(){e("#invite-repo-box").animate({opacity:0},200,function(){e(this).animate({height:0},200,function(){t.remove()})}),n(["atl._trackEvent","Share","Dismiss repo overview invite panel"])})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(714),n(715)],r=function(e,t){return t(function(){var t=window.location.hash.substring(1);t&&setTimeout(function(){e("#"+t+"-dialog-trigger").click()},0)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(293)],r=function(e,t,n){return t(function(e){var t={title:e.attr("data-revoke-title"),content:e.attr("data-revoke-confirm"),buttonText:e.attr("data-revoke-button")};e.on("click",function(i){i.preventDefault(),n(t).done(function(){window.location.href=e.attr("href")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(206)],r=function(e,t,n,i){return n(function(n){var r=t("#repo-clone-sourcetree-dialog"),o=i("Repo Overview");e.InlineDialog(n,"sourcetree-clone-dialog",function(e,t,n){r.appendTo(e).removeClass("hidden"),n()},{width:360,closeOnTriggerClick:!0}),n.on("click",function(){o("Clone in SourceTree Dialog - Displayed")}),r.on("click",".aui-button",function(){o("Clone in SourceTree - Clicked")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(206),n(369),n(163),n(387)],r=function(e,t,n,i,r,o){return t(function(e){var t=n("Repo Overview"),a=e.find('a[href="#sync-repo"]'),s=e.find("a.close"),l=a.attr("data-conflict-url"),u=a.attr("data-source-repo"),c=a.attr("data-dest-repo");o(a,{getData:function(){var e,t=a.attr("data-source-branch"),n=a.attr("data-dest-branch");return e=t==n?u:"{}/{}".format(u,t),{action:a.attr("data-compare-url"),source:a.attr("data-source-value"),sourceBranch:t,sourceRepo:u,sourceAvatar:a.attr("data-source-avatar"),sourceAvatarAltText:a.attr("data-source-repo-name"),dest:a.attr("data-dest-value"),destBranch:n,destRepo:c,destAvatar:a.attr("data-dest-avatar"),destAvatarAltText:a.attr("data-dest-repo-name"),sameRepo:!1,canCloseBranch:!1,hasConflicts:!1,mergeCommands:"",commitMessageSlug:e,syncRepo:!0}},success:function(){i.addMessage("{} successfully synced with {}.".format(c,u)),window.location.reload(!0)},conflictUrl:l}),s.on("click",function(n){n.preventDefault();var i=s.attr("data-pref"),o=s.attr("data-pref-value");r.set(i,o).done(function(){e.animate({opacity:0},200,function(){e.animate({height:0},200,function(){e.remove()})}),t("Sync Repo Box - Dismissed")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(485)],r=function(e,t,n,i){return n(function(e){function t(){var t=r.find(":selected");n.attr("data-owner",t.text()),e.toggleClass("project-select-none",null==t.attr("data-is-team")),i(n)}var n=e.find("#id_project"),r=e.parent().find("#id_owner");t(),r.on("change",t)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(145),n(393),n(170),n(403),n(368),n(725),n(215),n(246),n(441)],r=function(e,t,n,i,r,o,a,s,l,u,c){return n(function(){function n(n){var i=h.find("select[name=source]"),r=d.find("select[name=dest]");if(!(n&&e(n.target).parents("#pull-into .branch-field-container").length||0===i.length||0===r.length)){var o=c(i.val()).branch,a=r.val();if(r.find('option[value$="::"]').remove(),0===r.find('option[value$=":'+o+'"]').length){var s='<option value="{0}::">{1} (new branch)</option>'.format(),l=e(s(f.val(),o)),u=t.sortedIndex(r.find("option").get(),l.get(),function(t){return e(t).text()});0===u?l.insertBefore(r.find("option").get(0)):l.insertAfter(r.find("option").get(u-1))}r.val(a).trigger("change")}}function o(t,n){var i=t.find(".error");i&&0!==i.length||(i=e('<div class="error"></div>'),t.append(i));var r=e("<div></div>");r.text(n),i.append(r)}var l=e("#pullrequest-form"),d=l.find("#pull-into"),h=l.find("#pull-from"),p=l.find(".compare-widget-container"),f=(l.find("#id_source_repo"),l.find("#id_dest_repo")),m=l.find("textarea");if(m.markItUp(i()),function(){var t=e("#id_title"),n=e("#id_description");if(t.length&&n.length){var i=function(e){var t=e.data();return t.val=e.val(),function(n){e.val(t.val=n)}},r=i(t),o=i(n);e(document).bind("bb:compare",function(){var i=e("#compare-metadata"),a=0!==i.data("commit-count");if(l.find("button:submit").attr({disabled:!a,"aria-disabled":!a}),!l.hasClass("update")&&!l.data("has-errors")&&t.val()===t.data("val")&&n.val()===n.data("val")){var s=p.find('[name="source"]').val(),u=p.find('[name="dest"]').val(),c='ul[data-source="{0}"][data-dest="{1}"] li'.format(s,u),d=e(c,"#updateable-prs"),h=i.data("message");1===d.length?(r(d.data("title")),o(d.data("description"))):h?(r(h.subject),o(h.body)):(r(""),o(""))}})}}(),p.change(n),n(),e("#id_new_branch").prop("checked")===!0){var g=h.find("select[name=source]"),v=d.find("select[name=dest]");g.length&&v.length&&(v.val(v.find('option[value$="::"]').val()),v.change())}d.on("change","select[name=dest]",function(){var t=e(this).val();if(t){var n=c(t).branch;e("#id_new_branch").prop({checked:!n})}}),u("#updateable-prs",function(t){var n=t.children("ul");if(0!==n.length){var i=function(){var i=e(this),r=i.find('[name="source"]').val(),o=i.find('[name="dest"]').val();if(r&&o){var a=n.filter('[data-source="'+r+'"]').filter('[data-dest="'+o+'"]');n.not(a).hide(),a.show(),a=a.children();var s=a.length;l.find("input:submit").val(1===s?"Update pull request #"+a.data("local-id"):"Send pull request"),t.addClass("hidden"),s&&t.removeClass("hidden").find("strong").text(s>1?s+" existing pull requests will be superseded":"An existing pull request will be updated")}};p.change(i).change()}}),u("#id_reviewers_group",function(e){s(e)}),l.on("submit",function(){var n=l.find("#participants"),i=n.find(".non-reviewer").detach(),r=l.serialize(),s=l.attr("action"),u=l.find("#submitPrButton"),c=l.find("#global-errors");return u.addClass("loading").disable(!0),l.find(".error:not(#global-errors)").empty(),c.addClass("hidden"),e.ajax({type:"POST",url:s,data:r,dataType:"json"}).done(function(r){r.errors?(t.each(r.errors,function(r,a){if("__all__"===a){c.removeClass("hidden");var s=c.find(".messages").empty();t.each(r,function(t){s.append(e("<li>").text(t))})}else{var u=l.find("#id_{}_group".format(a));t.each(r,function(e){n.prepend(i),o(u,e)})}}),u.removeClass("loading").disable(!1)):r.result?window.location=r.result:setTimeout(function(){a(r.url).fail(function(e){o(u.closest(".buttons-container"),e),u.removeClass("loading").disable(!1)})},1e3)}).fail(function(){o(u.closest(".buttons-container"),gettext("Something went wrong while creating your pull request.")),u.removeClass("loading").disable(!1)}),!1}),u("#id_close_anchor_branch",function(n){function i(e){s=n.prop("checked"),n.prop({checked:!1,disabled:!0}),a.addClass("disabled").attr({title:e})}var o=e("#pullrequest-form"),a=n.next("label"),s=null,l=function(l){var u=c(o.find("select[name=source]").val()),d=e("#compare-metadata"),h=o.find("select[name=dest]"),p=(c(h.val()),!d.data("hasBranchClose"));if(a.html('Close <span class="branch-name">'+t.escape(u.branch)+"</span> after the pull request is merged"),p)i("Branch deletion is disabled for this branch");else{var f=u.branch===r.mainbranch.name;f?i("You're not permitted to close the main branch"):(n.prop({disabled:!1}),null!==s&&(n.prop("checked",s),s=null),a.removeClass("disabled").removeAttr("title"))}};p.bind("bb:compare:loaded",l),i("Loading pull request details")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(149),n(727),n(726),n(728),n(239),n(170),n(243)],r=function(e,t,n,i,r,o,a,s,l,u){return function(){function e(e,t){t(y.toSelect2Data())}function c(e){b.off("respond"),b.on("respond",function(t){e.callback({results:t.results})}),b.query(e.term)}function d(e,t){t.append(i.toHtml("mention-result",e.toEscapedJSON()))}function h(e,t){t.append(i.toHtml("selected-reviewer-template",e.toJSON()))}function p(e){return e.length<u.MENTIONS_MIN_QUERY_LENGTH?gettext("Continue typing to search for a user"):interpolate(gettext("Found no matches for %(query)s"),{query:n.escape(e)},!0)}var f=t("#reviewers"),m=t(".suggested-reviewers"),g=t("#id_dest_repo"),v=g.length&&g.val()||l,y=new r(f.data("reviewers"),{participants:f.data("participants"),suggested:f.data("suggested"),parse:!0}),b=new s([],{model:o,matcher:function(e,t){return y.canAdd(e)?e.matches(t,this):!1},queryEndpoint:"/xhr/mentions/"+v,queryParamKey:"term"});f.auiSelect2({placeholder:gettext("Start typing to search for a user"),containerCssClass:"text long-field",dropdownCssClass:"bb-typeahead-suggestions aui-dropdown2 aui-style-default bb-user-suggestions",multiple:!0,initSelection:e,query:c,formatResult:d,formatSelection:h,formatNoMatches:p}),new a({el:m,collection:y.suggested,reviewers:y}).render(),f.on("change",function(e){e.added&&y.add(e.added.toJSON()),e.removed&&y.remove(e.removed)}),y.on("add remove",function(){f.auiSelect2("data",y.toSelect2Data())}),g.on("change",function(){var e=g.val();b._queryEndpoint="/xhr/mentions/"+e,b.queryCache={},b.reset(),y.setDestination(e)})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(237)],r=function(e,t){return t.extend({parse:function(e){return e.avatar_url=e.avatar_url||e.avatar,e},toEscapedJSON:function(){return{avatar_url:this.get("avatar_url"),display_name:e.escape(this.get("display_name")),username:e.escape(this.get("username")),is_teammate:this.get("is_teammate"),is_team:this.get("is_team")}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(726),n(557),n(164)],r=function(e,t,n,i,r,o){var a=r.author?r.author.username:o.username,s=e.Collection.extend({model:i});return e.Collection.extend({model:i,initialize:function(e,t){t=t||{},this.participantUsernames=t.participants||[],this.suggested=new s(t.suggested||[],{parse:!0,reset:!0})},toSelect2Data:function(){var e=n.partial(n.contains,this.participantUsernames);return this.map(function(t){return t.locked=e(t.get("username")),t})},canAdd:function(e){return e.id===a?!1:!this.contains(e)},addSuggestedReviewer:function(e){this.add(this.suggested.findWhere({username:e}))},setDestination:function(e){function i(e){n.each(e.invalid_reviewers,function(e){r.remove(r.get(e))}),r.suggested.reset(e.suggested,{reset:!0,parse:!0})}this.destinationFullslug=e;var r=this;t.ajax({url:"/{}/pull-requests/xhr/reviewer-permissions/".format(this.destinationFullslug),data:{reviewers:this.pluck("username")}}).done(i)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405),n(729)],r=function(e,t){return e.CompositeView.extend({childView:t,template:"#suggested-reviewers-template",childViewContainer:".suggested-reviewer-list",childViewOptions:function(){return{reviewers:this.reviewers}},addChild:function(t){this.reviewers.get(t.id)||e.CollectionView.prototype.addChild.apply(this,arguments)},isEmpty:function(){var e=this.reviewers;return this.collection.every(function(t){return e.get(t.id)})},showEmptyView:function(){this.$el.addClass("hidden")},destroyEmptyView:function(){this.$el.removeClass("hidden")},initialize:function(e){this.reviewers=e.reviewers,this.listenTo(this.collection,"reset",this.render),this.listenTo(this.reviewers,"add remove",this.render)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(405)],r=function(e){return e.ItemView.extend({tagName:"li",template:"#suggested-reviewer-template",className:"suggested-reviewer-list-item",attributes:function(){return{"data-username":this.model.get("username"),"data-display-name":this.model.get("display_name")}},events:{click:"addSuggestedReviewer"},initialize:function(e){this.reviewers=e.reviewers},addSuggestedReviewer:function(){this.reviewers.add(this.model)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(305)],r=function(e,t,n){return e(function(e){n({$container:e,$pjaxContainer:t("#pullrequest-pjax"),ignoreQuery:"page"})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(145),n(412),n(557),n(170),n(314),n(681),n(683),n(389),n(682),n(388),n(680),n(416),n(556),n(660),n(661),n(440),n(665),n(732),n(165),n(368),n(325),n(215),n(246),n(147),n(149),n(306),n(733),n(736),n(439),n(158)],r=function(e,t,i,r,o,a,s,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,$,S,T,D,P){return r(function(){function r(e,t){return function(n){n.isconflicted?e():n.mergeimpossible&&(void 0!==t?t():e())}}function $(){F.disable(),t("#fulfill-pullrequest").attr("aria-disabled",!0).attr("title",gettext("Cannot merge due to conflicts"))}function T(e){var n=location.hash;history.replaceState(null,null,location.pathname),location.hash=n;var i=e.find("#general-thread-ids"),r=t("#activity-list.line-commenting > li.new-comment");if(i.length&&d.decorateThreads(q.toString(),i.data("value")),r.length){var o=!1;new c(q,o).decorate(r)}E(e.find(".pr-line-thread-ids"))}function E(e,t){e.length&&i.each(e.data("value"),function(e,n){i.each(e,function(e,n){t&&(e=i.intersection(e,t)),d.decorateThreads(q.toString(),e,n)})})}function A(){var e=this.filter(function(e){return e.get("approved")});o.vent.trigger("updateApprovals",e.length)}function I(){this.fetch({reset:!0})}var R=t("#pull-request-attrs"),M=function(){this.$window=null,this.$line=null};M.prototype.regex=/(F\d+)?(T\d+)?$/,M.prototype.oldRegex=/_(oldline|newline)(\d+)$/,M.prototype.cssClass="permalinked",M.prototype.isLinePermalink=function(e){var t=this.regex.exec(e);return!(!t[1]&&!t[2])},M.prototype.translateHash=function(e){var n=this.oldRegex.exec(e);if(n[1]&&n[2]){var i=e.substring("#chg_".length);i=i.substring(0,i.length-(n[1]+n[2]).length-1);var r={oldline:"F",newline:"T"},o="L"+i+r[n[1]]+n[2];if(document.getElementById(o))return o;var a=document.getElementById("chg-"+i);if(a){var s={oldline:"data-fnum",newline:"data-tnum"},l=t(a).find("div.common").filter("[{}={}]".format(s[n[1]],n[2]));if(1===l.length)return l.find(".line-numbers").attr("id")}}return null},M.prototype.decorate=function(e){this.$window=e,this.enterDocument()},M.prototype.enterDocument=function(){this.$window.bind("hashchange",t.proxy(this.highlightLine,this))},M.prototype.highlightLine=function(){var e=window.location.hash;if(this.oldRegex.test(e)){var n=this.translateHash(e);n&&(window.location.hash=n)}else if(this.isLinePermalink(e)){var i=document.getElementById(e.substring(1));i&&(null!==this.$line&&this.$line.removeClass(this.cssClass),this.$line=t(i).addClass(this.cssClass))}};var j=t("#pullrequest.view-pullrequest");j.find(".description img:not(.emoji)").each(function(e,n){var i=t(n),r=i.attr("src");if(!i.parent().is("a")){var o=t("<a>").addClass("image-link").attr({href:r,rel:"pr-image",target:"_blank","data-fancybox-type":"image"});i.wrap(o)}}),j.find(".description a.image-link").fancybox({loop:!1,nextEffect:"fade",prevEffect:"fade"});var L=t("#fulfill-pullrequest"),N=t("#reject-pullrequest"),O=new t.Deferred;if("open"===R.data("status")){var U=t(".menu-item.active-tab a","#pullrequest-navigation").attr("data-tab-link-id");"diff"===U?t(document).one("diff:loaded",function(){O.resolve({isconflicted:t("#compare").data("hasConflicts"),mergeimpossible:t("#pr-tab-info").data("mergeimpossible")})}):O=t.ajax({url:j.attr("data-conflicts-url"),type:"GET",dataType:"json",cache:!1});var H=function(){var e=t("<span>").addClass("aui-icon aui-icon-warning").attr("title",gettext("Cannot merge due to conflicts"));t("#pullrequest-actions").prepend(e.tooltip())};O.done(r(H)).fail(H)}var F=new l(L,{onUpdateContents:function(e){var n=e.popup.element,i=-(new Date).getTimezoneOffset();n.find('input[name="tzoffset"]').val(i);var o=function(){n.find("form").empty().append(t("#pull-request-header").find(".conflicts-detected")),n.find(".dialog-button-panel button").prop("disabled",!0).attr({"aria-disabled":!0,title:gettext("Cannot merge due to conflicts")})},a=function(){n.find("form").empty().append(t("#pull-request-header").find(".mergeimpossible")),n.find(".dialog-button-panel button").prop("disabled",!0).attr({"aria-disabled":!0,title:gettext("Cannot merge")})};O.done(r(o,a)).fail(a).always(function(){n.find("form.maskable").removeClass("has-mask")})},success:function(e,t){t.result?window.location=t.result:setTimeout(function(){k(t.url).fail(this.error.bind(this))}.bind(this),1e3)},error:function(n,i){if(i.responseJSON&&i.responseJSON.outOfSync){this.close();var r=t(".js-update-pr-href").attr("href"),o=gettext("The source branch for this pull request has new commits. You should update the pull request with them before proceeding:")+" "+gettext('<a class="quick-update-pr js-quick-update-pr" href="'+r+'">Update now.</a>');return void e.messages.error({title:gettext("New commits detected"),body:o})}this.complete_(),this.displayError({title:gettext("Unable to merge"),body:o,closeable:!1})},complete:function(){},dataType:"json",isStaticContent:!0,width:700,urlAttr:"data-form-url"}).bind();L.disable(!1);new l(N,{dataType:"json",isStaticContent:!0,urlAttr:"data-form-url"}).bind();N.disable(!1),x.showUpdatesDialog(),"open"===R.data("status")&&(j.hasClass("conflicts")?$():t(document).bind("bb:compare",function(){t("#compare-metadata").data("has-conflicts")&&(j.addClass("conflicts"),$())}),t(".pullrequest-metadata time").localize());var q=_.concat("repositories",s.owner.username,s.slug,"pullrequests",a.localId,"comments");S("#activity-list",function(e){var n=t("#pr-tab-content");T(n)}),v.collectionFrom(j,64).done(function(e){e.on("participants:refresh",A,e),e.on("reset",A,e),o.vent.on("currentUserApproved",I,e),S(".reviewers-group .participants ol",function(t){new y({el:t,collection:e,condition:function(e){return e.get("username")!==a.author.username},auiAvatarSize:"medium",emptyTemplate:"no-reviewers-template"}).render()}),S(".author ol",function(t){new y({el:t,collection:e,condition:function(e){return e.get("username")===a.author.username},auiAvatarSize:"medium"}).render()}),e.bind("approved",function(e){e&&j.find("a.follow").trigger("toggle-follow",{type:"pullrequest",isNowFollowing:!0})}),t(document).on("comment-added approval-changed.pullrequest",function(t){e.trigger("participants:refresh"),"comment-added"===t.type&&j.find("a.follow").trigger("toggle-follow",{type:"pullrequest",isNowFollowing:!0})})}),j.find(".compare-widget-container .compare-widget").each(function(n,i){var r=t(i),o=!1;e.InlineDialog(r,"repo-details-"+n,function(e,n,i){o||e.addClass("pullrequest-branch-details-dialog").append(t(D.toHtml("branch-details-template",{display_name:r.attr("data-user-display-name"),username:r.attr("data-user-name"),user_avatar:r.attr("data-user-avatar"),user_url:r.attr("data-user-url"),repo_name:r.attr("data-repo-name"),repo_avatar:r.attr("data-repo-avatar"),repo_url:r.attr("data-repo-url"),branch_name:r.attr("data-branch-name"),branch_url:r.attr("data-branch-url"),branch_state:r.attr("data-branch-state"),commit_id:r.attr("data-commit-id"),commit_url:r.attr("data-commit-url"),size:24}))),o=!0,i&&i()},{arrowOffsetX:-8,width:"auto"})}),S("#pullrequest-navigation .tabs-menu",function(e){var r=t("#pr-tab-content"),a=e.find(".menu-item"),s=!0;(new M).decorate(t(window));var l=null,v=function(){var e,c,d=a.filter(".active-tab").find("a").data("tab-link-id"),v=t("#pr-tab-content"),y=t("#pr-tab-content-wrapper"),x=t("#diff-tab-preload"),_=r.find(".pr-line-thread-ids"),k=r.find(".bb-udiff"),C=t("#compare");if(v.trigger("diff:loaded"),null===l&&(l=t("#general-comments")),"diff"===d?(e=C.attr("data-anchor"),c=C.attr("data-dest-rev"),t("#general-comments").length||l.appendTo(x)):l.detach(),v.removeClass("has-mask"),y.removeClass("diff commits activity"),y.addClass(d),location.hash){var $="#"+w(location.hash.substr(1),{isIdentifier:!0}),S=t($).parent("li.comment");if(document.getElementById(location.hash.substr(1)))S.addClass("highlight");else if("diff"===d){var D=_.data("value")||{},E=i.any(i.values(D),function(e){return i.any(i.values(e),function(e){return i.any(e,function(e){return"#comment-{}".format(e)===location.hash})})});if(E){var A=t("#pr-menu-activity"),I=location.hash,R=A.attr("href"),M=R.split("#");return M.length>1&&(M=[M.shift()]),M.push(I),A.attr("href",M.join("")).click(),void A.attr("href",R)}}}var j=C.attr("data-owner"),L=C.attr("data-slug"),N=C.attr("data-destination-owner"),O=C.attr("data-destination-slug"),U=C.data("local-id"),H=C.data("is-writer"),F=C.data("has-push-access"),I=C.attr("data-hash"),B=C.attr("data-branch"),W=C.attr("data-multiple-error");if(k.each(function(){var r,o=t(this),a=o.attr("data-filename"),s=o.attr("data-compare-files-url"),l=!!o.parent(".comment-content").length;if("diff"===d){var u=[],f=o.data("filename");_.length&&i.each(_.data("value"),function(e,t){u=i.union(u,e[f])}),r=new h(q,f,u,e,c).decorate(o)}new m(a,s).decorate(o.find(".diff-actions")),new p(o.data("expand-context-url")+encodeURI(a),o.data("identifier"),!l,r,q.toString()).decorate(o);var g=o.attr("data-path"),v=o.attr("data-source-url");n.e(1,function(e){var t=[e(737)];(function(e){new e({el:o,owner:j,slug:L,destinationOwner:N,destinationSlug:O,localID:U,isWriter:H,hasPushAccess:F,isPullRequest:!0,hash:I,branch:B,path:g,sourceUrl:v,multipleError:W})}).apply(null,t)})}),"diff"===d){var z=new b({el:t("#diff-ignore-whitespace")});z.on("toggle",function(e){var n={container:t("#pr-tab-content"),scrollTo:null,timeout:3e4},i=t("#pr-menu-diff");P.update("w",e?"1":"0");var r=P.asUrl(i.attr("href"));s=!0,i.attr("href",r),t.pjax(t.extend({url:r,replace:!0},n))}).render(),t(".comments-link").on("click",function(e){var n=t(e.target).closest("a.comments-link").data("file-path"),i=t(document.getElementById("chg-"+n)),r=i.find(".comment").find("article").first();0===r.length&&(r=i),t(window).scrollTo(r,500,{axis:"y",offset:-50}),e.preventDefault()}),t(".eclipsedcount").on("click",function(e){e.which>1||e.metaKey||e.ctrlKey||(e.preventDefault(),g(t(e.target)))});var V=t("#general-comments").find(".comment-count"),K=t("#comments-list");new u(V,K).decorate(),t("#commit-files-summary").find(".count-badge").each(function(e,n){var i=t(n),r=i.find(".count"),o=t(document.getElementById("chg-"+i.find(".comments-link").data("file-path")));new u(r,o).decorate()}),f.setupDeferredDiffMarkers(r.find(".bb-patch-unified"),!0,q),o.vent.trigger("diff:loaded")}"activity"===d&&T(r)};if(t("#diff-tab-preload").length){var y=t("#general-thread-ids"),x=t("#comments-list.line-commenting > li.new-comment");if(y.length&&d.decorateThreads(q.toString(),y.data("value")),x.length){var _=!0;new c(q,_).decorate(x)}}r.on("pjax:end",v),r.on("pjax:error",function(e,t,n){return t.readyState>0&&"abort"!==n?(r.html("<h2>Error</h2><p>We were unable to load this page.</p>"),!1):void 0}),r.on("pjax:beforeSend",function(){var e=t("#pr-tab-content-wrapper"),n=t("#pr-tab-content");n.addClass("has-mask"),s||e.removeClass("diff commits activity"),s=!1});var k={container:r,scrollTo:null,timeout:3e4},C=t("#pr-tab-info").data("active-tab-on-load"),$=t("#pr-menu-{}".format(C));if($.length){var S=$.attr("href");location.hash&&(S+=location.hash),t.support.pjax?t.pjax(t.extend({url:S,replace:!0},k)):r.load(S+"?_ajax=1",v)}t.support.pjax&&e.on("click","li a",function(n){n.which>1||n.metaKey||n.ctrlKey||n.shiftKey||n.altKey||(n.preventDefault(),e.find("li").removeClass("active-tab"),t(this).closest(".menu-item").addClass("active-tab"),r.detach().empty(),r.appendTo(t("#pr-tab-content-wrapper")),t.pjax(t.extend({url:t(this).attr("href"),push:!0},k)))})}),j.on("follow:pullrequest",".sidebar a.follow",function(e,n){var i=t(this).siblings(".aui-icon");i.toggleClass("aui-iconfont-watch",n),i.toggleClass("aui-iconfont-unwatch",!n)}),S(".issue-dialog-trigger",function(n){e.InlineDialog(n,1,function(e,n,i){return t(".issue-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:C.alignLeft()})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(149)],r=function(e,t){return{showUpdatesDialog:function(){var n,i,r=e("#edit-pullrequest"),o=r.attr("data-changed"),a=r.attr("data-newest-changeset");return o?(i=e("#pullrequest-updates-dialog, #rebase-necessitates-update"),n=e(t.toHtml("pullrequest-update-dialog-template",{mostRecent:a})),i.length?i.replaceWith(n):r.after(n),r.addClass("bb-inline-dialog-anchor"),n.on("click",".close",function(e){e.preventDefault(),n.remove(),r.removeClass("bb-inline-dialog-anchor")}),n):void 0}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(170),n(557),n(390),n(389),n(656),n(734),n(732),n(165),n(149)],r=function(e,t,n,i,r,o,a,s,l,u,c){function d(){return O.find("li").length?!1:!U.hasClass("updated")}function h(){e.ajax({url:j,data:{since:L},dataType:"json"}).done(p)}function p(e){L=e.lastModified,(e.prDetailsModified||e.anchorMoved||e.destRevMoved)&&(U.addClass("updated"),M.removeClass("hidden")),g(e.viewers),f(e),v(e),y()}function f(e){t.each(e.commentsAdded,function(e){B.push(e)}),t.each(e.commentsReplied,function(e){B.push(e)}),t.each(e.commentsEdited,function(e){var n=t.find(B,function(t){return e.comment.comment_id===t.comment.comment_id});n?B.splice(B.indexOf(n),1,e):$(e.comment)}),t.each(e.commentsDeleted,function(e){var n=t.find(B,function(t){return e.evt.reference_id===t.comment.comment_id});n?B.splice(B.indexOf(n),1):T(e.evt.reference_id)})}function m(e){e.set("last_updated_on",null),e.destroy()}function g(e){t.each(e,function(e){e.viewing=!0,q.add(e,{merge:!0})}),t.each(q.models,function(n){var i=t.find(e,function(e){return e.username===n.id});i||(n.get("comments")?n.set("viewing",!1):m(n))})}function v(e){t.each(e.approvalsRemoved,function(e){var t=e.user,n=q.get(t.username);n&&n.set("approved",!1)}),t.each(e.approvalsAdded,function(e){e.user.approved=!0,q.add(e.user,{merge:!0})}),(e.approvalsAdded.length||e.approvalsRemoved.length)&&I.trigger("approval-changed.pullrequest")}function y(){var e={};t.each(B,function(t){var n=t.user.username;e[n]=e[n]||{count:0,commentEvent:t},e[n].count++}),t.each(e,function(e,t){var n=q.get(t);if(n)n.set({comments:e.count,last_updated_on:e.commentEvent.comment.utc_last_updated});else{var i=e.commentEvent.user;i.comments=e.count,i.last_updated_on=e.commentEvent.comment.utc_last_updated,q.add(i)}}),t.each(q.models,function(t){e[t.get("username")]||(t.get("viewing")?t.set("comments",0):m(t))}),E()}function b(n){var i=t.find(B,function(e){return e.user.username===n});if(i){if(!e("#pr-tab-content-wrapper").hasClass("diff"))return void P(i.comment.comment_id);k(i.comment),B=t.reject(B,function(e){return e===i}),y()}}function w(t){return t.parent_id?x(t):t.filename?_(t):e("#comments-list")}function x(n){var i=e("#comment-"+n.parent_id);
if(!i.length){var r=t.find(B,function(e){return e.comment.comment_id===n.parent_id});if(!r){var o=e("#compare"),a=o.attr("data-anchor"),s=o.attr("data-dest-rev"),l="CompareRevisions(anchor=u'{}', destrev=u'{}')".format(a,s),u=o.find(".pr-line-thread-ids").data("value"),c=t.reject(u,function(e,t){return t===l}).reduce(function(e,t){return e.concat(t[n.filename]||[])},[]),d=t.any(c,function(e){return e===n.parent_id});return d?e('[data-filename="{}"] a.eclipsedcount'.format(n.filename)).click():P(n.comment_id),null}i=k(r.comment),B=t.reject(B,function(e){return e===r})}return i.parents(".aui-dialog").length&&e('[data-filename="{}"] a.eclipsedcount'.format(n.filename)).click(),i.siblings(".child-comments")}function _(t){var n=e("#compare");if(n.attr("data-anchor")!==t.anchor||n.attr("data-dest-rev")!==t.dest_rev)return P(t.comment_id),null;var i=e('[data-filename="{}"]'.format(t.filename)),r=i.find('[data-tnum="{line_to}"], [data-fnum="{line_from}"]'.format({line_to:t.line_to,line_from:t.line_from})),o=i.find(".heading");if((t.line_to||t.line_from)&&!r.length)return P(t.comment_id),null;var a=r.length?r.parents(".udiff-line"):o,s=a.next();return s.hasClass("comment-thread-container")||(s=e('<div class="comment-thread-container"><ol class="comments-list"></ol></div>').insertAfter(a)),s.find(".comments-list")}function k(t){var n=e("#comment-"+t.comment_id),i=w(t),a=r.prototype.parse(t),s=new r(a,{urlRoot:F.toString()}),l=new o(s);return i?("comments-list"===i.attr("id")?l.render(i.find(".new-comment"),"before"):n.length?l.decorate(n,a.filename):l.render(i),l.$elem.addClass("highlight"),l.scrollTo({onAfter:function(){l.$elem.removeClass("highlight")}}),l.$comment):null}function C(t){e.scrollTo(e("#pull-request-header"));var n=q.get(t);n&&(n.get("viewing")?n.set({approved:!1}):m(n)),E()}function $(t){var n,i=e("#comment-"+t.comment_id),r=i.find("header");r.find(".comment-deleted").length||(r.find(".comment-changed").remove(),n=e(H({edited:!0})),r.append(n),n.on("click","a",function(e){e.preventDefault(),i.find(".comment-content").html(t.content_rendered),n.remove()}))}function S(e,n){return t.each(e,function(e){n.push(e),S(e.children,n)}),n}function T(t){var n,i=e("#comment-"+t),r=i.find("header");r.find(".comment-changed").remove(),n=e(H({deleted:!0})),r.append(n),n.on("click","a",function(e){e.preventDefault(),D(t),n.remove()}),i.find(".comment-actions [href=#delete]").parent().remove()}function D(n){var i=e("#comment-"+n),r=i.parents(".child-comments").last().siblings("article, .deleted-comment-message"),a=r.length?[r.data("commentId")]:[n],s=o.decorateThreads(F.toString(),a),l=S(s,[]),u=t.find(l,function(e){return e.comment.id===n}),c=u.$elem.parents(".comment-thread-container");u.scrollTo({onAfter:function(){u.removeComment(),c.find("li.comment").length||c.remove()}})}function P(t){t?(B=[],y(),e("#pr-menu-activity").click(),I.one("pjax:end",function(){var n=e("#comment-"+t).parent(".comment");window.location.hash="comment-"+t,n.addClass("highlight"),n.one("transitionend webkitTransitionEnd",function(){n.removeClass("highlight")})})):window.location.reload(!0)}function E(){var e=U.hasClass("updated"),t=e?1:0;t=q.reduce(function(e,t){var n=t.get("comments");return e+=n,t.get("approved")?e+1:e},t),t>0?document.title="({}) {}".format(t,N):document.title=N}var A=function(t,n){function i(){return(new Date).getTime()-c<u.inactivity}function r(){i()||(h=0,a()),c=(new Date).getTime()}function o(e){return Math.min(i()?u.min:e*u.multiplier,u.max)}function a(){d&&clearTimeout(d),d=setTimeout(function(){t(),a()},h=o(h))}var s=1e3,l=60*s,u=e.extend({min:20*s,max:60*l,multiplier:1.25,inactivity:5*l},n),c=(new Date).getTime(),d=null,h=0;return e(window).focus(r),e("body").click(r),{start:function(){a()},stop:function(){clearTimeout(d),d=null}}},I=e(document),R=e("#pullrequest"),M=e("#pr-toolbar"),j=R.attr("data-updates-url"),L=R.attr("data-last-updated"),N=document.title,O=R.find(".qr-notice"),U=O.find(".pr-update-notice"),H=t.partial(c.toHtml,"comment-changed-template"),F=u.concat("repositories",n.owner.username,n.slug,"pullrequests",i.localId,"comments"),q=new a([],{noun:"pull request"}),B=[],W=new s({el:O.find("ol"),collection:q,auiAvatarSize:"medium"}).render();if(W.on("render-user-comment",b),W.on("show-approvals",C),q.on("add",function(){M.removeClass("hidden")}),q.on("destroy",function(){M.toggleClass("hidden",d())}),U.on("click","a",function(e){e.preventDefault(),P()}),j&&L){var z=new A(h);z.start(),h()}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(661),n(735)],r=function(e,t){return e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.collection.bind("add",this.addParticipant,this),this.collection.bind("add",this.toggleEmptyClass,this),this.collection.bind("destroy",this.toggleEmptyClass,this)},addParticipant:function(e){var n=new t({model:e,noun:this.collection.noun,auiAvatarSize:this.auiAvatarSize}).render();this.$el.append(n.$el),n.on("render-next-comment",this.renderUserComment,this),n.on("show-approvals",this.showApprovals,this)},toggleEmptyClass:function(){this.$el.toggleClass("empty",!this.collection.length)},renderUserComment:function(e){this.trigger("render-user-comment",e)},showApprovals:function(e){this.trigger("show-approvals",e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(149)],r=function(e,t){return e.View.extend({tagName:"li",events:{click:"renderNextComment"},initialize:function(e){this.noun=e.noun,this.auiAvatarSize=e.auiAvatarSize,this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},render:function(){var e=this.model.toJSON();return e.size=this.auiAvatarSize||"medium",this.$el.html(t.toHtml("participant-liveupdate-template",e)),this},renderNextComment:function(e){e.preventDefault(),this.model.get("comments")?this.trigger("render-next-comment",this.model.id):this.model.get("approved")&&this.trigger("show-approvals",this.model.id)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(2),n(368)],r=function(e,t,n,i){t(document).on("click",".js-quick-update-pr",function(r){r.preventDefault();var o=t(".js-quick-update-pr"),a=o.attr("href");if(!o.hasClass("loading")){o.addClass("loading");var s=function(i){var r=t("<div></div>"),a="An error occurred while updating.",s="Try refreshing this page or editing the pull request directly.";i&&(t.isArray(i)&&i.length?(n.each(i,function(e){t("<p></p>").text(e).appendTo(r)}),s=r.html()):(a=i,s=null)),e.messages.error({title:a,body:s}),o.removeClass("loading")};t.ajax({type:"POST",url:a,data:{_quick_update:1},dataType:"json",error:function(){s()},success:function(e){e.errors?s(e.errors):e.result?window.location=e.result:setTimeout(function(){i(e.url).fail(s)},1e3)}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(2),n(502),n(501),n(499),n(500),n(741),n(164),n(183),n(725),n(149)],r=function(e,t,n,i,r,o,a,s,l,u,c,d,h){return t.View.extend({template:"commit-form-template",events:{"keyup #id_path":"checkPath","click #id_create-pullrequest":"createPullRequestHandler","focusout #id_branch-name":"slugifyBranchName","click .create-pull-request-link":"createPullRequest","submit .commit-form":"commitChanges","click .commit-button":"commitChanges","click .cancel-link":"hide"},initialize:function(e){i.bindAll(this,"createPullRequestHandler","slugifyBranchName","createPullRequest","commitChanges","hide","updateCreatePRCheckbox");var r=new c({width:700,height:"auto",id:"commit-form"}),o=n(h.toHtml(this.template,{}));r.addHeader(o.attr("data-title")),r.addPanel("main","","commit-form-body"),r.addButton(o.attr("data-cta-label"),null,"commit-button"),r.addLink(o.attr("data-cancel-label"),null,"cancel-link"),this.dialog=r,this.setElement(r.popup.element[0]),this.$commitFormBody=this.$(".commit-form-body"),this.$cancelLinkTemplate=this.$(".cancel-link").clone(),this.$cancelPlaceholderTemplate=n('<span class="cancel-placeholder" />').text(this.$cancelLinkTemplate.text()),this.originalRepository=e.repository,this.destinationRepository=e.destinationRepository,this.localID=e.localID,this.isDelete=e.isDelete,this.isCreate=e.isCreate,this.isRename=e.isRename,this.isWriter=e.isWriter,this.hasPushAccess=e.hasPushAccess,this.isPullRequest=e.isPullRequest,this.originalHash=e.hash,this.originalBranch=e.branch,this.originalPath=e.path,this.sourceUrl=e.sourceUrl,this.state=new t.Model,this.state.on("change:createPullRequest",this.updateCreatePRCheckbox)},render:function(){var e={owner:this.originalRepository.get("owner").get("username"),slug:this.originalRepository.get("slug"),path:this.originalPath,filename:this.originalPath.split("/").pop(),isCreate:this.isCreate,isDelete:this.isDelete,isRename:this.isRename,isWriter:this.isWriter,hasPushAccess:this.hasPushAccess,isPullRequest:this.isPullRequest};this.$commitFormBody.html(h.toHtml(this.template,e)),this.$error=this.$(".aui-message.error"),this.$info=this.$(".aui-message.info"),this.$path=this.$("#id_path"),this.$prFields=this.$("#pr-fields"),this.$commitButton=this.$(".commit-button");var t=this.$(".commit-form");return this.defaultMessage=t.attr("data-default-message"),this.forkError=t.attr("data-fork-error"),this.commitError=t.attr("data-commit-error"),this.pullRequestError=t.attr("data-pull-request-error"),this.updateError=t.attr("data-update-error"),this.branchConflictError=t.attr("data-branch-conflict-error"),this.forkingMessage=t.attr("data-forking-message"),this.committingMessage=t.attr("data-committing-message"),this.mergingMessage=t.attr("data-merging-message"),this.creatingPRMessage=t.attr("data-creating-pr-message"),this.updatingPRMessage=t.attr("data-updating-pr-message"),this.$commitButton.addClass("aui-button"),this.$("#id_message").val(this.defaultMessage),this.$message||(n('<div class="message" />').prependTo(this.$(".dialog-button-panel")),this.$message=this.$(".dialog-button-panel").find(".message")),this.state.set({autocompleteInitialized:!1,createPullRequest:!this.isWriter||!this.hasPushAccess}),this.updateCreatePRCheckbox(this.state,this.state.get("createPullRequest")),this},getPath:function(){return this.$path.val()&&this.$path.val().trim()||this.originalPath},getMessage:function(){return this.$("#id_message").val()||this.defaultMessage},getCommit:function(){var e=new o({repository:this.originalRepository,parents:[this.originalHash],branch:new r({repository:this.originalRepository,name:this.originalBranch})});return this.isRename?(e.addFile({path:this.originalPath,content:null}),e.addFile({path:this.getPath(),content:this.content})):e.addFile({path:this.originalPath,content:this.content}),e},getPullRequest:function(){var e=this.getMessage(),t=this.commit.get("repository").id!==this.originalRepository.id?!1:!0;return new a({source:new s({repository:this.commit.get("repository"),branch:this.commit.get("branch")}),destination:new s({repository:this.originalRepository,branch:new r({repository:this.originalRepository,name:this.originalBranch})}),title:e.split("\n")[0],description:e,close_source_branch:t})},setContent:function(e){return this.content=e,this},generateBranchName:function(){return"{}/{}".format(u.username,this.getMessage().replace(/[^\w\s]/g,"").substring(0,40).replace(/\s+/g,"-").toLowerCase()+"-"+Date.now())},slugify:function(e){return e.replace(/[^\w\s/-]/g,"").replace(/\s+/g,"-")},slugifyBranchName:function(e){var t=n(e.target);t.val(this.slugify(t.val()))},redirect:function(e){var t=e.html.href;n(window).off(".editor"),window.location=t},commit:function(){var e=function(){this.isWriter?this.saveCommit(t):this.forkAndCommit(t)}.bind(this),t=this.getCommit();if(this.disable(),t.set({message:this.getMessage()}),this.state.get("createPullRequest")){var n=this.$("#id_branch-name").val();t.setBranch(n||this.generateBranchName()),t.get("branch").fetch().fail(e.bind(this)).done(function(){this.enable().showError(this.branchConflictError)}.bind(this))}else e()},saveCommit:function(e){this.showMessage(this.committingMessage),e.save(null,{success:function(t,n,i){this.commit=e,this.state.get("createPullRequest")?this.createPullRequest():this.isPullRequest?this.updatePullRequest():this.redirect(e.get("links"))}.bind(this),error:function(t,n,i){this.state.get("createPullRequest")||409!==n.status?this.showError(this.commitError).enable():this.branchAndMerge(e)}.bind(this)})},updatePullRequest:function(){this.showMessage(this.updatingPRMessage);var e=this.getPullRequest();e.set({local_id:this.localID}),e.get("destination").set({repository:this.destinationRepository}),e.updateRef().done(function(e){n(window).off(".editor"),window.location=e}).fail(function(){this.hide(),this.showError(this.updateError)}.bind(this))},forkAndCommit:function(e){this.showMessage(this.forkingMessage),this.originalRepository.fork().done(function(t){e.set({repository:t}),this.saveCommit(e)}.bind(this)).fail(function(){this.showError(this.forkError).enable()}.bind(this))},branchAndMerge:function(e){this.showMessage(this.mergingMessage),e.setBranch(this.generateBranchName()).save(null,{success:function(t,n,i){this.commit=e;var r={hash:e.get("hash").slice(0,13),branch:this.originalBranch,message:e.get("message")},o=h.toHtml("merge-message-template",r);this.commit.merge(this.originalBranch,o).done(function(e){this.isPullRequest?this.updatePullRequest():this.redirect(e.links)}.bind(this)).fail(function(){this.showError(new l({repository:this.originalRepository,commit:this.commit,path:this.originalPath}).render().$el.html()),this.$commitButton.removeClass("loading")}.bind(this))}.bind(this),error:function(e,t,n){this.showError(this.commitError).enable()}.bind(this)})},createPullRequest:function(e){e&&(e.preventDefault(),this.enable(),this.$("#id_create-pullrequest").prop("checked",!0),this.disable()),this.showMessage(this.creatingPRMessage);var t=this.getPullRequest();t.set({reviewers:this.$("#reviewers").val().split(",")}),t.save(null,{success:function(e,t,n){this.redirect(e.get("links"))}.bind(this),error:function(e,t,n){this.showError(this.pullRequestError).enable()}.bind(this)})},disable:function(e){return this.disabled=!0,this.$commitButton.addClass("loading"),e?this.$commitButton.attr({disabled:"disabled","aria-disabled":!0}):(this.$(":input").attr({disabled:"disabled","aria-disabled":!0}),this.$(".cancel-link").replaceWith(this.$cancelPlaceholderTemplate.clone())),this},enable:function(){return this.disabled=!1,this.$commitButton.removeClass("loading"),this.$(":input").removeAttr("disabled aria-disabled"),this.$(".cancel-placeholder").replaceWith(this.$cancelLinkTemplate.clone()),this},showError:function(e){return this.hideMessage().$error.removeClass("hidden").find(".message").html(e),this},hideError:function(){return this.$error.addClass("hidden"),this},showMessage:function(e){return this.$message.stop().fadeOut(200,function(){this.$message.html("{}&hellip;".format(e)),this.$message.fadeIn(200)}.bind(this)),this},hideMessage:function(){return this.$message.stop().hide(),this},updateCreatePRCheckbox:function(e,t){this.$("#id_create-pullrequest").prop("checked",t),this.$prFields&&this.$prFields.length&&(t?(this.$prFields.slideDown(200).find("#id_branch-name").val(this.generateBranchName()),this.isPullRequest||this.state.get("autocompleteInitialized")||i.defer(function(){d(this.$("#reviewers-group")),this.state.set({autocompleteInitialized:!0})}.bind(this))):this.$prFields.slideUp(200))},createPullRequestHandler:function(e){this.state.set({createPullRequest:n(e.target).is(":checked")})},commitChanges:function(e){e&&e.preventDefault(),this.disabled||this.commit()},show:function(e){e&&e.preventDefault(),this.render().checkPath(),this.dialog.show()},hide:function(e){e&&e.preventDefault(),this.dialog.hide()},checkPath:i.debounce(function(e){if(this.isRename){this.$("#path-error").remove(),this.disable(!0);var t=this.$path.val().trim();if(t===this.originalPath)return void this.$commitButton.removeClass("loading");if(""===t)return n('<span class="error" id="path-error">You must specify a path.</span>').insertAfter(this.$path),void this.$commitButton.removeClass("loading");var i=this.sourceUrl.slice(0,this.sourceUrl.lastIndexOf("/")+1);n.get(i+t).always(function(e,t){"success"===t?(n('<span class="error" id="path-error">A file with this name already exists.</span>').insertAfter(this.$path),this.$commitButton.removeClass("loading")):this.enable()}.bind(this))}},100)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(2),n(149)],r=function(e,t,n,i){return e.View.extend({template:"commit-merge-error-template",initialize:function(e){n.bindAll(this,"render"),this.repository=e.repository,this.commit=e.commit,this.path=e.path},render:function(){var e={owner:this.repository.get("owner").get("username"),slug:this.repository.get("slug"),hash:this.commit.get("hash"),path:this.path,branch:this.commit.get("branch").get("name"),encodedBranch:encodeURIComponent(this.commit.get("branch").get("name"))};return this.$el.html(i.toHtml(this.template,e)),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(){function t(e){e.closest("div.radio").prevAll().addClass("apply")}var n=e("#qseries form"),i=n.find("div.radio input");i.change(function(){var n=e(this);e("div.radio").removeClass("apply"),n.is(":checked")&&t(n)}),t(i.filter(":checked"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(867),n(868),n(875)],r=function(e,t,n,i,r){return t(function(){var t=e("#repo-share-link"),o=!!t.attr("data-team-name"),a=new n({id:"share-repo",trigger:t}),s=[new i],l=e("a.share");o&&s.unshift(new r({name:t.attr("data-team-name"),display:t.attr("data-team-display"),avatar:t.attr("data-team-avatar"),manageUrl:t.attr("data-team-manage-link")})),l.on("click",function(e){e.preventDefault(),a.show()}).on("mouseover.share-dialog",function(){a.renderPanels(s),l.off("mouseover.share-dialog")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(3),n(183),n(149)],r=function(e,t,n,i,r){return t.View.extend({className:"share-dialog",template:"share-dialog-template",events:{tabSelect:"onChangeTab"},initialize:function(e){this.shareButtonText=e.shareButtonText||gettext("Share"),this.trigger=e.trigger},dialogId:function(){return this.id+"-dialog"},createDialog:function(){this.dialog=new i({width:600,height:"auto",id:this.dialogId(),closeOnOutsideClick:!0}),this.dialog.addHeader(gettext("Share")).addPanel(gettext("Share"),this.$el,"panel-body").addLink(gettext("Manage this team"),null,"share-manage-link left").addButton(this.shareButtonText,this.onShare.bind(this),"aui-button aui-style").addCancel(gettext("Cancel"),this.onCancel.bind(this)),this.$share=n(this.dialog.page[0].button[1].item[0]),this.$manage=n(this.dialog.page[0].button[0].item[0])},renderPanels:function(e){return this.panels=e,this.panels.forEach(function(e){e.on("sending",function(){this.enableDialog(!1)},this),e.on("success",function(){this.enableDialog(!0),this.dialog.hide()},this),e.on("error",function(){this.enableDialog(!0)},this)}.bind(this)),this.render()},render:function(){if(!this.panels)throw new Error("panels must be set before rendering");this.dialog||this.createDialog(),this.dialog.popup.element.toggleClass("has-tabs",this.panels.length>1),n(this.trigger).attr("aria-controls",this.dialogId());var t=this.panels[0];if(1===this.panels.length)return this.$el.html(t.render().el),this.setPanel(t),this;var i=this.dialog,o=this.panels.map(function(e){return n.extend(e,{tabId:"{}-{}".format(i.id,e.display)})});return this.$el.html(r.toHtml(this.template,{panels:o})),this.panels.forEach(function(e){this.$("#{}-{}".format(i.id,e.display)).append(e.render().el)}.bind(this)),this.$(".tabs-pane:first").addClass("active-pane"),this.$(".menu-item:first").addClass("active-tab"),e.tabs.setup(),this.setPanel(t),this},enableDialog:function(e){this.$share.prop("disabled",!e)},onShare:function(){this.activePanel.share()},onCancel:function(){this.dialog.hide()},onChangeTab:function(e,t){var n=t.pane.selector.slice(1);this.panels.forEach(function(e){e.tabId===n&&this.setPanel(e)}.bind(this))},setPanel:function(e){this.activePanel=e,this.dialog.addHeader(e.action),this.$manage.attr("href",e.getManageLink()),this.$manage.text(e.manageText)},show:function(){this.dialog.show()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2),n(869),n(149)],r=function(e,t,n,i){return e.View.extend({className:"share-panel-repo",display:gettext("Repository"),action:gettext("Share"),manageText:gettext("Manage this repository"),template:"share-repo-template",render:function(){return this.$el.html(i.toHtml(this.template)),this.form=new n({el:this.$(".share-form")}).render(),this.form.on("all",function(e,t){this.trigger(e,t)},this),this},share:function(){this.form.send()},getManageLink:function(){return this.$(".manage-repo-link").attr("data-manage-link")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(870),n(872),n(170),n(147)],r=function(e,t,n,i,r){return n.extend({initialize:function(e){this.DetailView=t,this.modelSkeleton={permission:"read"},this.shareType="repo",n.prototype.initialize.call(this,e)},add:function(e){var t=this.$userOrEmail.val();if(i.owner&&t===i.owner.username||i.creator&&t===i.creator.username){var r=gettext('User "%(user_or_email)s" already has access to this repository');return this.showError(interpolate(r,{user_or_email:t},!0)),!1}n.prototype.add.call(this,e)},send:function(){this.on("success",function(){r(["atl._trackEvent","Share","Share repo"]),e.messages.success({body:gettext("You have successfully shared this repository"),fadeout:!0})}),n.prototype.send.call(this)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(871),n(149)],r=function(e,t,n,i){return n.extend({events:{"click .permission":"setPermission"},initialize:function(){n.prototype.initialize.call(this),t.bindAll(this,"setPermission")},render:function(){var e=this.model.toJSON();return e[this.model.get("permission")]=!0,this.$el.html(i.toHtml(this.template,e)),this},setPermission:function(t){this.model.set({permission:e(t.target).data("permission")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(2)],r=function(e,t){var n=e.View.extend({tagName:"tr",template:"share-detail-template",events:{"click .delete":"destroyModel"},initialize:function(e){this.events&&(this.events=t.defaults(this.events,n.prototype.events)),this.delegateEvents(this.events),t.bindAll(this,"render","remove"),this.model.on("change",this.render),this.model.on("destroy",this.remove)},destroyModel:function(e){e.preventDefault(),this.model.destroy()},remove:function(){this.$el.remove()}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(1),n(187),n(3),n(2),n(873),n(874),n(147),n(149),n(328)],r=function(e,t,n,i,r,o,a,s,l,u){return t.View.extend({template:"share-form-template",events:{"submit form":"add","keyup .user-or-email":"toggleAddButton"},initialize:function(e){r.bindAll(this,"render","renderShare","toggleAddButton","hideError","showError","add","send"),this.groups=e.groups,this.collection=new a,this.collection.on("add",this.renderShare),this.collection.on("reset",this.render),this.errors=[],this.on("send",this.send)},render:function(){var e={disabled:this.disabled};return this.$el.html(l.toHtml(this.template,e)),this.$error=this.$(".error"),this.$userOrEmail=this.$(".user-or-email"),this.$addButton=this.$("button"),this.collection.each(function(e){this.renderShare(e)}.bind(this)),this},renderShare:function(e){var t=new this.DetailView({groups:this.groups,hasCustomGroups:this.hasCustomGroups,model:e});this.$("tbody").append(t.render().el)},toggleAddButton:function(){""!==this.$userOrEmail.val()?this.$addButton.removeAttr("disabled"):this.$addButton.attr("disabled","disabled")},hideError:function(){this.$error.addClass("hidden")},isValid:function(){return!0},getFormError:function(){return this.errors.length?this.errors.pop():gettext("An unknown error occurred")},showError:function(e,t){var n=t?"html":"text";this.$error.find(".message")[n](e).end().removeClass("hidden")},add:function(e){e.preventDefault();var t=this.$userOrEmail.val(),i=r.clone(this.modelSkeleton),a=function(){this.hideError(),this.$userOrEmail.val(""),this.collection.add(new o(i))}.bind(this);return t?void(u.email(t)?(i.email=t,a()):n.user(t).details(function(e){i=r.extend(i,{username:e.username,displayName:e.display_name,avatar:e.avatar,bbUserObject:e}),this.isValid(e)?a():this.showError(this.getFormError())}.bind(this)).error(function(){var e=gettext('User "%(user_or_email)s" does not exist.');this.showError(interpolate(e,{user_or_email:t},!0))}.bind(this))):!1},send:function(){if(0===this.collection.length)return this.showError(gettext("Add a user or email address.")),!1;this.trigger("sending"),this.disabled=!0,this.render();var e=this.collection.length,t=e,n="repo"===this.shareType?"Repo Share":"Team Share";this.collection.each(function(e){var t=e.get("username")?"Existing User":"New User";s(["atl._trackEvent","Share",n,t]),e.save()}),this.collection.on("save",function(n){--e,n.get("error")||n.destroy(),0>=e&&(this.collection.length?(this.trigger("error"),this.disabled=!1,this.render(),this.showError(n.get("error")),this.off("success")):(this.disabled=!1,this.render(),this.trigger("success",{inviteCount:t})))}.bind(this))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(187),n(3),n(170),n(164),n(165)],r=function(e,t,n,i,r,o){return e.Model.extend({initialize:function(e){this.teamName=e.teamName||i.owner.username},save:function(){var e;if(this.get("email")){if(this.get("permission"))e=t.send_invitation(this.get("email"),this.get("permission"),i.toString());else if(this.get("group")){var a=t.user(this.teamName),s=a.username+"/"+this.get("group");e=a.invite(this.get("email"),s)}}else this.get("username")&&(this.get("permission")?e=n.ajax({url:o.concat("privileges",i.owner.username,i.slug,this.get("username")),type:"PUT",data:this.get("permission"),dataType:"json"}):this.get("group")&&(e=n.ajax({url:o.concat("groups",this.teamName,this.get("group"),"members",this.get("username")),type:"PUT",data:JSON.stringify(this.get("bbUserObject")),dataType:"json"})));e.error(function(e){if(500===e.status)this.set({error:gettext("There was a problem processing your request.")});else if(402===e.status){var t=n.parseJSON(e.responseText).data;if(t.user.username===r.username)this.set({error:gettext("You are already at your plan limit and will need to upgrade your plan before adding more users.")});else{var i=gettext("This account (%(username)s) is at its plan limit and will need to be upgraded before adding more users.");this.set({error:interpolate(i,{username:t.user.username},!0)})}}else 409!==e.status&&this.set({error:e.responseText})}.bind(this)).complete(function(){this.trigger("save",this)}.bind(this))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(873)],r=function(e,t){return e.Collection.extend({model:t,add:function(t){var n=this.any(function(e){return t.get("username")?t.get("username")===e.get("username"):t.get("email")?t.get("email")===e.get("email"):void 0});return n?!1:void e.Collection.prototype.add.call(this,t)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(1),n(2),n(876),n(165),n(149),n(212)],r=function(e,t,n,i,r,o){return t.View.extend({className:"share-panel-team maskable",display:gettext("Team"),action:gettext("Invite"),manageText:gettext("Manage this team"),template:"share-team-template",initialize:function(e){this.teamName=e.name,this.teamDisplay=e.display,this.teamAvatar=e.avatar,this.manageUrl=e.manageUrl},render:function(){return this.loadGroupsDeferred=this.loadGroupsDeferred||e.ajax({url:r.concat("groups",this.teamName),dataType:"json"}),this.$el.loading(this.loadGroupsDeferred,{mask:!0}).done(function(e){this.$el.html(o.toHtml(this.template,{display_name:this.teamDisplay,avatar:this.teamAvatar})),this.form=new i({el:this.$(".share-form"),groups:this.filterGroups(e),teamName:this.teamName}).render(),this.form.on("all",function(e,t){this.trigger(e,t)},this)}.bind(this)),this},filterGroups:function(e){return e},share:function(){this.form.send()},getManageLink:function(){return this.manageUrl}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(2),n(877),n(872),n(147),n(164)],r=function(e,t,n,i,r,o){return i.extend({initialize:function(e){this.DetailView=n,this.modelSkeleton={group:e.groups.length?e.groups[0].slug:"developers",teamName:e.teamName},this.shareType="team",this.hasCustomGroups=function(){if(2===e.groups.length){var n=!1,i=!1;if(t.each(e.groups,function(e){"Administrators"===e.name&&"admin"===e.permission?n=!0:"Developers"===e.name&&"write"===e.permission&&(i=!0)}),n&&i)return!1}return!0}.bind(this)(),i.prototype.initialize.call(this,e)},isValid:function(e){return e.username===this.modelSkeleton.teamName?(this.errors.push(gettext("You cannot invite a team to join itself.")),!1):e.username===o.username?(this.errors.push(gettext("You cannot invite yourself.")),!1):e.is_team?(this.errors.push(gettext("You cannot invite another team.")),!1):!0},send:function(){this.on("success",function(){r(["atl._trackEvent","Share","Share team"]),e.messages.success({body:gettext("You have successfully shared this team")})}),i.prototype.send.call(this)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(871),n(149)],r=function(e,t,n){return t.extend({events:{"click .admin":"toggleAdmin","change .group":"setGroup"},initialize:function(n){t.prototype.initialize.call(this,n),this.groups=n.groups,this.hasCustomGroups=n.hasCustomGroups,e.bindAll(this,"toggleAdmin","setGroup")},render:function(){var t=this.model.toJSON();return t.hasCustomGroups=this.hasCustomGroups,this.hasCustomGroups&&(t.groups=e.map(this.groups,function(e){return{name:e.name,slug:e.slug,isSelected:e.slug===this.model.get("group")}}.bind(this)),t.noGroupChoices=t.groups.length<=1),t.isAdmin="administrators"===this.model.get("group"),this.$el.html(n.toHtml(this.template,t)),this},toggleAdmin:function(e){var t=this.$(".admin").is(":checked")?"administrators":"developers";this.setGroup(null,t)},setGroup:function(e,t){this.model.set({group:t?t:this.$(".group").val()})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3),n(145),n(2),n(149),n(306),n(185),n(158)],r=function(e,t,i,r,o,a,s){return i(function(){n.e(1,function(n){var i=[n(751),n(739)];(function(n,i){var s=t("#editor-container"),l=s.attr("data-owner"),u=s.attr("data-slug"),c=s.data("is-writer"),d=s.data("has-push-access"),h=s.attr("data-hash"),p=s.attr("data-branch"),f=s.attr("data-path"),m=s.attr("data-source-url"),g=t(o.toHtml("edit-form-template",{owner:l,slug:u,isCreate:!0,isWriter:c,hasPushAccess:d,hash:h,branch:p,path:f,encodedPath:encodeURIComponent(this.path),content:"",syntaxes:r.sortBy(n,function(e){return e.name.toLowerCase()})})).appendTo(s),v=new i({el:g,source:"",isParentValid:function(){return t("#filename").val().trim()}}),y=new e.Collection,b=e.View.extend({id:"path",events:{"keydown #filename":"keydownHandler","keyup #filename":"keyupHandler"},initialize:function(e){this.editForm=e.editForm,this.initialPath=e.initialPath,this.sourceUrl=e.sourceUrl},render:function(){var e=this.collection;return this.$(".path-part").each(function(){e.add({path:t(this).text()})}),new w({el:this.$(".path-parts"),collection:this.collection}),this.$filename=this.$("#filename"),this.$filename.focus(),(this.collection.length||a.get("filename"))&&this.editForm.on("ready",this.updatePath.bind(this)),this},getFilename:function(){return this.$filename.val().trim()},setFilename:function(e){this.$filename.val(e)},getFullPath:function(){
var e=this.collection.pluck("path");return e.push(this.getFilename()),this.initialPath+e.join("/")},keydownHandler:function(e){this.checkForSlash(e),this.checkForDelete(e)},keyupHandler:function(e){this.updatePath()},checkForSlash:function(e){if(191===e.keyCode){e.preventDefault();var t=this.getFilename();t&&(this.collection.add({path:t}),this.setFilename(""))}},checkForDelete:function(e){if(8===e.keyCode&&!this.getFilename()){var t=this.collection.pop();t&&(e.preventDefault(),this.setFilename(t.get("path")))}},updatePath:function(){var e=this.getFullPath();this.updateEditorPath(e),this.editForm.setCommitEnabled(!0),e&&this.getFilename()?this.checkForPathExistence(e):(this.$("#duplicate-file-error").remove(),this.editForm.setCommitEnabled(!1))},updateEditorPath:function(e){return this.editForm.setPath(e),this.editForm.updatePathBasedSyntax(e),this},checkForPathExistence:r.debounce(function(e){t.ajax({url:this.sourceUrl+e,type:"GET"}).always(function(e,n){if(this.$("#duplicate-file-error").remove(),"success"===n){var i=gettext("A file with this name already exists.");t('<span class="error" id="duplicate-file-error"/>').text(i).insertAfter(this.$filename),this.editForm.setCommitEnabled(!1)}}.bind(this))},100)}),w=e.View.extend({tagName:"ul",className:"path-parts",initialize:function(e){this.collection=e.collection,this.collection.on("add remove",this.render.bind(this))},render:function(){return this.$el.empty().append(this.collection.map(function(e){return new x({model:e}).render().el})),this}}),x=e.View.extend({tagName:"li",className:"path-part",render:function(){return this.$el.text(this.model.get("path")),this}});new b({el:t("#path"),collection:y,editForm:v,initialPath:f,sourceUrl:m}).render(),v.on("ready",function(){s.removeClass("has-mask")})}).apply(null,i)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(490),n(740),n(147)],r=function(e,t,n,i,r){return t(function(){e("#editor-container").find(".delete-link").click(function(){var t=e("#editor-container"),o=n.load("{}/{}".format(t.attr("data-owner"),t.attr("data-slug"))),a=t.attr("data-hash"),s=(t.attr("data-branch"),t.data("is-writer")),l=t.data("has-push-access"),u=t.attr("data-path"),c=new i({repository:o,isDelete:!0,isWriter:s,hasPushAccess:l,hash:a,branch:t.attr("data-branch"),path:u});c.show(),r(["atl._trackEvent","Online editing","Delete file"])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(881),n(158)],r=function(e,t,n){return t(function(){function t(){var t=i.getSelectedChangeset(),n=r.getSelectedChangeset();return t.startsWith(n)||n.startsWith(t)?(l.removeClass("hidden"),l.find(".message").text("You cannot diff the same commit."),!1):(l.text(""),e.pjax({container:"#source-container",url:window.location.pathname,data:{diff1:t,diff2:n,at:u||""},success:function(t){e("#source-container").html(t)}}),!0)}var i,r,o=e("#source-diff"),a=o.find("#diff1-history-trigger"),s=o.find("#diff2-history-trigger"),l=o.find(".error"),u=o.data("at");i=n(a,"diff-dialog-diff1",{onSelect:t}),i.init(),r=n(s,"diff-dialog-diff2",{onSelect:t}),r.init()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(170),n(165),n(167),n(149),n(512)],r=function(e,t,n,i,r,o,a){return function(s,l,u){function c(){C||$||(C=!0,m.addClass("loading"),t.ajax({url:_,data:{page:k},dataType:"json",success:function(e){var n,i=e.changesets?e.changesets:e;if(!i.length){var a=u.noMoreText||gettext("No more commits");return n=t('<li class="end"></li>').text(a),$=!0,m.removeClass("loading"),void m.append(n)}for(var s=0,l=i.length;l>s;s++){var c=i[s];c.selected=w&&(w.startsWith(c.node)||c.node.startsWith(w)),c.path=b,n=t("<li></li>").html(o.toHtml("source-changeset",c)),g.before(n),k++}m.removeClass("loading"),r()},error:function(t,n){var i;i=S[t.status]?S[t.status]:n,f.hide(),m.remove(),m=null,e.messages.error({body:"{!esc}".format(i)})},complete:function(){C=!1}}))}function d(e,n,i){return m&&m.length?void(i&&i()):(m=t("<ul></ul>").addClass("file-history-widget"),g=t("<li></li>").addClass("loading-item"),m.append(g),e.append(m),c(),m.scroll(function(){m[0].scrollHeight-m.scrollTop()<=m.outerHeight()&&c()}),m.on("click","a",function(e){if(u.onSelect){var n=t(e.target).closest("a"),i=n.attr("data-hash"),a=w;if(e.preventDefault(),n.hasClass("highlight"))return;w=i;var s=u.onSelect(n);if(s){var l={hash:i.substring(0,7),utctimestamp:n.find("time").attr("datetime"),avatar:n.find("img").attr("src"),display_name:n.find("author").text()};m.find(".highlight").removeClass("highlight"),n.addClass("highlight"),v.html(t(o.toHtml("source-changeset-trigger",l))),r()}else w=a}f.hide()}),void(i&&i()))}function h(){f=e.InlineDialog(v,l,d,{initCallback:function(){this.show(),setTimeout(function(){a.mask(g,{spinner:a.spinnerSizes.TINY,background:"transparent"})},x)},hideCallback:function(){a.unmask(g,{spinner:a.spinnerSizes.TINY,background:"transparent"})},showDelay:x})}function p(){return w}u=u||{};var f,m,g,v=t(s),y=v.data("changeset"),b=v.data("path"),w=v.data("current"),x=0,_=u.url||i.concat("repositories",n.owner.username,n.slug,"filehistory",y)+b,k=0,C=!1,$=!1,S={500:gettext("An error occurred while processing your request."),404:gettext("Unable to find changesets for this file.")};return{init:h,getSelectedChangeset:p}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145)],r=function(e,t){return t(function(){var t=e("#editor-container"),i=t.data("owner"),r=t.data("slug"),o=t.data("is-writer"),a=t.data("has-push-access"),s=t.data("hash"),l=t.data("branch"),u=t.data("path"),c=t.data("source-url"),d=t.data("create-file");n.e(1,function(e){var n=[e(883)];(function(e){new e({el:t,owner:i,slug:r,isWriter:o,hasPushAccess:a,hash:s,branch:l,path:u,sourceUrl:c,createFile:d})}).apply(null,n)})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i,r;i=[n(3),n(2),n(145)],r=function(e,t,n){return n(function(n){function i(){if(h)return void(h=!1);l();var e=window.location.hash;if(e){var t=e.match(/\-\d+(?::\d+)?(?:,\d+(?::\d+)?)*$/);if(t){var n=o(t[0].substring(1));n.forEach(function(e){a(e)})}}}function r(t){t.preventDefault();var n=e(t.target),i=n.attr("href").match(/-(\d+)$/);if(i){var r=Number(i[1]),o={};t.shiftKey?(o.start=Math.min(u?u.start:1/0,r),o.end=Math.max(u?u.end:-(1/0),r)):(t.metaKey||t.ctrlKey||l(),o.start=o.end=r),a(o,t.shiftKey),s()}}function o(e){return e.split(",").map(function(e){var t=e.split(":").map(Number);return{start:t[0],end:t[1]||t[0]}})}function a(e,t){for(var i,r=e.start;r<=e.end&&(i=n.find('a[name="'+c+"-"+r+'"]'),i.length);r++)i.addClass("highlighted");t&&d.length>0?d[d.length-1]=e:d.push(e),u=e}function s(){var e=d.map(function(e){return e.start===e.end?e.start:e.start+":"+e.end});h=!0,window.location.hash=c+"-"+e.join(",")}function l(){n.find("a.highlighted").removeClass("highlighted"),d=[],lastLineHighlighted=null}var u,c=t.last(window.location.pathname.split("/")),d=[],h=!1;i(),e(window).on("hashchange",i),n.on("click",".linenodiv a",r)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(668),n(886),n(325),n(147),n(167),n(149),n(185),n(679),n(701),n(878),n(879),n(880),n(882),n(887),n(888),n(889),n(325),n(147),n(167),n(149),n(185)],r=function(e,t,n,i,r,o,a,s,l,u){return n(function(){var e=t(document),n=t("#source-container");u("#new-file-button",function(e){e.on("click",function(e){a(["atl._trackEvent","Online editing","New file"])})});var o={container:"#source-container",timeout:5e3};n.pjax(".pjax-trigger",o),n.on("pjax:send",function(e){n.addClass("has-mask")}),n.on("pjax:complete",function(e){n.removeClass("has-mask")}),e.pjax("#inline-dialog-changesets-dialog .file-history-widget a",o),e.pjax("#inline-dialog-branch-dialog .filter-list a",o),e.on("pjax:start",function(){t("#inline-dialog-branch-dialog").remove(),t("#inline-dialog-changesets-dialog").remove(),t("#inline-dialog-diff-dialog-diff1").remove(),t("#inline-dialog-diff-dialog-diff2").remove()}),e.on("pjax:timeout",function(){a(["atl._trackEvent","Source Browser","pjax timeout"])}),e.on("pjax:end",function(){s(),t(".tipsy:last").remove()}),u("#source-path",function(e){e.find(".add-file-link").tooltip({gravity:"w"})}),u("#checkout-branch-button",function(e){i(e,function(){return e.closest(".aui-buttons").find(".branch-dialog-trigger").attr("title")})}),r(function(e){return e.data("embed-url")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(293),n(325),n(149)],r=function(e,t,n,i,r,o){var a=1,s=t(".js-embed-link");return function(n){function i(e,i,r){var s=t(i);if(s.data("dialog-id")||s.data("dialog-id",a++),!e.find(".inline-dialog-embed-dialog").length){var l=o.toHtml("embed-template",{dialogId:s.data("dialog-id"),url:n(s)});e.append(l)}r&&r(),setTimeout(function(){t("#embed-code-"+s.data("dialog-id")).select()},0)}s.each(function(n,o){e.InlineDialog(t(o),"embed-dialog",i,{calculatePositions:r.alignRight()})})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(167)],r=function(e,t,n){return t(function(){var t=e("#source-list"),i=t.find(".date.deferred").first();i.length<1||(i.addClass("loading"),e.ajax({url:t.attr("data-lastmod-url"),success:function(i){e(i).each(function(){var n,i,r;return n=e(this),r=n.data("for"),r?(i=t.find(r),i.removeClass("deferred"),i.html(n)):void 0}),n()},complete:function(){i.removeClass("loading")}}))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(490),n(740),n(147)],r=function(e,t,n,i,r){return t(function(){e("#editor-container").find(".rename-link").click(function(){var t=e("#editor-container"),o=n.load("{}/{}".format(t.attr("data-owner"),t.attr("data-slug"))),a=t.attr("data-hash"),s=(t.attr("data-branch"),t.data("is-writer")),l=t.data("has-push-access"),u=t.attr("data-path"),c=t.attr("data-source-url");e.ajax({url:c,type:"GET",dataType:"json"}).done(function(e){var n=new i({repository:o,isRename:!0,isWriter:s,hasPushAccess:l,hash:a,branch:t.attr("data-branch"),path:u,sourceUrl:c});n.setContent(e.data),n.show()}),r(["atl._trackEvent","Online editing","Rename file"])})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(881),n(158)],r=function(e,t,n){return t(function(){var t=e("#source-view"),i=t.find("#file-history-trigger"),r=n(i,"changesets-dialog");r.init(),t.find(".edit-button-overlay").tooltip()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(891)],r=function(e,t){return e(function(e){var n=e.find(".textarea-preview"),i=e.data("isCreate"),r=e.find("#id_markup_type"),o=new t({el:n}).render();o.on("change:language",function(e){r.val(e)}),i&&e.find("#id_path").focus()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(405),n(694),n(696)],r=function(e,t,n,i){return n.extend({markItUpOptions:function(){return{syntax:this.language,isWiki:!0}},initialize:function(){n.prototype.initialize.call(this)},render:function(){return n.prototype.render.call(this),this._createDropdown(),this},setLanguage:function(e){this.language=e,this.$el.attr("data-markup-type",e).find("[class^=markup-type]").removeClass().addClass("markup-type-"+e),this.trigger("change:language",e)},_createDropdown:function(){this.languageDropdown=new i({el:e("#dropdown-wiki-lang"),$languageBtn:this.$(".markItUpButton.language"),language:this.language}).render(),this.listenTo(this.languageDropdown,"change:language",this.setLanguage)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145)],r=function(e,t,n){return n(function(){var e=t("#search-language-trigger"),n=e.closest("li"),i=n.find("select"),r=t("#id_language");r.auiSelect2({allowClear:!0}),e.on("click",function(e){e.preventDefault(),n.addClass("has-value"),r.auiSelect2("open")}),i.on("change",function(e){var n=t(e.target).val();t("#search-language").val(n),t("#repo-search-form").submit()});var o=t("#repo-search-form");o.on("submit",function(e){var n=t(e.target).find("#search-language");n.val()||n.remove()});var a=t("#search-query-input")[0];a.focus(),a.setSelectionRange(a.selectionEnd,a.selectionEnd)})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(293),n(886),n(283)],r=function(e,t,n,i,r){var o=function(t){var n;n=t.responseText?t.responseText:gettext("We had an issue enabling embedding on this file. Try again shortly."),e.messages.error({title:gettext("Error"),body:"<p>{}</p>".format(n)})};return n(function(){var e=t(".js-snippet-data"),n=e.data("embed-token-url-format");if(!n)throw new Error("Embed token URL format must be set for this to function properly.");r(function(e){var t=e.closest(".js-embed-meta");return t.data("embed-script-url")});var a=t(".js-enable-embeds");a.on("click",function(){var e=t(this),r=e.closest(".js-embed-meta"),a=function(){t.ajax({dataType:"json",type:"post",url:n.replace("__FILENAME__",r.data("filename")),data:{hash:r.data("snippet-hash"),token:r.data("embed-token")},success:function(t){var n=r.find(".js-button-swap").append(e).find(".js-disable-embeds");r.data("embed-script-url",t.script_url).find(".js-embed-buttons").prepend(n).append(r.find(".js-embed-link")).find(".js-embed-link").removeClass("hidden").click()},error:o})};r.data("snippet-is-private")?i({content:gettext("<span>This is a private snippet. Enabling embeds will allow <u><strong>anyone</strong></u> with the embed URL to view this file. Are you sure you want to do this?</span>"),buttonText:gettext("I am sure"),isSafeContent:!0,title:gettext("Publish file in private snippet?")}).done(a):a()});var s=t(".js-disable-embeds");s.on("click",function(){var e=t(this),r=e.closest(".js-embed-meta");i({content:gettext("This will disable any existing embeds. Are you sure?"),buttonText:gettext("I am sure"),title:gettext("Disable embeds?")}).done(function(){t.ajax({type:"delete",url:n.replace("__FILENAME__",r.data("filename")),data:{hash:r.data("snippet-hash")},success:function(){var t=r.find(".js-button-swap").append(e).append(r.find(".js-embed-link")).find(".js-enable-embeds");r.find(".js-embed-buttons").append(t)},error:o})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(305),n(304)],r=function(e,t,n,i){return t(function(t){var r=t,o=e("#snippets-pjax");n({$container:r,$pjaxContainer:o,ignoreQuery:"page"}),i(r,{$pjaxContainer:o})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(896),n(149)],r=function(e,t,n,i){return t(function(t){n.get().done(function(n){function r(e){return e.map(function(e){return e.name=e.title||e.id+": "+gettext("Untitled"),e})}(n.updated||n.recent)&&e("#snippets-dropdown-trigger").one("mouseover",function(){n.recent&&t.append(i.toHtml("snippet-dropdown-template",{sectionTitle:gettext("Recently viewed"),snippets:r(n.recent)})),n.updated&&t.append(i.toHtml("snippet-dropdown-template",{sectionTitle:gettext("Recently updated"),snippets:r(n.updated)}))})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(164),n(203)],r=function(e,t){return t({key:"snippet-history-"+e.id,url:"/!api/internal/snippets/user/history/"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(881),n(389),n(683)],r=function(e,t,n,i,r){return t(function(){var t=e("#view-snippet"),n=t.attr("data-comments-api-url"),o=e("#comments-list > .new-comment"),a=t.find("#general-thread-ids"),s=e(".snippet-header .follow");a.length&&i.decorateThreads(n,a.data("value")),o.length&&new r(n,!0).decorate(o),e(document).on("comment-added",function(){s.trigger("toggle-follow",{type:"snippet",isNowFollowing:!0})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(321),n(293),n(896),n(369)],r=function(e,t,n,i,r,o){return t(function(t){var a=e("#snippet-view-tabs").find("li"),s=e("#repo-content"),l=e(".delete-button");r.set(t.attr("data-id")),s.on("pjax:end",function(t){var n=s.find("> div:first").attr("id"),i=e("#"+n+"-tab");i.hasClass("aui-nav-selected")||(a.removeClass("aui-nav-selected"),i.addClass("aui-nav-selected")),e(t.target).removeClass("has-mask")}).on("pjax:error",function(t,n,i){return n.readyState>0&&"abort"!==i?(e(t.target).html("<h2>{}</h2>".format(gettext("An unexpected error occurred"))),!1):void 0}).on("pjax:beforeSend",function(t){e(t.target).addClass("has-mask")}),e.support.pjax&&a.on("click","a",function(t){var n=e(t.target).closest("li");t.preventDefault(),e.pjax({url:e(this).attr("href"),push:!0,container:s,scrollTo:null,timeout:3e4}),s.empty(),a.removeClass("aui-nav-selected"),n.addClass("aui-nav-selected")}),l.on("click",function(t){i({dialog2:!0,warning:!0,size:"small",buttonText:gettext("Delete"),title:l.attr("data-confirm-title"),content:l.attr("data-confirm-content")}).done(function(){e.ajax({url:l.attr("data-delete-url"),type:"DELETE"}).done(function(){o.addMessage(gettext("Snippet successfully deleted.")),window.location=l.attr("data-snippet-list-url")}).fail(function(){n(gettext("Failed to delete snippet."))})})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(145),n(307),n(900),n(901)],r=function(e,t,n){return t(function(){e.$("#is-ondemand, .title-tip").tooltip(),n({$pjaxContainer:e.$("#disk-usage-pjax"),$controls:e.$(".filter-search")})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(368)],r=function(e,t,n){return e(function(){var e=t("#git-gc");e.on("click",function(i){if(i.preventDefault(),!e.hasClass("loading")){e.addClass("loading");var r=function(){e.removeClass("loading"),alert("git gc failed")},o=function(t,n){e.removeClass("loading"),alert("git gc succeeded (size: "+n.old_size+" -> "+n.size+")")};t.ajax({type:"POST",url:e.attr("href"),error:r,success:function(e,t,i){setTimeout(function(){n(i.getResponseHeader("Location")).done(o).fail(r)},1e3)}})}})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(150),n(145),n(293),n(183),n(902)],r=function(e,t,n,i,r,o,a){var s=0,l=function(e,n){var i=e.id||s++,r=new o({width:e.width||450,height:e.height||"auto",id:"bb-support-"+i+"-confirmation-dialog"}),a=t("<div></div>").html(e.content),l=e.buttonText||gettext("Okay");return e.title&&r.addHeader(e.title),r.addPanel("main",a,"confirmation-dialog-body"),r.addButton(l,function(e){n.resolve(),e.remove()}),r};return i(function(){e.$("#repository-tabs").on("tabSelect",function(e,n){var i=n.pane,r=i.attr("data-iframe-url"),o=i.children("iframe");r&&!o.length&&t('<iframe width="100%" height="600px">').appendTo(i).attr("src",r)}),e.$("#change-read-only").on("click",function(e){e.preventDefault();var i,o,s=t(e.currentTarget).attr("data-read-only");return"false"===s?(o=new t.Deferred,i=l({title:"Reason for marking read-only",content:n.to_html(a)},o),i.addCancel("Cancel",function(){i.remove()}),i.show(),o.done(function(){var e=i.popup.element.find("input:radio[checked=checked]").val(),n=t("#readonly-form"),r=t("#readonly-form-reason"),o=t("#readonly-form-readonly");o.val("true"),r.val(e),n.submit()})):r("Make read-write?").done(function(){var e=t("#readonly-form"),n=t("#readonly-form-readonly");n.val("false"),e.submit()}),!1}),e.$("#change-staff-access").on("click",function(e){e.preventDefault(),t("#staff-access-form").submit()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports='<div><input name="reason" value="content" type="radio" id="ro-reason-content" disabled="disabled"><label for="ro-reason-content">Content violates TOS (notifies owner)</label></div>\n<div><input name="reason" value="size" type="radio" id="ro-reason-size" disabled="disabled"><label for="ro-reason-size">Repository size is excessive (notifies owner)</label></div>\n<div><input name="reason" value="none" type="radio" id="ro-reason-none" checked="checked"><label for="ro-reason-none">None; I\'m just on a power trip</label></div>'},function(e,t,n){var i,r;i=[n(145),n(3)],r=function(e,t){return e(function(){var e=t("#clear-branch-cache");e.on("click",function(n){n.preventDefault(),t.ajax({type:"DELETE",url:e.attr("href"),error:function(){alert("Clear branch cache failed")},success:function(e,t,n){alert("Branch cache cleared")}})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(8),n(368)],r=function(e,t,n,i){return e(function(){var e=t("#supportadmin-clear-user-sessions");e.on("click",function(i){i.preventDefault(),e.addClass("loading");var r=function(t,i,r){e.removeClass("loading"),n.messages.error({title:gettext("Error clearing sessions"),body:"<p>{}</p>".format(t.error.messages)})},o=function(t,i,r){e.removeClass("loading"),n.messages.success({title:gettext("Sessions cleared!")})};t.ajax({type:"PUT",dataType:"json",url:e.attr("href"),success:o,error:r})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(3),n(145),n(368),n(215),n(212)],r=function(e,t,n,i){return n(function(n){function r(){e.messages.success({title:"Repository has been deleted",body:"Redirecting in 5 seconds"}),setTimeout(function(){window.location.reload()},5e3)}function o(){e.messages.error({title:"Repository could not be deleted"})}var a=n.find("[type=submit]"),s={restore:!1};n.on("submit",function(e){e.preventDefault(),t.ajax({type:"delete",url:n.attr("action")}).done(function(e,t,n){var l=n.getResponseHeader("Location");a.loading(i(l),s).done(r).fail(o)})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(3),n(8),n(368)],r=function(e,t,n,i){return e(function(){var e=t("#supportadmin-delete-user-button"),r=t("#nuke-user-dialog"),o=n.dialog2(r),a=r.find("#really-nuke-user");e.on("click",function(e){e.preventDefault(),o.show()}),r.find("#dialog-close-button").on("click",function(e){e.preventDefault(),o.hide()}),a.on("click",function(e){e.preventDefault(),a.addClass("loading");var n=function(e,n){a.removeClass("loading");var i=t.parseJSON(n);alert(i.error.message),o.hide()},r=function(e,n){a.removeClass("loading");var i=t("#supportadmin-search-link").attr("href");alert("User "+n.username+" deleted by "+n.request_user),window.location.replace(i)};t.ajax({type:"DELETE",url:t("#nuke-user-link").attr("href"),success:function(e,t,o){setTimeout(function(){i(o.getResponseHeader("Location")).done(r).fail(n)},1e3)}})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(215),n(212)],r=function(e,t){return t(function(t){t.on("click",function(n){t.loading(e.ajax({type:"POST",url:t.attr("href")}),{loadTime:0,restore:!1}).done(function(){window.location.reload()})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(148),n(176)],r=function(e,t,n,i){return t(function(){n||i()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(147)],r=function(e,t){return e(function(){t(["atl._trackPageview","/repo/cloned"])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(324),n(164),n(215)],r=function(e,t,n,i){return t(function(){function t(e){var t=!("OK"===e.status);t&&c.text("Inheriting permissions exceeds the user limit for {}.".format(e.user.username)),e.can_upgrade&&n(d,{data:e}),c.toggleClass("hidden",!t),d.disable(t)}function r(){var n=e.ajax({url:a,type:"PUT",data:{is_private:l.is(":checked"),inherit:u.is(":checked"),target_user:s.find(":selected").text()||i.username}});d.loading(n),n.done(function(e){t(e)}),n.fail(function(e){402===e.status&&t(JSON.parse(e.responseText).data)})}var o=e("#fork-form"),a=o.attr("data-fork-overflow-url"),s=e("#id_owner"),l=e("#id_is_private"),u=e("#id_inherit"),c=e("#inherit-error"),d=o.find('button[type="submit"]');e("#id_owner, #id_is_private, #id_inherit").on("change",r),r()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(167),n(912),n(913)],r=function(e,t,n,i,r){return t(function(){var t=e("#github-repositories"),o=t.find(".mask");e.get(t.attr("data-html-url"),function(a){var s=e(a);n(s.find("time")),o.replaceWith(s);var l=new i(s.children(".github-import-data").data("imports"),{url:t.data("api-url")});new r({el:t,collection:l}).render(),l.fetch()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1)],r=function(e){return e.Collection.extend({initialize:function(e,t){this.url=t.url}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(1),n(149)],r=function(e,t,n,i){return n.View.extend({initialize:function(e){this.collection.bind("add",this.insert,this),this.collection.bind("reset",this.update,this),this.collection.bind("reset",this.poll,this)},statusTemplate:t.bind(i.toHtml,null,"github-import-progress"),buttonTemplate:t.bind(i.toHtml,null,"github-import-finished-button"),events:{"click button.github-start-import":"start","click button.github-import-all":"importAll"},pollDelayMs:1e3,spinnerDelayMs:500,poll:function(){var e=this.collection,t=e.any(function(e){return e.get("running")});t&&setTimeout(function(){e.fetch({reset:!0})},this.pollDelayMs)},start:function(t){var n=this;1===n.$("button.github-start-import:enabled").length&&n.disableImportAll();var i=e(t.target);i.attr("aria-disabled","true").attr("disabled","disabled");var r=setTimeout(function(){i.addClass("loading")},this.spinnerDelayMs);this.collection.create({url:i.data("url"),type:i.data("type")},{wait:!0,complete:function(){clearTimeout(r),n.poll()}})},importAll:function(n){var i=this,r=e(n.target).attr("data-type");i.disableImportAll();var o=i.$("button.github-start-import");o.attr("aria-disabled","true").attr("disabled","disabled");var a=setTimeout(function(){o.addClass("loading")},this.spinnerDelayMs);e.post(i.collection.url,{type:r},function(e){clearTimeout(a),t.each(e,function(e){i.collection.add(e)}),i.poll()})},disableImportAll:function(){var e=this.$("button.github-import-all");e.attr("aria-disabled","true").attr("disabled","disabled")},$buttonForModel:function(t){var n=t.get("url");return this.$("button.github-start-import").filter(function(){return e(this).attr("data-url")===n})},insert:function(t){var n=this.$buttonForModel(t),i=n.closest("article").find("h1"),r=i.find(".name").text(),o=t.get("succeeded")?"repository_html_url":"html_url",a=e("<a>").attr("href",t.get(o));i.find(".name").html(a.text(r)),i.append(this.statusTemplate(t.toJSON()))},update:function(){var n=this,i=t.map(n.$(".github-import-status"),function(t){return e(t).data("id")}),r=t.difference(i,n.collection.map(function(e){return e.get("id")}));t.each(r,function(e){var t=n.$("#github-import-status-"+e),i=t.closest("article").find(".github-start-import"),r=n.failedJSON(e,t.attr("href"));t.replaceWith(n.statusTemplate(r)),i.removeClass("loading").fadeOut(300,function(){i.replaceWith(n.buttonTemplate(r))})}),n.collection.each(function(t){var i=n.$("#github-import-status-"+t.get("id")),r=i.closest("article").find("h1"),o=i.closest("article").find(".github-start-import"),a=r.find(".name").text(),s=t.get("succeeded")?"repository_html_url":"html_url",l=e("<a>").attr("href",t.get(s));r.find(".name").html(l.text(a));var u=i.data("queued")&&!t.get("queued");u?setTimeout(function(){i.replaceWith(n.statusTemplate(t.toJSON()))},n.pollDelayMs/2):i.replaceWith(n.statusTemplate(t.toJSON()));var c=i.data("running")&&!t.get("running");c&&o.removeClass("loading").fadeOut(300,function(){o.replaceWith(n.buttonTemplate(t.toJSON()))})})},failedJSON:function(e,t){return{id:e,html_url:t,queued:!1,running:!1,succeeded:!1,failed:!0}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(569),n(198),n(147)],r=function(e,t,n,i,r){return t(function(){var t=e("#importing"),o=t.attr("data-success-url");n(t).done(function(){i(1e3,function(){location.href=o})}),function(){function e(){var e={};if("source-goog"===e.source)return"Google Code, "+e.scm;var t=[e.scm,e.auth?"auth":"no auth"];return"svn"===e.scm&&t.push("no history"),t.join(", ")}r(["atl._trackEvent","Importer",e()])}()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(579),n(578),n(215)],r=function(e,t,n,i){return t(function(){function t(){var e=o.val()&&!o.hasClass("invalid")&&a.val()&&!a.hasClass("invalid")&&s.val();l.disable(!e)}e("#logout-button").on("click",function(t){t.preventDefault();var n=e(this);e.get(n.data("logoutUrl")).complete(function(){window.location=n.attr("href")})});var r=e(".signup-form"),o=e("#id_username"),a=e("#id_email"),s=e("#id_password1"),l=r.find("button");if(r.length){var u=new i;n.username(o,u).onValidate(t).validate(),n.email(a,u).onValidate(t).validate(),s.on("input blur",t),t()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(312)],r=function(e,t,n){return t(function(){e(".upgrade-button").on("click",function(t){n("upgrade_button_clicked",{user:e(t.target).attr("data-target-user")})})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(145),n(918),n(643)],r=function(e,t,n,i){return t(function(){i.onReady();var t=e("#import-form");1===t.length&&((new n).bind(t),t.find("input[type=submit]").removeAttr("disabled"));var r=e("#repo-import .sidebar a.import-github"),o=r.find("form.connect-button");o.length&&r.on("click",function(e){e.preventDefault(),o.submit()})})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(922),n(923),n(924),n(919),n(925),n(926),n(165),n(198)],r=function(e,t,n,i,r,o,a,s,l,u){var c=function(t){this.sources_={"source-svn":new n(this),"source-hg":new i(this),"source-goog":new o(this),"source-sourceforge":new a(this),"source-codeplex":new s(this),"source-git":new r(this)},this.source_=null,this.previousUrl_=null,this.urlTimeout_=null,this.ajax_=null,this.$message_=e("<div></div>"),this.$form_=null,this.$url_=null,this.$source_=null,this.$scm_=null};return c.prototype={bind:function(t){this.$form_=t,this.$sourceScm_=e("#id_source_scm"),this.$url_=e("#id_url"),this.$source_=e("#id_source"),this.$auth_=e("#id_auth"),this.$authFields_=e("#url-auth-fields"),this.$username_=e("#id_username"),this.$password_=e("#id_password"),this.$submitButton_=this.$form_.find("button[type=submit]"),this.$scm_=t.find("input[name=scm]"),this.$url_.add(this.$username_).add(this.$password_).change(this.verifyUrl.bind(this)),this.$source_.change(this.onSourceChange_.bind(this)),this.$auth_.change(this.onAuthChange_.bind(this)),this.$submitButton_.click(this.disableButtonAndSubmit_.bind(this)),e(document).bind("source-scm-change",this.onSourceScmChange_.bind(this));for(var n in this.sources_)this.sources_[n].bind(t);this.$auth_.is(":checked")&&!this.$authFields_.is(":visible")&&this.$authFields_.show(),this.onSourceChange_(null,!0),this.$message_.delegate("a.suggestion","click",this.useSuggestedUrl_.bind(this)).hide().appendTo(this.$url_.closest("div"))},renderUrl:function(e){this.$url_.val(e),e!==this.previousUrl_&&this.resetUrlStatus_(),this.previousUrl_=e},verifyUrl:function(t){var n=this.$url_.val();if(""!==n){this.ajax_&&this.ajax_.abort();var i=this.$url_;this.urlTimeout_=u(300,function(){i.removeClass("valid invalid").addClass("loading")});var r={};this.source_.canAuth()&&this.$auth_.is(":checked")&&e.extend(r,{username:e("#id_username").val(),password:e("#id_password").val()}),this.ajax_=e.ajax({url:"/!api/1.0/_import/{}/{}".format(this.source_.scm(),encodeURIComponent(n)),type:"POST",data:r,dataType:"json",timeout:3e4,complete:this.ajaxComplete_.bind(this),success:this.ajaxSuccess_.bind(this)})}},useSuggestedUrl_:function(t){t.preventDefault();var n=e(t.target).attr("href");this.renderUrl(n),this.verifyUrl()},resetUrlStatus_:function(){this.$url_.removeClass("valid invalid"),this.$message_.hide().removeClass("error")},ajaxComplete_:function(e,t){if(clearTimeout(this.urlTimeout_),this.$url_.removeClass("loading"),"timeout"===t)this.$url_.addClass("invalid"),this.$message_.addClass("error").text(gettext("Connecting to the URL timed out.")).slideDown();else switch(e.status){case 400:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown();
break;case 404:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown();break;case 401:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(gettext("Authentication failed.")).slideDown();break;case 403:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown()}},ajaxSuccess_:function(e,t,n){if(200===n.status)if(e.svn)if(e.trunk)this.$url_.removeClass("invalid").addClass("valid"),this.$message_.slideUp();else{this.$url_.removeClass("valid").addClass("invalid");var i,r=gettext("The URL does not point to trunk."),o=gettext('The URL does not point to trunk. <a class="suggestion" href="%(suggest_url)s">Use trunk instead?</a>');i=0===e.suggestions.length?r:interpolate(o,{suggest_url:e.suggestions[0]},!0),this.$message_.addClass("error").html(i).slideDown()}else this.$message_.slideUp(),this.$url_.removeClass("invalid").addClass("valid")},disableButtonAndSubmit_:function(e){this.$submitButton_.attr({disabled:"disabled"}),this.$sourceScm_.val(this.source_.scm()),this.$form_.submit()},onAuthChange_:function(e){this.$authFields_.slideToggle(),this.verifyUrl()},onSourceChange_:function(e,t){this.source_&&this.source_.hideSource(t),this.source_=this.sources_[this.$source_.val()],this.source_.showSource(t),this.verifyUrl()},onSourceScmChange_:function(e){var t=this.source_.scm();this.$form_.find("#hidden_scm_input").remove(),"git"===t||"hg"===t?(this.$scm_.prop({disabled:!0}),this.$scm_.prop({checked:!1}).filter("[value="+t+"]").prop({checked:!0}).change(),this.$form_.append('<input id="hidden_scm_input" type="hidden" name="scm" value="'+t+'"/>')):this.$scm_.prop({disabled:!1})}},c}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(920)],r=function(e,t,n){var i=function(e){n.call(this,e)};return i.prototype=t.extend(new n,{template_:{hg:t.template("https://<%= projectName %>.googlecode.com/hg/"),svn:t.template("http://<%= projectName %>.googlecode.com/svn/trunk"),git:t.template("https://code.google.com/p/<%= projectName %>/")},bindSourceFields_:function(t){this.$container_=e("#source-fields-goog"),this.$projectName_=e("#id_goog_project_name"),this.$scm_=e('[name="goog_scm"]')}}),i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(921),n(198)],r=function(e,t,n,i){var r=function(e){this.repositoryImporter=e,this.idleVerifyUrlTimeout_=null,this.$form_=null,this.$auth_=null,this.$url_=null,this.$container_=null,this.$projectName_=null,this.$scm_=null};return r.prototype=t.extend(new n,{template_:{},bind:function(t){this.$form_=t,this.$auth_=e("#id_auth").closest("div.checkbox"),this.$name_=e("#id_name"),this.$url_=e("#id_url"),this.bindSourceFields_(t);var n=e(this.inputElements_());n.keydown(this.onKeyDown_.bind(this)),n.keyup(this.onKeyUp_.bind(this)),n.change(this.onProjectNameChange_.bind(this)),n.blur(this.cancelIdleUrlVerification_.bind(this)),this.$scm_.change(this.renderAndVerifyUrl_.bind(this)),this.$scm_.change(this.onSourceScmChange_.bind(this))},inputElements_:function(){return this.$projectName_[0]},getProjectName_:function(){return this.$projectName_.val()},bindSourceFields_:function(e){},canAuth:function(){return!1},onKeyDown_:function(e){if(8===e.keyCode){var t=this.$projectName_.val();t.startsWith(this.$name_.val())&&this.$name_.val(t.rstrip(/./))}},cancelIdleUrlVerification_:function(){window.clearTimeout(this.idleVerifyUrlTimeout_)},onKeyUp_:function(e){this.cancelIdleUrlVerification_(),this.idleVerifyUrlTimeout_=i(2e3,this.renderAndVerifyUrl_.bind(this)),this.repositoryImporter.renderUrl(this.url());var t=this.$projectName_.val();t.startsWith(this.$name_.val())&&this.$name_.val(t)},onProjectNameChange_:function(){this.repositoryImporter.renderUrl(this.url()),this.repositoryImporter.verifyUrl()},renderAndVerifyUrl_:function(){this.repositoryImporter.renderUrl(this.url()),this.repositoryImporter.verifyUrl()},url:function(){var e=this.getProjectName_().trim();return e?this.template_[this.scm()]({projectName:e}):""},scm:function(){return this.$scm_.filter(":checked").val()},showSource:function(e){this.onSourceScmChange_(),this.$url_.prop({readonly:!0}),this.$url_.val(""),this.$container_.is(":visible")||(e?(this.$container_.show(),this.canAuth()?this.$auth_.show():this.$auth_.hide()):(this.$container_.slideDown(),this.canAuth()?this.$auth_.slideDown():this.$auth_.slideUp()))},hideSource:function(e){this.$container_.is(":visible")&&(e?(this.$container_.hide(),this.$auth_.show()):(this.$container_.slideUp(),this.$auth_.slideDown())),this.$url_.prop({readonly:!1})}}),r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){var t=function(e){};return t.prototype={canAuth:function(){return!0},bind:function(e){},scm:function(){return"not-implemented"},onSourceScmChange_:function(){e(document).trigger("source-scm-change")},showSource:function(){this.onSourceScmChange_()},hideSource:function(){}},t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(921)],r=function(e,t,n){var i=function(e){this.$help_=null};return i.prototype=t.extend(new n,{scm:function(){return"svn"},showSource:function(){this.onSourceScmChange_(),this.$help_.show()},hideSource:function(){this.$help_.hide()},bind:function(t){this.$help_=e("#source-fields-subversion")}}),i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(2),n(921)],r=function(e,t){var n=function(e){};return n.prototype=e.extend(new t,{scm:function(){return"hg"}}),n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(921)],r=function(e,t,n){var i=function(e){this.$name_=null,this.$url_=null};return i.prototype=t.extend(new n,{bind:function(t){this.$name_=e("#id_name"),this.$url_=e("#id_url"),this.$url_.change(this.onUrlChange_.bind(this))},scm:function(){return"git"},onUrlChange_:function(){var e=this.$url_.val().trim(),t=/\/([^\/]*?)(\.git)?$/.exec(e);t&&""===this.$name_.val()&&this.$name_.val(t[1])}}),i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(920)],r=function(e,t,n){var i=function(e){n.call(this,e)},r={legacy:{hg:t.template("http://<%= projectName %>.hg.sourceforge.net:8000/hgroot/<%= projectName %>"),svn:t.template("https://<%= projectName %>.svn.sourceforge.net/svnroot/<%= projectName %>")},recent:{hg:t.template("http://hg.code.sf.net/p/<%= projectName %>/<%= mountPoint %>"),svn:t.template("http://svn.code.sf.net/p/<%= projectName %>/<%= mountPoint %>")}};return i.prototype=t.extend(new n,{inputElements_:function(){return[this.$projectName_[0],this.$mountPoint_[0]]},url:function(){var e=this.getProjectName_().trim();if(!e)return"";var t=this.$mountPoint_.val().trim(),n=t?"recent":"legacy";return r[n][this.scm()]({projectName:e,mountPoint:t})},bindSourceFields_:function(t){this.$container_=e("#source-fields-sourceforge"),this.$projectName_=e("#id_sourceforge_project_name"),this.$mountPoint_=e("#id_sourceforge_mount_point"),this.$scm_=e('[name="sourceforge_scm"]')}}),i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(2),n(920)],r=function(e,t,n){var i=function(e){n.call(this,e)};return i.prototype=t.extend(new n,{template_:{hg:t.template("https://hg01.codeplex.com/<%= projectName %>/"),svn:t.template("https://<%= projectName %>.svn.codeplex.com/svn/")},bindSourceFields_:function(t){this.$container_=e("#source-fields-codeplex"),this.$projectName_=e("#id_codeplex_project_name"),this.$scm_=e('[name="codeplex_scm"]')}}),i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(145),n(147)],r=function(e,t){return e(function(){t(["atl._trackEvent","Social registration","Reject"])})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(8),n(187),n(3),n(145),n(180),n(164),n(183),n(246),n(147)],r=function(e,t,n,i,r,o,a,s,l){return i(function(){var i=n("#social-wizard"),u=function(e,t,i,r,o,s){var l=new a({width:i,height:"auto",id:e,closeOnOutsideClick:!0});return l.addHeader(r),l.addPanel("body",t,"panel-body"),l.addButton("Save",o.save,"save-button"),l.addCancel("Cancel",o.cancel),t.show(),t.on("submit",function(e){e.preventDefault(),n(l.popup.element).find(".save-button").trigger("click")}),s.on("click",function(){l.show()}),l},c=function(e){var t=n(e.popup.element);t.find(".error").addClass("hidden"),t.find("input, textarea").val("")};e.bind("show.dialog",function(e,t){c(t.dialog)});var d=function(e,t){n(e.popup.element).find(".error").removeClass("hidden").find(".message").text(t)},h=function(e){n(e.popup.element).find(".save-button").prop("disabled",!0)},p=function(e){n(e.popup.element).find(".save-button").removeProp("disabled")},f=function(){i.find('[href="/"]').addClass("aui-button").addClass("aui-button-primary").text("Go to dashboard")};i.find('[href="/"]').on("click",function(){"Do this later"===n(this).text()&&l(["atl._trackEvent","Social registration","Wizard","Do this later"])}),s("#add-ssh-key-form",function(e){var i=u("ssh-key-dialog",e,840,"Add an SSH key",{save:function(r){if(!n("#id_key").val())return void d(i,"Please enter an SSH key before saving.");h(i);var a=t.user(o.username);a.add_ssh_key(e.serializeArray()).success(function(){f(),i.hide(),n("#account-ssh-key").addClass("completed"),l(["atl._trackEvent","Social registration","Wizard","Set key"])}).error(function(){d(i,"The SSH key entered is invalid.")}).complete(function(){p(i)})},cancel:function(e){e.hide()}},n("#set-ssh-key"))}),s("#account-ssh-key[data-import-url]",function(t){var i=t.data("import-url");n("#import-ssh-keys").on("click",function(){t.addClass("loading"),n.ajax({url:i,dataType:"json"}).success(function(n){t.removeClass("loading"),n.length>0?(f(),t.find(".key-count").text(n.length).end().addClass("completed"),l(["atl._trackEvent","Social registration","Wizard","Import keys"])):e.messages.warning({body:"Import failed. Are your SSH keys already associated with another Bitbucket account?"})})})});var m=n("#choose-password-form"),g=u("password-dialog",m,400,"Choose a password",{save:function(e){return n("#id_new_password1").val()&&n("#id_new_password2").val()?n("#id_new_password1").val()!==n("#id_new_password2").val()?void d(g,"The values entered do not match"):(h(g),void n.ajax({url:m.attr("action"),type:"POST",data:m.serialize(),dataType:"html"}).success(function(){f(),g.hide(),n("#account-password").addClass("completed"),l(["atl._trackEvent","Social registration","Wizard","Set password"])}).error(function(){d(g,"There was a problem processing your request.")}).complete(function(){p(g)})):void d(g,"Please complete both fields before saving")},cancel:function(e){e.hide()}},n("#set-password"));n(".ssh-key-copy-help."+r.os.toLowerCase()).show();var v=function(t,n,i){e.InlineDialog(t,n,function(e,t,r){l(["atl._trackEvent","Social registration","Wizard",n]),e.html(i.html()),r&&r()})};v(n("#ssh-key-help-trigger"),"ssh-key-help",n("#ssh-key-help")),v(n("#password-help-trigger"),"password-help",n("#password-help"))})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(1),n(3)],r=function(e,t){var i=e.Router.extend({routes:{"snippets/new":"new","snippets/:owner/:id/edit/":"edit"},"new":function(){n.e(1,function(e){var n=[e(930),e(940)];(function(e,n){var i=t(".snippet-form"),r=i.find(".snippets-owner-input option:selected").data("user"),o="private"===i.find("input[name=permissions]:checked").val(),a=new e({owner:r,is_private:o});new n({el:i,model:a}).render()}).apply(null,n)})},edit:function(){n.e(1,function(e){var n=[e(930),e(940)];(function(e,n){var i=t(".snippet-form"),r=i.find(".snippets-json").data("snippets-json"),o=new e(r,{parse:!0});new n({el:i,model:o}).render()}).apply(null,n)})}});return new i}.apply(t,i),!(void 0!==r&&(e.exports=r))}]);
//# sourceMappingURL=app.js.map